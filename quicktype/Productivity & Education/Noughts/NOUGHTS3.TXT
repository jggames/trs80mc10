1000 REM **********************
1020 REM *        A.I.        *
1030 REM *                    *
1040 REM * NOUGHTS & CROSSES  *
1050 REM *       5/2/79       *
1060 REM * BY TREVOR L. LUSTY *
1070 REM *                    *
1080 REM **********************
1100 CLS
1200 DIM E1(10),E2(12),B(3,3),T(200),M(200),S(8):GOSUB4000
1220 PRINT"THIS IS A GAME OF NOUGHTS":PRINT"AND CROSSES WITH THE BOARD"
1240 PRINT"NUMBERED AS FOLLOWS:"
1260 PRINT
1280 PRINT"1 I 2 I 3"
1300 PRINT"==I===I=="
1320 PRINT"4 I 5 I 6"
1330 PRINT"==I===I=="
1360 PRINT"7 I 8 I 9":PRINT
1380 INPUT"HIT ENTER TO CONTINUE";M$:CLS
1400 PRINT"YOU MAY BEAT ME AT FIRST,"
1401 PRINT"BUT I LEARN FROM MY MISTAKES"
1420 PRINT"AND I NEVER MAKE THE SAME"
1421 PRINT"MISTAKE TWICE-- YOU HAVE"
1422 PRINT"BEEN WARNED!"
1440 PRINT
1480 PRINT"WE WILL TAKE TURNS-- YOU WILL"
1481 PRINT"BE X I SHALL BE O."

1500 REM * INITIALIZE VARIABLES *
1520 L$="X.O"
1540 M7=0
1560 Q=1
1580 T(Q)=0
1600 M(Q)=511

1620 REM * CLEAR BOARD BEFORE NEXT GAME *
1640 FOR N1=1 TO 3
1660 FOR N2=1 TO 3
1680 B(N1,N2)=0
1700 NEXT N2
1720 NEXT N1
1740 PRINT
1760 PRINT
1780 PRINT "OK, LET'S START."
1800 M9=0
1820 REM * DECIDE WHO STARTS *
1840 M7=M7+1
1860 IF M7=2*INT(M7/2) THEN 2280
1880 PRINT "WHAT IS YOUR MOVE";
1900 INPUT H

1920 REM * CHANGE COORDINATES *
1940 GOSUB 3120:IF Y>3 OR Y<1 OR X>3 OR X<1 THEN 1980
1960 IF B(Y,X)=0 THEN 2040
1980 PRINT"ILLEGAL MOVE-- TRY AGAIN."
2000 PRINT
2020 GOTO 1880
2040 B(Y,X)=1
2060 M9=M9+1:GOSUB3580

2080 REM * HAS OPPONENT WON? *
2100 GOSUB 3200
2120 IF F1=1 THEN 2200
2140 IF M9<9 THEN 2280
2160 PRINT"DRAW-- I MUST BE GETTING":PRINT"BETTER."
2180 GOTO 1640
2200 M(Q2)=M(Q2)-E2(P2-1)
2220 PRINT"I CONCEDE. --- YOU WIN ---":PRINT"I'LL TRY HARDER NEXT TIME."
2240 GOTO 1640

2260 REM * COMPUTE PATTERN *
2280 T2=0
2300 FOR N1=1 TO 3
2320 T1=9*(B(N1,1)+1)+3*(B(N1,2)+1)+(B(N1,3)+1)
2340 T2=T2+T1*E1(2*N1)
2360 NEXT N1

2380 REM * SEARCH TABLE *
2400 FOR Q1=1 TO Q
2420 IF T(Q1)=T2 THEN 2660
2440 NEXT Q1

2460 REM * INSERT NEW POSITION IN TABLE *
2480 Q=Q+1:Q1=Q:REM Q=Q1=Q+1
2500 T(Q)=T2
2520 M(Q)=0
2540 FOR N1=1 TO 3
2560 FOR N2=1 TO 3
2580 IF B(N1,N2)<>0 THEN 2620
2600 M(Q)=M(Q)+E2(3*(N1-1)+(N2-1))
2620 NEXT N2
2640 NEXT N1

2660 REM * FIND COMPUTER'S MOVE *
2680 IF M(Q1)=0 THEN 2200
2700 FOR P1=1 TO 9
2720 IF M(Q1)/E2(P1)<>INT(M(Q1)/E2(P1)) THENZZ=P1:P1=9:NEXT P1:P1=ZZ:GOTO 2760
2740 NEXT P1
2760 Q2=Q1
2780 P2=P1
2800 PRINT"COMPUTER PLAYS POSITION";P1
2820 H=P1
2840 GOSUB 3120
2860 B(Y,X)=-1
2880 M9=M9+1

2900 REM * PRINT BOARD/TEST WIN *
2920 GOSUB 3580
2940 GOSUB 3200
2960 IF F1=-1 THEN 3020

2980 IF M9<9 THEN 1880
3000 GOTO 2160
3020 PRINT"I WIN!!! TRY AGAIN?"
3040 INPUT A$
3060 IF LEFT$(A$,1)="Y" THEN 1640
3065 IF LEFT$(A$,1)<>"N" THEN 3040
3080 END

3100 REM * CONVERT TO XY COORDINATES *
3120 Y=INT((H-1)/3)+1
3140 X=H-3*(Y-1)
3160 RETURN

3180 REM * TEST FOR A WIN *
3200 FOR N1=1 TO 3
3220 S(N1)=B(N1,1)+B(N1,2)+B(N1,3)
3240 S(N1+3)=B(1,N1)+B(2,N1)+B(3,N1)
3260 NEXT N1

3280 REM * TEST DIAGONALS *
3300 S(7)=B(1,1)+B(2,2)+B(3,3)
3320 S(8)=B(3,1)+B(2,2)+B(1,3)

3340 REM * SEARCH TABLE FOR WIN *
3360 FOR N1=1 TO 8
3380 IF S(N1)=3 THEN 3480
3400 IF S(N1)=-3 THEN 3520
3420 NEXT N1
3440 F1=0
3460 RETURN
3480 ZZ=N1:N1=8:NEXT N1:N1=ZZ:F1=1
3500 RETURN
3520 ZZ=N1:N1=8:NEXT N1:N1=ZZ:F1=-1
3540 RETURN

3560 REM * PRINT THE BOARD *
3580 PRINT
3600 FOR N1=1 TO 3
3620 FOR N2=1 TO 3
3640 M8=2-B(N1,N2)
3660 PRINT MID$(L$,M8,1)" ";
3680 NEXT N2
3700 PRINT
3720 NEXT N1
3740 PRINT
3760 RETURN

4000 E2(0)=1
4001 E2(1)=2
4002 E2(2)=4
4003 E2(3)=8
4004 E2(4)=16
4005 E2(5)=32
4006 E2(6)=64
4007 E2(7)=128
4008 E2(8)=256
4009 E2(9)=512
4010 E2(10)=1024
4011 E2(11)=2048
4012 E2(12)=4096
5000 E1(0)=1 
5001 E1(1)=10 
5002 E1(2)=100 
5003 E1(3)=1000 
5004 E1(4)=10000 
5005 E1(5)=100000 
5006 E1(6)=1000000 
5007 E1(7)=10000000
5008 E1(8)=100000000 
5009 E1(9)=1000000000
5010 E1(10)=10000000000:RETURN
5020 REM MC-10 EDITS JIM GERRIE
5030 REM AND GEORGE PHILLIPS
