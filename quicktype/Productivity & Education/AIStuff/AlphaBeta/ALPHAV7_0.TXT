0 CLS:CLEAR128:M=16384:C1=0:C2=0:GOTO105
100 REM ** ALPHA MAINLINE, V.7-- TRS-80 **
110 CLS:PRINT
105 DIMAC(5,8)
110 AC(1,8)=42:FORN=2TO5:AC(N,8)=37:NEXTN
115 CLS0:GOSUB1000
120 FORCN=1TO5
125 AC(CN,2)=M+RND(415):IFPEEK(AC(CN,2))<>128THEN125
130 POKEAC(CN,2),AC(CN,8):AC(CN,1)=1:AC(CN,6)=1:NEXTCN
135 FORN=0TO15
140 TP=M+RND(415):IFPEEK(TP)<>128THEN140
145 POKETP,191:NEXTN
150 FORCN=1TO5
155 IFAC(CN,6)=0THEN165
160 ONAC(CN,1)GOTO170,185,220
165 NEXTCN:GOTO150
170 FORN=4TO5:AC(CN,N)=RND(5)-3:NEXTN
175 IFAC(CN,4)=0ANDAC(CN,5)=0THEN170
180 AC(CN,1)=2:GOTO165
185 CP=AC(CN,2):CI=AC(CN,4):CJ=AC(CN,5)
190 GOSUB2000
195 IFCX=128ANDCY=128THEN210
200 IFCN=1THENAC(CN,1)=3:GOTO215
201 AC(CN,1)=1
205 GOTO215
210 POKECP,128:CP=NP:POKECP,AC(CN,8):AC(CN,1)=2
215 AC(CN,2)=CP:AC(CN,3)=NP:GOTO165
220 KC=RND(2)-1:IFKC=0THENAC(CN,1)=1:GOTO165
225 PP=PEEK(AC(CN,3))
230 IFPP>129ANDPP<=190THENPOKEAC(CN,3),153:GOTO255
235 FORN=2TO5
240 IFAC(CN,3)=AC(N,2)THENAC(N,6)=0:GOTO250
245 NEXTN
250 POKEAC(CN,3),128
255 AC(CN,1)=2:GOTO165
260 REM
265 REM
1000 REM ** BORDER, V.1-- TRS-80 **
1005 F0=M:F1=M+31:F2=M+384:F3=F2+31
1010 FORN=F0TOF1:POKEN,188:NEXT
1015 FORN=F2TOF3:POKEN,179:NEXT
1020 FORN=F0TOF2STEP32:POKEN,186:NEXT
1025 FORN=F1TOF3STEP32:POKEN,181:NEXT
1030 POKEF0,177:POKEF1,178:POKEF2,180:POKEF3,184
1035 RETURN
1040 REM
1045 REM
2000 REM ** SEARCH AHEAD, V.1-TRS-80 **
2005 NP=CP:CX=128:CY=128
2010 SI=SGN(CI):SJ=SGN(CJ):AI=ABS(CI):AJ=ABS(CJ)
2015 IFAI=0THEN2030
2016 AI=AI-1
2020 IFSI>0THENNP=NP+1:GOTO2025
2021 NP=NP-1
2025 CX=PEEK(NP)
2030 IFAJ=0THEN2045
2031 AJ=AJ-1
2035 IFSJ>0THENNP=NP+32:GOTO2040
2036 NP=NP-32
2040 CY=PEEK(NP)
2045 IFNOT(CX=128ANDCY=128)THENRETURN
2050 IFAI=0ANDAJ=0THENRETURN
2051 GOTO2015
2055 REM
2060 REM
4000 REM ALPHA COMBO DEMO
4010 REM      TRS-80
