10 REM***FAMILY TREE**
20 REM**BY R.C.MERRY**
30 REM****************
40 REM****MAY 1980****
50 REM****************
60 REM*RECORDING YOUR*
70 REM*FAMILY HISTORY*
80 REM**ON AN 8K PET**
90 REM****************
100 DIMN$(31),X$(22),Z$(31)
110 FORI=1TO31:Z$(I)=RIGHT$(STR$(I),2):NEXT
120 CLS:PRINT@260,"FAMILY TREE":PRINT:PRINT"LOAD A FAMILY TREE FILE (Y/N)?":GOSUB1110
130 IFR$="N"THEN160
140 PRINT:PRINT"LOAD FAMILY TREE FILE":PRINT"PRESS ANY KEY WHEN READY.":GOSUB1110
150 OPEN1.1,0."FAMILY TREE",FORI=01.031,INPUT*I.N$(1),NEXT,CLOSE1,0070210
160 FORI=1TO31:N$(I)="X"
170 FORJ=1TO6:N$(I)=N$(I)+N$(I)
180 NEXTJ,I
190 N$(0)="X"
200 FORJ=ITO5:N$(0)=N$(0)+N$(0):NEXT
210 FORI=2TO31:IFLEFT$(N$(I),3)<>"XXX"THENZ$(I)+"$"+Z$(I)+"#"
220 NEXT
230 CLS0
231 PRINTZ$(16)"€"Z$(17)"€€€"Z$(20)"À"Z$(21)"€€€"Z$(24)"À"Z$(25)"€€"Z$(28)"À"Z$(29)"À€€€";
232 PRINT"€€Ê€€€€€€ÀÊ€€€€€€€Ê€€€€€ÀÊÀ€€€€€";
233 PRINT"À€Ê€"Z$(18)"À"Z$(19)"€Ê€"Z$(22)"€"Z$(23)"€Ê"Z$(26)"À"Z$(27)"ÀÊÀ"Z$(30)"À"Z$(31);
234 PRINT"À€Ê€€ÃÇ€€ÃÊÀÃÃÊ€€ÃÊ€ÃÇÀ€ÃÊÀÃÃÊÀÀ";
235 PRINT"€€Ê€€Ê€€€Ê€ÀÊ€€€ÀÊ€€ÊÀ€€Ê€€Ê€€€€";
236 PRINT"€"Z$(8)"€"Z$(9)"€À"Z$(10)"À"Z$(11)"€€€"Z$(12)"€"Z$(13)"€€"Z$(14)"À"Z$(15)"À€€€";
237 PRINT"€€€ËÃÂ€€ÃÃÊ€€€€€€€ËÃÂ€€ÃÃÊÀ€€€€€";
238 PRINT"€€€€€Ê€€Ê€€€€€€€€€€€Ê€€Ê€€À€€€€€";
239 PRINT"€€€€"Z$(4)"€"Z$(5)"€€€€€€€À€€"Z$(6)"€"Z$(7)"€€€€€€€€";
240 PRINT"€€€€€€ËÃÃÃÃÃÃÂÀÀÃÃÃÃÃÊ€€€€€€€€€€";
241 PRINT"€€€€€€À€€€€€€Ê€€Ê€€€€€€€€€€€€€€€";
242 PRINT"€€father€€€€"Z$(2)"À"Z$(3)"À€€€€mother€€€€";
243 PRINT"€€€€€€€€€€€€€€Ê€€€€€€€€€€€€€€€€€";
400 IFLEFT$(N$(1),3)<>"XXX"THENPRINT@416+8,LEFT$(N$(1),16);:GOTO420
410 PRINT@416+14," 1";
420 PRINT@448,"# OF PERSON REQUIRED (0=QUIT)";
430 INPUTN
440 IFN=OTHEN1230
450 IFINT(N/2)=N/2THENM=N+1,6070470
460 M=N -1
470 PRINT"74AME,";LEFTS(NS(N),25)
480 PRINT"A13ORN,";MID$(N$(N),26,10)
490 PRINT"XMARRIED,";MIMN$(N),36,10)
500 PRINT"NTO,";LEFT$(N$M.25)
510 PRINT"IDIED,";MID*(N4,(N).46.10)
520 PRINT"ACERTIFICATESMID$(14$(N):56.6)
530 PRINT"MIORE DETAIL ON FILE "RIGHT$(N$(N),3)
540 PRINT"XDO YOU WANT TO,
550 PRINT"Ml)ADD TO THIS INFORMATION
560 PRINT"AE)CREATE R DETAILED FILE
570 PRINT"AB)RERD THE DETAILED FILE
580 PRINT"AW)DUMP DATA TO TAPE
590 INPUT"X5)00 BACK TO TREE (ENTER NUMBER)"J:
600 ONROOT0610.920.1000.1060,210
610 PRINT"nNAME,";LEFT$(N$(N)25)
620 GOSUB1100
630 IFR$="N"THEN680
640 INPUT"ANAME";R$
650 IFLEN(R$)>25THENPRINT"APLEASE USE 25 LETTERS/SPACES OR LESS",GOT0640
660 IFLEN(R$)(25THENR$=R$+" ",0070660
670 NS(N)=R$4-RIGHT$(N$(N).39)
680 PRINT"MBORNMID$(N$(N),26.10),GOSUB1100
690 IFRI="N"THEN720
700 00SUB1130
710 WN)=LEFTS(N*(N):25)+R$+RIGHT$(N$(N).290
720 PRINT"*MARRIED,";MID$(N$<N),36.10),GOSUi1100
730 IFR$="N"THEN760
740 GOSUB1130
750 W(N)=LEFTS(NS(N).35)+R$+RIGHTS(WN).19)
760 IFNOITHEN810
770 PRINT"*TTO,";N$(0),GOSUB1100
780 IFR$="N"THEN810
790 PRINT"XEPOUSE'S NAME
800 INPUT"t1$(0)
810 PRINT"AIDIED,";MID$(WN),46,10):00SUB1100
820 IFR$="N"THEN850
GOSUB1130
840 N$(.4)=LEFT$(N$(N),45)+R$4.RIGHT$(N$(N),9)
350 PRINTPOCERTIFICATES:";MID$(N$(N),56,6),00SUB1100
860 IFR$="N"THEN470
070 PRINT"XENTER CERTIFICATES OBTAINED E.G.'B M D'
380 INPUT"M";R$
890 IFLEN(R$))6THENPRINT"VENTRY TOO LONG"GOT0870
900 IFLEN(R$)-C6THENR$=R$+" ":0010900
910 N$(4)=LEFT$(N$(N):55)+R$+RIGHTS(N$(N),3),601.0470
920 GOSUB1160,PRINT"nENTER FILE IF LESS THAN 23 LINES",PRINT"XPUT 'END'A1
930 FORI=0T022,INPUTXVI):IFFEEK(224)+256*FEEK(225)>33648THENPRINT"0";
940 IFRIGHTS(XWI).3)0"ENWTHEN960
950 FORJ=1+11.022:X$(..1)="NIL"'NEXT:I=22
960 NEXT
970 PRINT":1LORD FILE ";B$:PRINT"XPRESS ANY KEY WHEN READY",GOSUB1110
980 P0KE244,2:POKE243,122:0PEN1.1,1,B$FORI=01.022:PRINT#1,X$(1),GOSUB1190
990 NEXT:CLOSE1,00T0470
1000 GOSUB1160:PRINT"1ORD FILE ";B$PRINT"XPRESS ANY KEY WHEN READY",GOSUB1110
1010 OPEN1,1,0,B$,FORI=0T022INPUTC,X$(1),NEXT,CLOSE1
1020 FORI=07022:IFX$(1)="NIL"THENX$(1)=""
1030 PRINTX$(1):IFLEN(X$(1))=40THEOPRINT"1";
1040 NEXT
1050 PRINT"PRESS ANY KEY WHEN READY":00SUB1110:001.0470
1060 PRINT"XLOAD FAMILY TREE FILE TAPE",FRINT"XPRESS ANY KEY WHEN READY" 6051181
110 '
1070 POKE244,2,POKE243,122:0PEN1,1,1,"FAMILY TREE"
1080 FOR1=07031,PRINT*1,N$(1):00SUB1190
1090 NEXT,CLOSE10070470
1100 PRINT"XDO YOU WISH TO CHANGE THIS (Y/N)?
1110 R$=INKEY$:IFR$=""THEN1110
1120 RETURN
1130 INPUT"XNEW DATE";R$
1140 IFLEN(R$)<>10THENPRINT"AENTER DATE IN THE FORM 03/05/1941":001.01130
1150 RETURN
1160 B$=STR$(N),IFLEN(B$)=2THENBW#0"+RIGHT$(BC1) 00701180
1170 B$="*"+RIGHT$(B$,2)
1180 N$(14)=LEFT$(10(N),61)+B$:RETURN
1190 IFPEEK(625):180THENRETURN
1200 POKE59411,53:T=TI
1210 IFTI-TC12THEN1210
1220 POKE59411,61:RETURN
1230 END
