10 REM SYLLOGY
15 REM FROM THE AMAZING VZ300 OMNIBUS
20 CLEAR400:GOSUB 1050:REM INITIALISE
30 PRINT:INPUT A$
40 IF A$="?" THEN 910
50 IF A$="" THEN END
60 FLAG=0
70 REM NOTE SPACE BEFORE CLOSE QUOTE IN NEXT LINES
80 IF LEFT$(A$,3)="IS " THEN 480:REM CONCLUSIONS
90 IF LEFT$(A$,4)="THE " THEN A$=MID$(A$,5)
100 IF LEFT$(A$,3)="AN " THEN A$=MID$(A$,4)
110 IF LEFT$(A$,2)="A " THEN A$=MID$(A$,3)
120 X=LEN(A$)
130 N=0
140 N=N+1
150 IF MID$(A$,N,1)=" " THEN B$=LEFT$(A$,N-1):GOTO 180
160 IF N<X THEN 140
170 PRINT "I DON'T UNDERSTAND":GOTO 30
180 K=4
190 IF MID$(A$,N+1,1)="W" THEN K=5
200 C$=MID$(A$,N+K):REM QUALIFYING PHRASE
210 IF LEFT$(C$,2)="A " THEN C$=MID$(C$,3):REM REMOVES ARTICLE
220 IF LEFT$(C$,3)="AN " THEN C$=MID$(C$,4)
230 IF LEFT$(C$,4)="THE " THEN C$=MID$(C$,5)
240 REM ** STORE INFORMATION **
250 REM CHECK TO SEE IF CAN FIND SUBJECT BEFORE BLANK
260 N=0
270 N=N+1
280 IF Z$(1,N)=B$ THEN 320:REM SUBJECT HEADING EXISTS
290 IF Z$(1,N)="" THEN Z$(1,N)=B$:GOTO 320
300 IF N<25 THEN 270
310 PRINT "NO MORE SUBJECT ROOM"
320 REM REACHES HERE WITH SUBJECT STORED AS HEADING
330 REM ** NOW PUT OBJECT UNDER THIS **
340 K=0
350 K=K+1
360 IF Z$(K,N)=C$ THEN 400:REM ALREADY STORED
370 IF Z$(K,N)="" THEN Z$(K,N)=C$:GOTO 400
380 IF K<25 THEN 350
390 PRINT "NO MORE OBJECT SPACE"
400 IF FLAG=1 THEN PRINT TAB(6);"> OK":GOTO 30
410 REM ** NOW SWAP OBJECT AND SUBJECT AND SAVE AGAIN **
420 FLAG=1
430 M$=B$
440 B$=C$
450 C$=M$
460 GOTO 250
470 REM *****************
480 REM ** CONCLUSIONS **
490 REM ** FIRST SPLIT INPUT **
500 A$=MID$(A$,4):REM STRIP "IS"
510 IF LEFT$(A$,2)="A " THEN A$=MID$(A$,3):REM STRIP "A"
520 IF LEFT$(A$,3)="AN " THEN A$=MID$(A$,4):REM STRIP "AN"
530 REM ** GET FIRST WORD  F$ **
540 X=LEN(A$)
550 N=0
560 N=N+1
570 IF MID$(A$,N,1)=" " THEN F$=LEFT$(A$,N-1):GOTO 600
580 IF N<X THEN 560
590 PRINT "> DO NOT UNDERSTAND":GOTO 30
600 REM ** NOW GET SECOND WORD  S$ **
610 S$=MID$(A$,N+3)
620 IF LEFT$(S$,1)=" " THEN S$=MID$(S$,2)
630 PRINT "(LOOKING FOR ";F$;")"
640 X=0
650 X=X+1
655 IF Z$(1,X)<>F$ THEN 670
660 PRINT "( FOUND AT 1 " ;X;")":GOTO 700
670 IF X<25 THEN 650
680 PRINT "CANNOT FIND SUBJECT":PRINT TAB(2);F$
690 GOTO 30
700 Y=1
710 Y=Y+1
720 IF Z$(Y,X)=S$ THEN PRINT TAB(6);"> YES":GOTO 30
730 IF Y<25 THEN 710
740 Y=1
750 Y=Y+1
760 P$=Z$(Y,X)
770 M=0
780 M=M+1
790 IF Z$(1,M)=P$ THEN 830
800 IF M<25 THEN 780
810 IF Y<25 THEN 750
820 PRINT TAB(6);"> NO":GOTO 30
830 Q=1
840 Q=Q+1
850 IF Z$(Q,M)=S$ THEN PRINT TAB(6);"> YES":GOTO 30
860 IF Q<25 THEN 840
870 IF M<25 THEN 780
880 GOTO 820
900 REM *********************************
910 REM CHECK CONTENTS OF PARTICULAR FILE
920 INPUT "SUBJECT TO CHECK";H$
930 T=0
940 T=T+1
950 IF Z$(1,T)=H$ THEN 990
960 IF T<25 THEN 940
970 PRINT "I HAVE NO DATA STORED ON ";H$
980 GOTO 30
990 K=1
1000 K=K+1
1010 IF Z$(K,T)<>"" THEN PRINT K;T;Z$(K,T)
1020 IF K<25 THEN 1000
1030 GOTO 30
1040 REM **********
1050 REM INITIALISE
1060 CLS
1080 DIM Z$(25,25)
1090 RETURN
