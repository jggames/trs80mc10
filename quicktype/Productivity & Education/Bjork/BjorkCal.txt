5  REM....PERPETUAL CALENDAR PROGRAM
6  REM....FOR RADIO SHACKS TRS-80
7  REM....BY STEVE BJORK
8  DIMA(150)
9  CLS:PRINT@400,"PERPETUAL CALENDER   BY STEVE BJORK"
10 PRINT@ 448,"ENTER MONTH AND YEAR (MM,YY)";:INPUT M,Y
11  IF (M>12)+(M<1)THEN10
17  IF Y<100 THENY=Y+1900
18  RESTORE:FOR I=1 TO 12:READ V:NEXT I
19  FOR I=1 TO M:READ A$:NEXT I
20  B$=" ":L=0:IF INT(Y/4)<>(Y/4)THEN50
30  IF INT(Y/100)=(Y/100) THEN50
40  B$="LEAP-YEAR":L=1
50  T=INT((Y-1893)/4)
60  C=(Y-1893+T)/7:C=INT((C-INT(C))*7+.5)
90  RESTORE:FOR I=1 TO 12:READA(I):NEXTI:A(2)=A(2)+L
91  D=0:IF M=1 THEN 100
92  FOR I=1 TO M-1:D=D+A(I):NEXT I
100  D=(D+C)/7
110  D=INT((D-INT(D))*7+.5)
111  IF D=0THEND=7
120  CLS:PRINT@ 22,A$;"  ";Y;"  ";B$
150  T=0:FOR I=(D-2) TO 0 STEP-1:T=T+1:A(T+12)=(-I):NEXTI
160  P=1:FOR J=D TO 7:A(J+12)=P:P=P+1:NEXT J
164  RESTORE
165  W=0:FOR I=1 TO 12:READ X:NEXTI:FORI=1TO12:READB$:NEXTI
166  FOR J=8 TO 56 STEP 8:READ B$:PRINT@64+J,B$:NEXTJ
167  A$=" ":H=0:READ A,A$:IF A=0 THEN 170
168  IF INT(A)<>M THEN167
169  H=INT((A-INT(A))*100+.5)
170  FOR I=128 TO 832 STEP 128
180  P=0:FOR J=8 TO 56 STEP 8:S=I+J
190  P=P+1:Q=A(P+12)+(W*7)
191  Z=0:IF Q<10 THENZ=1
200  IF (Q<=0)+(Q>A(M))THEN220
210  PRINT@ S+Z,Q
211  IF H<>Q THEN 220
212  PRINT@ S+63,A$
220  NEXT J:W=W+1:NEXT I
270  END
1000  DATA31,28,31,30,31,30,31,31,30,31,30,31
1100  DATAJANUARY,FEBRUARY,MARCH,APRIL,MAY,JUNE,JULY,AUGUST
1200  DATASEPTEMBER,OCTOBER,NOVEMBER,DECeMBER
1300  DATASUN,MON,TUE,WED,THU,FRI,SAT
1400  REM...HOLIDAYS (M.D)
1500  DATA1.01,NEW YR,12.25,XMAS,2.14,VAL,7.04, 4TH,4.01,FOOL
1510  DATA10.31,HAL'WN
1800  DATA0,END
