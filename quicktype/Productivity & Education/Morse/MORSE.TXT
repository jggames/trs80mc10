4 REM MORSE PROGRAM
5 REM PROGRAMME DEVISED THROUGH THE
6 REM COLLABORATIVE EFFORTS, OF
7 REM CHRIS DPACUP & DEREK WAKELIN
11 DIM M$(43),D(43),Z$(64),V(15),W(15)
12 B$="ETINAMSDRGUKWOHBLZFCP?VX?Q?YJ?56?7???8???????94???????3???2?10??"
14 FORI=1TO64:Z$=MID$(B$,I,1):NEXT
20 REM POKE950,8,POKE951,12,SYS845
30 REM POKE950,8,POKE951,0,SWS845
40 FORI=1TO43:READM$(I):NEXT
50 FORI=1TO43:D(I)=1:NEXTI
100 CLS
110 PRINTTAB(11)"MORSE TUTOR":PRINTTAB(11)"-----------":PRINT
120 PRINT"THESE ARE YOUR OPTIONS:"
130 PRINT:PRINT"COMPUTER GENERATED MORSE":PRINT"------------------------"
150 PRINT"1. LEARNING THE CODE (1 LETTER)"
160 PRINT"2. IMPROVING SPEED"
170 PRINT"3. MORSE TEST SIMULATOR (RANDOM)"
180 PRINT"COMPUTER ANALYSED MORSE":PRINT"-----------------------"
190 PRINT"4. LEARNING TO TRANSMIT":PRINT"ENTER NUMBER OF SELECTION"
220 A$=INKEY$:IFA$=""THEN220
230 ONASC(A$)-48GOSUB1000,2000,2000,4000
240 GOTO100
300 REM SUBROUTINE TO GENERATE MORSE
310 FORJ=1TOLEN(M$(C))
320 IFMID$(M$(C),J,1)="S"THENT=DL
330 IFMID$(M$(C),J,1)="L"THENT=3*DL
340 GOSUB410
350 FORK=1TODL:NEXTK
360 NEXTJ
370 FORK=1TOCS:NEXTK
380 RETURN
400 REM TONE GENERATION
410 REM POKE950,8:POKE951,12:SYS845
420 FORK=1TOT:NEXTK
430 REM POKE950,8:POKE851,0:SYS845
440 RETURN
1000 REM SINGLE LETTERS
1005 CLS
1010 PRINT"ENTER REQUIRED SPEED"
1011 INPUT"(NUMBER OF 5 LETTER WORDS/MIN)";S
1015 PRINT"PRESS ANY LETTER OR NUMBER."
1020 GR=INT(EXP(5.28-.21*5))
1022 IC=3.10470588*GR
1024 DL=INT(IC-GR*LOG(S))
1025 CS=2*DL
1030 A$=INKEY$:IFA$=""THEN1030
1035 IFA$="*"THENRETURN
1040 PRINTA$;
1050 IFA$=" "THENFORK=ITODL*4:NEXT:GOTO1030
1060 C=ASC(A$)-47
1070 GOSUB310
1080 GOTO1030
2000 REM IMPROVING SPEED
2005 CLS:SY=1:INPUT"RANDOM WORDS OR NUMBERS W/N";A$:IF LEFT$(A$,1)="N"THENSY=0
2010 L5=10+SY*16:DT=L5:PRINT"ENTER REQUIRED SPEED"
2012 INPUT"(NUMBER OF 5 LETTER WORDS/MIN)";S
2014 PRINT"HOW MUCH TIME DO YOU WANT TO":PRINT"REPLY? 0 GIVES LEAST TIME"
2015 INPUT"HIGHER NUMBERS MORE TIME";MAX:MAX=MAX*50
2018 PRINT"PRESS ANY KEY TO START"
2020 GR=INT(EXP(5.28-.21*5))
2022 IC=3.10470588*GR
2024 DL=INT(IC-GR*LOG(S))
2025 CS=2*DL
2026 A$=INKEY$:IFA$=""THEN2026
2027 FORK=1TOCS:NEXTK
2270 DT=L5/DT:FORK=SY*17+1TOL5+SY*17:D(K)=D(K)*DT:NEXTK:DT=L5
2280 K=RND(0)*L5:C1=0:C=0+SY*17
2282 C=C+1
2284 C1=C1+ID(C)
2286 IFC1=<KTHEN2282
2290 DU=0:GOSUE310
2300 A$=INKEY$:IFA$=""THENDU=DU+1:GOTO2300
2310 IFA$="*"THENRETURN
2312 IFA$<>"#"THEN2320
2314 FORI=SY*17+1TOL5+SV*17STEP2
2316 PRINTCHR$(47+I);D(I)/L5;TAB(15);CHR$(47+I+1);D(I+1)/L5
2318 NEXT
2319 GOTO 2300
2320 IFDU<=MAXTHENDT=DT-D(C)/4:D(C)=D(C)-D(C)/4:GOTO2350
2340 IFDU>MAXTHENPRINT"TOO SLOW  ";
2350 PRINTCHR$(C+47);:IFFA$=CHR$(C+47)THENPFINT"  CORRECT":GOTO2270
2400 DT=DT+D(C)*2:D(C)=D(C)+D(C)*2:PRINT:GOTO2290
2410 GOSUB310
2420 A$=INKEY$:IFA$=""THEN2420
2430 IFA$=CHR$(C+47)THEN2300
2440 GOTO2410
3000 REM RANDOM WORDS
3005 CLS
3006 SY=1
3007 INPUT"RANDOM WORDS OR NUMS: W/N";A$
3008 IFLEFT$(A$,1)="N"THENSY=0
3010 INPUT"NUMBER OF LETTERS, PER WORD";NL
3020 INPUT"ENTER SPEED TO WHICH YOU ASPIRE";S
3030 GR=INT(EXP(5.28-.21*N))
3032 IC=3.01470588*GR
3034 DL=INT(IC-GR*LOG(S))
3042 PRINT"HOW MUCH DO YOU WANT TO SLOW"
3044 PRINT"DOWN THE INTER LETTER INTERVAL?"
3045 PRINT"ENTER 0 IF YOU DON'T WANT A CHANGE"
3046 PRINT"ENTER A NUMBER GREATER THAN 0 TO SLOW IT DOWN PROPORTIONATELY"
3047 INPUTSL
3050 CS=2*DL+100*SL
3100 FORI=1TONL
3120 C=INT(RND(0)*(10+SY*16)+1)+SY*17
3140 PRINTCHR$(C+47);
3160 GOSUB310
3180 NEXTI
3200 FORK=1TO2*CS:NEXTK
3220 PRINT
3240 A$=INKEY$:A$="*"THENRETURN
3250 GOTO3100
4000 REM DECODE MORSE
4005 CLS
4010 REM POKE59459,0
4040 INPUT"WOULD YOU LIKE THE MACHINE TO   ESTIMATE YOUR DIT LENGTH (Y/N)";A$
4050 IFA$="N"THENINPUT"LENGTH OF DIT";DIT:GOTO4250
4060 PRINT"TAP IN V, AT LEAST 3 TIMES"
4070 IF PEEK(59471)=255THEN4070
4080 FORI=1TO12:SI=0
4090 REM POKE950,8:POKE951,12:SYS845
4130 IFPEEK(59471)0255THENSI=SI+1:GOTO4130
4141 REM POKE950,8:POKE951,0:SY8845
4150 V(I)=SI
4160 NS=0
4170 IFI=12THEN4210
4180 IFPEEK(59471)=255THENNS=NS+1:GOTO4180
4190 W(I)=NS
4200 NEXT
4210 DIT=V(.4)+V(8)+V(.12)
4220 DIT=INT(.(DIT/20/2)+1
4240 PRINT"YOUR DIT LENGTH",DIT
4250 DL=40
4260 C=28:GOSUB310
4300 NS=0
4310 I=0
4320 IFPEEK(59471)=255THENNS=NS+1:GOTO4320
4330 IFNS>4*DITTHENPRINT" "
4340 T1=0:I2=1
4350 FORI=1TO5
4360 I2=I2*2
4370 REM POKE950,8:POKE951,12:SYS845
4380 SI=0
4390 IF PEEK(59471)<>255THENSI=S1+1:GOTO4390
4400 REM POKE950,8:POKE951,0:SYS845
4410 IFSI>DITTHENT1=T1+I2:GOTO4430
4420 T1=T1+I2/2
4430 NS=0
4440 IF PEEK(59471)<>255THEN4470
4450 NS=NS+1:IFNS>DITTHENPRINT2S(T1);:GOTO4300
4460 GOTO4440
4470 NEXTI
4480 GOTO4300
7000 DATA LLLLL,SLLLL,SSLLL,SSSLL,SSSSL,SSSSS
7010 DATA LSSSS,LLSSS,LLLSS,LLLLS
7020 DATA SLSLSL,LLSSL,SSSLS,LLSLLSL
7030 DATA LSLSLS,LLLSSS
7040 DATA SSSLLL
7070 DATA SL,LSSS,LSLS,LSS,S
7080 DATA SSLS,LLS,SSSS,SS,SLLL
7090 DATA LSL,SLSS,LL,LS,LLL
7100 DATA SLLS,LLSL,SLS,SSS,L
7110 DATA SSL,SSSL,SLL,LSSL,LSLL,LLSS
