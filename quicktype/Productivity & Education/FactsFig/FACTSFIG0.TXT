10 PMODE4,1
20 CLS
30 PRINT@45,"menu":PRINT@102,"1- ENTER DATA":PRINT@166,"2- DISPLAY BAR CHART":PRINT@230,"3- VIEW/EDIT DATA":PRINT@294,"4- QUIT PROGRAM"
40 A$=INKEY$:IFA$<"1"ORA$>"4"THEN40
50 IFA$="1"ANDDA=1THEN80
60 ON VAL(A$) GOSUB1000,2000,3000,4000
70 GOTO20
80 PRINT@484,"ARE YOU SURE?";
90 A$=INKEY$:IF A$<>"Y" AND A$<>"N" THEN 90
100 IF A$="Y" THEN CLEAR200:A$="1":GOTO 60
110 GOTO 20
1000 DA=1:CLS:INPUT" NAME OF X-AX1S";X$
1010 X$=LEFT$(X$,32):IF X$="" THEN X$="X-AXIS"
1020 MD=INT(16-LEN(X$)/2)
1030 INPUT" NAME OF Y-AXIS";Y$
1040 Y$=LEFTS(Y$,12):IF Y$="" THEN Y$="Y-AXIS"
1050 HT=INT(6-LEN(Y$)/2)
1060 INPUT" NO OF BARS";NB
1070 NB=INT(NB):IF NB<1 THEN 1060
1080 BL=INT(26/NB):IF BL<1 THEN BL=1
1090 DIM A(NB)
1100 PRINT
1110 FOR K=1 TO NB
1120 PRINT" VALUE OF BAR";K;:INPUT A(K)
1130 NEXT
1140 RETURN
2000 IF DA=0 THEN PRINT@455,"no data entered":FOR K=1 TO 2000:NEXT:RETURN
2010 TP=0:BT=0
2020 FOR K=1 TO NB
2030 IF A(K)>TP THEN TP=A(K)
2040 IF A(K)<BT THEN BT=A(K)
2050 NEXT
2060 IF TP=0 AND BT=0 THEN PRINT" ALL VALUES ZERO":FOR K=1 TO 2000:NEXT:RETURN
2070 CLS:PRINT@64,"DO YOU WANT A SCALED GRAPH Y/N?"
2080 A$=INKEY$:IF A$<>"Y" AND A$<>"N" THEN 2080
2090 IF A$="N" THEN 2120
2100 IF TP>0 THEN E=INT(LOG(TP)/LOG(10)):TP=INT(1+TP/(10^E))*10^E
2110 IF BT<0 THEN E=INT(LOG(-BT)/LOG(10)):BT=-INT(1-BT/(10^E))*10^E
2120 IN=178/(TP-BT)
2130 ST=INT(IN*TP)
2140 T$="":IF TP=0 THEN 2160
2150 IF TP>ABS(BT) THEN E=2*INT(LOG(TP)/LOG(1000)) ELSE E=2*INT(LOG(ABS(BT))/LOG(1000))
2160 T$="+"+MID$(STR$(INT(.5+TP/10^E)),2):B3$="":IF BT=0 THEN 2180
2170 B$=STR$(INT(.5+BT/10^E))
2180 SL=1:LP=NB:IF NB>26 THEN LP=26
2190 POKE 179,243:PCLS:POKE 65475,0:POKE 65477,0:POKE 65479,0
2200 POKE 179,2
2210 LINE(40,0)-(47,191),PRESET,BF
2220 IF T$="" THEN 2260
2230 FOR K=1 TO LEN(T$):P=ASC(MID$(T$,K,1))AND63:FOR M=0 TO 11
2240 POKE 1540-LEN(T$)+32*M+K,P
2250 NEXT M,K
2260 IF B$="" THEN 2300
2270 FOR K=1 TO LEN(B$):P=ASC(MID$(B$,K,1))AND63:FOR M=0 TO 11
2280 POKE 6916-LEN(B$)+M*32+K,P
2290 NEXT M,K
2300 FOR K=1 TO LEN(X$)
2310 P=ASC(MID$(X$,K,1))AND63
2320 FOR M=182 TO 190:POKE 1503+MD+32*M+K,P:NEXT
2330 NEXT
2340 FOR K=1 TO LEN(Y$)
2350 FOR M=0 TO 11
2360 P=ASC(MID$(Y$,K,1))AND63
2370 POKE 1568+384*(K+HT)+32*M,P
2380 NEXT M,K
2390 FOR K=5 TO 31
2400 POKE 1536+32*ST+K,128
2410 NEXT
2420 FOR K=ST TO 0 STEP —22
2430 POKE 1541+K*32,202
2440 NEXT
2450 FOR K=ST TO 178 STEP 22
2460 POKE 1541+K*32,202
2470 NEXT
2480 FOR K=SL TO LP:CO=(CO+1)AND1
2490 POKE 178,35+CO*64:POKE 179,3+CO*192
2500 IF INT(A(K)*IN)>0 THEN LINE(48+8*(K-SL)*BL,ST-1)-(47+8*(K-SL+1)*BL,ST-INT(A(K)*IN)),PSET,BF
2510 IFFIX(A(K)*IN)<0THENLINE(48+8*(K-SL)*BL,ST)-(47+8*(K-SL+1)*BL,ST-FIX(A(K)*IN)),PRESET,BF
2520 NEXT K
2530 IF LP=NB THEN 2570
2540 SL=LP+1:LP=LP+26:IF LP>NB THEN LP=NB
2550 IF INKEY$="" THEN 2550
2560 POKE 179,243:LINE(48,0)-(255,178),PRESET,BF:GOTO 2390
2570 IF INKEY$="" THEN 2570
2580 RETURN
3000 IF DA=0 THEN PRINT@455, "no data entered":FOR K=1 TO 2000:NEXT:RETURN
3010 SL=1:LP=NB:IF NB>14 THEN LP=14
3020 CLS:PRINT"bar","value"
3030 FOR K=SL TO LP
3040 PRINTK,A(K)
3050 NEXT
3060 IF NB=LP THEN 3130
3070 PRINT@480,"e TO EDIT, ANY OTHER TO CONTINUE";
3080 A$ =INKEY$:IF A$="" THEN 3080
3090 IF A$="E" THEN 3170
3100 SL=LP+1:LP=LP+14
3110 IF LP>NB THEN LP=NB
3120 GOTO 3020
3130 PRINT@480,"e TO EDIT, ANY OTHER TO RETURN";
3140 A$=INKEY$:IF A$="" THEN 3140
3150 IF A$="E" THEN 3170
3160 RETURN
3170 CLS:PRINT:INPUT" NUMBER OF ENTRY TO BE EDITED ?";E
3180 E=INT(E):IF E<1 OR E>NB THEN 3170
3190 PRINT:PRINT"NEW VALUE OF ENTRY";E;:INPUT A(E)
3200 GOTO 3020
4000 CLS:PRINT@37,"ARE YOU SURE (Y/N)?"
4010 A$=INKEY$:IF A$<>"Y" AND A$<>"N" THEN 4010
4020 IF A$="N" THEN RETURN
