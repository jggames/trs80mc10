60 CLSt PRINT3256: "A MOMENT WHILE I SHUFFLE et.":
80 ' 100 X=0: Y2=6701: COSUB 150e Y2=6801: GOSUB 150: Y2=7201: GOSUB150t Y2=83010 C
OSUB 150: FOR X=0 TO 51: Y5=MT(X)
105 ' 110 Y6=RND(100): IF MM(Y6))0 THEN 110 ELSE MM(Y6)=Y5
115 ' 120 NEXTCY6=0: FOR X=1 TO 100: IF MM(X)=0 THEN NEXT ELSE M(Y6)=MM(X): Y6=
Y6+1: NEXT
125 ' 130 COTO 200: REMARKS CONTROL PASSES TO RULES-DISPLAY ROUTINE
140 ' 150 FOR Y.Y2 TO Y2+12: MT(X)=Y: X=X+1: NEXT: RETURN


4 REM MORSE PROGRAM
5 REM PROGRAMME DEVISED THROUGH THE
6 REM COLLABRATNE EFFORTS, OF
7 REM CHRIS DPACUP 8, DEREK WAKELIN
11 DIM ME(42.1,0(47)
12 DIM 741(64,,,I151,1,1<15) 12 BE="ETINRMSDRCUKWOHBL7PCP2209,1
14 FCR1.11.064,ZE,ID.MIDE(EI,I,1),NEX1 20 POKE 950,0,POKE951,54,SYS845
20 POKE 950,7,POKE951,55,SW.E45
40 FORI=11.043,README(I),HEXT 50 FORI=IT042,D(1)=1,NEXTI
100 PRINT"n"
110 FEINT" MORSE TLITOR" t15 PRINT" PRINT 120 PRINT"THE FOLLOWING OPTIONS ARE AVAILABLE"
130 PRINT 145 PRINT"CDMPUTER GENERATED MORSE"
146 FRINT" 150 PRINT"1. LEARNING THE CODE - SINGLE LETTER?"' 150 PRINT"2. IMPROVING SPEED"
170 FRINT"3. MORSE 7E01 SIMULATOR - PRNDOM WORDS"
180 PRINT,PRINT"COMPUTER ANALYSED MORSE"
182 PRINT" 190 FRINT"4. LEARNING TO TRANSMIT" 200 FRINT,FRINT,FEINT"ENTEP NUMBER OF SELECTED OPTION"
220 GET A8, IF PE.""THEN 220
9N <920,(A$) -43S, COSUB1000,2000,2000,4000 240 GOT0 100
200 REM SUBROUTINE TO GENERATE MORSE
210 FOR1=-ITOLEN(M4(13)) '20 IF MIT4(ME<C),J,11="S" THEN T=DL 320 IF MIDEUIVC1,J,11="L" THEN T=3*DL
340 GOSUB 410
050 FORK=ITODL,HEXTK
350 NEXT.? 370 FORK=ITOCExHEXTK
280 RETURN 400 REM TONE GENERATION
410 POSE 950,8,POKE951,12,SVS045
420 FORK=1TOT,NEXTK
430 POKE 950.8,POKE851.0,SN3845
440 RETURN 1000 REM SINGLE LETTERS
1005 PFIHT"1" 1010 PRINT"ENTEP REQUIRED SPEED"
101i INPUT"<NUMBER OF 5 LETTER WORD3/M11 IE)";'S 1015 PEIHT"PRESS ANY LETTER CR NUMBER."
1020 GR=INT(EXP(5.28-.'21+5)Y 1022 IC=2.10470588*GR
1024 DL=INT(IC-GR*LOG(S))
1025 CE=2*DL
1030 GETAS,IFFIE=""THEN1020 1025 IFRE="*"THENFETURN
1040 PRINTAS. 1050 IF RE." "THENFORK=ITODL*4,NEXT,GOT01030 1050 C=ASURE)-47
1070 00803 310 . 1080 GOTO 1030
2000 REM IMPR.OlING SPEED 2005 FRINT"M"
2005 SY=1 2007 INPUT "RANDOM WORDS OP NUMBERS, W,11" ,RE 2003 IF LEFTEI91,1)."N"THEN S7=0
2009 L5=10+SY*16,DT.L5
2010 PRIEN"EHTER FEQUIRED SPEED"
2012 INPUT "'NUMBER: OF 5 LETTER WORDS/MINUTE)":S 2014 PRINT"HOW MUCH TIME DO YOU WANT TO FEFtY? " 2015 INPUT"0 GIVE? LEAST TIME, HIGHER NUMBERS MORE TIME"ItAX,MAX=MRX*50
2018 PRINT"PRESS PBS' TO START PROGRAMME."
,020 GR=INT(EXP,I.5.28-.2145)1 2022 12=3.10470588*GR
2024 DL=iNT(IC-OR*LOG(S))
2025 C8=2*DL
2026 GETRE,IFAE=""THEN2025
2027 FCRK.ITOCF,NEXTK
270 DT=L5,,TT-RORK=VT117+1TOL5,SY+17 IKK)=TM DT,NEXTK,DT=L5
IS=RI4TI,f1)*L5131.0,C=O+SV*17 C=C91 34 Cl.C1+IKCI
_2.65 IF Cl=a: THEN2282 2290 D0=0,GOSUE810
2200 GETAE,IFH$=""THENDU=DU 1,00102300
10 IF 9$="1"THENFETURN
2312 IF REC-"*" THEN2320 2214 FORI=SY*17+1TOL5+SV*17 STEP2
3115 FRIIFICHRE(47.1.).D(II/L5TREs.15);CHRE(474. 2318 NEXT
GOTO 2300
IFDU,..=MAXTHENDT=DT-D(C)/4,DIC)=D(CI-D(C. 00102250
_ IF DH>MAXTHENFPINT"TOO SLOW
2350 PPIHTCHRE(C+47).,IFFIE=CHRE(C,47)THENPFINT" CORRECT",GOT02270 2400 DT4DT+D(C)4,2,D(C)=D(C>+D(C+2,FRTNT'0OTO 2290
24000111113310
OET93,IF Ar=""THEN 2420
IF AE=CERE(C,47)THEN 0070 0 10 SOTO 2410
00 REM RANDOM WORTS
05 PRINT"71" 2006 37.1
3007 INPUT "RANDOM WORDS OF: NUMBER'S: W.,N";F4
? ocle TF LEFTEtAt,I)="N"THEN ^Y=0 ^1179 INPUT"WIDEF, OF LETTERS, PER WORD".NL INPUT"ENTEP SPEED TO WHICH YOU ASPIRE",S 0R=INT(EXF5.21-.21*NLI>
-.=.,,,;.01410513,C9FOR DL=iNT(..TCHOR*LOG(S)) 3042 RFINT"HOW MUC DO YOU WANT TO SLOW DOWN"
3044 FRINT"THE TNTER LETTER IN 7" 3045 PPINT"ENTER G IF WILI T,Cw'T QAHT N CHANGE" 2045 PFIHT"ENTEP A NUMBER GREATER, THAN 0 TC, SLOW IT DOWN PROPORTIONATELY"
2047 INPUTSL S050 CS.2*DL+100*SL
FCRI=ITCNL c,,,t7,:RND(1.*(10+SY*15)+1>.17
2140 FEINTCHRE(C+47); GOSUB 210
HEXTI 1200 FORK=1TODFCS,NEXTK
- 2211PRINT 3240 GETWIPA$="*"TMENFTURN
3250 GOTO 3100
4000 REM DECODE MORSE
4005 PRINT"M"
4010 POKE59459,0
4040 INPUT"WOULD YOU LIKE THE MACHINE TO ESTIMATE YOUR DIT LENGTH (Y/N)";A$
4050 IF A$="N"THENINPUT"LENGTH OF DIT";DIT:GOT04250
4060 PRINT"TAP IN V,AT LEAST THREE TIMES"
4070 IF PEEK(59471)=255THEN4070
4080 FORI=1T012:SI=0
4090 POKE950,8:POKE951,15:9YS845
4130 IFPEEK(59471)0255THENSI=SI+1:GOT04130
4141 POKE950,8:POKE951,0:SY8845
4150 V(I)=SI
4160 NS=0
4170 IFI=12THEN4210
4180 IFPEEK(59471)=255THENNS=NS+1:GOT04180
4190 W(I)=NS
4200 NEXT
4210 DIT=V(.4)+V(8)+V(.12)
4220 DIT=INT(.(DIT/20/2)+1
4240 PRINT"YOUR DIT LENGTH",DIT
4250 DL=40
421% C=28:GOSUB310
NS=0
431A I=0
4320 IF PEEK(59471)=255THENNS=NS+1:GOT04320
43R0 IFNS)4*DITTHENPRINT" ".
4340 T1=0:I2=1
4350 FORI=1T05
431=70 I2=I2*2
437A POKE950,8:FOKE951,12:SYS845
4380 SI=0
4R90 IF PEEK(59471)<>255THENSI=S1+1:GOT04390
4400 POKE950,8:POKE951,0:SYS845
4410 IF 9I>DITTHENT1=T1+I2:GOT04430
4420 T1=T1+I2/2
4430 NS=Ei
4440 IF PEEK(59471)(>255THEN4470
4450 NS=NS+1:IFNS>DITTHENPRINT2S(T1);:GOT04300
441;0 GOT04440
4470 NEXTI
44RA GOTO 4300

6000 Pt:=WD-1: IF WD=8 THEN 6400 ELSE FOR X=0 TO 3: QD(X)=0:NEXT:X=0: FOR TC=0 TO
3: Y=T(PD,TC): IF Y>0 THEN QD(TC)=1: X=X+1:NEXTELSE NEXT:REMARK:NOTE ANY MATCHI
NG DENOMINATIONS IN OTHER SUITS (UNLESS FOLLOWING 8, THEN ONLY WANT TO LOOK AT
THE FORCED SUIT)
6011 IF X=0 THEN 6400: REMARK: WE JUMP TO 6400 IF THE MACHINE CANNOT MATCH THE D
ENOMINATION OFTHE CARD LED
6015 ' 6020 GOSUB 7010: REMARK: ON RETURN FROM THIS SUBROUTINE WE HAVE STORED THE LEND
TH OF EACH SUIT HELD BY THE MACHINE IN THE ARRAY OS
6025 ' 6030 FUR X=0 TO 3: IF QD(X)=0 AND XOWC THEN QS(X)=0: NEXT ELSE NEXT: REMARK: TH
IS TELLS THE MACHINE TO IGNORE SUITS WITHOUT MATCHING DENOMINATIONS BY NULLING THE VALUE IN OS
6035 ' 6040 GOSUB 8600: REMARK: ON RETURN, X3 HAS A VALUE EQUAL TO THE COLUMN IN THE T
ARRAY FROM WHICH THE MACHINE WILL PLAY ITS CARD
6C:45 ' 6050 IF X3=WC THEN 6100: REMARK: TESTING TO SEE IF THE MACHINE'S PREFERRED SUIT
IS THE SAME AS THE PLAYER'S LED SUIT
6055 ' 6060 TC=X2: TR=PD: GOTO 8000: REMARK: MACHINE'S CHOSEN SUIT IS IN X3 AND THE DEN
OMINATION IS THE SAME AS THAT OF THE PLAYER'S CARD
£065 ' 6100 GOSUB 7030 :TC=X3: TR=X: GOTO 8000: REMARK: ON RETURN FROM 7030 WE HAVE FOU
ND THE HIGHEST LARD (OTHER THAN AN 8) IN THE CORRECT SUIT. X3=THE SUIT AND X= THE DENOMINATION
6:::95 6400 X3=WC: REMARK: WE DON'T HAVE THE SAME DENOMINATION IN ANOTHER SUIT, OR WE
ARE FOLLOWING AN 8 WHICH FORCES A PARTICULAR SUIT. LOOK FOR A CARD IN THAT SUIT
6405 ' 6410 GOSUB 7030: REMARK: ON RETURN, X= THE HIGHEST CARD WHICH IS NOT AN 8
6415 6420 IF X=-1 THEN 6440: REMARK: WE HAVE NO CARDS IN THE LED OR FORCED SUIT LICE
PT PERHAPS AN 8
6425 6430 TR=X: TC=WC: GOTO 8000: REMARK: PLAY THE CHOSEN CARD WHICH IS IN THE LED S
UIT 6435 ' 6440 FOR X8=0 TO 3: IF T(7,X8)>0 THEN 6460 ELSE NEXT: REMARK: IF THE VALUE IS GR
EATER THAN ZERO WE HAVE AN 8 AND JUMP TO 6460
6445 ' 6450 GOTO 7600: REMARK: WE CAN'T PLAY A CARD SO WILL HAVE TO DRAW ONE
6455 ' 6460 U6=0: IF U=1 THEN TC=X8: TR=7: GOTO 8000 ELSE GOSUB 7300: XFX3: GOSUB 6490
: IF 06=0 GOSUB 7400: TC=X8: TR=7: GOTO 8000 ELSE 05=18: GOTO 7600
6465 ' 6490 IF PU(4 RETURN ELSE IF Z)45RETURN ELSE U8=INT(52-Z)/4:U7=0:U6=1: RETURN


6499 REMARK: ROUTINE TO BUILD UP VALUES IN QS
7000 GOSUB 7010: GOSUB 8600: GOSUB 7030: GOSUB 7050: TR=Xt TC=X3t
7005 ' 7010 FOR X=0 TO 3: OS(X)=0: NEXT: FOR TC.0 TO 3:
O ELSE IF T(TR,TC))0 GOSUB 7025 7020NEXT: NEXT: RETURN
7025 OS(TC)=0S(TC)+1: RETURN
7029 REMARK: ROUTINE TO FIND HIGHEST CARD
7030 FUR X=12 TO 0 STEP -It IF X=7 THEN 7040 7040 NEXT: RETURN
7049 REMARK: ROUTINE TO DISPLAY PLAYED CARD (CALLED BY LINE 8000)
7050 O(X3)=0((3)+1: XL=T(XtX3): T(XtX3)=0t Y=XL: GOSUB 2550: PRINT@S8t" "1: NT@S8, CHRS(WS);: Y5=WElt GOSUB 2300:PRINT@S7," "t: PRINT@S7,Ft: RETURN 7299 REMARK: ROUTINE TO WEIGHT SUIT VALUES
7300 FOR ZZ=0 TO 3: OS(Z1)=0: NEXT: FOR 7Z=0 TO 3: FOR ZY=0
NEXT: NEXT: VS=(0(0)*5)+(06(0)*20): VH=(0(1)*5)+(05(1)*20):
20): VC=(P(3)*5)+(OS(2)*20)
7305 IF OS(0)=0 THEN VS=0
7306 IF OE(1)=0 THEN VH=0
7307 IF OS(2)=0 THEN VD=0
7308 IF OS(3)=0 THEN VC=0
7309 REMARK: DON'T FORCE A SUIT MACHINE IS VOID IN, WHATEVER
S SAY 7310 GS(0)=VS: OS(1)=VH: OS(2)=VD: QS(3)=VC
7320 GOSUB 8600: REMARK: COME BACK WITH THE CORRECT SUIT TO FORCE = X3
7330 RETURN
7350 IF ZY=7 OR T(ZY,ZZ)=0 RETURN ELSE QS(ZZ)=US(ZZ)+I: RETURN
7399 REMARK: ROUTINE TO PLAY AN 8
7400 IF U=I THEN PRINT@384,"I'M AFRAID MY LAST CARD'S AN 8";tRETURN ELSE IF X3.0
THEN J=C5 ELSE IF X3=1 THEN J=C6 ELSE IF X3=2 THEN J=C7 ELSE J=C8 7410 PRINT@384 "I'M GOING TO PLAY AN 8 - YOU WILL HAVE TO PLAY "Jt: PRINT@832t
CHR$(30);: PRINT@896,"NOTE THIS SUIT, THEN PRESS ANY KEY":: PRINT@960, CHR$(30);
: GOSUR 16000: PRINT@384, CHR$(216);: PRINT@896,CHR$(30);:PRINT@960,C9;: RETURN
7599 REMARK: ROUTINE TO DRAW CARDS UNTIL PLAYABLE CARD FOUND OR OTHER CONDITIONS
MET 7600 IF Z=52 GOTO 8500 ELSE PRINT11384,-;: GOSUB 7700: GOSUBI6100: Y.M(Z): Z=Z+
1: U7=U7+1: GOSUB 2550: PR1NT@384,CHR$(30);:IF Z=47 GOSUB 26000 ELSE IF Z=52G0S
U B 10500: REMARK: AT THIS POINT WD=DENOM. AND WS=SUIT 7610 GOSUB 2600: REMARK: TC NOW HAS VALUE FROM 0 TO 3
7620 T(WD-1tTC)=Y: U=U+lt GOSUB 2100: REMARK: DRAWN CARD HAS BEEN STORED IN MACH
INE'S HAND 7630 IF WD=8 OR WD-1=PD OR TC=WC THEN 7650: REMARK: 7650 IF IT CAN BE USED AS D
ISCARD 7640 IF U6=0 THEN 7600 ELSE IF U7(=U8 THEN 7600 ELSE X3=XF: GOSUB 7400: TC=U5t T
R=7: GOTO 8000 7650 IF WD=8 THEN XT=X: TT=TC: GOSUB 7010: X=XT: TC=TT: GOSUB 7300: XF.X3t GOSUB
7400: TR=7: GOTO 8000 ELSE TR=WD-1: GOTO 8000: REMARK: NOTE THE SUIT THE MACHIN
E IS FORCING IF PLAYING AN 8, ELSE JUST PLAY IT
7990 REM*.x********,-********-,.***** 7995 REMARK: ROUTINES IN LISTING 3 JUMP HERE
8000 PRINT@384, "HERE'S MY DISCARD GOSUB 16100: PRINT@384, CHR$(216):: S
4=0: R6=0 8010 U6=0: X=TR: X3=TC: GOSUB 7050: U=U-1: GOSUB 2100: R=Ot IF TR=7 AND U=0 THEN
PRINT@384, "I WIN WITH AN 8! ";: GOSUB 16200: RETURN ELSE IF TR=7 THEN TC=X
F: RETURN ELSE RETURN
8011 REM****************************
8499 REMARK: ROUTINE CALLED WHEN MACHINE CAN'T PLAY ONE AND PACK IS EMPTY
8500 R6=R6+1: IF R6=2 THEN 19900 ELSE PRINT@384,"I CAN'T GO: YOU TRY TO PLAY ONE
"I: GOSUB 16100: GOSUB 16100: PRINT@384,CHR$(30);: R=Ot TR=PD: TC=WC: RETURN
8599 REMARK: ROUTINE TO FIND SUIT WITH MOST CARDS IN AND STORE ITS ARRAY COLUMN
IN X3 8600 IF QS(0)>=QS(1) THEN X1=0 ELSE X1=1 8610 IF US(X1))=0S(2) THEN X2=X1ELSE X2=2
8620 IF OS(X





700 DATA LLLLL,SLLLL,SSLLL,SSSLL,SSSSL,SSSSS
7010 DATA LSSSS,LLSSS,LLLSS,LLLLS
70'20 DATASLSLSL,LLSSL,SSSLS,LLSLLSL
70R0 DATRLSLSLS,LLLSSS
7040 DATA SSSLLL
7070 DATA SL,LSSS,LSLS,LSS,S
7030 DATA SSLS,LLS,SSSS,SS,SLLL
7090 DATA LSL,SLSS,LL,LS,LLL
7100 DATA SLLS,LLSL,SLS,SSS,L
7110 DATA SSL,SSSL,SLL,LSSL,LSLL,LLSS
