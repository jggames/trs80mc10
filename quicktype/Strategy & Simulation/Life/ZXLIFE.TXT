0 CLS:CLEAR1000
10 DIM L$(16)
20 FOR I=1 TO 16
30 FOR J=1 TO 16
40 L$(I)=LEFT$(L$(I),J-1)+"0"+MID$(L$(I),J+1)
50 IF RND(0)>=.7 THEN L$(I)=LEFT$(L$(I),J-1)+"1"+MID$(L$(I),J+1)
60 NEXT J
70 NEXT I

1000 CLS1:M=LEN(L$(1))
1010 DIM N$(M)
1020 FORI=1TOM:FORJ=1TOM:RESET(I,J):NEXT:NEXT
1080 G=0
1090 PRINT@480,G;
1100 FORI=1TOM:FORJ=1TOM:IFMID$(L$(I),J,1)="0"THEN1150
1130 SET(I,J,.):GOTO1160
1150 RESET(I,J)
1160 NEXT:NEXT
1180 FORI=1TOM:FORJ=1TOM:N=.:FORK=I-1TOI+1:FORL=J-1TOJ+1:IFK=.ORK>MORL=.ORL>MOR(K=IANDL=J)THEN1250
1240 N=N+VAL(MID$(L$(K),L,1))
1250 NEXT:NEXT
1270 N$(I)=LEFT$(N$(I),J-1)+MID$(L$(I),J,1)+MID$(N$(I),J+1)
1280 IFN<=1ORN>=4THENN$(I)=LEFT$(N$(I),J-1)+"0"+MID$(N$(I),J+1)
1290 IFN=3THENN$(I)=LEFT$(N$(I),J-1)+"1"+MID$(N$(I),J+1)
1300 NEXT:NEXT
1320 FORI=1TOM:L$(I)=N$(I):NEXT:G=G+1:GOTO1090

2000 REM ENTER LINES:
2010 REM 10 DIM L$(3)
2020 REM 20 L$(1)="000"
2030 REM 30 L$(2)="111"
2040 REM 40 L$(3)="000"
2050 REM MAIN PROGRAM
2060 REM STARTS AT 1000

