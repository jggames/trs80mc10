50 LOMEM: 14848
60 HIMEM: 16383
100 GOTO 20010
510 POKE -16368,0
530 RN = RN +1:KY = PEEK( -16384): IF KY <128 THEN 530
540 POKE -16368,0
550 RN = RND( -997.3/(RN +.1))
599 RETURN
1110 POKE 1,1: POKE 2,1: POKE 3,75: POKE 4,100: CALL 825: RETURN
1210 POKE 1,1: POKE 2,5: POKE 3,50: POKE 4,25: CALL 825: RETURN
1310 POKE 1,5: POKE 2,1: POKE 889,128: CALL 865: POKE 889,129: CALL 865: POKE 889,130: POKE 1,15: FOR N = 1 TO 10: POKE 2,N: CALL 865: NEXT : POKE 2,15: CALL 865: RETURN
1410 POKE 1,20: POKE 2,1: FOR N = 1 TO 20: POKE 0, RND(N) *240 +15: CALL 816: NEXT : RETURN
1510 POKE 0,200: POKE 1,40: POKE 2,P +1: CALL 816: POKE 0,100: CALL 816: POKE 0,50: CALL 816: RETURN
1610 FLASH : PRINT "TRY AGAIN!": NORMAL : POKE 1,1: POKE 2,1: POKE 3,200: POKE 4,100: CALL 825: POKE 3,100: POKE 4,200: CALL 825: POKE 3,200: POKE 4,100: CALL 825: POKE 3,100: POKE 4,200: CALL 825: RETURN
1660 POKE 1,6: POKE 2,1: POKE 3,40: POKE 4,200: CALL 825: GOSUB 1810: RETURN
1710 POKE 1,2: POKE 2,1: FOR N = 1 TO 5: POKE 3,200: POKE 4,100: CALL 825: NEXT N: RETURN
1760 POKE 1,5: POKE 2,1: POKE 889,128: CALL 865: POKE 1,10: POKE 889,129: CALL 865: POKE 889,130: CALL 865: FOR N = 1 TO 20: NEXT N: RETURN
1810 POKE 1,9: POKE 2,1: POKE 889,128: CALL 865: POKE 889,129: CALL 865: POKE 889,130: POKE 1,80: FOR N = 1 TO 10: POKE 2,N: CALL 865: NEXT : POKE 2,15: CALL 865: RETURN
1910 VTAB 24: HTAB 8: INVERSE : PRINT "HIT ANY KEY TO CONTINUE.";: NORMAL : GOSUB 510: PRINT : RETURN
1960 POKE 0,W +60: POKE 1,10: POKE 2,1: CALL 816: RETURN
2010 GOSUB 1510: GOSUB 510
2070 IF KY = 155 THEN V = -10: GOTO 2999
2080 IF KY = 141 THEN V = 0: GOTO 2499
2090 V = -1
2100 IN$ = CHR$(KY -128)
2120 FOR I = 1 TO WN
2130 IF IN$ = MID$ (SN$,I,1) THEN V = I
2140 NEXT I
2499 RETURN
2510 V = 0: GOSUB 1510
2520 GOSUB 510
2530 IF KY = 155 THEN V = -10: GOTO 2999
2540 IF KY = 141 THEN 2999
2550 IF KY <176 OR KY >185 THEN V = -1: GOTO 2999
2560 V = V *10 +KY -176: GOTO 2520
2999 RETURN
3010 HOME
3030 W = 1
3040 IF WC%(W) = P THEN 3100
3050 W = W +1: IF W < = WN THEN 3040
3060 PRINT P$; MID$ (NA$,P *4 +1,4);" CONTROLS NO WORLDS."
3070 GOSUB 1910: GOTO 3999
3100 PRINT P$; MID$ (NA$,P *4 +1,4);" FROM WORLD:";
3110 GOSUB 2010
3120 IF V = -10 THEN GOSUB 9010: GOTO 3010
3130 IF V = 0 THEN 3999
3140 IF V <0 OR V >WN THEN 3170
3150 IF WC%(V) = P THEN 3180
3160 PRINT : PRINT "YOU DON'T CONTROL THAT WORLD."
3170 GOSUB 1610: PRINT : GOTO 3100
3180 WR = V: PRINT " TO WORLD:";
3190 GOSUB 2010
3200 IF V = -10 THEN GOSUB 9010: GOTO 3010
3210 IF V <1 OR V >WN THEN 3170
3220 WD = V: PRINT "NUMBER OF SHIPS:";
3230 GOSUB 2510
3240 PRINT : IF V = -10 THEN GOSUB 9010: GOTO 3010
3250 IF V <1 THEN 3170
3260 IF V >WS%(WR) THEN PRINT "YOU DON'T HAVE THAT MANY SHIPS THERE.": GOTO 3170
3270 FM = V
3300 GOSUB 4010
3310 IF F < = 50 THEN 3100
3999 RETURN
4010 F = 1
4020 IF FC%(F) = 0 THEN WS%(WR) = WS%(WR) -FM:FC%(F) = P:FD%(F) = WD:FS%(F) = FM:FT%(F) = T +( SQR((WX%(WR) -WX%(WD)) ^2 +(WY%(WR) -WY%(WD)) ^2) +.99)/3: GOTO 4999
4030 F = F +1: IF F < = 50 GOTO 4020
4040 TEXT : PRINT "THIS FLEET ORDER CANCELLED. ION STORM PREVENTS FURTHER RELEASE OF SHIPS THIS YEAR.":P%(0) = PN
4050 PRINT : GOSUB 1410: GOSUB 1910
4999 RETURN
5010 W = FD%(F):DE = WS%(W):AK = FS%(F):G1 = SQR( RND(1) *.8 + RND(1) *.2):G2 = SQR(1 -G1 ^2):AK$ = MID$ (NA$,FC%(F) *4 +1,4):DE$ = MID$ (NA$,WC%(W) *4 +1,4)
5015 HOME : INVERSE : FOR N = 1 TO 6: HTAB 8: PRINT " ";: HTAB 33: PRINT " ": NEXT N: HTAB 8: PRINT TAB( 34): NORMAL : VTAB 1
5020 HTAB 10: PRINT "SUBSPACE COMMUNICATION": PRINT : HTAB 17: PRINT "WORLD "; MID$ (SN$,W,1): GOSUB 1410: PRINT
5030 IF WC%(W) = FC%(F) THEN HTAB 14: PRINT "REINFORCEMENT": VTAB 15: PRINT P$;: FLASH : PRINT AK$;: NORMAL : PRINT " HAS SENT ";AK;" SHIPS": PRINT : PRINT "TO REINFORCE HIS WORLD.":WS%(W) = AK +DE: GOTO 5300
5040 HTAB 12: PRINT "ATTEMPTED INVASION": PRINT : PRINT : PRINT : INVERSE : HTAB 7: PRINT "ATTACKER";: HTAB 27: PRINT "DEFENDER": NORMAL : PRINT : PRINT TAB( 4);P$; TAB( 24);P$: PRINT : PRINT TAB( 9);AK$; TAB( 29);DE$
5045 GOSUB 1710
5050 PRINT : PRINT "INITIAL FORCE: ";AK; TAB( 21);"INITIAL FORCE: ";DE: PRINT : PRINT "GUNNERY FACTOR: "; INT(G2 *100); TAB( 21);"GUNNERY FACTOR: "; INT(G1 *100): PRINT : PRINT " SHIPS LEFT: ";AK; TAB( 24);"SHIPS LEFT: ";DE
5070 IF DE = 0 THEN FLASH : VTAB (22): PRINT "ATTACKER WINS";: NORMAL : PRINT " WITHOUT A FIGHT.":WS%(W) = AK:WC%(W) = FC%(F): GOTO 5300
5080 VTAB 22: HTAB 1: PRINT TAB( 26);"DEFENDER FIRES";:I = 0
5090 I = I +1: INVERSE : HTAB 20: PRINT " ";: GOSUB 1210: NORMAL : HTAB 20: PRINT " ";
5100 IF RND(P) >G1 * SQR(AK/(AK +DE)) THEN 5130
5110 INVERSE : VTAB 20: HTAB 20: PRINT " ": HTAB 19: PRINT " ": HTAB 18: PRINT " ": HTAB 19: PRINT " ": HTAB 20: PRINT " ";: GOSUB 1310:AK = AK -1: NORMAL : VTAB 19: HTAB 16: PRINT AK;" "
5115 VTAB 20: HTAB 20: PRINT " ": HTAB 19: PRINT " ": HTAB 18: PRINT " ": HTAB 19: PRINT " ": HTAB 20: PRINT " ";: VTAB 22
5120 IF AK = 0 THEN FLASH : PRINT : VTAB 22: HTAB 5: PRINT "DEFENDERS";: NORMAL : PRINT " FIGHT OFF THE AGGRESSORS.":WS%(W) = DE: GOTO 5300
5130 IF I G2 * SQR(DE/(AK +DE)) THEN 5250
5230 INVERSE : VTAB 20: HTAB 20: PRINT " ": HTAB 19: PRINT " ": HTAB 18: PRINT " ": HTAB 19: PRINT " ": HTAB 20: PRINT " ";: GOSUB 1310:DE = DE -1: NORMAL : VTAB 19: HTAB 36: PRINT DE;" "
5235 VTAB 20: HTAB 20: PRINT " ": HTAB 19: PRINT " ": HTAB 18: PRINT " ": HTAB 19: PRINT " ": HTAB 20: PRINT " ";: VTAB 22
5240 IF DE = 0 THEN FLASH : PRINT : VTAB 22: PRINT "ATTACKERS";: NORMAL : PRINT " ARE VICTORIOUS!":WS%(W) = AK:WC%(W) = FC%(F): GOTO 5300
5250 IF I 0 THEN PRINT TAB( 32);WI%(W); TAB( 37);W2%(W);
8060 PRINT : NEXT W
8070 VTAB ( PEEK(34) +1): FOR W = 1 TO INT(WN/2 +.5)
8080 PRINT " "; MID$ (SN$,W,1); TAB( 6); MID$ (NA$,WC%(W) *4 +1,4);: GOSUB 1960
8090 IF WC%(W) >0 THEN PRINT TAB( 11);WI%(W); TAB( 16);W2%(W);
8100 PRINT : NEXT W
8110 POKE 34, PEEK(37)
8999 RETURN
9010 TEXT : HOME : PRINT : PRINT
9020 PRINT "G=GO BACK TO REGULAR TURN"
9030 PRINT : PRINT "M=STARMAP"
9040 PRINT : PRINT "T=TIME/DISTANCE CALCULATOR"
9045 IN$ = "TURN OFF": IF PEEK(816) = 96 THEN IN$ = "TURN ON"
9046 PRINT : PRINT "N=";IN$;" SOUND EFFECTS"
9050 PRINT : PRINT "S=SAVE CURRENT GAME ON DISK"
9060 PRINT : PRINT "Q=QUIT (YOU DROP OUT OF THE GAME)"
9070 PRINT : PRINT "E=END THE GAME (FOR EVERYBODY)"
9080 PRINT : PRINT "C=CHANGE THE NUMBER OF TURNS IN THE GAME"
9200 PRINT : PRINT : PRINT "WHICH DO YOU WANT?";: POKE -16368,0: GET IN$: PRINT
9210 IF IN$ = "G" THEN T = T -1: GOSUB 8010:T = T +1: GOTO 9999
9220 IF IN$ = "M" THEN GOSUB 30010: GOTO 9400
9230 IF IN$ = "T" THEN GOSUB 35010: GOTO 9010
9235 IF IN$ = "N" AND PEEK(816) = 166 THEN GOSUB 32500: GOTO 9010
9236 IF IN$ = "N" AND PEEK(816) = 96 THEN GOSUB 32000: GOTO 9010
9240 IF IN$ = "S" THEN PRINT "THE GAME WILL BE SAVED AT THE END OF THIS TURN.":SF = 1: GOTO 9400
9250 IF IN$ = "Q" THEN GOSUB 9510: GOTO 9010
9260 IF IN$ = "E" THEN GOSUB 9710: GOTO 9010
9270 IF IN$ = "C" THEN GOSUB 9910: GOTO 9010
9300 HOME : PRINT "I DIDN'T GET THAT.": GOSUB 1610: PRINT : PRINT : GOTO 9020
9400 GOSUB 1910: GOTO 9010
9510 GOSUB 9810: IF IN$ < >"Y" THEN 9599
9520 FOR F = 1 TO 50: IF FC%(F) = P THEN FC%(F) = 0
9530 NEXT F
9540 FOR W = 1 TO WN: IF WC%(W) = P THEN WC%(W) = 0
9550 NEXT W
9599 RETURN
9710 GOSUB 9810: IF IN$ < >"Y" THEN 9799
9720 POP : POP :P%(0) = PN:T = TN
9740 FOR F = 1 TO 50:FC%(F) = 0: NEXT F
9799 RETURN
9810 PRINT : PRINT "ARE YOU SURE?";: POKE -16368,0: GET IN$: PRINT
9899 RETURN
9910 HOME
9920 PRINT "THIS IS NOW GAME YEAR ";T: PRINT
9930 PRINT "THERE ARE ";TN;" YEARS IN THE GAME.": PRINT
9940 PRINT "HOW MANY YEARS DO YOU WANT IN THE GAME NOW";: POKE -16368,0: INPUT V
9950 IF T >V OR V >100 THEN GOSUB 1610: GOTO 9910
9960 TN = V
9999 RETURN
10010 HOME : HTAB 13: INVERSE : PRINT "THE GAME IS OVER.": NORMAL : GOSUB 1410: PRINT "HIT FOR FINAL GAME STATISTICS. HIT TO CONTINUE THE GAME.";: GOSUB 510: IF KY = 155 THEN TN = T: GOTO 10999
10015 PRINT : IF KY = 141 THEN POKE 34,0:N = 0: GOTO 10030
10020 GOSUB 1610: GOTO 10010
10030 FOR P = 1 TO PN:V = 0
10050 FOR W = 1 TO WN: IF WC%(W) = P THEN V = V +1
10070 NEXT W
10080 PRINT P$; MID$ (NA$,P *4 +1,4);" HAS ";V;" PLANETS."
10090 IF V >N THEN N = V
10100 NEXT P: PRINT
10200 IF PN = 1 THEN 10400
10300 FOR P = 1 TO PN:V = 0
10320 FOR W = 1 TO WN: IF WC%(W) = P THEN V = V +1
10340 NEXT W
10350 IF V = N THEN PRINT "CONGRATULATIONS TO ";: FLASH : PRINT P$; MID$ (NA$,P *4 +1,4);"!": NORMAL
10360 NEXT P
10370 GOSUB 1660
10390 GOTO 10500
10400 IF V = WN THEN PRINT "CONGRATULATIONS!": GOSUB 1410: GOTO 10500
10410 PRINT "BETTER LUCK NEXT TIME."
10500 PRINT : PRINT
10510 PRINT "HIT 'RETURN' TO END IT ALL";: POKE -16368,0: INPUT IN$
10520 PRINT : PRINT
10610 FOR I = 1 TO 36: PRINT MID$ ("THIS IS CENTRAL CONTROL SIGNING OFF.",I,1);
10620 GOSUB 1760: NEXT I
10630 FOR I = 1 TO 2000: NEXT I
10640 GOSUB 1760
10650 HOME
10999 RETURN
20010 GOSUB 21010
20020 GOSUB 22010
20030 GOSUB 23010
20050 GOSUB 32010
20060 GOSUB 25010
20062 PRINT : PRINT : PRINT "DO YOU WANT TO RETURN TO AN OLD GAME (O)OR START A NEW ONE (N)?": GOSUB 1510: GOSUB 510: PRINT
20070 IF KY = 206 THEN 20130
20080 IF KY = 207 THEN PRINT "LOAD FROM DISK (D) OR TAPE (T)?": GOSUB 1510: GOSUB 510: PRINT : GOTO 20100
20090 GOSUB 1610: GOTO 20062
20100 IF KY = 196 THEN PRINT "NOW LOADING OLD GAME.": PRINT D$;"BLOAD GXOLD":W = FRE(0):T = T -1: GOSUB 8010:T = T +1: GOTO 20265
20105 IF KY < >212 THEN GOSUB 1610: GOTO 20062
20110 PRINT "INSERT THE TAPE CONTAINING THE OLD GAME INTO THE RECORDER, REWIND IT AND PRESS THE 'PLAY' BUTTON - THEN HIT .": GOSUB 510
20112 PRINT : PRINT "NOW READING TAPE."
20114 POKE 60,00: POKE 61,58: POKE 62,255: POKE 63,63: CALL -259
20116 W = FRE(0):T = T -1: GOSUB 8010:T = T +1: GOTO 20265
20130 GOSUB 28010
20135 GOSUB 33010
20140 GOSUB 29010
20150 GOSUB 30010
20160 PRINT "NEW SETUP? ";: GOSUB 1510: GOSUB 510
20170 IF KY = 217 THEN PRINT "YES": PRINT "PLEASE WAIT WHILE I MAKE MORE STARS.": GOTO 20140
20180 IF KY = 206 THEN PRINT "NO": PRINT "PLEASE WAIT WHILE I SET UP THE GAME.": GOTO 20200
20190 GOSUB 1610: GOTO 20160
20200 GOSUB 31010
20220 GOSUB 34010
20250 GOSUB 8010
20260 T = 1
20265 FOR P = 0 TO PN:P%(P) = 0: NEXT
20270 P = INT(PN * RND(PN) +1): IF P%(P) = 1 THEN 20270
20275 P%(P) = 1:P%(0) = P%(0) +1
20280 GOSUB 3010
20290 IF P%(0) 212 THEN GOSUB 1610: GOTO 20350
20370 SF = FRE(0):SF = 0: PRINT : PRINT "INSERT A NEW TAPE (NOT THE GAME TAPE) INTO THE TAPE RECORDER, REWIND IT AND PRESS 'RECORD' - THEN HIT .": GOSUB 510
20380 PRINT : PRINT "GAME BEING SAVED ON TAPE."
20390 POKE 60,00: POKE 61,58: POKE 62,255: POKE 63,63: CALL -307: PRINT "GAME SAVED."
20400 PRINT : PRINT "DO YOU WANT TO CONTINUE THE GAME? ";: GOSUB 1510: GOSUB 510
20410 IF KY = 217 THEN PRINT "YES": GOTO 20440
20420 IF KY = 206 THEN PRINT "NO": TEXT : GOTO 20999
20430 PRINT : PRINT : GOSUB 1610: GOTO 20400
20440 IF T < = TN THEN 20265
20450 GOSUB 10010
20500 IF T = TN THEN 20265
20999 END
21010 TEXT : HOME : VTAB 12
21999 RETURN
22010 N = 0:V = 0:I = 0:W = 0:F = 0:P = 0:DE = 0:AK = 0:G1 = 0:G2 = 0:PN = 0:WN = 0:KY = 0:RN = 0:T = 0:TN = 0:AB = 0:FM = 0:WD = 0:WR = 0:DI = 0:TI% = 0:SF = 0
22030 P$ = "FLEET ADMIRAL "
22040 IN$ = " "
22050 NA$ = "ZERO"
22070 SN$ = "ABCDEFGHIJKLMNOPQRSTUVWXYZ*#$%&+<=>?()@^"
22080 D$ = CHR$(4)
22090 AK$ = " ":DE$ = " "
22999 RETURN
23010 DIM WS%(40),WC%(40),WX%(40),WY%(40),WI%(40),W2%(40)
23020 DIM FS%(50),FD%(50),FC%(50),FT%(50)
23030 DIM P%(20)
23100 FOR F = 1 TO 50:FC%(F) = 0: NEXT
23110 FOR W = 1 TO 40:WC%(W) = 0:WI%(W) = 0:WS%(W) = 0: NEXT
23999 RETURN
25010 GOSUB 1410: HOME : VTAB 12: HTAB 13
25020 FOR I = 1 TO 14: PRINT MID$ ("G A L A X Y !",I,1);
25030 GOSUB 1110: NEXT I: PRINT
25060 GOSUB 1710
25065 FOR I = 1 TO 10: GOSUB 1210: NEXT I
25070 GOSUB 1660
25999 RETURN
28010 HOME : POKE -16368,0: INPUT "HOW MANY PLAYERS (1-20)?";PN
28020 IF PN <1 OR PN >20 THEN GOSUB 1610: GOTO 28010
28030 PN = INT(PN): PRINT
28040 POKE -16368,0: INPUT "HOW MANY WORLDS (5-40)?";WN
28050 IF WN < = PN THEN PRINT : PRINT "YOU MUST HAVE MORE STARS THAN PLAYERS.": PRINT "(THIS ISN'T BASKETBALL.)": GOSUB 1610: PRINT : GOTO 28040
28055 IF WN >40 THEN PRINT : PRINT WN;" IS TOO MANY STARS.": GOSUB 1610: GOTO 28040
28060 WN = INT(WN): PRINT
28070 POKE -16368,0: INPUT "HOW MANY YEARS (TURNS) IN THE GAME (1-100)? ";TN
28080 IF TN <1 OR TN >100 THEN GOSUB 1610: GOTO 28070
28090 TN = INT(TN): PRINT
28100 PRINT "DO YOU WANT THE NEUTRAL WORLDS TO BUILD DEFENSIVE SHIPS? ";: GOSUB 510
28110 IF KY = 217 THEN AB = 1: PRINT "YES": GOTO 28200
28120 IF KY = 206 THEN AB = 0: PRINT "NO": GOTO 28200
28130 PRINT : PRINT : GOSUB 1610: GOTO 28100
28200 PRINT : PRINT
28210 FOR P = 1 TO PN
28220 PRINT : PRINT P$;P;" WILL BEGIN THE GAME IN"
28230 PRINT "CONTROL OF WORLD "; MID$ (SN$,P,1);"."
28240 INPUT "WHAT NAME WILL THIS FLEET ADMIRAL USE (1 TO 4 CHARACTERS)? ";IN$
28250 IF LEN(IN$) <1 OR LEN(IN$) >4 THEN GOSUB 1610: GOTO 28220
28260 IF LEN(IN$) = 1 THEN IN$ = IN$ +" "
28270 IF LEN(IN$) = 2 THEN IN$ = IN$ +" "
28280 IF LEN(IN$) = 3 THEN IN$ = IN$ +" "
28290 NA$ = NA$ +IN$
28300 NEXT P
28800 PRINT : PRINT "PLEASE WAIT WHILE I CREATE THE UNIVERSE.";
28999 RETURN
29010 WX%(1) = 1 + INT( RND(PN) *20)
29020 WY%(1) = 1 + INT( RND(PN) *20)
29030 FOR W = 2 TO WN
29040 WX%(W) = 1 + INT( RND(PN) *20)
29050 WY%(W) = 1 + INT( RND(PN) *20)
29060 I = 1
29070 IF WX%(W) = WX%(I) AND WY%(W) = WY%(I) THEN 29040
29080 I = I +1: IF I TO QUIT."
35030 PRINT : PRINT "FROM WORLD: ";
35040 GOSUB 2010
35050 IF V = 0 THEN 35999
35060 IF V <1 OR V >WN THEN GOSUB 1610: GOTO 35030
35070 WR = V
35100 PRINT "TO WORLD:"
35110 GOSUB 2010
35120 IF V <1 OR V >WN THEN GOSUB 1610: GOTO 35030
35130 WD = V
35200 DI = SQR((WX%(WR) -WX%(WD)) ^2 +(WY%(WR) -WY%(WD)) ^2)
35210 TI% = (DI +.99)/3
35220 DI = INT(DI *100)/100
35400 PRINT : PRINT " DISTANCE: ";DI;" LIGHT YEARS"
35410 PRINT " TRAVEL TIME: ";TI%;" YEARS"
35420 PRINT " CURRENT TURN: ";T
35430 PRINT "TURN OF ARRIVAL: ";T +TI%
35500 GOTO 35030
35999 RETURN
