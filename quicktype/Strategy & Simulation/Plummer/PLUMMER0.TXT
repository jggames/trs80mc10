10 DEF SEG=0:SCREEN 0,0:KEY OFF
20 LM=13:AX=10:AY=5:DL=1200:DM=110:SD=25:SW=80
30 BK=219:UI0TH SW:LOCATE,,0:BA$=CHR$(29)
40 SP$=CHR$(32):MX=AX*5+3:MY=AY*4+3
50 DIM MP(MX,MY),V(5,2),Z$<3>
60 Z$(0)="BLINKING":Z$(1)="SOAKING"
70 Z$(2)="QUIT?":ZS(3)="SURFACE?"
80 BL$=STRING$(MX,BK)
90 FOR X=1 TO HX:FOR Y=1 TO MY:MP(X,Y)=BK:NEXT Y,X
100 VC=5:RY=2:FOR Y=2 TO HY-1
110 IF Y=RY THEN S=1:RY=RY+AY ELSE S=AX
120 FOR X=2 TO HX-1 STEP S:MPCX,Y)=32:NEXT X,Y
130 FOR Y=1 TO 5:READ T$:FOR X=1 TO 6
140 T=ASC(MID$(T$,X)):T=T+(T=66>*34
150 MP(AX*CX-1)+2,AY*CY-1)+2)=T:NEXT X,Y
160 FOR L=1 TO 5:READ T:Y=INT(T/6):X=T-6*Y
170 V(L,1)=X*AX+2:V(L,2)=Y*AY+2:NEXT L
180 SEL=0:CX=4*AX+2:CY=3*AY+2:PM$="C"
190 CLS:FOR Y=1 TO HY:PRINT TAB(LM+1);:FOR X=1 TO MX
200 PRINT CHR$(MP(X,Y));:NEXT X:PRINT:NEXT Y
210 GOSUB 1000:SEL=ABSC(K=81)*2+CK=83)*3)
220 IF SEL=0 THEN 270
230 CLS:N$="DO YOU WANT TO "+Z$CSED:GOSUB 3000
240 GOSUB 1000:IF K<>78 AND K<>89 THEN SOUND 500,2:GOTO 240
250 IF K=78 THEN SEL=0:GOTO 190
260 ON SEL-1 GOTO 580,410
270 DX=<K=74)-(K=76):DY=(K=73)-(K=75)
280 IF DX=0 AND DY=0 THEN 320
290 TX=CX+DX:TY=CY+DY
300 T=MPCTX,TY):IF T=BK THEN 330
310 CX=TX;CY=TY:PHS=CHRS(T):GOTO 210
320 IF K=67 OR K=79 THEN 340
330 SOUND 500,2:GOTO 210
340 T=MP(CX,CY):IF T=K OR <T<>67 AND T<>79) THEN 330
350 MPCCX,CY)=K:PM$=CHR$(K):GOSUB 2000
360 VC=VC-(K=79)+CK=67):IF VC<6 THEN 210
370 FOR D=1 TO DL:NEXT D:X=LM+1
380 FOR Y=HY TO 1 STEP-1:GOSUB 4000:PRINT BL$;
390 FOR D=1 TO DL/3;NEXT D,Y
400 FOR D=1 TO DL:NEXT D:F=1:GOTO 450
410 F=0:IF VC<>5 THEN 450
420 FOR L=1 TO 5
430 IF MP(V(L,1),V(L,2))=79 THEN VC=VC-1
440 NEXT L:IF VC=0 THEN VC=-1
450 CLS:H$="LUKE EMERGES "+Z$CF)
460 M$=M$+" INTO THE BRIGHT SUNLIGHT AND IS GREETED"
470 M$=M$+" BY THE TOWNFOLK, WHO SHOUT,"
480 IF LEN(M$)<=SW THEN NS=M$:GOSUB 3000:GOTO 530
490 B=SW+1:C=1:F0R A=B TO 2 STEP-1
500 IF MID$(M$,A,1)=SP$ THEN C=0:B=A:A=2
510 NEXT A:N$=LEFT$CM$,B-1):GOSUB 3000
520 M$=RIGHT$(M$,LEN(K$)-B+C):GOTO 480
530 FOR 0=1 TO DL*3:NEXT D
540 CLS:IF VC=-1 THEN 570
550 FOR 1=1 TO DM:PRINT "YOU'RE FIRED! ";
560 FOR D=1 TO SD:NEXT D,I:GOTO 580
570 N$="WHY, YOU CLEVER WATER RAT, YOU!":GOSUB 3000
580 POKE 1050,PEEK(1052):END
1000 K$=INKEY$:IF SEL=0 THEN GOSUB 2000
1010 IF K$="" THEN 1000 ELSE K=ASC(K$)
1020 K=K-32*(K>96)*(K<123):RETURN
2000 Y=CY:X=LM+CX:GOSUB 4000
2010 PRINT "*";BA$;PM$;:RETURN
3000 IF LEN(N$)=SW THEN PRINT NS;;RETURN
3010 PRINT TABCCSW-LEN(N$))/2);N$:RETURK
4000 LOCATE Y,X:RETURN
5000 DATA EBBCEE,EBCBOE,CCO+OC,EOEOCE,CEECEE
5010 DATA 3,13,16,17,19
