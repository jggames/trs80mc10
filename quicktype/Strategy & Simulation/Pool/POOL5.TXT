0 K=RND(-(PEEK(9)*256+PEEK(10))):M=16384:DATA198,32,126,251,214
2 A=20000:FORI=0TO4:READB:POKEA+I,B:NEXT
10 CLS:PRINT"FIRST PLAYER NAME.":PRINT:INPUTN$:A$=LEFT$(N$,7):PRINT:PRINT"SECOND PLAYER NAME."
20 PRINT:INPUTN$:B$=LEFT$(N$,7):CLS:D=1:Q0=M+256+26:B0=15:B1=42:B=B0:C=1:EXEC20000:PRINT@511," ";:PRINT@0,""
70 FORP=MTOM+480STEP32
100 POKEP-1,96:POKEP,143:NEXT
110 B=B0:Q=Q0
120 POKEQ,B
130 GOSUB3030
510 IFD=1THENGOSUB1000
520 GOSUB2500
530 IFPEEK(Q+I)<>32THENGOSUB2000
540 IFPEEK(Q+I)<>32THENGOSUB2500
545 IFPEEK(Q+I)<>32THENGOSUB2000
550 POKEQ,32:Q=Q+I:IFB=B0THENQC=Q
570 POKEQ,B:IFI=0THEN510
590 FORT=0TOD:NEXT:D=D*1.2:IFD>200THENI=0:D=1:H=0:IFB=B1THENB=B0:Q=QC:POKEQ,B
620 IFD=1THENGOSUB3007
630 GOTO510
1000 IFS=1THENGOSUB6000
1020 FORV=1TO8
1030 IFV=1THENI=-1:Z=45
1040 IFV=2THENI=-33:Z=28
1050 IFV=3THENI=-32:Z=33
1060 IFV=4THENI=-31:Z=47
1070 IFV=5THENI=1:Z=45
1080 IFV=6THENI=33:Z=28
1090 IFV=7THENI=32:Z=33
1100 IFV=8THENI=31:Z=47
1110 A=PEEK(Q-I)
1120 POKEQ-I,Z:FORT=0TO100:NEXT:POKEQ-I,A:GOSUB7000
1155 IFK=65THENV=V-1:V=V-(V=.)*8:GOTO1030
1160 IFK=32THENK=V:V=8:NEXT:V=K:GOTO1200
1170 IFK<>68THEN1110
1180 NEXTV:GOTO1000
1200 FORD=1TO100STEP10:V$=STR$(100-(D-1)):PRINT@483,"speed";V$;"  ";
1260 FORT=0TO300:NEXT:GOSUB7000:IFK=0THENPRINT@483,"SPEED";:GOTO5000
1310 NEXTD:GOTO1200
2000 IFPEEK(Q+I)=128ORPEEK(Q+32)=128ORPEEK(Q-32)=128THENH=1:GOTO3000
2040 IFPEEK(Q+I)>64ANDQ<M+64THENI=I+64:GOTO5000
2050 IFPEEK(Q+I)>64ANDQ>M+448THENI=I-64:GOTO5000
2060 IFPEEK(Q+I)=143THENI=I+2:GOTO5000
2070 IFPEEK(Q+I)=96THENI=I-2:GOTO5000
2080 RETURN
2500 IFI=0THENRETURN
2520 IFPEEK(Q+I)=B0THENPOKEQ,B:B=B0:Q=Q+I:GOTO5000
2530 IFPEEK(Q+I)=B1THENPOKEQ,B:B=B1:Q=Q+I:GOTO5000
2540 IFPEEK(Q+1)=B1THENPOKEQ,B:B=B1:Q=Q+1:GOTO5000
2550 IFPEEK(Q-1)=B1THENPOKEQ,B:B=B1:Q=Q-1:GOTO5000
2560 IFPEEK(Q-32)=B1THENPOKEQ,B:B=B1:Q=Q-32:GOTO5000
2570 IFPEEK(Q+32)=B1THENPOKEQ,B:B=B1:Q=Q+32:GOTO5000
2580 RETURN
3000 IFB=B0THENI=0:D=1:POKEQ,32:Q=Q0:H=0:S=1
3007 IFH=0THENC=-C:GOSUB5400
3010 IFC<0THEN3500
3020 IFH=1THENSA=SA+1:POKEQ,32:GOSUB5200
3030 PRINT@3,A$;CHR$(95);SA;:PRINT@16+3,B$;" ";STR$(SB);:GOTO3535
3040 IFB=B1THENH=0:I=0:D=1:Q=QC:B=B0
3045 PRINT@483,"SPEED 100";
3050 FORP=M+33TOM+478:IFPEEK(P)=B1THENRETURN
3070 NEXT
3080 GOSUB4000
3090 RETURN
3500 IFH=1THENSB=SB+1:POKEQ,32:GOSUB5200
3510 PRINT@3,A$;" ";SA;:PRINT@16+3,B$;CHR$(95);STR$(SB);
3535 IFSA+SB=15THENGOSUB9000
3540 GOTO3040
4000 POKEM,128:POKEM+1,128:POKEM+32,128
4170 POKEM+480,128:POKEM+448,128:POKEM+481,128
4180 POKEM+31,128:POKEM+30,128:POKEM+31+32,128
4190 POKEM+480+31,128:POKEM+480+30,128:POKEM+480+31-32,128
4200 POKEM+16,128:POKEM+15,128:POKEM+17,128
4210 POKEM+480+16,128:POKEM+480+15,128:POKEM+480+17,128
4300 FORN=1TO15
4310 P=M+RND(480)
4320 IFPEEK(P)<>32THEN4310
4330 IFPEEK(P+1)<>32THEN4310
4340 IFPEEK(P-1)<>32THEN4310
4350 IFPEEK(P+32)<>32THEN4310
4360 IFPEEK(P-32)<>32THEN4310
4370 IFPEEK(P+31)<>32THEN4310
4380 IFPEEK(P-31)<>32THEN4310
4390 IFPEEK(P+33)<>32THEN4310
4400 IFPEEK(P-33)<>32THEN4310
4410 POKEP,B1
4420 NEXT
4430 RETURN
5000 SOUND1,1
5005 D=D*1.2
5010 RETURN
5200 FORS=1TO3:SOUND198,2:NEXTS
5260 RETURN
5400 FORT=1TO10:SOUND9,1:NEXT:RETURN
6000 FORP=M+53TOM+469STEP32
6020 IFPEEK(P)=32THENPOKEP,175
6030 NEXT
6040 V=1
6500 GOSUB7000
6505 IFK=65THENI=-1
6510 IFK=68THENI=1
6520 IFK=87THENI=-32
6530 IFK=83THENI=32
6535 IFK=32THEN6580
6540 POKEQ,32:IFPEEK(Q+I)=32THENQ=Q+I:QC=Q
6550 POKEQ,B
6570 I=0:GOTO6500
6580 SOUND96,1
6600 FORP=M+53TOM+469STEP32:IFPEEK(P)=175THENPOKEP,32
6620 NEXT
6630 S=0
6640 RETURN
7000 K=PEEK(2)ANDPEEK(17023):RETURN
9000 PRINT@499,"CONTINUE?";
9010 M$=INKEY$:IFM$="Y"THENPRINT@499,"         ";:RETURN
9020 IFM$<>"N"THEN9010
9030 RUN
