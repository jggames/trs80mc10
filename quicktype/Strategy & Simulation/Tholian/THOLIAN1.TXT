0 DU$="ÍhÍ0DÍ(DÉTWANG1/CMD      DO NOT EDIT THIS STRING !!   Z80 CODE BY GEORGE SOMERS 06/80 "
1 POKE16553,255:REM
                         STAR TREK:
                      ENCOUNTER IN THE
2 REM                NEAR THOLIAN SECTOR
3 REM                  COPYRIGHT 1979
                        BARRY L ADAMS
                    GREENVILLE , NC  27834
4 '	                     **** <[> ****
  WITH CORRECTIONS, ADDITIONS, AND MACHINE LANGUAGE GRAPHICS BY
                        GEORGE SOMERS
                        **** <\> ****
9 RANDOM:REM MAIN PROGRAM LOOP LINES 20 - 565: GRAPHICS ROUTINES BLOCK  600 & LINES 1450,1770: INTRODUCTION, SETUP AND DATA 10,1500 -   2050

10 POKE&H40B1,0:POKE&H40B2,243:CLEAR700:DIM A(16):DEFINTB-F,H-K,N-P,S,U-Z:RANDOM:DEFUSR=&HFB9A:DEFUSR1=&HF332:DEFUSR2=&H68C3:CMD"LOAD TWANG1/CMD":DEFUSR3=&HFA08:DEFUSR4=&HFD00:DEFUSR5=&HFDDD:DEFUSR6=&HFDFA:DEFUSR7=&HFE7C:DEFUSR8=&HFEB6:DEFUSR9=&HF4CB
11 CQ$=CHR$(176)+CHR$(176)+CHR$(176)+CHR$(186)+CHR$(181)+CHR$(176)+CHR$(176)+CHR$(176):CW$=CHR$(131)+CHR$(131)+CHR$(131)+CHR$(171)+CHR$(151)+CHR$(131)+CHR$(131)+CHR$(131):POKE&HF567,7:POKE&HFB07,80
12 CMD"TWANG1"
13 POKE&H4026,242:POKE&H4027,245:POKE&H4153,115:POKE&H4154,245:POKE&H4162,54:POKE&H4163,245:POKE&H4165,200:POKE&H4166,245:POKE&H4168,158:POKE&H4169,245:GOTO1500
14 REM DEFLECTOR SHIELDS
15 PRINT:INPUT"SPECIFY AM'T OF ENERGY TO TRANSFER TO SHIELDS";H:IF A(6)+H>5*U,15 ELSE IF G-H<0 PRINT"ENGINEERING REPORTS INSUFFICENT ENERGY  <";G;">":GOTO15:ELSE G=G-H:A(6)=A(6)+H:Q=10:RETURN
19 REM SHIP SYSTEMS  SETUP
20 LPRINT:FORZZ=1TO5:ZY=LOC(1):FORYZ=1TO5:NEXTYZ:NEXTZZ:FORZZ=1TO30:ZY=EOF(1):NEXTZZ:ZZ=USR7(ZZ):GOSUB9008:GOSUB9009:S=INT(RND(A/U)):X=S:G=RND(A+U)+A*S:FOR J=1TO5:A(J)=1:NEXT:A(6)=RND(U*5)
25 K=0:FORJ=10TO15:A(J)=1:NEXT:A(16)=RND(U+A)+A:GOTO40
30 CLS:X=X-1:IF A(6)<0 OR G<0 OR X<=0, X=S-X:A=1:GOTO45:ELSE 25
35 PRINT@209,"OUT OF";S;"HAVE BEEN DESTROYED":PRINT@529,"THE FEDERATION HAS BEEN ";:IF X=S PRINT"SAVED":GOTO500:ELSE PRINT"LOST":PRINTTAB(28);"IDIOT!":GOTO510
40 GOSUB60000:R=L*10*RND(A/U):B=INT(180*RND(A/L/10)):F=0:I=0:CLS:GOSUB650:FORC=1TO5:PRINT@470,"R E D  A L E R T":GOSUB920:CLS:GOSUB9003:GOSUB930:NEXTC
45 K7=K7+1:PRINT@140,"SENSORS REPORT ";X;B$;"WAR CRUISERS":IF A=1,35 ELSE PRINT@216,"APPROACHING"
50 PRINT:PRINT"RANGE";R;"METERS";TAB(42);"AZIMUTH";B*2;"DEG":IFZ>0 A(6)=Z-H:Z=0:H=ABS(H)
55 IF A(6)<1426 PRINT:PRINTTAB(21);"DANGER SHIELDS LOW"
60 PRINT:PRINT"BANKS";G;TAB(24);"SHIELDS";A(6);TAB(46);B$;A(16):PRINT:PRINTTAB(26);"COMMAND"
70 GOSUB9004:C$=INKEY$:IFC$="",70 ELSE C=VAL(C$):CLS:PRINTA$;:IF C<4 PRINT"FIRE ";
75 ON C GOSUB 130,135,150,170,175,185,15,190,195:GOTO205
78 REM
79 REM KLINGONS LOGIC ROUTINE
80 W=A(11)+A(12):Y=A(14)+A(15):PRINTB$;:IF S>1 PRINT"#";K7;
85 IF G<=A(16),90 ELSE IF A(16)<499 OR ( W=0 AND A(13)=0 AND Y=0 ),370
90 M=RND(A)*U:IF R>=M+L*10,110
95 IF A(13)=1 AND R>L*5 AND B<111,120
100 IF W>0 AND R<=M/4+L,115 ELSE IF W>0,110
105 IF A(16)>U AND A(13)=1,125 ELSE IF Y>0 C=5:GOSUB175:GOTO205:ELSE C=6:GOTO75
110 IF A(14)>0 C=4:QR=21:GOSUB170:QR=0:B=0:Q=150:GOTO205:ELSE 105
115 IF W>0 PRINT"FIRING PHASER":Q=780:GOSUB 140:GOSUB9000:Q=500:C=1:GOTO205:ELSE 95
120 IF A(13)=0 OR A(16)<U,100
125 PRINT"FIRING PLASMA WEAPON":GOSUB9013:C=3:GOSUB9012:B=55:Q=1425:GOSUB160:Q=U:GOTO205
130 PRINT"FORWARD PHASERS":IF A(1)=0,180 ELSE GOSUB9000:Q=700:IF B>90,155 ELSE 140
135 PRINT"REAR PHASERS":IF A(2)=0,180 ELSE GOSUB9000:Q=350:IF B<90,155
140 IF R>L,H=Q*(L/R):RETURN
145 H=Q+Q*(1-R/L):RETURN
150 PRINT"PHOTON TORPEDO":IF A(3)=0,180 ELSE GOSUB9001:GOSUB9001:GOSUB 960:Q=U:IF B<=90,160
155 H=0:RETURN
160 IF R>5*L AND R<=6.8*L,H=Q:RETURN:ELSE IF R>6.8*L,H=Q*.8*5*L/R:RETURN:ELSE IF I=0 CLS:FOR C1=1TO5:PRINT@404,"DANGER REFLECTIVE ENERGY":GOSUB8994:CLS:GOSUB9003:NEXTC1
165 F=1:H=RND(Q)+200:PRINT"RELECTION DATA";:GOTO225
170 IF J=0 AND A(4)=0 PRINT"IMPULSE";:GOTO180:ELSEGOSUB5000:PRINT@485,"CLOSING IN":R=R/2:B=0:Q=150:GOSUB5030:RETURN
175 IF J=0 AND A(4)=0 AND A(5)=0 PRINT"ENGINE";:GOTO180:ELSEGOSUB5000:PRINT@485,"STEERING AWAY":R=R*(1+A(5+I)+.05*A(4+I)):Q=350:GOSUB5030:RETURN
180 PRINT" SYSTEM INOPERATIVE":FORZZ=1TO2:GOSUB9011:NEXTZZ:GOTO50
185 PRINT"STANDING BY":Q=10:RETURN
190 PRINT"REACTIVATING DILITHIUM CRYSTALS":GOSUB9006:Q=-INT(1575*((100E3-G)/100E3)):Z=A(6):A(6)=Z/4:RETURN
195 PRINT:PRINT"SPECIFY SYSTEM TO BE REPAIRED":H$="":GOSUB9003
200 H$=INKEY$:IF H$="",200 ELSE A(VAL(H$))=1:Q=650:RETURN
203 REM
204 REM ATTACK ASSESSMENT
205 IF I=0 G=G-Q:IF G<0,385 ELSE 215
210 A(16)=A(16)-Q:IFA(16)<0,385ELSEIFC<3ANDA(6)-H<=0ANDA(6)<600,K3=1:A(6)=-1:J=0:PRINT"WE ARE RECEIVING A TRANSMISSION FROM THE ";B$;"COMMANDER":PRINT"STANDBY":GOSUB900:GOSUB1930:CLS:PRINT@276,E$;:GOSUB960:GOSUB640:GOSUB930:GOTO390:ELSE215
215 IF C=5 PRINT"CONTACT ";:IF R>1E8PRINT"LOST":X=X+1:GOTO30:ELSE PRINT"NOT LOST"
220 IF I=0 J=10 ELSE J=0
225 IF H>A*2 H=A*2
230 D=RND(H):IFC>3H=0:GOTO400:ELSEPRINTTAB(21);:IFJ=0PRINT"DAMAGE REPORT":PRINTA$;:GOTO235:ELSEPRINT"SENSORS REPORT":PRINTB$;:IFA(16)-H>0,235 ELSEIFR<6E5,234ELSEIFK7<SAND(A(11)=0ANDA(12)=0ANDA(13)=0)ORA(16)<349,233ELSE235
233 GOSUB9010:PRINT"STANDBY - WE'RE RECEIVING A VISUAL SIGNAL FROM A ";B$;"VESSEL":GOSUB960:K5=1:GOSUB960:GOSUB1770
234 PRINT@340,K1$:GOSUB960:GOSUB640:GOSUB930:GOTO390
235 PRINT"HIT BY";H;"UNITS OF DESTRUCTIVE ENERGY"
240 A(6+J)=A(6+J)-H:IF A(6+J)<0,385 ELSE IF D<300 PRINT"MINOR DAMAGE - SHIELDS HOLDING":GOTO400:ELSE IFD<900 OR A(3+J)=0 OR (A(1+J)=0 AND A(2+J)=0),260 ELSE FOR C1=1TO3:A(C1+J)=0:NEXT:PRINT"WEAPONS' SYSTEM ";
245 IF A(5+J)=1 OR A(4+J)=1 PRINT "AND ";ELSE365
260 IF D<800 OR A(5+J)=0,280 ELSE A(5+J)=0:PRINT"WARP DRIVE";:GOTO365
280 IF D<700,300 ELSE IF A(3+J)=1 A(3+J)=0:IF J=0 PRINT"PHOTON TORPEDO TUBES";:GOTO 365:ELSE PRINT"PLASMA WEAPON";:GOTO365
290 IFRND(3)=1,320
300 IF D<500 OR A(4+J)=0,320 ELSE A(4+J)=0:PRINT"IMPULSE DRIVE";:GOTO365
320 IF D>399 AND A(1+J)=1,A(1+J)=0:PRINT"FORWARD";:GOTO360:ELSE IF A(2+J)=1 A(2+J)=0:PRINT"REAR ";:GOTO360:ELSE B3=B*2:IF B3<90 PRINT"FORWARD";ELSE IF B3<180 PRINT"STARBOARD";ELSE IF B3<270 PRINT"AFT";ELSE PRINT"PORT";
330 PRINT" SHIELDS ";:IF A(6+J)<400 PRINT"DEPLETED" ELSE IF A(6+J)<2000 PRINT" DISRUPTED" ELSE IF A(6+J)<3000 PRINT" BUCKLING" ELSE PRINT"LOSING PHASE"
340 D=0:GOTO 400
360 PRINT" PHASERS";
365 PRINT" DAMAGED":GOTO400
370 GOSUB900:PRINT@464,"DANGER ";B$;" SELF-DESTRUCTED":GOSUB9003:GOSUB910:GOSUB1450:Q=A(16):GOSUB140:K=1:IF A(6)-H<0 X=X-1
380 C=1:J=0:GOSUB11000:GOTO225
385 GOSUB910
390 GOSUB1450:CLS:PRINT@468," ";:IF J=0 PRINTA$;:X=X+1:ELSE PRINTB$;
395 PRINT"DESTROYED":GOSUB9008:GOSUB12000:GOTO30
397 REM
398 REM KLINGON RANGE & POSITION ROUTINE
400 IF F=1 F=0:GOSUB910:IF I=10 H=1425:RETURN:ELSE H=U:RETURN
405 T1=.5*(A(4)+A(14)+.05*(A(5)+A(15))):IF K=1 GOSUB900:GOTO30:ELSE R=ABS(R+T1*(RND(0)-.5)*L):B=INT(ABS(B-150+20*(RND(0)))):IF B>180 B=ABS(360-B)
410 IF J=0 I=0:GOTO50:ELSE I=10:J=10:GOTO80
498 REM
499 REM CONGRATULATIONS
500 PRINT@903,"AN EXCELLENT DISPLAY OF TACTICAL ABILITY CAPTAIN":PRINTTAB(14);"ANOTHER TURN AROUND THE OLD GALAXY ";:GOSUB8990:GOSUB8991:GOSUB8992:GOSUB8993
505 INPUTF$:IFF$="NO"ORF$="N",GOTO64000 ELSE A3=1:GOTO1510
508 REM
509 REM INSULTS
510 IS=RND(10):GOSUB9012:ON IS GOTO 515,520,525,530,535,540,545,550,555,560
515 PRINT@902,"WAS THAT EVER A DISPLAY OF TACTICAL POWERS - YUK!":GOTO565
520 PRINT@912,"ANOTHER BRILLIANT ROUND CAPTAIN":GOTO565
525 PRINT@905,"OH, NOW THAT WAS GOOOOOOOOOOOOOOOOOOOOOOOOD!":GOTO565
530 PRINT@908,"AH, LEADING WITH YOUR CHIN AGAIN I SEE":GOTO565
535 PRINT@900,"STARFLEET COMMAND FROWNS ON THOSE WHO BREAK THEIR SHIPS":GOTO565
540 PRINT@900,"IN THE IMMORTAL WORDS OF MR SPOCK 'BOY ARE YOU A TURKEY!'":GOTO565
545 PRINT@909,"HMMMM, CAPTAIN CRASH I PRESUME!!!!!!":GOTO565
550 PRINT@902,"A SPECIAL COMMUNIQUE FROM THE FEDERATION - N E R D!":GOTO565
555 PRINT@902,"ABSOLUTELY BRILLIANT  -  WITH YOU WHO NEEDS KLINGONS!":GOTO565
560 PRINT@900,"WONDERFUL, ANOTHER DAZZLING DISPLAY OF TACTICAL BRILLIANCE"
565 GOSUB9012:PRINTTAB(18);"WANT TO TRY AND SAVE FACE";:GOTO505
598 REM
599 REM KLINGON GRAPHICS
600 PRINT@152,K1$;:IFK4=1 RETURN ELSE GOSUB960
620 GOSUB9000:POKE15711,143:FORT=1TO5:NEXT:POKE15711,128:POKE15775,46:GOSUB970:POKE15775,128:POKE15839,129:GOSUB970:POKE15839,160:GOSUB970:POKE15839,128:POKE15903,148:GOSUB970:POKE15903,128
622 POKE15967,149:GOSUB970:POKE15967,128:POKE16031,189:GOSUB970:POKE16031,128
630 POKE16095,191:GOSUB970:POKE16095,128:POKE16159,191:POKE16223,131:GOSUB970:POKE16159,128:POKE16223,128:POKE16223,191:POKE16287,191:GOSUB970:POKE16223,128:POKE16287,128:GOSUB930:RETURN
640 POKE16351,191:GOSUB940:POKE16351,128:POKE16287,143:GOSUB940:POKE16287,128:POKE16223,141:GOSUB940:POKE16223,128:POKE16159,133:GOSUB940:POKE16159,128:POKE16095,132:GOSUB940:POKE16095,128:POKE16031,144:GOSUB940:POKE16031,128:POKE16031,130:GOSUB940
645 POKE16031,128:POKE15903,46:GOSUB940:POKE15903,128:POKE15839,46:GOSUB940:POKE15839,128:RETURN
650 CLS:B=1:C=128:FORT=1TO10:PRINT@RND(1022),".";:NEXT:POKE15839,46:GOSUB920
655 GOSUB9000:POKE15839,58:GOSUB940:POKE15839,46:GOSUB940:POKE15903,46:GOSUB940:POKE15903,C:POKE16031,130:GOSUB940:POKE16031,C:POKE16031,144:GOSUB940:POKE16031,C:POKE16095,132:GOSUB940:POKE16095,C
657 POKE16159,133:GOSUB940:POKE16159,C
660 POKE16223,141:GOSUB940:POKE16223,C:POKE16287,143:GOSUB940:POKE16287,C:POKE16351,191:GOSUB940:POKE16351,C:IFB=1 B=0:GOSUB920:GOSUB655 ELSE B3=1:GOTO1450
800 FORT=1TO100:NEXT:CLS:RETURN
900 FORT=1TO1000:NEXT:CLS:RETURN
905 FORT=1TO1000:NEXT:RETURN
910 FORT=1TO100:NEXT:RETURN
920 FORT=1TO100:NEXT:RETURN
930 RETURN
940 FORT=1TO10:NEXT:RETURN
950 FORT=1TO2:NEXT:RETURN
960 FOR T=1TO500:NEXT:RETURN
970 FORT=1TO25:NEXT:RETURN
1448 REM
1449 REM BOOM MAKER GRAPHICS
1450 GOSUB9100:CLS:GOSUB9005:PRINT@479,CHR$(140):PRINT@478,STRING$(3,140):PRINT@477,STRING$(5,140):PRINT@476,STRING$(7,140):PRINT@475,STRING$(9,140):PRINT@470,STRING$(19,140):PRINT@476,STRING$(7,191):PRINT:GOSUB9012
1452 PRINT@477,"B O O M":GOSUB950:CLS:PRINT@470,STRING$(19,140)
1455 PRINT@448,STRING$(63,140):GOSUB950:CLS:IF B3=1 B3=0:RETURN
1460 FORT=1TO15:PRINT@400+RND(200),".";:NEXTT:FORT=1TO400:PRINT@400+RND(200)," ";:NEXT:CLS:RETURN
1498 REM
1499 REM INTRODUCTION & SETUP
1500 ZZ=USR1(ZZ):ZZ=USR1(ZZ):CLS:PRINT@472,CHR$(23);"SPACE";:GOSUB9008:PRINTCHR$(23):PRINT@460,"THE FINAL FRONTIER";:GOSUB9009
1510 PRINT@31,".":GOSUB950:CLS:PRINTTAB(31);".":GOSUB950:CLS:PRINT@95,".":GOSUB950:CLS:PRINT@95,CHR$(144):GOSUB950:CLS:PRINT@159,CHR$(129):GOSUB950:CLS:PRINT@159,CHR$(132):GOSUB950:CLS:PRINT@159,CHR$(176):GOSUB950:CLS:PRINT@223,CHR$(131):GOSUB950:CLS
1515 PRINT@223,CHR$(140):GOSUB940:CLS:PRINT@222,STRING$(2,176):GOSUB950:CLS:PRINT@286,STRING$(2,131):GOSUB950:CLS:PRINT@286,STRING$(3,140):GOSUB950:CLS:PRINT@286,STRING$(3,176):GOSUB950:CLS:PRINT@347,STRING$(5,143):GOSUB950:CLS:PRINT@347,STRING$(11,188)
1520 GOSUB950:CLS:PRINT@346,STRING$(13,176):PRINT@410,STRING$(13,131):GOSUB950:CLS:PRINT@345,STRING$(15,188):GOSUB950:CLS:PRINT@408,STRING$(15,191):GOSUB950:CLS:PRINT@468,STRING$(23,191):PRINT@532,STRING$(23,191):PRINT@596,STRING$(23,191):GOSUB940
1550 CLS:Z=0:K7=0:PRINTCHR$(23);:PRINT@276,"STAR TREK";:GOSUB9006:PRINT@398,"ENCOUNTER IN THE";:PRINT@522,"NEAR THOLIAN SECTOR";:PRINT@646,"ENTER A STARDATE (XXXX)";:INPUTA:A=ABS(A):IFA<1000ORA>9999,A=9999
1555 IFA3=1THENCLS:GOTO20
1595 PRINTCHR$(28);:ZZ=USR8(ZZ):A3=1:QZ=USR5(QZ):FORZZ=1TO10:QZ=USR4(QZ):NEXTZZ
1600 PRINT@150,"A TREATY OF PEACE BETWEEN";:PRINT@214,"THE KLINGON EMPIRE AND THE";:PRINT@278,"FEDERATION OF PLANETS HAS";:PRINT@342,"LASTED SINCE ORGANIAN STAR";:PRINT@406,"DATE 3199.5  HOWEVER, WITH";:PRINT@470,"THE PASSING OF AYELBORNE,";
1610 PRINT@534,"THE KLINGONS HAVE OPENLY";:PRINT@598,"PROVOKED HOSTILITIES WITH";:PRINT@662,"FEDERATION SHIPPING, AND";:PRINT@726,"HAVE ILLEGALLY CONFISCATED";:PRINT@790,"A VAST AMOUNT OF CARGO. THE";:PRINT@854,"SPECTRE OF WAR AGAIN LOOMS";
1620 PRINT@918,"OVER THE ENTIRE GALAXY!";
1622 GOSUB8990:GOSUB8991:GOSUB8992:GOSUB8993:FORT=1TO1000
1623 FY$=INKEY$:IFFY$<>""THENT=1000
1624 NEXTT
1640 E$=STRING$(5,176)+STRING$(4,188)+STRING$(4,176)+CHR$(144)+CHR$(32)+STRING$(19,188)+CHR$(156)+STRING$(38,32)+CHR$(130)+CHR$(139)+CHR$(143)+CHR$(191)+CHR$(188)+CHR$(176)+CHR$(144)+STRING$(4,32)+CHR$(191)+CHR$(191)+STRING$(52,32)+CHR$(41)+CHR$(175)
1650 E$=E$+STRING$(13,191)+STRING$(4,143):A$="ENTERPRISE ":B$="KLINGON ":U=1000:L=U*U
1660 K$=CHR$(172)+STRING$(2,188)+STRING$(10,140)+STRING$(7,188)+STRING$(6,191)+STRING$(2,188)+STRING$(53,32)+CHR$(139)+STRING$(7,191)+CHR$(189)+CHR$(144)+STRING$(54,32)+CHR$(188)+CHR$(190)+STRING$(8,191)+STRING$(3,188)
1670 K1$=CHR$(160)+CHR$(184)+STRING$(5,143)+CHR$(191)+CHR$(159)+CHR$(143)+STRING$(4,143)+CHR$(180)+CHR$(144)+STRING$(48,32)+CHR$(191)+STRING$(6,32)+CHR$(171)+CHR$(129)+STRING$(6,32)+CHR$(191)+STRING$(54,32)+CHR$(138)+STRING$(2,143)
1750 ZZ=USR8(ZZ):QZ=USR5(QZ):FORZZ=1TO10:QZ=USR4(QZ):NEXTZZ:PRINT@0,"SHIP'S LOG :  STARDATE";A+.1:PRINT:PRINT"  THE ENTERPRISE IS IN DOCK AT STARBASE 12 FOR RESUPPLY AND CREWR & R. ";
1753 PRINT"MR. SPOCK AND LT. SULU ARE SUPERVISING REPAIR OF THE NAV-IGATION SENSORS";
1755 PRINT" WHILE LT. UHURA RUNS COMMUNICATION CHECKS WITH  THE STARBASE COMMO UNIT. CHIEF ENGINEER SCOTT AND MR CHEKOV ARE CONDUCTING A FIRING TEST OF THE FORWARD PHASER BANKS.";
1760 PRINT@468,E$;:GOSUB9008:GOSUB9009
1765 REM ENTERPRISE GRAPHICS
1770 PRINT@468,E$;:FORC=1TO3:GOSUB9011:GOSUB9000:PRINT@467,CHR$(188);:FORT=467TO448 STEP-1:PRINT@T,CHR$(95);:PRINT@T+1,CHR$(32);:NEXTT:PRINT@448," ";:GOSUB970:NEXTC:IFK5=1 K5=0:CLS:RETURN
1780 GOSUB905:ZZ=USR8(ZZ):QZ=USR5(QZ):FORZZ=1TO10:QZ=USR4(QZ):NEXTZZ:GOSUB11000:FORX=1TO3:PRINTCHR$(23):PRINT@218,"BEEP":GOSUB940:CLS:GOSUB9003:GOSUB950:NEXT:GOSUB920
1785 PRINT@450,CHR$(23);"CAPTAIN , WE'RE RECEIVING A":PRINTTAB(2);"MESSAGE FROM STARFLEET HQ":PRINTTAB(1);"I'LL PIPE IT TO YOUR VIEWER":GOSUB900
1800 CLS:X=10:GOSUB1810:X=23:GOSUB1810:X=9:GOSUB1810:PRINTA:PRINT:X=12:GOSUB1810:PRINT:X=499:GOSUB1810:X=12:GOSUB1810:GOSUB905:ZZ=USR7(ZZ):GOTO1820
1810 FORT1=1TOX:READM:PRINTCHR$(M);:IFM=32THENGOSUB8999
1815 NEXTT1:IFX=9,RETURNELSEPRINT:RETURN
1818 LPRINT:FORZZ=1TO20:ZY=CVI(QK):NEXTZZ
1820 CLS:PRINTTAB(22);"USS ENTERPRISE":PRINTTAB(19);STRING$(20,45):PRINT"CAPTAIN'S LOG";TAB(46);"STARDATE";A+.3:PRINT:PRINT" THE ENTERPRISE IS NOW ENROUTE TO THOLIAN SPACE TO RELIEVE THE  EMBATTLED FEDERATION COLONIES. ALL CREW MEMBERS ARE INTENSELY";
1825 PRINT"   REVIEWING THE COMPUTER BANKS ON KLINGON WEAPONRY IN PREPARATION FOR WHAT LIES AHEAD. A GLIMPSE OF THE LAST GARBLED MESSAGE FROM OUTPOST 7 IS ALL THAT IS NECESSARY TO REMIND US ALL OF THE      VICIOUSNESS OF THE ENEMY.":PRINT
1830 PRINTTAB(8);"LOG PAGE 2  COMPUTER BANK SCAN OF KLINGON WAR VESSEL":PRINTTAB(8);"LOG PAGE 3  LAST TRANSMISSION FROM OUTPOST 7":PRINTTAB(8);"LOG PAGE 4  ENTERPRISE CONTROL COMMANDS":PRINTTAB(8);"LOG PAGE 5  CLOSE LOG";
1835 F$=" ":F$=INKEY$:F=VAL(F$):IF F<2 OR F>5,1835 ELSEZZ=USR7(ZZ): IF F=3,1900 ELSE IF F=5,20 ELSE IF F =2,1840
1836 GOSUB9007:CLS:PRINT"

                ENTERPRISE CONTROL COMMANDS

                1 --->  FORWARD PHASERS
                2 --->  REAR PHASERS
                3 --->  PHOTON TORPEDOES
                4 --->  CLOSE IN ON ENEMY VESSEL
1837 PRINT"                5 --->  PULL AWAY FROM ENEMY VESSEL
                6 --->  STAND BY
                7 --->  TRANSFER ENERGY TO SHIELDS
                8 --->  RECHARGE WEAK DILITHIUM CRYSTALS
                9 --->  REPAIR
1838 FORT=1TO1000:NEXT:ZZ=USR5(ZZ):ZZ=USR7(ZZ):GOSUB9007:GOTO1820
1840 GOSUB9007:CLS:PRINTTAB(20);"KLINGON BATTLE CRUISER":PRINTTAB(15);"CIRCA  ORGANIAN STARDATE 3199.5":PRINTTAB(27);"TOP VIEW":PRINT:PRINTTAB(29);"/- - - - - - - - - TWIN FWD PHASERS";
1842 PRINTTAB(10);"BRIDGE  - - - - ";CHR$(94);TAB(31);CHR$(93);" - - - - - - - - - ";
1845 PRINT"PLASMA WEAPON":PRINT@770,"PORT ENGINE NACELLE ";CHR$(91);TAB(29);CHR$(91):PRINTTAB(29);CHR$(33):PRINTTAB(29);"IMPULSE ENGINES AND":PRINTTAB(29);"SINGLE REAR PHASER";
1849 PRINT@0,
1850 POKE15708,143:POKE15709,159:POKE15710,133:POKE15773,149:POKE15836,168:POKE15837,189:POKE15900,170:POKE15901,191:POKE15958,180:POKE15959,176:POKE15960,176:POKE15961,184:POKE15962,190:POKE15963,191:POKE15964,191:POKE15964,191:POKE15965,191:POKE15966,191
1855 POKE15967,191:POKE15968,188:POKE15969,180:POKE15970,176:POKE15971,176:POKE15972,184:POKE16022,159:FORT=16023TO16027:POKET,143:NEXT:POKET,191:POKE16029,191:POKE16030,191:FORT=16031TO16035:POKET,143:NEXT:POKET,175:POKE16086,133:POKE16100,138
1860 FORT=1TO2000:NEXT:GOSUB9007:ZZ=USR7(ZZ):K4=1:PRINTTAB(20);"KLINGON BATTLE CRUISER":PRINT@130,"BOW VIEW":PRINT@351,CHR$(91):PRINT@410,"BRIDGE":PRINT@473,"/":PRINT@535,"/":PRINT@597,"/":PRINT@642,"PORT VIEW"
1862 GOSUB600:K4=0:PRINT@660,K$;:PRINT@724,CHR$(91);
1865 PRINT@774,"FWD PHASER BANKS";:PRINT@838,"PLASMA WEAPON";:FORT=1TO1000:NEXT:GOSUB9007:ZZ=USR7(ZZ):GOTO1820
1900 GOSUB9010:CLS:PRINTTAB(2);"TRANSMISSION FROM OUTPOST 7   RECORDED ON";TAB(46);"STARDATE";A-12.4:PRINTSTRING$(63,45):PRINT:GOSUB910
1901 PRINT"OUTPOST 7 CALLING STARFLEET COMMAND ON PRIORITY CHANNEL 1":GOSUB910:GOSUB9010
1905 PRINT"STARFLEET COME IN";:GOSUB910:PRINT" . . STARFLEET DO YOU HEAR US . . ?":GOSUB910:GOSUB9010:PRINT"OUTPOST 7 CALLING STARFLEET COMMAND  -  ACKNOWLEDGE !":GOSUB910:GOSUB9010
1908 PRINT"STARFLEET - WE ARE UNDER HEAVY ATTACK . . . . ENEMY UNKNOWN !":GOSUB910:GOSUB9010
1910 PRINT"OUR TRANSMISSIONS ARE BEING JAMMED . . (CRACKLE) . . .":GOSUB9012:GOSUB910:PRINT". . LARGE . . . EXPLOSIONS . . . (CRACKLE) . . WE . . . WAIT !":GOSUB9005:GOSUB910
1912 GOSUB9010:PRINT"WE'RE RECEIVING A . . . . (CRACKLE) . .";:GOSUB9012:GOSUB910:PRINT" . . (CRACKLE) . . . .";:GOSUB9012
1915 GOSUB910:GOSUB910:PRINT". . WE CAN SEE SOMETHING ON THE MAIN SCREEN - STAND BY":GOSUB910:PRINT". . ( CRACKLE) . .";:GOSUB9012:GOSUB910:PRINT"MY GOD, THEY ARE KLINGONS !":GOSUB9005
1918 GOSUB910:PRINT"WE . . . CAN'T SUSTAIN ANOTHER DIRECT HIT !":GOSUB9012:GOSUB9005
1920 GOSUB910:PRINT"SWITCHING TO MAIN VIEWER ";:GOSUB910:PRINT". . . STARFLEET DO YOU COPY . . . ?":GOSUB910:PRINT". . . . . (CRACKLE) . . . .";:GOSUB9010:GOSUB900
1930 GOSUB9010:CLS:PRINTCHR$(23):GOSUB9011:PRINT@384,;TAB(10);"EARTHLINGS":GOSUB9003:PRINTTAB(2);"PREPARE TO MEET YOUR DOOM":GOSUB9011:PRINTTAB(1);"AT THE HANDS OF THE KLINGON"
1931 GOSUB9003:PRINTTAB(12);"EMPIRE":GOSUB9011:GOSUB910:GOSUB900:GOSUB600:GOSUB620:IFK3=1,K3=0:RETURN:ELSE GOSUB1450:GOSUB910
1935 PRINT@460,". . . . (CRACKLE) . .";:GOSUB9012:GOSUB9012:GOSUB910:PRINT" . . (CRACKLE) . . .":GOSUB9012:ZZ=USR7(ZZ):GOSUB900:PRINT@470,"END OF TRANSMISSION":GOSUB910:GOSUB9007:ZZ=USR7(ZZ):GOTO1820
2000 DATA67,79,77,77,85,78,73,81,85,69,70,82,79,77,32,83,84,65,82,70,76,69,69,84,32,67,79,77,77,65,78,68,32,83,84,65,82,68,65,84,69,32,65,76,69,82,84,32,83,84,65,84,85,83,75,76,73,78,71,79,78,32,66,65,84,84,76,69,32,67,82,85,73,83,69,82,83,32
2010 DATA72,65,86,69,32,66,69,69,78,32,67,79,78,68,85,67,84,73,78,71,32,83,79,82,84,73,69,83,32,65,67,82,79,83,83,32,84,72,69,32,78,69,85,84,82,65,76,32,90,79,78,69,32,65,71,65,73,78,83,84,32,70,69,68,69,82,65,84,73,79,78,32,79,85,84,80,79,83,84,32
2020 DATA67,79,76,79,78,73,69,83,32,65,76,79,78,71,32,84,72,69,32,84,72,79,32,45,76,73,65,78,32,65,78,68,32,71,79,84,72,79,83,73,65,78,32,83,69,67,84,79,82,83,46,32,79,85,84,80,79,83,84,83,32,55,32,65,78,68,32,56,32,72,65,86,69,32,66,69,69,78,32
2030 DATA68,69,83,84,82,79,89,69,68,65,83,32,87,69,76,76,32,65,83,32,70,69,68,69,82,65,84,73,79,78,32,83,84,65,82,83,72,73,80,83,32,86,65,76,73,65,78,84,32,65,78,68,32,67,79,78,83,84,69,76,76,65,84,73,79,78,46,32,89,79,85,82,32
2035 DATA77,73,83,83,73,79,78,32,73,83,32,84,79,32,73,77,77,69,68,73,65,84,69,76,89,32,76,69,65,86,69,32,83,84,65,82,66,65,83,69,32,49,50,32,65,78,68,32,77,65,75,69,32,70,79,82,32,84,72,69,32,79,85,84,80,79,83,84,32,65,83,84,69,82,79,73,68,83,32,65,78,68,32
2040 DATA80,65,84,82,79,76,32,84,72,69,32,78,69,65,82,32,84,72,79,76,73,65,78,32,83,69,67,84,79,82,46,32,89,79,85,32,65,82,69,32,84,79,10,69,78,71,65,71,69,32,65,78,68,32,68,69,83,84,82,79,89,32,84,72,69,32,75,76,73,78,71,79,78,32,82,65,73,68,73,78,71,32
2050 DATA80,65,82,84,73,69,83,32,79,80,69,82,65,84,73,78,71,32,73,78,32,84,72,65,84,83,69,67,84,79,82,46,32,70,65,73,76,85,82,69,32,87,73,76,76,32,77,69,65,78,32,84,72,69,32,76,79,83,83,32,79,70,32,84,72,69,32,70,69,68,69,82,65,84,73,79,78,46
2060 DATA32,32,71,79,79,68,32,76,85,67,75,33
5000 IFQR=21THENPRINT@422,B$;:RETURNELSEPRINT@422,A$;:RETURN
5030 PRINT@476,CQ$;:PRINT@540,CW$;:PRINT@384,"";:GOSUB9200:RETURN
8990 QA=0:QB=0:QC=0:QD=120:QF=188:GOSUB9014:QD=380:QF=105:GOSUB9014:QD=60:QF=111:GOSUB9014:QD=20:QF=125:GOSUB9014:QD=20:QF=140:GOSUB9014:QD=20:QF=149:GOSUB9014:QD=420:QF=158:GOTO9014
8991 QA=0:QB=0:QC=0:QD=120:QF=176:GOSUB9014:QD=220:QF=188:GOSUB9014:QD=300:QF=94:GOSUB9014:QD=60:QF=105:GOSUB9014:QD=20:QF=111:GOSUB9014:QD=20:QF=125:GOSUB9014:QD=20:QF=140:GOSUB9014:QD=460:QF=149:GOTO9014
8992 QA=0:QB=0:QC=0:QD=140:QF=158:GOSUB9014:QD=250:QF=168:GOSUB9014:QD=60:QF=149:GOSUB9014:QD=60:QF=131:GOSUB9014:QD=60:QF=125:GOSUB9014:QD=30:QF=111:GOSUB9014:QD=30:QF=105:GOSUB9014:QD=30:QF=111:GOSUB9014:QD=500:QF=94:GOTO9014
8993 QA=0:QB=0:QC=0:QD=520:QF=79:GOSUB9014:QD=60:QF=83:GOSUB9014:QD=190:QF=94:GOSUB9014:QD=320:QF=168:GOSUB9014:QD=150:QF=125:GOSUB9014:QD=520:QF=140:GOTO9014
8994 QA=8:QB=10:QC=150:QD=4:QF=750:GOTO9014
8995 QA=160:QB=5:QC=248:QD=8:QF=250:GOTO9014
8996 QA=152:QB=10:QC=248:QD=4:QF=350:GOTO9014
8997 QA=152:QB=10:QC=248:QD=1:QF=850:GOTO9014
8999 QA=0:QB=0:QC=0:QD=9:QF=15:GOTO9014
9000 QA=100:QB=2:QC=0:QD=5:QF=5:GOTO9014
9001 QA=30:QB=1:QC=0:QD=10:QF=15:GOTO9014
9002 QA=0:QB=0:QC=0:QD=5:GOTO9014
9003 QA=0:QB=0:QC=0:QD=15:QF=100:GOTO9014
9004 QA=25:QB=25:QC=0:QD=1:QF=25:GOTO9014
9005 QA=100:QB=35:QC=35:QD=5:QF=35:GOTO9014
9006 QA=45:QB=250:QC=250:QD=15:QF=35:GOTO9014
9007 FORZZ=1TO11:QA=0:QB=0:QC=0:QD=90:QF=5+RND(20):GOSUB9014:NEXTZZ:RETURN
9008 QA=0:QB=0:QC=0:QD=250:QF=188:GOSUB9014:QD=30:QF=140:GOSUB9014:QD=390:QF=105:GOTO9014:RETURN
9009 QA=0:QB=0:QC=0:QD=160:QF=111:GOSUB9014:QD=20:QF=140:GOSUB9014:QD=20:QF=168:GOSUB9014:QD=20:QF=125:GOSUB9014:QD=390:QF=94:GOSUB9014:RETURN
9010 QA=0:QB=0:QC=0:QD=80:QF=17:GOSUB9014:QD=80:QF=17:GOSUB9014:QD=160:QF=17:GOSUB9014:QD=120:QF=17:GOSUB9014:QD=40:QF=17:GOSUB9014:QD=40:QF=17:GOSUB9014:QD=40:QF=17:GOSUB9014:RETURN
9011 QA=0:QB=0:QC=0:QD=50:QF=30:GOTO9014
9012 QA=0:QB=0:QC=0:QD=20:QF=999:GOTO9014
9013 QA=150:QB=1:QC=0:QD=14:QF=30
9014 IFQC>0THENPOKE-1529,QC:REM TM=-1535
9015 POKE-1531,QA:QE=INT(QD/256):DD=QD-QE*256
9020 POKE-1530,QB:POKE-1533,DD:POKE-1532,QE
9021 QG=INT(QF/256):FF=QF-256*QG:POKE-1535,FF:POKE-1534,QG
9024 ZZ=USR3(ZZ):RETURN
9100 FORT=1TO4:ZZ=USR5(ZZ):NEXTT:RETURN
9200 IFQ=350THENFORZZ=1TO10:QZ=USR4(QZ):NEXTZZ:RETURN
9205 IFQ=150ANDB=0THENFORZZ=1TO10:QZ=USR6(QZ):NEXTZZ:RETURN
11000 LPRINT:FORZZ=223TO863STEP64:PRINT@ZZ," ";:NEXTZZ:PRINT@400,E$;:PRINT@590,"                           ";:FORZZ=384TO576STEP64:PRINT@ZZ,CHR$(149);:PRINT@ZZ+63,CHR$(170);:NEXTZZ:FORZZ=1TO70:ZY=CVI(QK):POKE15898,41:NEXTZZ:ZZ=USR7(ZZ):RETURN
11010 LPRINT:FORZZ=223TO863STEP64:PRINT@ZZ," ";:NEXTZZ:PRINT@543,"                    ";:PRINT@400,K$;:PRINT@590,"                        ";:FORZZ=384TO576STEP64:PRINT@ZZ,CHR$(149);:PRINT@ZZ+63,CHR$(170);:NEXTZZ:FORZZ=1TO70:ZY=CVI(QK):NEXTZZ:ZZ=USR7(ZZ):RETURN
12000 IFJ<>0THENGOTO11000ELSEGOTO11010
60000 ' *** WARP DRIVE ***
60020 CLS:POKE-17342,0:QF=600:PRINT@525,"WARP DRIVE ENGINES WARMING : POWER ALERT";:FORQI=0TO47:FY$=INKEY$:IFFY$<>""THENZT=0:OI=0:RETURN
60091 IFOI<1THENGOSUB62000:OI=1
60093 GOSUB63000:IFQI=34THENQJ=USR5(QJ):QJ=USR5(QJ):PRINT@468,"APPROACHING CRITICAL MASS";:PRINT@525," WARP ENGINES NEARLY WARM : POWER ALERT ";
60130 NEXTQI
60140 CLS:OI=0:PRINT@525,CHR$(23);"PREPARE TO WARP";:GOSUB8995:CLS
60150 FORZZ=1TO5:QJ=USR5(QJ):NEXT:QJ=USR(QJ):FORZZ=1TO5:QJ=USR5(QJ):NEXT
60160 ZZ=USR7(ZZ):PRINT@264,CHR$(23);"** WARP DRIVE SLOWING **";:GOSUB8996:ZZ=USR7(ZZ):PRINT@326,CHR$(23);"** SWITCHING TO IMPULSE **";:GOSUB8997:PRINTCHR$(28);:ZZ=USR7(ZZ):LPRINT:FORZZ=1TO20:ZY=EOF(1):NEXTZZ:ZZ=USR7(ZZ):RETURN
62000 PRINT@391,"COLD";:PRINT@436,"WARM";:FORZT=15495TO15544:POKEZT,140:NEXT:FORZT=15623TO15672:POKEZT,140:NEXT:FORZT=15687TO15735STEP12:POKEZT,170:NEXT:ZT=0:RETURN
63000 POKE15560+OI,191:GOSUB9002:QF=QF-10:OI=OI+1:RETURN
64000 ZZ=USR7(ZZ):PRINTCHR$(23);" 


YOU, CAPTAIN KIRK, ARE TRULY A
   COWARD! mAY YOU DIE AT THE
   HANDS OF OUR ENEMIES AND MAY
   IT BE A SLOW AND PAINFUL
 
        D E A T H !

                BONES
64100 GOSUB9005:FORX=1TO500:NEXTX:CMD"S"

