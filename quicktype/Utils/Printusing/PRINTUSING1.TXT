10 REM TEST THE ROUTINE
20 INPUT N:GOSUB31000:PRINTN$:GOTO20
30 NN=N:LD=2:DD=2:LD$=" ":GOSUB30000:PRINTNN$
40 GOTO20
29999 REM NN=#,LD=# SIZE, DD=DECIMAL SIZE, LD$=LEADING ZERO OR SPACE
30000 NN$=STR$(NN):NN$=RIGHT$(NN$,LEN(NN$)-1):FORTT=1TOLD:NN$=LD$+NN$:NEXT:DF=0
30010 LL=LEN(NN$):FORTT=1TOLL:IFMID$(NN$,TT,1)="."THENDF=TT:TT=LL
30020 NEXT:IFDF=0THENNN$=NN$+".0":DF=LL+1
30030 NN$=NN$+"0000000000":NN$=MID$(NN$,DF-LD,LD+1+DD):RETURN
31000 ON1-(N-INT(N)-0)GOTO31010:N$=STR$(INT(N))+MID$(STR$((N+.005)-INT(N))+"00",2,3):RETURN
31010 N$=STR$(N)+".00":RETURN
