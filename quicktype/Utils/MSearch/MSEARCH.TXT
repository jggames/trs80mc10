70 CLS0
80 FORX=0TO63:SET(X,0,1):SET(X,1,1):SET(X,31,1):SET(X,30,1):NEXT
90 FORY=0TO31:SET(0,Y,1):SET(63,Y,1):NEXT
200 P=32:Y=10:SET(P,Y,1):P(0)=P:K=1
210 IFPOINT(P+1,Y)=0THEN260
220 IFPOINT(P-1,Y)=0THEN260
230 IFPOINT(P,Y+2)=0THEN260
240 IFPOINT(P,Y-2)=0THEN260
250 GOTO350
260 ONRND(4)GOTO270,270,290,300
270 XX=0:YY=-1:GOTO310
280 XX=0:YY=1:GOTO310
290 XX=1:YY=0:GOTO310
300 YY=-1:XX=0
310 IFPOINT(P+XX,Y+YY)=1THEN260
320 SET(P+XX,(Y+YY)+YY,1):SET(P,((Y+YY)+YY)+1,1)
330 P=P+XX:Y=(Y+YY)+YY:P(K)=P:Y(K)=Y
340 GOTO210
350 K=K-1:P=P(K):Y=Y(K):RESET(P,Y):RESET(P,Y+1)
360 IFK=0THEN400
370 GOTO210
400 STOP
