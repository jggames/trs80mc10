REM http://alumni.cse.ucsc.edu/~dmackie/DEAN_Professional.html#Publications
0 CLS:CLEAR1200:DIMC1,C2:M=16384:C1=RND(-(PEEK(9)*256+PEEK(10))):GOSUB9000:GOTO10
1 C2=1:C1=32:FORC1=C1TOC2STEP-1:I$=MID$(M$,C1,1):IFI$<"!"THEN?MID$(M$,C2,C1-C2):C2=C1+1:C1=C2+32:IFI$=""THENC1=.
2 C1=C1+(C1>255)*(C1-255):NEXT:M$="":RETURN
3 FORC1=1TO250:NEXT:RETURN
10 DIMCL$(15),CL(15),FA$(12),CO$(3),CA$(5,3),S(5,15):GOSUB9100
30 FORX=1TO15:READDU$:CL$(X)=DU$:NEXT
50 DATAADAM,BETTY,CASSY,DENNIS,EDWIN,ROPE,ICE PICK,CLUB,PISTOL,KNIFE,KITCHEN,STUDY,BATHROOM,LOUNGE,BEDROOM
60 DATA1,11,22,165,180,1,10,22,165,180,1,13,22,165,180
70 FORX=1TO15:READCL(X):NEXT
130 FORX=1TO3:T=RND(5):IFX=1THENGU=T
150 FORY=1TO5:CA$(Y,X)=""
160 IFY=TTHENCO$(X)=CL$(X*5+Y-5):GOTO190
180 L=L+1:FA$(L)=CL$(X*5+Y-5)
190 NEXTY,X
210 FORZ=1TO12
220 X=RND(5):IFX=GUTHEN220
230 Y=RND(3)
240 IFCA$(X,Y)<>""THEN220
250 CA$(X,Y)=FA$(Z)
260 NEXT
265 Y1=RND(12):Y2=RND(12):Y3=RND(12):IFY1=Y2THEN265
267 Y3=RND(12):IFY3=Y1ORY3=Y2THEN267
270 CA$(GU,1)=FA$(Y1):CA$(GU,2)=FA$(Y2):CA$(GU,3)=FA$(Y3)
280 GOSUB9300
300 CLS0:PRINT@203,"GOOD LUCK!";:GOSUB9900
430 A(1)=RND(5)
440 A(2)=RND(5):IFA(2)=A(1)THEN440
450 A(3)=RND(5):IFA(3)=A(1)ORA(3)=A(2)THEN450
460 PRINT@67,"WHO DO YOU INTERROGATE?";
470 NP$(1)=CL$(A(1)):NP$(2)=CL$(A(2)):NP$(3)=CL$(A(3)):NP$(4)="":NP$(5)=""
480 NP(1)=1:NP(2)=12:NP(3)=22:NP(4)=0:NP(5)=0:MA=3:GOSUB8000
490 P=A(Q)
500 GOSUB9900:GOSUB9800:GOSUB9900
510 PRINT@67,"WHO DO YOU SUSPECT?";
520 FORI=1TO5:NP$(I)=CL$(I):NP(I)=CL(I):NEXT:S=0:W=0:R=0
530 MA=5:GOSUB8000:A$=CL$(Q):S=Q
540 GOSUB9900:GOSUB9800:GOSUB9900
550 PRINT@67,"...WITH WHICH WEAPON?";
560 FORI=1TO5:NP$(I)=CL$(5+I):NP(I)=CL(5+I):NEXT
570 MA=5:GOSUB8000:B$=CL$(5+Q):W=5+Q
580 GOSUB9900:GOSUB9800:GOSUB9900
600 PRINT@67,"...IN WHICH ROOM?";
610 FORI=1TO5:NP$(I)=CL$(10+I):NP(I)=CL(10+I):NEXT
620 MA=5:GOSUB8000:C$=CL$(10+Q):R=10+Q
630 GOSUB9900:GOSUB9800:GOSUB9900
640 PRINT@352,;:M$=A$+", WITH THE "+B$+", IN THE "+C$:GOSUB1:PRINT@416,;
645 GOSUB9700
650 FORX=1TO3:IFCA$(P,X)=A$THEN700
660 IFCA$(P,X)=B$THEN710
670 IFCA$(P,X)=C$THEN720
680 NEXTX
685 M$=CL$(P)+" DOESN'T KNOW ANYTHING THAT WOULD HELP YOU.":GOSUB1
690 S(P,S)=127:S(P,W)=127:S(P,R)=127:GOTO730
700 M$=CL$(P)+" KNOWS THAT "+CA$(P,X)+" DID NOT DO IT.":GOSUB1:S(P,S)=88:GOTO730
710 M$=CL$(P)+" KNOWS THAT THE "+CA$(P,X)+" WAS NOT THE MURDER WEAPON.":S(P,W)=88:GOSUB1:GOTO730
720 M$=CL$(P)+" KNOWS THAT THE "+CA$(P,X)+" WAS NOT THE PLACE.":S(P,R)=88:GOSUB1
730 PRINT@65,"ARE YOU READY TO ACCUSE (Y/N)?";
731 PRINT@135,"PRESS <H> FOR HELP";
735 A$=INKEY$:IFA$=""THEN735
740 IFA$="Y"THEN800
741 IFA$="H"THENGOSUB9000:GOSUB9200:GOSUB9998:GOTO735
750 PRINT@64,LEFT$(M2$,32);:PRINT@128,LEFT$(M2$,32);:GOSUB9900
780 CLS0:GOSUB9900:GOTO430
800 CLS0:GOSUB9900:GOSUB9800:GOSUB9900:PRINT@67,"WHO DO YOU ACCUSE?";
805 FORI=1TO5:NP$(I)=CL$(I):NP(I)=CL(I):NEXT
810 MA=5:GOSUB8000:A$=CL$(Q)
815 GOSUB9900:GOSUB9800:GOSUB9900
820 PRINT@67,"...WITH WHICH WEAPON?";
825 FORI=1TO5:NP$(I)=CL$(5+I):NP(I)=CL(5+I):NEXT
830 MA=5:GOSUB8000:B$=CL$(Q+5)
835 GOSUB9900:GOSUB9800:GOSUB9900
840 PRINT@67,"...IN WHICH ROOM?";
845 FORI=1TO5:NP$(I)=CL$(10+I):NP(I)=CL(10+I):NEXT
850 MA=5:GOSUB8000"C$=CL$(Q+10)
855 GOSUB9900:GOSUB9800:GOSUB9900
860 IFA$<>CO$(1)THEN1000
870 IFB$<>CO$(2)THEN1000
880 IFC$<>CO$(3)THEN1000
900 PRINT@352,;:M$="CONGRATULATIONS, INSPECTOR! YOU HAVE SOLVED ANOTHER MYSTERY!":GOSUB1
910 M$="IT WAS "+A$+" IN THE "+C$+" WITH THE "+B$+".":GOSUB1
920 PRINT@263,"TRY ANOTHER (Y/N)?";
930 A$=INKEY$:IFA$="Y"THENRUN
940 IFA$="N"THENEND
950 GOTO930
1000 PRINT@352,;:M$="SORRY, YOU ARE WRONG AND OUT OF THE GAME.":GOSUB1
1005 M$="IT WAS NOT "+A$+" IN THE "+C$+" WITH THE "+B$+".":GOSUB1
1010 GOSUB9900:GOTO430

8000 Q=1:NP(0)=NP(4)-6
8010 PRINT@96+NP(Q2),LEFT$(M2$,204);:PRINT@96+NP(Q),MG$;:Q2=Q
8020 FORI=1TO5:PRINT@161+NP(I),NP$(I);:NEXTI
8030 Z$=INKEY$:Z=Z+1:IFZ=100THENNZ=1:GOSUB9900
8040 IFZ$=""THEN8030
8050 IFZ$="S"THENQ=Q+1:IFQ>MATHENQ=MA
8055 IFZ$="A"THENQ=Q-1:IFQ<1THENQ=1
8060 IFZ$=CHR$(13)THENRETURN
8070 Z=0:GOTO8010

9000 REM TITLE PAGE
9005 CLS4
9010 PRINT"¿¿¿¿¿¿…a…B…c…D…eµ¾½¼¾¿½¼½¼¿¼½¼½¿";
9015 PRINT"adam€€€€€€€€€€€€µºººº¿µ´·µµ´¿´·¿";
9020 PRINT"BETTY……………µº¿º»¼·µµ´·´½µµ¿";
9025 PRINT"cassy€€€€€€€€€€€µ¿¿¿¿¾½¾¿½¼½¿¿¿¿";
9030 PRINT"DENNIS……………µ¿¿¿¿µºº¶µ´¿¿¿¿¿";
9035 PRINT"edwin€€€€€€€€€€€µ¿¿¿¿¶¹º¿µ´½¿¿¿¿";
9040 PRINT"ROPE……………µ¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿";
9045 PRINT"icepick€€€€€€€€€µ¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿";
9050 PRINT"CLUB……………µ¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿";
9055 PRINT"pistol€€€€€€€€€€µ¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿";
9060 PRINT"KNIFE……………µ¿¿¿¿¿¿¿¿¿¿¿¿¿¿¿";
9065 PRINT"kitchen€€€€€€€€€µ¿º¼¼¼¼¼¼¼¸½¿¿¿¿";
9070 PRINT"STUDY ……………µ¿¿€€²²³³³³¿¿¿¿¿";
9075 PRINT"bath€€€€€€€€€€€€µ¿¿€€¼·¿¿¿¿¿¿¿¿¿";
9080 PRINT"LOUNGE……………µ¿¿€€µ¿¿¿¿¿¿¿¿¿¿";
9090 PRINT"bedroom€€€€€€€€€µ¿¿³³¿¿¿¿¿¿¿¿¿¿";:RETURN

9100 X1=54:Y1=23
9110 FORY=Y1TOY1-12-RND(3)STEP-1:FORX=1TORND(2)+1
9120 IFX1+X<64THENSET(X1+X,Y,6)
9130 FORC1=1TO150:NEXT:NEXT:X1=X1+RND(3)-1:NEXT
9155 GOSUB9700:RETURN

9200 FORC1=1TO15STEP2:X=0:FORC2=7TO15STEP2:X=X+1:IFS(X,C1)THENPOKEM+32*C1+C2,S(X,C1)-64
9201 NEXT:NEXT
9210 FORC1=2TO14STEP2:X=0:FORC2=7TO15STEP2:X=X+1:IFS(X,C1)THENPOKEM+32*C1+C2,S(X,C1)
9211 NEXT:NEXT:RETURN

9300 FORI=1TO7:FORJ=1TO8:READA:MG$=MG$+CHR$(192+A):NEXTJ
9310 FORJ=1TO24:MG$=MG$+CHR$(128):NEXTJ,I
9315 MG$=LEFT$(MG$,LEN(MG$)-20)
9320 FORJ=1TO224:M2$=M2$+CHR$(128):NEXT
9500 RETURN

9700 SOUND113,8:SOUND129,4:SOUND135,4:GOSUB3:SOUND113,4:GOSUB3:SOUND161,2:SOUND155,8:RETURN

9800 PRINT@32,M2$;M2$;
9810 RETURN

9900 FORX=0TO31:POKEM+X,134+16*(RND(8)-1):POKEM+X+480,134+16*(RND(8)-1):NEXT:RETURN

9998 PRINT@7*32+18,"ARE YOU READY";:PRINT@8*32+18,"     TO      ";:PRINT@9*32+18,"ACCUSE (Y/N)?";:RETURN

10000 DATA0,1,6,12,12,9,2,0,0,10,0,0,0,0,5,0,5,0,0,0,0,0,0,10,0,10,0,0,0,0,5,0
10100 DATA0,4,9,3,3,6,8,0,0,0,0,10,5,0,0,0,0,0,0,11,7,0,0,0
