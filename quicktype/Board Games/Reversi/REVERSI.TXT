10 CLS
20 PRINT:PRINT:PRINT:PRINT" *********  REVERSI  **********"
105 DIMA(100):DIMB(100):DIMC(100):DIMD(8):DIME(100)
110 I=RND(1000)
171 D(1)=1:D(2)=11:D(3)=10:D(4)=9:D(5)=-1:D(6)=-11:D(7)=-10:D(8)=-9
185 GOSUB 9000
200 GOSUB 8000
205 IF Q<5 THEN 295
215 GOSUB 1300
220 IF T=1 THEN 295
225 T3=T3+1
226 IF T3<2 THEN 254
228 PRINT "THE GAME IS OVER":FOR I=1TO10:SOUND 100,1:SOUND200,1:NEXTI
229 N=0:J=0
231 FOR Z=12 TO 89
232 IF B(Z)=-1 THEN 239
234 IF B(Z)<>1 THEN 244
235 J=J+1
237 GOTO 244
239 N=N+1
244 NEXT Z
245 PRINT"BLUE HAS";N;", WHITE HAS";J;":PRINT"PIECES."
248 PRINT "DO YOU WANT TO PLAY AGAIN?      (0=NO, 1=YES)";
250 INPUT T
251 RESTORE
252 IF T=1 THEN 185
253 GOTO 9998
254 PRINT
255 IF P=1 THEN 260
256 PRINT "BLUE HAS NO PLAY, LOSES TURN."
258 GOTO 950
260 PRINT "WHITE HAS NO PLAY, LOSES TURN."
270 GOTO 950
295 GOSUB 1100
380 IF M<>1 THEN 500
390 IF Q>4 THEN 430
402 M=45
403 IF B(M)=2 THEN 540
404 M=M+1
405 GOTO 403
430 GOSUB 3000
500 IF M<1 THEN 800
510 IF M>100 THEN 800
520 IF Q>4 THEN 600
530 IF B(M)<>2 THEN 800
540 B(M)=P
550 GOTO 830
600 GOSUB 1400
640 IF T<>0 THEN 950
800 PRINT "ILLEGAL PLAY"
805 SOUND 5,20
810 FOR I=0TO2000:NEXTI
820 GOTO 200
830 Q=Q+1
950 P=-P
955 IF E(M)<>64 THEN 200
960 GOSUB 5000
970 GOTO 200
1100 PRINT
1101 PRINT"IF YOU WANT THE COMPUTER TO PLAYENTER 0,0"
1115 IF P=1 THEN 1140
1120 PRINT CHR$(175);" BLUE";
1130 GOTO 1145
1140 PRINT CHR$(207);" WHITE";
1145 PRINT "'S TURN, ENTER X,Y";
1150 INPUT X,Y
1155 SOUND 150,2
1160 M=X+1+10*Y
1170 RETURN
1300 T=1
1301 PRINT "CHECKING";
1302 M=1
1310 IF U<4 THEN 1318
1316 U=0
1317 SOUND 100,1:PRINT".";
1318 U=U+1
1320 IF B(M)<>0 THEN 1390
1330 N=1
1340 J=D(N)
1350 IF B(M+J)<>-P THEN 1385
1370 K=M+J+J
1380 IF B(K)=3 THEN 1385
1381 IF B(K)=0 THEN 1385
1382 IF B(K)=P THEN 1394
1383 K=K+J
1384 GOTO 1380
1385 N=N+1
1386 IF N<9 THEN 1340
1390 M=M+1
1391 IF M<90 THEN 1310
1392 T=0
1394 RETURN
1400 T=0
1410 IF B(M)=0 THEN 1430
1420 RETURN
1430 N=1
1440 J=D(N)
1444 IF B(M+J)<>-P THEN 1700
1470 K=M+J+J
1480 IF B(K)=3 THEN 1700
1490 IF B(K)=0 THEN 1700
1500 IF B(K)=P THEN 1530
1510 K=K+J
1515 GOTO 1480
1530 T=1
1531 L=M
1532 IF L=K THEN 1700
1533 LETB(L)=P
1534 L=L+J
1535 GOTO 1532
1700 N=N+1
1705 IF N<9 THEN 1440
1710 RETURN
3000 PRINT "THINKING";
3680 F=9999
3690 FOR Z=12 TO 89
3700 C(Z)=B(Z)
3710 NEXT Z
3750 M=12
3752 IF U<4 THEN 3759
3753 U=0
3754 SOUND 200,1
3755 PRINT".";
3759 U=U+1
3770 GOSUB 1400
3780 IF T=0 THEN 3860
3790 GOSUB 3900
3800 IF H>F THEN 3840
3802 IF H<F THEN 3810
3804 Z=RND(0)
3806 IF Z>.7 THEN 3840
3810 F=H
3820 W=V
3840 FOR Z = 12 TO 89
3850 B(Z)=C(Z)
3855 NEXT Z
3860 M=M+1
3865 IF M<90 THEN 3752
3870 M=W
3875 PRINT
3880 RETURN
3900 H=-99999
3920 FOR Z = 12 TO 89
3925 A(Z)=B(Z)
3930 NEXT Z
3935 P=-P
3940 V=M
3950 M=12
3970 GOSUB 1400
3980 IF T=0 THEN 4080
3990 GOSUB 4130
4000 IF G<F THEN 4030
4016 H=G
4020 GOTO 4100
4030 IF G<H THEN 4050
4040 H=G
4050 FOR Z=12 TO 89
4060 B(Z)=A(Z)
4070 NEXT Z
4080 M=M+1
4090 IF M<90 THEN 3970
4100 M=V
4105 P=-P
4110 RETURN
4130 G=0
4140 Z=12
4150 IF B(Z)=P THEN 4190
4160 IF B(Z)=0 THEN 4300
4170 G=G-E(Z)
4180 GOTO 4300
4190 G=G+E(Z)
4200 IF G>F THEN 4500
4300 Z=Z+1
4400 IF Z<90 THEN 4150
4500 RETURN
5000 IF M<>12 THEN 5100
5010 E(18)=5:E(28)=5:E(29)=5
5100 IF M<>19 THEN 5200
5200 IF M<>82 THEN 5300
5210 E(72)=5:E(73)=5:E(83)=5
5300 IF M<>89 THEN 5400
5310 E(77)=5:E(78)=5:E(88)=5
5400 RETURN
8000 CLS:PRINT"     1  2  3  4  5  6  7  8"
8200 FOR Y=8 TO 1 STEP -1
8300 PRINTY;" ";
8400 FOR X=1TO8
8500 IF B(X+1+Y*10)=1 THEN 8700
8550 IF B(X+1+Y*10)=-1 THEN 8900
8600 PRINTCHR$(128);CHR$(131);CHR$(128);
8650 GOTO 8990
8700 PRINTCHR$(128);CHR$(195);CHR$(128);
8800 GOTO 8990
8900 PRINTCHR$(128);CHR$(163);CHR$(128);
8990 NEXT X
8995 PRINT Y
8996 NEXT Y
8997 PRINT"    ";:FORT=1TO24:PRINTCHR$(131);:NEXT:PRINT:SOUND 200,2
8998 RETURN
9000 FOR N=11 TO 90
9050 READ E(N)
9060 NEXT N
9066 FOR N=1 TO 100
9068 B(N)=0
9070 NEXT N
9074 FOR N=1 TO 10
9076 B(N)=3
9078 B(90+N)=3
9080 B(10*N-9)=3
9082 B(10*N)=3
9085 NEXT N
9087 B(45)=2:B(46)=2:B(55)=2:B(56)=2
9172 U=5:Q=1:P=-1
9191 RETURN
9220 DATA 0,64,-30,10,5,5,10,-30,64,0
9222 DATA 0,-30,-40,2,2,2,2,-40,-30,0
9224 DATA 0,10,2,5,1,1,5,2,10,0
9226 DATA 0,5,2,1,1,1,1,2,5,0
9228 DATA 0,5,2,1,1,1,1,2,5,0
9230 DATA 0,10,2,5,1,1,5,2,10,0
9234 DATA 0,-30,-40,2,2,2,2,-40,-30,0
9236 DATA 0,64,-30,10,5,5,10,-30,64,0
9998 STOP
9999 END
