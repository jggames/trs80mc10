100 CLEAR 100: CLS: DEFINT A -Z: RANDOM: SH 0:
ST = O 110 PRINT ®463, "PLEASE ENTER YOUR NAME ";: INPUT NS
120 DIM A(8), B(99), D(4), E(12), M(12)
130 DIM PV(12,12), Q(12), V(12). Z(12)
140 D(1) = - 10: D(2) = -1: D(3) = 1: D(4) = 10
ISO A(l) = 10: A(2) = -10: A(4) _ -1: A(8) = 1: CLS
160 PRINT 0461, "TRS.80 PLAYING STRENGTH (1 TO 5) " :: INPUT Y 170 DM = 2'Y: FOR I = 11 T088: BU) = RND(9): NEXT I 180 FOR I = O TO 10: B(1) = 99: NEXT I: FOR I = 89 TO 99:
B(I) = 99: NEXT 190 FOR I = 19 TO 79 STEP 10: BUI = 99 &1 + U = 99:
NEXT I 220 CLS: FOR I = 11 TO 88: IF B(I) = 99 THEN 240
230 X$ = RIGHTS (SIRS (B(I),l): GOSUB 1000
240 NEXT I: PRINT((t22, "TREASURE SEARCH "; Y: 250 PRINT®256, NS :: PRINT ®448, "TRS.8O " :: YS = STRINGS (12, " ")
260 T= 54:TS =" :H = 4S:HS = "X ": ZS = STRINGS (32, " ")
270 I = T: XS = TS: GOSUB 1000: B(T) = 99: B(H) = 99
280 I = H: XS = HS: GOSUB 1000: GOTO 300
290 PRINT 01788, "ILLEGAL MOVE. TRY AGAIN ";:
FOR I = 1 TO 999: NEXT 1 300 PRINT ®788, ZS :: PRINT @788, "WHICH DIRECTION FOR
X";
310 IF INKEYS = "" THEN 310 ELSE R = PEEK(16444)
320 R = INT(R/8): I = H + A(R)
330 IF B(J) = 99 THEN 290 ELSE PRINT0788, ZS;
360 I = H: B(1) = 0: XS = " - ": GOSUB 1000: SH = SH + BO;
370 H J: B(H) = 99: I = H: XS HS: GOSUB 1000
380 PRINT 0321, 5H:: IF SH > 99 THEN 93D
510 DT = DM
520 L= 1:SC.0:S = -1
530 V(0) -99: V(I) -99: M(0) T: M(I) H 540 L =L +1:O(L) =aS = -S: V(L) = V(L- 2)
580 0(L) Q(L) + I: IF O(L) > 4 THEN 760
590 M(L - 2) + D(O(L))
600 IF B(1) = 99 THEN 580 ELSE M(L) = 1: E(L) = BU)
610 1)(1) = 99: B(M(L - 2)) =O :SC =SC +5'E(L)
620 PRINT ®179 + 64 ' L. I; SC: V(L); " ";: IF L < DT THEN
540
670 V(L +1)= -S' SC
680 B(M(L)) = E(L): B(M(L - 2)) = 9a SC = SC - S E(L)
700 IF V(L) < - V(L + 1) THEN V(L) = -V(L + I) ELSE 580
740 F L = 2 THEN BM = M(L): PRINT 0180, BM; V(2);
750 IF V(L) < - V(L - 1) THEN 580
760 L = L - I: S = -S: PRINT @243 + 64 ' L, YS :: IF L > 1 THEN 660
800 I T: B(I) = 0: XS = " -": GOSUB 1000: PRINT @179, YS:
810 T BM: ST= ST +B(T):1(T)99:1T:XS =TS
820 GOSUB 1000: PRINT 0513, ST ;: IF ST < 100 THEN 300
910 PRINT 0915, "THANK YOU FOR A PLEASANT GAME";
920 GOTO 920
930 PRINT ®917, "CONGRATULATIONS, YOU WIN ";:
GOTO 920
1000 R = INT (I/10): C = I - 10'R:K= 141 +(8 -R)' 64+ C'4
1010 PRINTOK, XS :: RETURN


550 1 = Z(L): I = 0
560 I = I + 1: IF J = M(L - 2) + D(I) THEN 600 ELSE IF I < 4 THEN 560
590 1 = M(L - 2) + D(O(L)): IF J Z(L) THEN 580
710 IF L > 2 THEN Z(L) = M(L)


500 FOR I = 4 TO DM: Z(I - 2) = PV(2,I): NEXT I 510 IF PV(2,3) = H THEN DT = DM ELSE DT = 2
720 I = L: PV(L,I) = M(L): IF L = DT THEN 740
730 I = I + 1: PV(L,I) = PV(L + 1,I): IF I < DT THEN 730
780 IF DT = DM THEN 800
790 FOR I = 2 TO DT: Z(I) = PV(2,I): NEXT I: DT = DT + 2:
GOTO 520 
