0 DIMC1,C2,C3,M,M$:M=16384:GOTO10
7 C1=(PEEK(17024)AND1)*256+PEEK(17025)-1+M:FORC2=1TOLEN(M$):C3=ASC(MID$(M$,C2)):POKEC1+C2,C3+64*(C3>63):NEXT:?@C1-M+C2,:RETURN

10 GOSUB530:GOTO280
20 H=0:K=0:FORA=7TO35:GOSUB60:NEXT
30 GOSUB170:IFH<1THEN250 
40 H=0:K=0:A=T:GOSUB60:IFH<1THEN250
50 GOTO30
60 IFB(A)=0ORB(A)=-SORB(A)=2THENRETURN
70 FORB=0TOD(A-7):C=A+M(B):IFB(C)=SORB(C)=2THEN160
80 IFB(C)THEN120
90 SC=RND(0)*.9:IFH<SCTHENH=SC:F=A:T=C
100 IFCK=1ANDT1=CTHENL=1:B=7
110 GOTO160
120 IFB(C+M(B))THEN160
130 SC=1+RND(0)*.9:IFH<SCTHENH=SC:F=A:T=C+M(B):K=C
140 IFCK=0THEN160
150 IFT1=C+M(B)THENL=1:K1=C:B=7
160 NEXT:RETURN
170 B(T)=B(F):B(F)=0:A=F:GOSUB760
180 IFKTHENB(K)=0:A=K:GOSUB760
190 A=T:GOTO760
200 GOSUB520:IFS=1THENM$="THE WITCHES WIN!":GOSUB7:GOTO220
210 M$="THE GHOSTS WIN!":GOSUB7 
220 PRINT@502,;:M$="HIT A KEY":GOSUB7
230 K$=INKEY$:IFK$=""THEN230
240 RUN
250 S=-S:H=0:A=7
260 IFA=36THEN200
270 GOSUB60:IFH=0THENA=A+1:GOTO260
280 D=0:GOSUB 520:IFS=1THENM$="GHOST'S TURN":GOSUB7:PRINT"";:GOTO300
290 M$="WITCH'S TURN":GOSUB7:PRINT"";
300 M$="FROM: ":GOSUB7
310 E=RND(0):K$=INKEY$:IFK$=""THEN310
320 IFASC(K$)=13THENGOSUB520:GOTO20 
330 IFASC(K$)+32<97ORASC(K$)+32>121THEN310
340 M$=K$:GOSUB7:A=N(ASC(K$)-65):Z=A
350 PRINT@504,;:M$="TO: ":GOSUB7 
360 K$=INKEY$:IFK$=""THEN360
370 IFASC(K$)+32<97ORASC(K$)+32>121THEN360
380 M$=K$:GOSUB7:T1=N(ASC(K$)-65) 
390 CK=1:L=0:K1=0:GOSUB60:CK=0
400 H=0:A=7
410 IFA=36THEN440
420 GOSUB60:IFH>=1THEN440 
430 A=A+1:IFA<36THEN420
440 IFDTHEN470 
450 IFLTHEN480
460 SOUND99,5:GOTO280
470 IFL=0ORK1=0THENSOUND99,5:GOTO510
480 IFK1=0ANDH>=1THEN460
490 F=Z:T=T1:K=K1:GOSUB170:IFK1=0THEN250
500 A=T:Z=A:H=0:GOSUB60:IFH<1THEN250
510 GOSUB520:D=1:GOTO350
520 PRINT@480,"";:POKEM+511,128:PRINT@480,;:RETURN
530 CLS0:DIMC,W
540 DIMB(42),D(28),N(28),XL(35),YL(35),L(35),V(35),W(35)
560 CLS0:PRINT@128,;:GOSUB2000:PRINT@12*32+8,;:M$="THE WITCHING HOUR":GOSUB7
570 FORC1=1TO4000:NEXT:CLS0:GOSUB1000

650 S=-1:FORA=0TO7:READM(A):NEXT
660 FORA=0TO28:READD(A):NEXT
670 B=48:C=32:D=59:E=12
680 FORA=0TO4:FORF=0TO4:H=6*A+F+7
690 L(H)=G+97:N(G)=H:READV(H),W(H):G=G+1:XL(H)=6*F:YL(H)=3*A:NEXT:NEXT
700 CLS0
730 FORA=0TO42:READB(A):GOSUB760:NEXT:RETURN
740 RETURN
760 IFB(A)=2THENRETURN
770 IFB(A)<0THENPRINT@XL(A)+YL(A)*32,W1$;:PRINT@XL(A)+YL(A)*32+32,W2$;:PRINT@XL(A)+YL(A)*32+64,W3$;
780 IFB(A)=0THENPRINT@XL(A)+YL(A)*32,B1$;:PRINT@XL(A)+YL(A)*32+32,B2$;:PRINT@XL(A)+YL(A)*32+64,B3$;
790 IFB(A)>0THENPRINT@XL(A)+YL(A)*32,G1$;:PRINT@XL(A)+YL(A)*32+32,G2$;:PRINT@XL(A)+YL(A)*32+64,G3$;
800 PRINT@XL(A)+(YL(A)+2)*32,CHR$(L(A));
810 PRINT@XL(A)+YL(A)*32,;:M$=CHR$(V(A)):GOSUB7:PRINT@XL(A)+YL(A)*32+5,;:M$=CHR$(W(A)):GOSUB7:RETURN

900 DATA -6,1,6,-1,-5,7,5,-7 
910 DATA 7,3,7,3,7,0,3,7,3,7,3,0
920 DATA 7,3,7,3,7,0,3,7,3,7,3,0,7,3,7,3,7

921 DATA 192,192,192,192,192,192,192,192,192,192
922 DATA 192,192,92,192,47,192,92,192,47,192
923 DATA 192,192,47,192,92,192,47,192,92,192
924 DATA 192,192,92,192,47,192,92,192,47,192
925 DATA 192,192,47,192,92,192,47,192,92,192

930 DATA 2,2,2,2,2,2,2,-1,-1,-1,-1,-1,2
940 DATA -1,-1,-1,-1,-1,2,-1,-1,0,1,1,2 
950 DATA 1,1,1,1,1,2,1,1,1,1,1,2,2,2,2,2,2,2 

1000 W1$=""
1001 W2$=""
1002 W3$=""

1010 G1$=""
1011 G2$=""
1012 G3$=""

1020 B1$=""
1021 B2$=""
1022 B3$="":RETURN

2000 PRINT"";
2001 PRINT"";
2002 PRINT"";
2003 PRINT"";
2004 PRINT"򀀀";
2005 PRINT"ܯ؀";:RETURN
3000 REM FROM COMPUTE!
3010 REM OCTOBER 1985
3020 REM BRIAN FLYNN
3030 REM MC-10 EDITS BY
3040 REM JIM GERRIE
