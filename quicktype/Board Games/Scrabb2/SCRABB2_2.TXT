10 DEFINTI-N
20 DIMIV(740),IB(441),IS(225),IL(26),KT(6,4),KF(6)
25 DIMKM(6,2),KW(6,3),NB(6,225)
27 CLS:INPUT"FAST OR SLOW";Z$:FA=0:IFZ$="FAST"THENFA=1
30 FORJ=1TO66:IB(J)=-1:IB(J+375)=-1:NEXT
35 FORJ=64TO358STEP21:FORJ1=0TO2:IB(J+J1)=-1:NEXT
40 FORJ1=18TO20:IB(J+J1)=-1:NEXTJ1,J
50 FORJ=1TO6:FORJ1=1TO4:READKT(J,J1):NEXTJ1,J
55 DATA-3,-2,-1,1,-2,-1,1,2,-1,1,2,3
57 DATA-63,-42,-21,21,-42,-21,21,42,-21,21,42,63
60 FORJ=1TO6:READKF(J):NEXT
65 DATA8,12,24,28,14,56
80 FORJ=1TO6:FORJ1=1TO2:READKM(J,J1):NEXTJ1,J
85 DATA-2,-1,-1,1,1,2,-42,-21,-21,21,21,42
90 FORJ=1TO3:FORJ1=1TO3:READKW(J,J1):KW(J+3,J1)=KW(J,J1):NEXTJ1,J
92 DATA729,27,1,729,1,27,27,1,729
100 FORJ=1TO443:READIV(J):NEXT:FORJ=444TO740:READJ1:IV(J)=J1+10000:NEXT
102 DATA28,31,32,35,36,40,41,45,46,47,51,52,55,59,79,113
104 DATA123,143,147,148,149,153,159,163,204,217,221,225,231
106 DATA247,249,257,258,262,263,271,285,298,325,333,339,352
108 DATA356,360,372,376,379,393,399,409,411,413,419,423,424
110 DATA429,433,437,441,491,522,528,549,555,583,586,587,626,636
112 DATA657,680,784,808,815,830,841,863,911,919,923,933,946,976
114 DATA984,985,986,990,992,1054,1055,1058,1065,1069,1081,1089
116 DATA1101,1108,1111,1112,1116,1127,1132,1166,1181,1226,1228
118 DATA1235,1250,1253,1258,1261,1274,1307,1324,1328,1351
120 DATA1362,1364,1382,1409,1423,1446,1486,1489,1493,1499
122 DATA1503,1505,1510,1597,1598,1605,1607,1613,1618,1703
124 DATA1705,1708,1715,1720,1721,1864,1870,1878,1883,1806
126 DATA1887,1888,1945,2032,2038,2043,2044,2044,2138,2216 
128 DATA2218,2227,2228,2230,2232,2234,2239,2327,241­2,2594
130 DATA2596,2599,2606,2607,2608,2611,2612,2616,2618,2698
132 DATA2756,2758,2759,2772,2774,2945,2950,2954,2959,2966
134 DATA2968,3056,3065,3073,3074,3076,3164,3166,3172,3173
136 DATA3175,3324,3326,3328,3333,3335,3339,3427,3485,3486
138 DATA3488,3497,3498,3499,3596,3690,3692,3693,3701,3747
140 DATA3761,3792,3813,3827,3841,3849,3947,3973,3980,3981
142 DATA4001,4017,4027,4064,4086,4132,4138,4145,4149,4186
144 DATA4193,4271,4325,4405,4408,4415,4419,4420,4421,4425
146 DATA4513,4514,4523,4529,4530,4532,4534,4535,4619,4621
148 DATA4622,4624,4631,4635,4637,4641,4643,4723,4781,4784
150 DATA4786,4787,4793,4795,4797,4803,4804,4875,4885,4943
152 DATA4955,4959,5132,5134,5135,5137,5142,5146,5148,5149
154 DATA5155,5242,5243,5251,5258,5263,5348,5350,5351,5353
156 DATA5160,5162,5502,5509,5510,5512,5523,5528,5684,5690
158 DATA5695,5794,5863,5864,5866,5869,5872,5878,5879,5882
160 DATA5884,5980,5985,5987,5990,5991,6079,6080,6091,6094
162 DATA6095,6239,6241,6242,6244,6246,6252,6253,6257,6260
164 DATA6262,6401,6404,6407,6412,6419,6647,6896,6897,6928
166 DATA6950,6980,7058,7087,7120,7319,7324,7330,7333,7335
168 DATA7340,7342,7430,7445,7446,7448,7535,7540,7697,7700
170 DATA7702,7715,7718,7720,7864,7876,7877,8048,8051,8065
172 DATA8071,8155,8160,8168,8170,8178,8179,8266,8278,8282
174 DATA8440,8442,8443,8777,8778,8791,8793,8794,8798,8799
176 DATA8800,8884,8887,8888,8903,8904,8905,8907,8995,8996
178 DATA9007,9011,9155,9160,9168,9169,9173,9176,9177,9328
180 DATA9339,9508,9509,9511,9518,9520,9522,9523,9524,9527
182 DATA9529,9624,9632,9708,9722,9724,9727,9738,9744,9883
184 DATA9884,9894,9895,9896,9897,9902,9905,48,58,64,235,238
186 DATA240,249,258,343,361,364,451,461,465,469,473,613,615
188 DATA618,619,624,626,631,634,754,775,793,968,973,980,982
190 DATA998,1047,1048,1103,1166,1187,1190,1233,1263,1318,1360
192 DATA1372,1422,1423,1426,1441,1453,1511,1520,1522,1530,1561
194 DATA1568,1670,1695,1703,1704,1705,1707,1709,1710,1711,1714
196 DATA1715,1716,1800,1804,1806,1813,1817,1819,1889,1912,1914
198 DATA1921,1923,1927,1928,1931,2013,2073,2078,2085,2089,2093
200 DATA2165,2175,2186,2233,2238,2245,2247,2249,2250,2251,2344
202 DATA2363,2961,2965,2975,3153,3156,3159,3162,3163,3165,3169,3173
204 DATA3174,3261,3263,3266,3270,3273,3279,3281,3367,3372,3378
206 DATA3379,3381,3529,3547,3694,3703,3709,3802,3880,3881,3882
208 DATA3885,3890,3894,3898,3901,3902,3903,3987,3989,3991,4000
210 DATA4006,4009,4010,4096,4108,4112,4114,4118,4157,4173,4258
212 DATA4260,4268,4270,4272,4276,4277,4279,4280,4281,4284,4308
214 DATA4420,4431,4432,4434,4540,4609,4612,4614,4620,4621,4623
216 DATA4625,4627,4628,4631,4716,4720,4722,4729,4801,4811,4826
218 DATA4828,4835,4837,4839,4843,4989,4990,4998,4999,5000,5001
220 DATA5003,5005,5008,5010,5091,5149,5154,5161,5163,5171,5202
222 DATA5216,5432,5506,5572,5676,5760,5809,6079,6084,6085,6086
224 DATA6087,6088,6178,6193,6197,6282,6286,6295,6300,6448,6457
226 DATA6467,6612,6796,6798,6799,6801,6810,6812,6813,6814,6818
228 DATA6819,6904,6907,6916,6984,6998,7008,7024,7029,7036,7177
230 DATA7186,7187,7188,7192,7278,7447,8263,8265,8268,8275,8361
232 DATA8374,8376,8379,8380,8383,8482,8484,8634,8644,8651,8653
234 DATA8803,8997,9005,9093,9094,9213,9360,9374
236 DATA9999,9999,9999,9999,9999,9999,9999,9999
238 DATA9999,9999,9999,9999,9999,9999,9999
300 FORJ=1TO225:READIS(J):NEXT
302 DATA4,0,0,1,0,0,0,4,0,0,0,1,0,0,4
304 DATA0,3,0,0,0,2,0,0,0,2,0,0,0,3,0
306 DATA0,0,3,0,0,0,1,0,1,0,0,0,3,0,0
308 DATA1,0,0,3,0,0,0,1,0,0,0,3,0,0,1
310 DATA0,0,0,0,3,0,0,0,0,0,3,0,0,0,0
312 DATA0,2,0,0,0,2,0,0,0,2,0,0,0,2,0
314 DATA0,0,1,0,0,0,1,0,1,0,0,0,1,0,0
316 DATA4,0,0,1,0,0,0,3,0,0,0,1,0,0,4
318 DATA0,0,1,0,0,0,1,0,1,0,0,0,1,0,0
320 DATA0,2,0,0,0,2,0,0,0,2,0,0,0,2,0
322 DATA0,0,0,0,3,0,0,0,0,0,3,0,0,0,0
324 DATA1,0,0,3,0,0,0,1,0,0,0,3,0,0,1
326 DATA0,0,3,0,0,0,1,0,1,0,0,0,3,0,0
328 DATA0,3,0,0,0,2,0,0,0,2,0,0,0,3,0
330 DATA4,0,0,1,0,0,0,4,0,0,0,1,0,0,4
340 FORJ=1TO26:READIL(J):NEXT
342 DATA1,3,3,2,1,4,2,4,1,8,5,1,3
344 DATA1,1,3,10,1,1,1,1,4,4,8,4,10
350 CLS:REM PRINT MOD
380 GOSUB9000:GOTO400
390 PRINT@878,"ILLEGAL MOVE";:PRINT@942,"            ":FORJ1=1TO1000:NEXT
400 PRINT@878,"MOVE FROM,TO";:PRINT@942,"            ";
410 PRINT@942," ";:INPUTJ1,J2:IFPEEK(15423)<>191THENGOSUB9000
415 IFJ1=-99THENGOSUB9800
416 IFJ1=-99THEN400
417 IFJ1>=0THEN420
418 PRINT"GAME ENDED FREE MEMORY EQUALS";MEM:END
420 IFJ1=0THEN500
425 IFJ1>J2THEN400
430 IS=1:PRINT@878,"WHAT WORD   ";:PRINT@942,"          ";
440 PRINT@942," ";:INPUTIW$:IFPEEK(15423)<>191THENGOSUB9000
450 J8=1:IFJ2>J1+10THEN480
452 J3=LEN(IW$):J4=J2-J1+1:IFJ3<>J4THEN390
454 J3=1:FORJ=J1TOJ2STEPJ8:J5=INT((J-1)/15):J6=J-(15*J5):J7=N+(21*J5)+J6
455 J5=15357+(64*J5)+(3*­J6)
456 POKEJ5,32:POKEJ5+2,32
458 W$=MID$(IW$,J3,1):J3=J3+1:J6=ASC(W$):POKEJ5+1,J6
460 IB(J7)=J6-64:NEXT
470 GOTO400
480 J8=15:J3=LEN(IW$):J4=INT((J2-J1)/15)+1:IFJ3<>J4THEN390
485 GOTO454
490 PRINT@878,"ILLEGAL 7  ";:PRINT@942,"LETTER MAX ";
492 FORJ=1TO1000:NEXT
500 PRINT@878,"TRS LETTERS ";:PRINT@942,"            ":PRINT@942," ";:INPUTIW$
510 J=LEN(IW$):IFJ>7THEN490
515 PRINT@110,TIME$;
520 FORJ1=1TOJ:W$=MID$(IW$,J1,1):L(J1)=ASC(W$)-64:NEXT
535 J1=0:FORJ2=1TO6
540 J3=L(J2):J4=L(J2+1):IFIL(J3)>=IL(J4)THEN550
545 J1=J4:L(J2+1)=J3:L(J2)=J4
550 NEXT:IFJ1>0THEN535
552 IFIS>0THEN600
553 IS=1
555 FORJ1=1TOJ:FORJ2=1TOJ:FORJ3=1TOJ
560 IFJ1=J2ORJ1=J3ORJ2=J3THEN590
565 IW=(729*L(J1))+(L(J2)*27)+L(J3)
567 GOSUB9100:IFIW=0THEN590
570 FORJ4=15826TO15834:POKEJ4,32:NEXT
572 POKE15827,L(J1)+64:POKE15830,L(J2)+64:POKE15833,L(J3)+64
574 IB(220)=L(J1):IB(221)=L(J2):IB(222)=L(J3)
575 PRINT@238,TIME$;
576 PRINT@622,"LAST MOVE TRS 80";:PRINT@686,"SPELT  ";CHR$(L(J1)+64);CHR$(L(J2)+64);CHR$(L(J3)+64);:GOTO400
590 NEXTJ3,J2,J1:PRINT@878,"TRS 80 WANTS";:PRINT@942,"NEW LETTERS";:FORJ1=1TO2000:NEXT:GOTO400
600 IFJ>1THEN700
610 FORI1=67TO361STEP21:FORI2=0TO14:I=I1+I2:IFIB(I)=0THEN690
615 IFIB(I-2)>0ORIB(I-1)>0ORIB(I+1)>0THEN690
620 IFIB(I-20)>0ORIB(I+20)>0THEN690
625 IW=(L(1)*27)+IB(I):GOSUB9100:IFIW=0THEN690
630 IB(I-1)=L(1):L9=I-1:GOSUB9700
636 L1=INT((L9-1)/15):L9=L9-(15*L1)
638 J=15358+(3*L9)+(64*L1):POKEJ,L(1)+64:POKEJ+1,32
639 PRINT@238,TIME$;
640 PRINT@622,"LAST MOVE TRS 80";:Z$=CHR$(L(1)+64)+CHR$(IB(I)+64)
642 PRINT@686,"SPELT   ";Z$;:GOTO400
690 NEXTI2,I1:PRINT@622,"TRS 80 DOES NOT  ";:PRINT@686,"MAKE A MOVE";
695 I2=14:NEXTI2:I1=361:NEXTI1:GOTO400
700 REM CHECK BOARD
705 L0=0
710 FORI1=67TO361STEP21:FORI2=0TO14:I=I1+I2:IFIB(I)=0THEN900
720 I0=(INT((I1-67)/21)*15)+I2+1
730 J3=IB(I)
735 REM CHECK SIX POSSIBLE MOVES
740 FORK=1TO6:IFNB(K,I0)>0THEN875
750 GOSUB9300:IFIW=0THEN875
755 K2=21:IFK>3THENK2=1
760 REM CHECK FOR CONFLICTS
770 FORJ1=1TOJ:FORJ2=1TOJ:IFJ1=J2THEN850
780 IW=(L(J1)*KW(K,1))+(L(J2)*KW(K,2))+(J3*KW(K,3))
790 GOSUB9100:IFIW=0THEN850
800 M2=I+KM(K,1):M4=L(J1):GOSUB9400
810 IFIW=0THEN850
820 M5=K7:M6=K8:M1=M2:M3=M4
830 M2=I+KM(K,2):M4=L(J2):GOSUB9400
840 IFIW=0THEN850
845 M7=K7:M8=K8:GOSUB9600
850 NEXTJ2,J1
855 IFFA=0THEN875
869 IFL0>0THEN950
875 NEXTK
900 NEXTI2,I1
910 IFL0>0THEN950
920 PRINT@878,"TRS 80 WANTS";:PRINT@942,"NEW LETTERS";:FORJ=1TO2500:NEXT:GOTO400
950 IB(L1)=L3:IB(L2)=L4
952 IFL6>3THENL6=L6-3
954 ONL6GOTO955,956,957
955 Z$=CHR$(L3+64)+CHR$(L4+64)+CHR$(L5+64):GOTO958
956 Z$=CHR$(L3+­64)+CHR$(L5+64)+CHR$(L4+64):GOTO958
957 Z$=CHR$(L5+64)+CHR$(L3+64)+CHR$(L4+64)
958 PRINT@622,"LAST MOVE TRS 80";:PRINT@686,"SPELT ";Z$::PRINT@238,TIME$;"    ";
959 PRINT@750,L0;" POINTS";
960 L9=L1:GOSUB9700:L1=INT((L9-1)/15):L9=L9-(15*L1)
962 J=15358+(3*L9)+(64*L1):POKEJ,L3+64:POKEJ+1,32
964 L9=L2:GOSUB9700:L2=INT((L9-1)/15):L9=L9-(15*L2)
966 J=15358+(3*L9)+(64*L2):POKEJ,L4+64:POKEJ+1,32
968 GOTO400
9000 CLS:N=66:FORN1=0TO14:N2=N+(21*N1):N3=15*N1
9020 FORN5=1TO15:N6=IB(N2+N5):IFN6>0THEN9050
9030 N6=(N1*15)+N5:N7=INT(N6/100):N6=N6-(100*N7)
9040 PRINT USING"###";N6;:GOTO9060
9050 PRINT" ";CHR$(64+N6);" ";
9060 NEXT:IFN1=1THENPOKE15423,191
9065 IFN1<>14THENPRINT""
9068 NEXT:RETURN
9100 FORN=20TO740STEP20
9105 IFIW=IV(N)THEN9250
9110 IFIW<IV(N)THEN9200
9115 NEXT:GOTO9275
9200 N=N-19
9205 N1=N+18
9210 FOR N2=N TO N1:IFIW=IV(N2)THEN9250
9220 NEXT:GOTO9275
9250 IW=1:N=66:RETURN
9275 IW=0:N=66:RETURN
9300 REM SEE IF BOARD IS OFEN FOR TYPE OF MOVE
9310 K9=I+KT(K,2):IFIB(K9)<>0THEN9350
9320 K9=I+KT(K,3):IFIB(K9)<>0THEN9350
9325 K9=I+KT(K,1):IFIB(K9)>0THEN9350
9330 K9=I+KT(K,4):IFIB(K9)>0THEN9350
9340 IW=1:RETURN
9350 IW=0:NB(K,I0)=1:RETURN
9400 REM CHECK CROSS WORDS
9405 K3=M2-K2-K2-K2:K4=M2+K2+K2+K2:K6=-1:K7=0
9410 FORK5=K3TOK4STEPK2:K6=K6+1:IFIB(K5)<1ANDK5<M2THEN9415
9412 IFIB(K5)<1ANDK5>M2THEN9440
9414 GOTO9420
9415 K7=0:GOTO9430
9420 K7=K7+(2[K6)
9430 NEXT
9440 FORK5=1TO6:IFK7=KF(K5)THEN9460
9450 NEXT:NB(K,I0)=1:IW=0:RETURN
9460 ON K5 GOTO9470,9480,9510,9540,9560,9580
9470 K7=0:K8=0:IW=1:RETURN
9480 K7=IB(M2-K2):IW=(27*K7)+M4:GOSUB9100
9490 K8=0:RETURN
9510 K7=IB(M2+K2):IW=K7+(27*M4):GOSUB9100
9520 K8=0:RETURN
9540 K7=IB(M2-K2):K8=IB(M2+K2):IW=(729*K7)+(27*M4)+K8
9550 GOSUB9100:RETURN
9560 K7=IB(M2-K2-K2):K8=IB(M2-K2)
9570 IW=(729*K7)+(27*K8)+M4:GOSUB9100:RETURN
9580 K7=IB(M2+K2):K8=IB(M2+K2+K2)
9590 IW=(729*M4)+(27*K7)+K8:GOSUB9100:RETURN
9600 L9=M1:GOSUB9700:N2=1:N4=1:GOSUB9750:N1=N2:N3=N4
9610 L9=M2:GOSUB9700:N2=1:N4=1:GOSUB9750:N1=IL(M3)*N1:N2=IL(M4)*N2
9620 L8=0:IFM5+M6=0THEN9640
9630 L8=(IL(M5)+IL(M6)+N1)*N3
9640 IFM7+M8=0THEN9660
9650 L8=L8+(IL(M7)+IL(M8)+N2)*N4
9660 L8=L8+((IL(J3)+N1+N2)*(N3*N4))
9680 IFL8>L0THEN9690
9685 RETURN
9690 L6=K:L5=J3:L0=L8:L1=M1:L2=M2:L3=M3:L4=M4:RETURN
9700 L9=L9-64:L8=INT(L9/21):L9=L9-(L8*21):L9=(15*L8)+L9-2
9710 RETURN
9750 L9=IS(L9):IFL9=0THENRETURN
9760 ONL9GOTO9762,9764,9766,9768
9762 N2=2:RETURN
9764 N2=3:RETURN
9766 N4=2:RETURN
9768 N4=3:RETURN
9800 L=15360:FORL1=0TO14:L4=64*L1:FORL2=0TO63:LPRINTCHR$(PEEK(L+L4+L2));
9810 NEXT:LPRINT" ":NEXT:RETURN
