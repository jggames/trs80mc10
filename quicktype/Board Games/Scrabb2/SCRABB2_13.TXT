0 CLEAR2100:DIMV(740),B(441),I(26),T(6,4),F(6),M(6,2),W(6,3),B$(6),L(7):GOSUB6000:GOTO27
8 FORZZ=1TO2500:NEXT:RETURN
9 M$="":M$=LEFT$(B$(K),I0-1)+"1"+MID$(B$(K),I0+1):B$(K)=M$:RETURN
27 CLS:INPUT"FAST OR SLOW";Z$:FA=0:IFZ$="FAST"THENFA=1
30 FORJ=1TO66:B(J)=-1:B(J+375)=-1:NEXT:FORJ=64TO358STEP21:FORJ1=0TO2:B(J+J1)=-1:NEXT
40 FORJ1=18TO20:B(J+J1)=-1:NEXTJ1,J:FORJ=1TO6:FORJ1=1TO4:READT(J,J1):NEXTJ1,J
55 DATA-3,-2,-1,1,-2,-1,1,2,-1,1,2,3,-63,-42,-21,21,-42,-21,21,42,-21,21,42,63
60 FORJ=1TO6:READF(J):NEXT:DATA8,12,24,28,14,56
80 FORJ=1TO6:FORJ1=1TO2:READM(J,J1):NEXTJ1,J:FORJ=1TO3:FORJ1=1TO3:READW(J,J1):W(J+3,J1)=W(J,J1):NEXTJ1,J
85 DATA-2,-1,-1,1,1,2,-42,-21,-21,21,21,42,729,27,1,729,1,27,27,1,729
100 FORJ=1TO443:READV(J):NEXT:FORJ=444TO740:READJ1:V(J)=J1+10000:NEXT
102 DATA28,31,32,35,36,40,41,45,46,47,51,52,55,59,79,113
104 DATA123,143,147,148,149,153,159,163,204,217,221,225,231
106 DATA247,249,257,258,262,263,271,285,298,325,333,339,352
108 DATA356,360,372,376,379,393,399,409,411,413,419,423,424
110 DATA429,433,437,441,491,522,528,549,555,583,586,587,626,636
112 DATA657,680,784,808,815,830,841,863,911,919,923,933,946,976
114 DATA984,985,986,990,992,1054,1055,1058,1065,1069,1081,1089
116 DATA1101,1108,1111,1112,1116,1127,1132,1166,1181,1226,1228
118 DATA1235,1250,1253,1258,1261,1274,1307,1324,1328,1351
120 DATA1362,1364,1382,1409,1423,1446,1486,1489,1493,1499
122 DATA1503,1505,1510,1597,1598,1605,1607,1613,1618,1703
124 DATA1705,1708,1715,1720,1721,1864,1870,1878,1883,1806
126 DATA1887,1888,1945,2032,2038,2043,2044,2044,2138,2216 
128 DATA2218,2227,2228,2230,2232,2234,2239,2327,2412,2594
130 DATA2596,2599,2606,2607,2608,2611,2612,2616,2618,2698
132 DATA2756,2758,2759,2772,2774,2945,2950,2954,2959,2966
134 DATA2968,3056,3065,3073,3074,3076,3164,3166,3172,3173
136 DATA3175,3324,3326,3328,3333,3335,3339,3427,3485,3486
138 DATA3488,3497,3498,3499,3596,3690,3692,3693,3701,3747
140 DATA3761,3792,3813,3827,3841,3849,3947,3973,3980,3981
142 DATA4001,4017,4027,4064,4086,4132,4138,4145,4149,4186
144 DATA4193,4271,4325,4405,4408,4415,4419,4420,4421,4425
146 DATA4513,4514,4523,4529,4530,4532,4534,4535,4619,4621
148 DATA4622,4624,4631,4635,4637,4641,4643,4723,4781,4784
150 DATA4786,4787,4793,4795,4797,4803,4804,4875,4885,4943
152 DATA4955,4959,5132,5134,5135,5137,5142,5146,5148,5149
154 DATA5155,5242,5243,5251,5258,5263,5348,5350,5351,5353
156 DATA5160,5162,5502,5509,5510,5512,5523,5528,5684,5690
158 DATA5695,5794,5863,5864,5866,5869,5872,5878,5879,5882
160 DATA5884,5980,5985,5987,5990,5991,6079,6080,6091,6094
162 DATA6095,6239,6241,6242,6244,6246,6252,6253,6257,6260
164 DATA6262,6401,6404,6407,6412,6419,6647,6896,6897,6928
166 DATA6950,6980,7058,7087,7120,7319,7324,7330,7333,7335
168 DATA7340,7342,7430,7445,7446,7448,7535,7540,7697,7700
170 DATA7702,7715,7718,7720,7864,7876,7877,8048,8051,8065
172 DATA8071,8155,8160,8168,8170,8178,8179,8266,8278,8282
174 DATA8440,8442,8443,8777,8778,8791,8793,8794,8798,8799
176 DATA8800,8884,8887,8888,8903,8904,8905,8907,8995,8996
178 DATA9007,9011,9155,9160,9168,9169,9173,9176,9177,9328
180 DATA9339,9508,9509,9511,9518,9520,9522,9523,9524,9527
182 DATA9529,9624,9632,9708,9722,9724,9727,9738,9744,9883
184 DATA9884,9894,9895,9896,9897,9902,9905,48,58,64,235,238
186 DATA240,249,258,343,361,364,451,461,465,469,473,613,615
188 DATA618,619,624,626,631,634,754,775,793,968,973,980,982
190 DATA998,1047,1048,1103,1166,1187,1190,1233,1263,1318,1360
192 DATA1372,1422,1423,1426,1441,1453,1511,1520,1522,1530,1561
194 DATA1568,1670,1695,1703,1704,1705,1707,1709,1710,1711,1714
196 DATA1715,1716,1800,1804,1806,1813,1817,1819,1889,1912,1914
198 DATA1921,1923,1927,1928,1931,2013,2073,2078,2085,2089,2093
200 DATA2165,2175,2186,2233,2238,2245,2247,2249,2250,2251,2344
202 DATA2363,2961,2965,2975,3153,3156,3159,3162,3163,3165,3169,3173
204 DATA3174,3261,3263,3266,3270,3273,3279,3281,3367,3372,3378
206 DATA3379,3381,3529,3547,3694,3703,3709,3802,3880,3881,3882
208 DATA3885,3890,3894,3898,3901,3902,3903,3987,3989,3991,4000
210 DATA4006,4009,4010,4096,4108,4112,4114,4118,4157,4173,4258
212 DATA4260,4268,4270,4272,4276,4277,4279,4280,4281,4284,4308
214 DATA4420,4431,4432,4434,4540,4609,4612,4614,4620,4621,4623
216 DATA4625,4627,4628,4631,4716,4720,4722,4729,4801,4811,4826
218 DATA4828,4835,4837,4839,4843,4989,4990,4998,4999,5000,5001
220 DATA5003,5005,5008,5010,5091,5149,5154,5161,5163,5171,5202
222 DATA5216,5432,5506,5572,5676,5760,5809,6079,6084,6085,6086
224 DATA6087,6088,6178,6193,6197,6282,6286,6295,6300,6448,6457
226 DATA6467,6612,6796,6798,6799,6801,6810,6812,6813,6814,6818
228 DATA6819,6904,6907,6916,6984,6998,7008,7024,7029,7036,7177
230 DATA7186,7187,7188,7192,7278,7447,8263,8265,8268,8275,8361
232 DATA8374,8376,8379,8380,8383,8482,8484,8634,8644,8651,8653
234 DATA8803,8997,9005,9093,9094,9213,9360,9374
236 DATA9999,9999,9999,9999,9999,9999,9999,9999
238 DATA9999,9999,9999,9999,9999,9999,9999
340 FORJ=1TO26:READI(J):NEXT
342 DATA1,3,3,2,1,4,2,4,1,8,5,1,3
344 DATA1,1,3,10,1,1,1,1,4,4,8,4,10
350 CLS
380 GOSUB9000:GOTO400
390 PRINT@432,"ILLEGAL MOVE":PRINT@464,"":GOSUB8
400 PRINT@464,"":PRINT@432,"MOVE FROM?":GOSUB8100:J1=ZZ:IFJ1>0THENPRINT@432,"TO?":GOSUB8110:J2=ZZ
410 IFPEEK(16415)<>32THENGOSUB9000
417 IFJ1>=0THEN420
418 PRINT@432,"QUIT?":M$=INKEY$:IFM$=""THEN418
419 ON-(M$<>"Y")GOTO400:END
420 IFJ1=.THEN500
425 IFJ1>J2THEN400
430 IS=1:PRINT@432,"WHAT WORD":PRINT@464,"":PRINT@464,;:INPUTIW$:IFPEEK(16415)<>32THENGOSUB9000
450 J8=1:IFJ2>J1+10THEN480
452 J3=LEN(IW$):J4=J2-J1+1:IFJ3<>J4THEN390
454 J3=1:FORJ=J1TOJ2STEPJ8:J5=INT((J-1)/15):J6=J-(15*J5):J7=N+(21*J5)+J6:J5=16382+32*J5+J6:
460 W$=MID$(IW$,J3,1):J3=J3+1:J6=ASC(W$):POKEJ5+1,J6-64:B(J7)=J6-64:NEXT:GOTO400
480 J8=15:J3=LEN(IW$):J4=INT((J2-J1)/15)+1:IFJ3<>J4THEN390
485 GOTO454
490 PRINT@432,"ILLEGAL 7":PRINT@464,"LETTER MAX":GOSUB8
500 PRINT@432,"MC-10 LETTERS":PRINT@464,"":PRINT@464,;:INPUTIW$:IFIW$=""THEN400
510 J=LEN(IW$):IFJ>7THEN490
520 FORJ1=1TOJ:W$=MID$(IW$,J1,1):L(J1)=ASC(W$)-64:NEXT
535 J1=0:FORJ2=1TO6:J3=L(J2):J4=L(J2+1):IFI(J3)>=I(J4)THEN550
545 J1=J4:L(J2+1)=J3:L(J2)=J4
550 NEXT:IFJ1>0THEN535
552 IFIS>.THEN600
553 IS=1:FORJ1=1TOJ:FORJ2=1TOJ:FORJ3=1TOJ:IFJ1=J2ORJ1=J3ORJ2=J3THEN590
565 IW=(729*L(J1))+(L(J2)*27)+L(J3):GOSUB9100:IFIW=0THEN590
572 POKE16614,L(J1):POKE16615,L(J2):POKE16616,L(J3)
574 B(220)=L(J1):B(221)=L(J2):B(222)=L(J3)
576 PRINT@272,"LAST MOVE MC-10";:PRINT@304,"SPELT "CHR$(L(J1)+64)CHR$(L(J2)+64)CHR$(L(J3)+64):GOTO400
590 NEXTJ3,J2,J1:PRINT@432,"MC-10 WANTS":PRINT@464,"NEW LETTERS":GOSUB8:GOTO400
600 IFJ>1THEN700

601 PRINT@0,"*1";
610 FORI1=67TO361STEP21:FORI2=0TO14:I=I1+I2:IFB(I)=0THEN690
615 IFB(I-2)>0ORB(I-1)>0ORB(I+1)>0THEN690
620 IFB(I-20)>0ORB(I+20)>0THEN690
625 IW=(L(1)*27)+B(I):GOSUB9100:IFIW=0THEN690
626 PRINT@3,"*2";

630 B(I-1)=L(1):L9=I-1:GOSUB9700
636 L1=INT((L9-1)/15):L9=L9-(15*L1)
638 J=16383+L9+32*L1:POKEJ,L(1)
640 PRINT@272,"LAST MOVE MC-10";:Z$=CHR$(L(1)+64)+CHR$(B(I)+64):PRINT@304,"SPELT "Z$:GOTO400
690 NEXTI2,I1:PRINT@432,"MC-10 DOES NOT":PRINT@464,"MAKE A MOVE":GOSUB8:GOTO400
700 L0=0:FORI1=67TO361STEP21:FORI2=0TO14:I=I1+I2:IFB(I)=0THEN900
720 I0=(INT((I1-67)/21)*15)+I2+1:J3=B(I):FORK=1TO6:IFMID$(B$(K),I0,1)="1"THEN875
750 GOSUB9300:IFIW=0THEN875
755 K2=21:IFK>3THENK2=1
770 FORJ1=1TOJ:FORJ2=1TOJ:IFJ1=J2THEN850
780 IW=(L(J1)*W(K,1))+(L(J2)*W(K,2))+(J3*W(K,3)):GOSUB9100:IFIW=.THEN850
800 M2=I+M(K,1):M4=L(J1):GOSUB9400:IFIW=0THEN850
820 M5=K7:M6=K8:M1=M2:M3=M4:M2=I+M(K,2):M4=L(J2):GOSUB9400:IFIW=.THEN850
845 M7=K7:M8=K8:GOSUB9600
850 NEXTJ2,J1:IFFA=.THEN875
869 IFL0>.THEN950
875 NEXTK
900 NEXTI2,I1
910 IFL0>.THEN950
920 PRINT@432,"MC-10 WANTS":PRINT@464,"NEW LETTERS":GOSUB8:GOTO400
950 B(L1)=L3:B(L2)=L4
952 IFL6>3THENL6=L6-3
954 ONL6GOTO955,956,957
955 Z$=CHR$(L3+64)+CHR$(L4+64)+CHR$(L5+64):GOTO958
956 Z$=CHR$(L3+64)+CHR$(L5+64)+CHR$(L4+64):GOTO958
957 Z$=CHR$(L5+64)+CHR$(L3+64)+CHR$(L4+64)
958 PRINT@272,"LAST MOVE MC-10";:PRINT@304,"SPELT "Z$:PRINT@335,L0"POINTS"
960 L9=L1:GOSUB9700:L1=INT((L9-1)/15):L9=L9-(15*L1):J=16383+L9+32*L1:POKEJ,L3
964 L9=L2:GOSUB9700:L2=INT((L9-1)/15):L9=L9-(15*L2):J=16383+L9+32*L2:POKEJ,L4
968 GOTO400
6000 B$(0)="400100040001004030002000200030003000101000300100300010003001000030000030000020002000200020001000101000100400100030001004001000101000100020002000200020000030000030000100300010003001003000101000300030002000200030400100040001004"
7000 FORCC=1TO6
7010 B$(CC)="000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
7020 NEXT:RETURN
REM 8000 FORCC=0TO7:FORZZ=1TO8:M$=MID$("¿ß¿ï¯ïßßïßï¯¯ßß¿ßï",ZZ+CC*8,1)
8010 PRINT@32*CC+(ZZ-1),M$;:PRINT@32*CC+(15-ZZ),M$;:PRINT@448-32*CC+(ZZ-1),M$;:PRINT@448-32*CC+(15-ZZ),M$;
8020 NEXT:NEXT:RETURN
8100 XX=7:YY=7
8110 CC=16384+32*YY+XX:ZZ=PEEK(16384+32*YY+XX):POKECC,207:M$=INKEY$:XX=XX+(M$="A"ANDXX>0)-(M$="D"ANDXX<14)
8140 YY=YY+(M$="W"ANDYY>0)-(M$="S"ANDYY<14):POKECC,ZZ:IFM$=CHR$(13)THENZZ=YY*15+XX+1:RETURN
8150 IFM$="C"THENZZ=0:RETURN
8160 IFM$="R"THENZZ=-1:RETURN
8190 GOTO8110
9000 CLS:PRINT@16,"S C R A B B L E":GOSUB8000:N=66:FORN1=0TO14:N2=N+(21*N1):N3=15*N1
REM 9010 PRINT@80,"WASD=MOVE CURSOR";:PRINT@112,"ENTER=SELECT":PRINT@144,"C=COMPUTER MOVE":PRINT@208,"¿3W ï2W¯3L ß2L"
9020 FORN5=1TO15:N6=B(N2+N5):IFN6>0THENPOKE16383+32*N1+N5,N6
9060 NEXT:NEXT:FORCC=16400TO16415:POKECC,PEEK(CC)-64:NEXT:RETURN
9100 FORN=20TO740STEP20
9105 IFIW=V(N)THEN9250
9110 IFIW<V(N)THEN9200
9115 NEXT:GOTO9275
9200 N=N-19:N1=N+18:FORN2=NTON1:IFIW=V(N2)THEN9250
9220 NEXT:GOTO9275
9250 IW=1:N=66:RETURN
9275 IW=.:N=66:RETURN
9300 K9=I+T(K,2):IFB(K9)THEN9350
9320 K9=I+T(K,3):IFB(K9)THEN9350
9325 K9=I+T(K,1):IFB(K9)>.THEN9350
9330 K9=I+T(K,4):IFB(K9)>.THEN9350
9340 IW=1:RETURN
9350 IW=.:GOTO9
9400 K3=M2-K2-K2-K2:K4=M2+K2+K2+K2:K6=-1:K7=0
9410 FORK5=K3TOK4STEPK2:K6=K6+1:IFB(K5)<1ANDK5<M2THENK7=0:GOTO9430
9412 IFB(K5)<1ANDK5>M2THEN9440
9414 K7=K7+INT(2^K6)
9430 NEXT
9440 FORK5=1TO6:IFK7=F(K5)THEN9460
9450 NEXT:IW=.:GOTO9
9460 ONK5GOTO9470,9480,9510,9540,9560,9580
9470 K7=.:K8=.:IW=1:RETURN
9480 K7=B(M2-K2):IW=(27*K7)+M4:GOSUB9100
9490 K8=.:RETURN
9510 K7=B(M2+K2):IW=K7+(27*M4):GOSUB9100
9520 K8=.:RETURN
9540 K7=B(M2-K2):K8=B(M2+K2):IW=(729*K7)+(27*M4)+K8
9550 GOSUB9100:RETURN
9560 K7=B(M2-K2-K2):K8=B(M2-K2)
9570 IW=(729*K7)+(27*K8)+M4:GOSUB9100:RETURN
9580 K7=B(M2+K2):K8=B(M2+K2+K2)
9590 IW=(729*M4)+(27*K7)+K8:GOSUB9100:RETURN
9600 L9=M1:GOSUB9700:N2=1:N4=1:GOSUB9750:N1=N2:N3=N4
9610 L9=M2:GOSUB9700:N2=1:N4=1:GOSUB9750:N1=I(M3)*N1:N2=I(M4)*N2
9620 L8=0:IFM5+M6=0THEN9640
9630 L8=(I(M5)+I(M6)+N1)*N3
9640 IFM7+M8=.THEN9660
9650 L8=L8+(I(M7)+I(M8)+N2)*N4
9660 L8=L8+((I(J3)+N1+N2)*(N3*N4))
9680 IFL8>L0THENL6=K:L5=J3:L0=L8:L1=M1:L2=M2:L3=M3:L4=M4
9685 RETURN
9700 L9=L9-64:L8=INT(L9/21):L9=L9-(L8*21):L9=(15*L8)+L9-2
9710 RETURN
9750 L9=VAL(MID$(B$(0),L9,1)):ONL9GOTO9762,9764,9766,9768:RETURN
9762 N2=2:RETURN
9764 N2=3:RETURN
9766 N4=2:RETURN
9768 N4=3:RETURN
