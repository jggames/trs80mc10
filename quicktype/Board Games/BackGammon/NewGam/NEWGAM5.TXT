0 CLEAR400:DIML(1,2),CC,ZZ,C2,C3,X9,Y9,A(33):L(0,0)=32:L(0,1)=8:L(0,2)=2:L(1,0)=16:L(1,1)=4:L(1,2)=1:MC=16384:GOTO12
3 CLS0:POKE49151,28:RETURN
4 POKE49151,0:CLS:RETURN
5 CC=INT(X9/2):ZZ=INT(Y9/3):C3=MC+CC+ZZ*32:IFPEEK(C3)<128THENPOKEC3,128
6 C2=L(INT(X9-CC*2),INT(Y9-ZZ*3)):POKEC3,(C2ORPEEK(C3)):RETURN
7 CC=(PEEK(17024)AND1)*256+PEEK(17025)-1+MC:FORC2=1TOLEN(M$):C3=ASC(MID$(M$,C2)):POKECC+C2,C3-(C3AND64):NEXT:?@CC-MC+C2,:RETURN
8 CC=INT(X9/2):ZZ=INT(Y9/3):C3=MC+CC+ZZ*32:IFPEEK(C3)<128THENPOKEC3,128
9 C2=L(INT(X9-CC*2),INT(Y9-ZZ*3)):POKEC3,(C2ORPEEK(C3)):IFPEEK(C3)<192THENPOKEC3,PEEK(C3)+64
10 RETURN
11 CC=INT(X9/2):ZZ=INT(Y9/3):C3=MC+CC+ZZ*32:C2=L(INT(X9-CC*2),INT(Y9-ZZ*3)):POKEC3,(NOT(NOT(C2ORPEEK(C3))ORC2)):RETURN
12 A$="€† »ª·‚µ‚·ˆ­ˆ– ¯€±¨½Š½€‘€†€™€³€¦€¶€™ˆ›ª¯Š»¢»ˆ¿¢¾ ½ª®ª·¢¶ ®¢«‚¾ªºŠ»ª¾¨¼ªºˆ— µ «ª©¨¯ª¦¢¥ µ‚"
13 A$="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"+A$
14 C$="ÁÀÆàûê÷ÂõÂ÷ÈíÈÖàïÀñèýÊýÀÑÀÆÀÙÀóÀæÀöÀÙÈÛêïÊûâûÈÿâþàýêîê÷âöàîâëÂþêúÊûêþèüêúÈ×àõàëêéèïêæâåàõÂ"
15 C$="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"+C$:GOTO19
16 FORCC=1TOLEN(B$):PRINTMID$(A$,(ASC(MID$(B$,CC,1))-31)*2,2);:NEXTCC:RETURN
17 FORCC=1TOLEN(B$):PRINTMID$(C$,(ASC(MID$(B$,CC,1))-31)*2,2);:NEXTCC:RETURN
19 O=0:B=0:A(0)=0:A(25)=0
20 DATA2,0,0,0,0,-5,0,-3,0,0,0,5,-5,0,0,0,3,0,5,0,0,0,0,-2
30 FORX=1TO24:READA(X):NEXTX
40 GOSUB1000
60 P=RND(6):C=RND(6)
70 CC=0:ZZ=P:GOSUB3900:CC=3:ZZ=C:GOSUB3910
80 IFP=CTHEN60
90 IFP<CTHEN100
95 PRINT@0,"€€€";:PRINT@32,"€€€";:FORZZ=1TO150:NEXTZZ:CC=0:ZZ=P:GOSUB3900:FORZZ=1TO150:NEXTZZ
96 M$=INKEY$:IFM$=""THEN95
97 GOTO120
100 PRINT@3,"€€€";:PRINT@35,"€€€";:FORZZ=1TO150:NEXTZZ:CC=3:ZZ=C:GOSUB3910:FORZZ=1TO150:NEXTZZ
101 M$=INKEY$:IFM$=""THEN100
120 IFP>CTHEN600

130 REM COMPUTER'S TURN
140 T=0:GOSUB1300
150 GOSUB1350:CC=16:GOSUB4060
155 REM ARE ALL PIECES ON INNER BOARD?
160 C=1:FORZ=0TO18:IFA(Z)>.THENC=0
170 NEXTZ
171 REM PLAYER HASN'T PASSED COMPUTER?
172 V=0:P=0:FORZ=1TO24:IF-(A(Z)<0)*PTHENV=1
174 IFA(Z)>.THENP=1
176 NEXTZ
178 H=0:L=0:R=0:FORY=0TO3:IFA(Y+26)=.THEN315
180 FORX=0TO25-A(Y+26):E=0:IFA(X)<=.THEN310
190 IF-(X=0)*-(A(X)>0)THENE=E+128
200 IFX+A(26+Y)=25THENE=E+64
210 IF-(A(X)=1)*(A(X+A(26+Y)))*VTHENE=E+16
220 IF-(A(X)<>2)*(A(X+A(26+Y)))*VTHENE=E+8
230 IF-(A(X+A(26+Y))=-1)+-(X<7)THENE=E+32
240 IFX<19THENE=E+4
250 IF-(A(X+A(26+Y))<-1)+(-(C=0)*-(X+A(26+Y)>24))THEN310
260 E=E+1:IF-(X+A(26+Y)=25)+-(Y=3)THEN300 
270 FORZ=0TO3:D=X+A(26+Y)-A(26-Z):IF-(Y=Z)+-(A(26+Z)=0)+-(D<0)+-(D>24)THEN290
280 IF-(A(D)=1)+-(A(D)>2)THENE=E+2:TM=Z:Z=3:NEXTZ:Z=TM:GOTO300
290 NEXTZ
300 IF-(H<E)+-(H=E)*(-(X<L)+-(X=L)*-(R<A(26+Y)))THENH=E:R=A(26+Y):L=X
310 NEXTX
315 NEXTY

320 IF-(H<128)*-(A(0)>0)THEN580
330 IFH<>0THEN390
340 R=7:FORY=0TO3:IF-(A(26+Y)<R)*-(A(26+Y)>1)THENR=A(26+Y):L=Y
350 NEXTY:FORX=0TO25-R:IFA(X)>.THEN580
360 NEXTX:FORX=26-RTO24:IFA(X)>.THENA(26+L)=25-X:GOTO178
370 NEXTX:GOTO580
390 IFL>0THENC=A(L):P=L:GOSUB1600
400 A(L)=A(L)-1:IFL=.THENGOSUB1550
440 IFA(L+R)=-1THENB=B+1:A(L+R)=0:C=1:P=L+R:GOSUB1600:GOSUB1550
450 Y=A(L+R)+1:A(L+R)=Y:IFL+R<25THENC=A(L+R):P=L+R:GOSUB2000:GOTO453
452 GOSUB1550
453 FORZZ=0TO3:IFA(26+ZZ)=RTHENZ=ZZ:ZZ=3
454 NEXTZZ:GOSUB1350:PRINT". MOVE FROM";:X=L:GOSUB1850:PRINT" TO";:X=L+R:GOSUB1850:A(26+Z)=0
455 M$=INKEY$:IFM$<>CHR$(13)THEN455
460 IFA(25)=15THEN560
470 FORX=0TO3:IFA(26+X)>.THEN150
480 NEXT X:GOTO 600
560 GOSUB 1500:PRINT AT 0;"I WIN.  ANOTHER GAME (Y/N)";:GOTO 860
580 GOSUB 1350:PRINT". CANNOT MOVE";
590 A$=". HIT ENTER":GOSUB16
591 M$=INKEY$:IFM$<>CHR$(13)THEN591
600 REM PLAYER'S TURN
610 T=1:GOSUB1300
620 GOSUB1350:IFBTHENF=25:CC=4*32:FORC2=1TO10:GOSUB4001:FORZZ=1TO150:NEXTZZ:GOSUB4000:FORZZ=1TO150:NEXTZZ:NEXTC2:GOTO640
630 R=999:N=99:GOSUB3002:PRINT@8,;:B$="FROM:":GOSUB16:GOSUB5000:F=CC
635 IFF=NTHEN130
640 IFF=RTHENGOSUB1000:GOTO620
650 IF(-(F=25)*-(B=0))+-(F<1)+-(F>25)THENSTOP:GOTO980
660 IF-(F<25)*-(A(F)>=0)THENSTOP:GOTO980
670 PRINT@18,;:B$="TO:":GOSUB16:X=O:O=0:N=99:R=999:GOSUB5000:D=CC:O=X:D=INT(D)
672 IFD=NTHEN130
673 IFD=RTHENGOSUB1000:GOTO620
675 IF-(D<0)+-(D>24)THEN980
680 IFA(D)>1THEN980
682 M=0:G=0:FORW=0TO3:IFA(26+W)=F-DTHEN690





683 IF M<A(26+W) THEN M=A(26+W):G=W
684 NEXT W:IF (D<>0)+(B<>0) THEN 980
685 REM DICE EXCEED WHAT'S NEEDED TO MOVE OFF?
686 W=G:IF F<M THEN M=F+1
687 FOR X=M TO 6:IF A(X)<0 THEN 980
688 NEXT X:GOTO 706
689 REM PUT COMPUTER ON BAR?
690 IF (D>0)*(A(D)=1) THEN A(0)=A(0)+1:GOSUB 1550:A(D)=0
695 REM FROM BAR?
700 IF F=25 THEN B=B-1:GOSUB 1550:GOTO 730
702 REM FROM NORMAL
704 IF D<>0 THEN 710
706 FOR X=7 TO 24:IF A(X)<0 THEN 980
708 NEXT X
710 C=A(F):P=F:GOSUB 1600:A(F)=A(F)+1
720 IF D=0 THEN 800
730 A(D)=A(D)-1:P=D:C=A(D):GOSUB 2000:A(26+W)=0
740 REM ANY MORE DICE LEFT?
750 FOR W=0 TO 3:IF A(26+W)<>0 THEN 620
760 NEXT W:GOTO 130
800 REM JUST MOVED OFF
840 O=O+1:GOSUB 1550:A(26+W)=0:IF O<15 THEN 750
850 GOSUB 1500:PRINT AT 0;"YOU WIN!  ANOTHER GAME (Y/N)";
860 Y=1:N=0:INPUT A:IF (A<>Y)*(A<>N) THEN GOTO 820
870 IF A=Y THEN RUN
880 END
970 REM ILLEGAL MOVE
980 CC=18:GOSUB4050:FORZZ=1TO150:NEXTZZ:GOSUB999:FORZZ=1TO150:NEXT
981 M$=INKEY$:IFM$=""THEN980
990 GOTO620
999 PRINT@18,"€€€€€€€€€€€€€€";:PRINT@18+32,"€€€€€€€€€€€€€€";:RETURN
1000 REM REDRAW SCREEN
1002 GOSUB3
1004 CC=4*32:GOSUB4000:REM PRINT BAR
1005 CC=11*32:GOSUB4010:REM PRINT OFF
1010 REM FORX=0TO13:X9=X:Y9=6:GOSUB5:Y9=44:GOSUB5:NEXTX
1020 REM FORY=6TO44:X9=0:Y9=Y:GOSUB5:X9=13:GOSUB5:NEXTY
1030 GOSUB3000
1190 GOSUB1550
1200 CC=4*32:GOSUB4002:REM PRINT RED BAR
1210 CC=11*32:GOSUB4012:REM PRINT OFF
1240 FORP=1TO24:S=1:IFA(P)<.THENS=-1
1250 FORC=0TOA(P)STEPS:GOSUB2000:NEXTC:NEXTP
1270 RETURN
1300 REM ROLL DICE
1310 A(26)=RND(6):A(27)=RND(6):A(28)=0:A(29)=0
1320 IFA(26)=A(27)THENA(28)=A(26):A(29)=A(26)
1325 FORX=0TO3:A(30+X)=A(26+X):NEXTX
1330 RETURN
1350 REM PRINT DICE
1360 GOSUB1500
1370 CC=0:FORX=26TO29
1380 IFA(X)THENONA(X+4)GOSUB1400,1410,1420,1430,1440,1450
1390 NEXTX:RETURN
1400 ZZ=1:IFT=.THENGOSUB3910:GOTO1460
1401 GOSUB3900:GOTO1460
1410 ZZ=2:IFT=.THENGOSUB3910:GOTO1460
1411 GOSUB3900:GOTO1460
1420 ZZ=3:IFT=.THENGOSUB3910:GOTO1460
1421 GOSUB3900:GOTO1460
1430 ZZ=4:IFT=.THENGOSUB3910:GOTO1460
1431 GOSUB3900:GOTO1460
1440 ZZ=5:IFT=.THENGOSUB3910:GOTO1460
1441 GOSUB3900:GOTO1460
1450 ZZ=6:IFT=.THENGOSUB3910:GOTO1460
1451 GOSUB3900
1460 CC=CC+3:RETURN
1500 REM CLEAR TOP LINE
1510 PRINT@0,"€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€";
1520 RETURN
1550 REM UPDATE BAR/OFF COUNTERS
1560 REM PRINT AT 193;:COLOR 2:INVERSE 1:PRINT B;:PRINT AT 449;A(0);
1570 REM PRINT AT 577;O;:PRINT AT 833;A(25);
1580 PRINT@0,;:RETURN

1600 REM ERASE A PIECE
1610 IFC=.THENRETURN
1620 C=ABS(C):X=4*P+12:Y=45-C*2
1630 IFP>12THENX=4*(28-P):Y=5+C*2
1640 IFC>9THENRETURN
1650 IFP-INT(P/2)*2THEN1750
1660 IFC=9THEN1740

1670 ONINT((C-1)/3)+1GOTO1680,1700,1720
1680 Y9=Y:FORX9=XTOX+2:GOSUB11:NEXTX9:RETURN
1700 Y9=Y:FORX9=XTOX+2:GOSUB11:NEXTX9:RETURN
1720 Y9=Y:FORX9=XTOX+2:GOSUB11:NEXTX9:RETURN
1740 Y9=Y:FORX9=XTOX+2:GOSUB5:NEXTX9:RETURN

1750 IFC=9THEN1820
1755 ONINT((C-1)/3)+1GOTO1760,1780,1800
1760 Y9=Y:FORX9=XTOX+2:GOSUB11:NEXTX9:RETURN
1780 Y9=Y:FORX9=XTOX+2:GOSUB11:NEXTX9:RETURN
1800 Y9=Y:FORX9=XTOX+2:GOSUB11:NEXTX9:RETURN
1820 Y9=Y:FORX9=XTOX+2:GOSUB11:NEXTX9:RETURN


1850 REM PRINT TWO DIGIT NUMBER
1860 ON X+1 GOTO 1870,1880,1885,1890,1895,1900,1905,1910,1915,1920,1925,1930,1935,1940,1945,1950,1955,1960,1965,1970,1975,1980,1985,1990,1995,1997
1870 PRINT" BAR";:RETURN
1880 PRINT" 01";:RETURN
1885 PRINT" 02";:RETURN
1890 PRINT" 03";:RETURN
1895 PRINT" 04";:RETURN
1900 PRINT" 05";:RETURN
1905 PRINT" 06";:RETURN
1910 PRINT" 07";:RETURN
1915 PRINT" 08";:RETURN
1920 PRINT" 09";:RETURN
1925 PRINT" 10";:RETURN
1930 PRINT" 11";:RETURN
1935 PRINT" 12";:RETURN
1940 PRINT" 13";:RETURN
1945 PRINT" 14";:RETURN
1950 PRINT" 15";:RETURN
1955 PRINT" 16";:RETURN
1960 PRINT" 17";:RETURN
1965 PRINT" 18";:RETURN
1970 PRINT" 19";:RETURN
1975 PRINT" 20";:RETURN
1980 PRINT" 21";:RETURN
1985 PRINT" 22";:RETURN
1990 PRINT" 23";:RETURN
1995 PRINT" 24";:RETURN
1997 PRINT" OFF";:RETURN

2000 REM DRAW A PIECE
2010 IFC=.THENRETURN
2030 X=4*P+12:Y=45-ABS(C)*2
2040 IFP>12THENX=4*(28-P):Y=5+ABS(C)*2
2050 IFABS(C)>9THENRETURN
2060 IFC<.THENY9=Y:FORX9=XTOX+2:GOSUB5:NEXTX9:RETURN
2070 Y9=Y:FORX9=XTOX+2:GOSUB8:NEXTX9:RETURN

REM DRAW BOARD
3000 FORZZ=0TO11:Y9=72+ZZ*2:GOSUB3010:NEXTZZ
3001 PRINT@40,;:B$="XWVUTSRQPONM":GOSUB16:PRINT@488,;:B$="ABCDEFGHIJK":GOSUB16:RETURN
3002 PRINT@40,;:B$="XWVUTSRQPONM":GOSUB17:PRINT@488,;:B$="ABCDEFGHIJK":GOSUB17:RETURN
3010 GOSUB3100:Y9=Y9+384:GOSUB3102:RETURN
3100 X9=Y9:PRINT@X9,;:GOSUB3110:X9=X9+32:PRINT@X9,;:GOSUB3110:X9=X9+32:PRINT@X9,;:GOSUB3120:X9=X9+32:PRINT@X9,;:GOSUB3120
3101 X9=X9+32:PRINT@X9,;:GOSUB3130:X9=X9+32:PRINT@X9,;:GOSUB3130:RETURN
3102 X9=Y9:PRINT@X9,;:GOSUB3110:X9=X9-32:PRINT@X9,;:GOSUB3110:X9=X9-32:PRINT@X9,;:GOSUB3120:X9=X9-32:PRINT@X9,;:GOSUB3120
3103 X9=X9-32:PRINT@X9,;:GOSUB3130:X9=X9-32:PRINT@X9,;:GOSUB3130:RETURN
3110 M$="*":GOSUB7:PRINTCHR$(87);:RETURN
3120 PRINTCHR$(106)CHR$(95);:RETURN
3130 PRINTCHR$(98)CHR$(63);:RETURN

REM PRINT DICE ZZ=RANDOM 1-6 @CC  
3900 PRINT@CC,MID$("  ¿½ª»¿ª»½ª»»ª»¹ªººª",ZZ*3,3);:PRINT@CC+32,MID$("  ¼¼¨¼¬¨¼¬¨¬¬¨¬¬¨¬¬¨",ZZ*3,3);:RETURN
3910 PRINT@CC,MID$("  ÿýêûÿêûýêûûêûùêúúê",ZZ*3,3);:PRINT@CC+32,MID$("  üüèüìèüìèììèììèììè",ZZ*3,3);:RETURN

REM BLUE BAR
4000 PRINT@CC,"»ˆ›Š»ˆ";:PRINT@CC+32,"¬ ¨¨¨¨";:RETURN

REM BLANK
4001 PRINT@CC,"€€€€€€€€";:PRINT@CC+32,"€€€€€€€€";:RETURN

REM RED BAR
4002 PRINT@CC,"ûÈÛÊûÈ";:PRINT@CC+32,"ìàèèèè";:RETURN

REM BAR BLUE
4010 PRINT@CC,"ºª» » ";:PRINT@CC+32,"¬¨¨€¨€";:RETURN

REM BAR RED
4012 PRINT@CC,"úêûàûà";:PRINT@CC+32,"ìèè€è€";:RETURN

REM BLUE NUMBERS
4020 PRINT@CC,MID$(" šŠ€³ª±ª«ª»¢«‚°ª»ª»ª",ZZ*2,2):PRINT@CC+32,MID$(" ¤ œˆ¬ˆŒ¨€¨Œ¨¬¨”€¬¨€¨",ZZ*2,2);:RETURN

REM RED NUMBERS
4022 PRINT@CC,MID$(" ÚÊÝ€óêñêëêûâëÂðêûêûê",ZZ*2,2):PRINT@CC+32,MID$(" äàÜÈìÈÌè€èÌèìèÔÀìè€è",ZZ*2,2);:RETURN

REM FROM BLUE/RED
4030 PRINT@CC,"» »ˆºª¯ª";:PRINT@CC+32,"¨€¨¨¬¨¨¨";:RETURN

REM FROM RED
4032 PRINT@CC,"ûàûÈúêïê";:PRINT@CC+32,"è€èèìèèè";:RETURN

REM TO BLUE
4040 PRINT@CC,"µ ºª";:PRINT@CC+32,"”€¬¨";:RETURN

REM TO RED
4042 PRINT@CC,"õàúê";:PRINT@CC+32,"Ô€ìè";:RETURN

REM ILLEGAL BLUE
4050 PRINT@CC,"µ ª€ª€» º ›Šª€";:PRINT@CC+32,"œˆ¬ˆ¬ˆ¬ˆ¬¨¨¨¬ˆ";:RETURN

REM THINKING
4060 PRINT@CC,"õàëêõàúÊëèõàúÊúà";:PRINT@CC+32,"Ô€èèÜÈèèèèÜÈèèìè";:RETURN

5000 M$=INKEY$:IFM$=""THEN5000
5010 CC=(ASC(M$)-64):IFA<0ORA>26THEN5000
5020 RETURN
