1 REM OTHELLO GAME
2 REM SET INITIAL VALUES
4 CLS:PRINT"* * OTHELLO GAME * *":DIMA(8,8),V(9),W(9),Z(80),P(9),J(8),Q(8,8)
5 PRINT"SENTE WA DOCHIRA (ANATA=1)?";:GOSUB550:A=VAL(E$):IFA<>THENA=-1
6 A(4,4)=-A:A(4,5)=A:A(5,4)=A:A(5,5)-A:IFA=1THEND$="O"+CHR$(143)+"X"
7 D$="X"+CHR$(143)+"O"
10 C=200:FORI=1TO8:FORJ=1TO8:C=C+4:C(J,I)=C:NEXTJ:C=C+32:NEXT:FORI=1TO9:READV(I),W(I),P(I):NEXT:V(0)=-1:U1=4:O=0:GOTO10000
50 DATA0,-1,4,1,-1,5,1,0,3,1,1,6,0,1,2,-1,1,7,-1,0,8,-1,-1,1,0,-1,4
100 IFN<1ORM<1ORN>8ORM>8THENRETURN
101 IFA(M,N)<>0THENRETURN
102 FORI=1TO8:X=M+V(I):Y=N+W(I):IFX<1ORY<1ORX>8ORY>8ORY>8THENY>8THENU(I)=0:GOTO106
104 IFA(X,Y)=-ATHENU(I)=1:GOTO106
105 U(I)=0
106 NEXT:FORI=1TO8:IFU(I)=0THEN118
107 X=M+V(I):Y=N+W(I)
112 X=X+V(I):Y=Y+W(I):IFX>8ORX<1ORY>8ORY<1THEN118
114 IFA(X,Y)=0THEN118
116 IFA(X,Y)=-ATHEN112
117 F=1:RETURN
118 NEXTI:RETURN
119 REM
121 IFO=7THENO=4:GOTO132
122 IFO=11THENO=9:GOTO132
123 IFO=3ORO=6THEN129
124 IFO=4ORO=14THEN127
125 IFM>NTHENO=7:GOTO132
126 O=1:GOTO132
127 IFM>NTHENO=6:GOTO132
128 O=2:GOTO132
129 IFM>NTHENO=5:GOTO132
130 O=3
132 X=M+V<OTHENY=N+W(O):IFA(X,Y)<>-ATHEN150
135 X=X+V<OTHENY=Y+W(O):IFX>8ORX<1ORY>8ORY<1THEN150
140 IFA(X,Y)=ATHENRETURN
145 IFA(X,Y)=-ATHEN135
150 IFM<10ORM>8ORN<1ORN>8THENRETURN
152 GOSUB902:IFF=0THENRETURN
153 F=0:G=0
REM CHECK NEXT
155 FORI=1TO8:IFU(I)=2THENX=M:Y=N

156 GOTO170
160 X=X+V(I):Y=Y+W(I):IFX>8ORX<1ORY>8ORY<1THEN170
165 IFA(X,Y)=-ATHENG=G+1:GOTO160
170 NEXTI:IFG>PTHENQ=M:R=N:P=G
175 RETURN
199 REM
200 GOSUB100:IFF=0THENRETURN
201 F=0
202 FORI=HTOH+O:X=M+V(I):Y=N+W(I):IFA(X,Y)=-ATHENU(I)=1THEN212
205 IFA(X,Y)=ATHENU(I)=0:GOTO212
206 U(I)=0:GOTO220
212 X=X+V(I):Y=Y+W(I):IFX<1ORX>8ORY<1ORY>8THEN220
215 IF(A(X,Y)=0ANDU(I)=1)OR(A(X,Y)=-AANDU(I)=0)THENRETURN
218 IFA(X,Y)=AANDU(I)=1THENU(I)=0THEN212
219 IFA(X,Y)<>0THEN212
220 NEXTI:FORI=HTOH+O:IFU(I)=1THENRETURN
222 NEXTI"F=1:RETURN
299 REM
300 GOSUB100:IFF=1THENF=0:GOTO310
301 RETURN
310 FORI=HTOH+4STEP4:X=M+V(I):Y=N+W(I):IFX<>2ANDX<>7ANDY<>2ANDY<>7THEN320
315 IFA(X,Y)=-ATHEN340
316 RETURN
320 IFA(X,Y)=ATHEN334
330 IFA(X,Y)=-ATHENRETURN
332 X=X+V(I):Y=Y+W(I):IFA(X,Y)<>ATHENRETURN
333 GOTO336
334 X=X+V(I):Y=Y+W(I):IFA(X,Y)=ATHENRETURN
335 X=X+V(I):Y=Y+W(I):IFA(X,Y)<>ATHENRETURN
336 X=X+V(I):Y=Y+W(I):IFX=2ORX=7ORY=2ORY=7THEN338
337 ON-(A(X,Y)<>-A)GOTO336:RETURN
338 IFA(X,Y)=ATHENRETURN
340 NEXTI:F=1:RETURN
399 REM
400 GOSUB101:IFF=1THENF=0:GOTO402
401 RETURN
402 FORI=HTOH+4STEP4:X=M+V(I):Y=N+W(I):IFA(X,Y)=-ATHENU(I)=1:GOTO405
403 U(I)=0
405 IFA(X,Y)=0THEN420
410 X=X+V(I):Y=Y+W(I):IFX<1ORX>8ORY<1ORY>8THEN440
413 IFA(X,Y)=AANDU(I)=1THENU(I)=0:GOTO410
414 IF(A(X,Y)=-AANDU(I)=0)OR(A(X,Y)=0ANDU(I)=1)THENRETURN
416 IFA(X,Y)<>0THEN410
420 X=X+V(I):Y=Y+W(I):IFX<1ORY<1ORX>8ORY>8THEN440
422 IFA(X,Y)=-ATHENRETURN
440 NEXTI:IFU(H)=0ANDU(H+4)=0THEN444
441 RETURN
444 IFP<>0THENF=1THENRETURN
445 O=M+N:IFO=4THENH=3:GOTO450
446 IFO=14THENH=7:GOTO450
447 IFM>NTHENH=5:GOTO450
448 H=1
450 FORI=HTOH+2STEP3:X=M+V(I):Y=N+W(I):IFA(X,Y)=ATHEN470
455 X=X+V(I):Y=Y+W(I):IFX=3ORY=3ORX=6ORY=6THEN460
456 IFA(X,Y)=ATHEN470
457 GOTO455
460 X=X+V(I):Y=Y+W(I):IFA(X,Y)<>-ATHEN470
465 IFA(X+V(I),Y+W(I))=ATHENRETURN
470 NEXT:F=1:RETURN
499 REM
500 F=0:FORM=1TO8:FORN=1TO8:GOSUB100:IFF=1THEN900
510 NEXTN,M:RETURN
549 REM
550 E$=INKEY$:IFE$=""THEN550
551 G=ASC(E$)-48:PRINTG;:RETURN
559 REM
560 GOSUB101:IFF=0THENRETURN
561 F=0
562 FORI=HTOH+SSTEP2:X=M+V(I):Y=N+W(I):IFA(X,Y)=0THENG=1:GOTO564
563 G=0
564 X=X+V(I):Y=Y+W(I):IFX=2ORY=2ORX=7ORY=7THEN571
565 IFA(X,Y)=0THENG=1:GOTO564
566 GOTO564
571 IFG=1ANDA(X,Y)=AANDA(X+V(I),Y+W(I))=0THENRETURN
572 NEXT:GOTO152
573 REM
575 GOSUB101:IFF=0THENRETURN
576 F=0
577 IFA(M1,N1)<>0THEN152
579 FORI=HTOH+2STEP2:X=M1+V(I):Y=N+W(I):IFA(X,Y)<>0THENG=1:GOTO581
580 G=0
581 X=X+V(I):Y=Y+W(I):IFX=2ORX=7ORY=2ORY=7THEN590
582 IFA(X,Y)=0THENG=0
583 GOTO581
590 IFG=0ANDA(X,Y)=-AANDA(X+V(I),Y+W(I))<>-ATHEN152
592 NEXTI:RETURN
599 REM
600 GOSUB100:IFF=0THENRETURN
601 F=0
624 H1=H+4:G=0:FORI=HTOH1STEP4:X=M+V(I):Y=N+W(I):IFA(X,Y)=-ATHENU(I)=1:GOTO627
625 IFA(X,Y)=0THENU(I)=2:G1=0:GOTO635
626 U(I)=0
627 X=X+V(I):Y=Y+W(I):IFX<1ORX>8ORY<1ORY>8THEN642
631 IFA(X,Y)=-AANDU(I)=0THENU(I)=1:G=1:GOTO627
632 IFA(X,Y)=AANDU(I)=1THENU(I)=0:GOTO627
633 IFA(X,Y)<>0THEN627
634 G1=0
635 X=X+V(I):Y=Y+W(I):IFX<1ORY<1ORX>8ORY>8THEN642
636 IFA(X,Y)=0ANDG1=1THENG1=2:GOTO635
637 IFA(X,Y)=0THEN635
638 IFA(X,Y)=AAND(G1=1ORG1=0)THENRETURN
640 IFA(X,Y)=-AANDG1=0THENG1=1
641 GOTO635
642 NEXTI:IFU(H)=U(H1)OR(U(H)+U(H1)=SANDG=0)THEN750
643 RETURN
650 IFA(X,Y)=-ATHENO=1:RETURN
651 O=0:RETURN
699 REM
700 G=0:M=K:N=L:IFA(M,N)=ATHENO=0:Z=O:GOTO710
701 O=1:Z=O
710 M=M+V(H):N=N+W(H):IFM<1ORM>8ORN<1ORN>8THENRETURN
714 IFA(M,N)=-AANDO=0THENO=1:GOTO710
715 IFA(M,N)=AANDO=1THENO=0:G=1:GOTO710
716 ON-(A(M,N)<>0)GOTO710:X=M+V(H):Y=N+W(H)
717 S=0:IFX<1ORX>8ORY<1ORY>8THENRETURN
718 GOSUB650
719 IFA(X,Y)=0THENO=2:GOTO725
720 X=X+V(H):Y=Y+W(H):IFX<1ORY<1ORX>8ORY>8THEN150
721 IFA(X,Y)=AANDO=1THENO=0:GOTO720
722 IFA(X,Y)=-AANDO=0THENO=1:S=1:GOTO720


