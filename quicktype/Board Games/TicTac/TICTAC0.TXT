PRINT " * ** RATIONAL TIC -TAC -TOE * * *"
REM
REM A PROGRAM BY D D HINRICHS IN TDL 8 K BASIC
REM APRIL 1977
PRINT
INPUT "DO YOU WANT INSTRUCTIONS (Y OR N) " ; A$
IF A$ = "N" THEN 230 : REM SKIP INSTRUCTIONS
N =48
FOR I = 1 TO 9
B(I) = N + I NEXT I PRINT
PRINT "THIS PROGRAM PLAYS AN AGGRESSIVE GAME OF TIC -TAC -TOE. IF"
PRINT "YOU MAKE ANY MISTAKE, THE COMPUTER WILL WIN. IF YOU PLAY"
PRINT "A PERFECT GAME, YOU WILL GET A DRAW. THE PLAYING BOARD IS"
PRINT "DISPLAYED AS FOLLOWS:"
GOSUB 1780 : REM DISPLAY PLAYING BOARD
PRINT
PRINT "TO MAKE YOUR MOVE, ENTER THE DIGIT (1 - 9) THAT REPRESENTS"
PRINT "THE BOARD CELL YOU WISH TO OCCUPY, THEN ENTER A CARRIAGE"
PRINT "RETURN. THE COMPUTER WILL THEN CALCULATE ITS RESPONSE AND"
PRINT "DISPLAY THE UPDATED BOARD. AT THE START, THE COMPUTER WILL" - PRINT "RANDOMLY CHOOSE A CENTER, CORNER, OR SIDE OPENING MOVE."
PRINT
PRINT "COMPUTER MOVES ARE: X"
PRINT "YOUR MOVES ARE: O"
F = RND( -1)
DATA 4,6,8,2,3,7,0,9,0,0, 7,3,1,4,9,3,7,6,9,4
DATA 2,8,6,4,1,9,0,7,0,0, 1,9,3,7,2,7,3,8,9,2
DATA 9,1,8,2,7,3,7,1,2,9, 8,2,1,9,6,4,0,3,0,0
DATA 9,1,6,3,4,1,9,7,4,3, 6,4,2,8,7,3,0,1,0,0
DATA 5,8,7,3,6,4,0,9,0,0, 5,8,6,4,1,9,0,7,0,0
DATA 1,3,5,9,8,5,8,3,1,7, 1,3,7,4,6,0,9,0,8,0
DATA 3,1,5,7,8,5,8,3,1,7, 1,3,5,8,9,0,0,0,0,0
DATA 1,5,7,4,6,3,6,5,7,4, 3,1,5,8,7,0,0,0,0,0
DATA 4,7,5,6,9,5,9,7,4,3, 9,5,7,8,4,7,4,9,5,8
DATA 5,9,2,8,3,3,2,9,5,6, 5,9,3,2,7,2,3,5,8,9
DATA 2,3,5,8,9,9,5,3,2,6, 3,2,5,9,7,7,4,5,3,9
DATA 7,4,3,5,2,3,2,7,4,5
REM
REM ENTRY POINT TO INITIALIZE FOR A NEW GAME
RESTORE : REM RESET DATA POINTER TO START
E =0
: REM SET EACH BOARD CELL TO ITS NO.
F = INT(RND(1) *2)
G =1
H =0
Cl = 10
C2 = 10
N =0
FOR I = 1 TO 9
B(I) = 32
NEXT I REM INITIAL COMPUTER MOVE IS 0, 1, OR 2
C = INT(RND(1) *3)
IF C = O THEN C = 5
590 U = 10 -C
600 GOSUB 2100
630 IF = 5 THEN 1720
640 IF = 2 THEN 1320
650 IF U = 5 THEN 940
670 R = 10 * U + 140
680 IF U > 5 THEN R = R - 10
700 E = 1 720 IF F = 1 THEN R = R + 5
740 F = 1 742 IF R = 0 GOTO 770
745 FOR I = 1 TO R
750 READ C 760 NEXT I


770 REM REENTRY POINT FOR LOOP TO SELECT COMPUTER RESPONSES
780 F = F - 1 790 F = F * F FLIP FLAG (O TO 1 OR 1 TO 0)
800 READ C
810 C2 = C 1 820 Cl = C
830 N = N + 1 840 IFC= OORC =UTHEN 770
850 B(C) = 88
860 IF C2 = 0 OR C = H THEN 1160
870 IF F = 1 THEN 2070
880 IF E = 0 THEN 900
890 IF N = 5 THEN 2070
900 GOSUB 1780
910 GOSUB 1980
920 GOTO 770
930 REM
940 REM CORNER OPENING GAME,
950 U = 1 960 GOSUB 2100
970 IF U = 3 OR U = 7 THEN 1220
980 IFU= 4ORU= 8THENG =0
990 GOSUB 2100
1030 C = 7 1040 IF G = 0 THEN C = 3
1050 IF C < > U THEN 2060
1060 GOSUB 2100
1090 IF G = 0 THEN 1130
1095 C = 2
1100 IF B(2) < > 32 THEN C
1110 IF B(C) = 32 THEN 2060
1120 GOTO 1150
1130 C = 4
1135 IF B(4) < > 32 THEN C = 8
1140 IF B(C) = 32 THEN 2060
1150 C =10 -U
1155 B(C) = 88
1160 GOSUB 1780
1163 PRINT
1167 PRINT "CONGRATULATIONS - YOU GOT A DRAW THAT GAME"
1170 INPUT "DO YOU WANT TO PLAY ANOTHER GAME (Y OR N) "; A$
1180 IF A$ = "Y" THEN 450 : REM GO TO START NEW GAME
1190 PRINT
1195 PRINT "SO LONG UNTIL NEXT TIME THEN"
1200 STOP
1210 REM CORNER OPENING GAME, 1ST USER MOVE 5, 2ND USER MOVE 3 OR 7
1220 CO = 2
1230 IFU= 3THENCO =4
1240 GOSUB 2100
1250 C =CO
1260 IF U = C THEN C = C + 4 : REM ADJUST TRIAL COMPUTER MOVES
1270 GOTO 2060 : REM COMPUTER WINS WITH ADJUSTED TRIAL MOVE
1310 REM
1320 REM SIDE OPENING GAME REENTRY POINT
1330 IF U = 8 THEN 1420 : REM SKIP IF FIRST USER MOVE IS 8
1340 R = 10 * U + 60 : REM FIND RESPONSES FOR SIDE GAME
1350 IF U = 1 THEN R = 80
1360 IF INT(U /2) = U/2 THEN 700 . 1370 IF U > 6 THEN E = 1 1380 GOTO 740
1400 REM
1410 REM SIDE OPENING GAME, FIRST USER MOVE IS 8
1420 B(9) = 88 : REM
1430 GOSUB 1780 : REM
1440 GOSUB 1980 : REM
1450 IF U < 4 THEN 1560
1460 IF U > 5 THEN 1630
1470 B(3) = 88
1480 GOSUB 1780
1490 GOSUB 1980
1500 C = 1 1510 IF U= I THEN C =6
1520 GOTO 2060
1540 REM
1550 REM SIDE OPENING GAME, 1ST USER MOVE IS 8, 2ND USER MOVE IS 3 OR 1 1560 F = 0
1565 H = 6
1570 IF U < > 1 THEN 1600 : REM SET UP LAST 5 REPONSES
1580 F = 1 1590 H = 4
1600 R = 140
1610 GOTO 700
1620 REM
1630 REM SIDE OPENING GAME, 1ST USER MOVE IS 8, 2ND USER MOVE IS 6 OR 7 1640 B(1) = 88 


1650 GOSUB 1780
1660 GOSUB 1980
1670 C = 3
1680 IF U = 3 THEN C = 5 1690 GOTO 2060
1700 REM
1710 REM CENTER OPENING GAME REENTRY POINT
1720 R = U * 10 - 10 : REM FIND RESPONSES FOR CENTER GAME
1730 IF U > 5 THEN R = R - 10
1740 IF INT(U /2) = U/2 THEN 700 : REM RETURN TO SELECT RESPONSES
1750 GOTO 740 : REM RETURN TO SELECT RESPONSES
1760 REM
1770 REM DISPLAY SUBROUTINE TO PRINT UPDATED PLAYING BOARD
1780 PRINT
1790 PRINT TAB(4) "I I"
1800 PRINT TAB(2) CHR$(B(1)) ; " I " ; CHR$(B(2)) ; " I " ; CHR$(B(3))
1810 PRINT "---- +--- + - - - -"
1820 PRINT TAB(2) CHR$(B(4)) ; " I " ; CHR$(B(5)) ; " I " ; CHR$(B(6))
1830 PRINT "---- +--- + - - - -"
1840 PRINT TAB(2) CHR$(B(7)) ; " I " ; CHR$(B(8)) ; " I " ; CHR$(B(9))
1850 PRINT TAB(4) "I I"
1860 RETURN
1960 REM
1970 REM SUBROUTINE TO ACCEPT AND CHECK NEW USER MOVE
1980 INPUT "YOUR MOVE IS " ; U
1990 IF U < 1 OR U > 9 THEN 2030
2000 IF INT(U) < > U THEN 2030
2010 IF B(U) < > 32 THEN 2030
2020 B(U) = 79
2025 RETURN
2030 PRINT "YOUR MOVE IS ILLEGAL. TRY AGAIN"
2040 GOTO 1980
2050 REM
2055 REM ROUTINE FOR WHEN THE COMPUTER WINS THE GAME
2060 B(C) = 88 : REM PUT COMPUTER MOVE IN PROPER CELL
2070 GOSUB 1780 : REM DISPLAY BOARD FOR WINNING GAME
2075 PRINT
digits are selected sequentially for the program's responses. If the selected response is
the same as the user's move, the user has
blocked that row and the next digit is
selected by using a loop. The digits in the even numbered positions and the fifth (last)
digit represent winning responses, and control is diverted to a win routine which prints
the board and the computer winning
message.
Two more of the 24 possible combinations
have only one strategy for a sure program
win, but the program responses are handled
in the same manner.
Six of the 24 possible combinations do
not have a forced win strategy. These are handled by a 7 digit string of forcing moves that may end in a draw. These 7 digit strings
have a 0 spacer inserted before the seventh
digit to trigger diversion to the draw routine.
The latter prints the board and a draw mes- sage after the seventh digit has been selected.
A separate test causes a jump to the next
digit if a zero spacer is detected as a program
response.
That leaves three cases that require spe-
: REM DISPLAY UPDATED BOARD
: REM ACCEPT THIRD USER MOVE
: REM COMPUTER RESPONSE IS 3 OR 5
: REM COMPUTER WINS
2080 PRINT " * * * ** I WON * * * * *"
2090 LOTO 1170 : REM NEW GAME?
2100 REM
2110 REM SUBROUTINE FOR COMBINED CALC, ENTERING, BOARD DISPLAY, USER MOVE
2120 C = 10 -U
2130 B(C) = 88
2140 GOSUB 1780
2150 GOSUB 1980
2160 RETURN
2170 END 
