10 REM chess
20 GOSUB2970
30 GOTO60
40 GOSUB2580
50 GOSUB2820
60 GOSUB2580
70 REM *********************************
80 IFA$="S"THENEND
90 IFA$="X"THENPRINT"EXCHANGING SIDES":GOSUB3540:A$=""
100 IFA$="P"THENGOSUB3730
110 REM *********************************
120 FORZ=1TO16:T(Z)=0:NEXTZ
130 U=0
140 PRINT"p1ease stand by"
150 FORQ=1TO64:IFA(S(Q))>=BBANDA(S(Q))<=RBTHENU=U+1:T(U)=S(Q):IFA(S(Q))=KBTHENKM=S(Q)
160 NEXTQ:IFU<3THEN2230
170 GOTO650
180 FOR Q: 1 TO U:IF A(T(Q}}:KB THEN T(Q)
:T(U):T(U) =KM
190 NEXT Q
200 Q = INT(RND*3)
210 IF A$ = "C" THEN Q = 0
220 IF Q<U THEN Q = Q + 1
230 Z = T(Q):GOSUB 280
240 IF MM = 1 THEN GOSUB 2500:GOTO 40
250 IF Q<U THEN 220
260 GOTO 2360
270 REM *********************************
280 IF A(Z) = QB THEN GOSUB 910
290 IF A(Z) = RB THEN GOSUB 1170
300 IF A(Z) = BB THEN GOSUB 1420
310 IF A(Z) = NB THEN GOSUB 1690
320 IF A(Z) = PB THEN GOSUB 2240
330 RETURN
340 REM *********************************
350 IF A(X) = 107 THEN MM= 0: Q = Q + 1:RETURN
360 IF X + 9 > 88 THEN 380
370 IF A(X + 9)<83 AND A(X + 9)>65 AND RND<.96 THEN RETURN
380 IF X - 11<11 THEN 400
390 IF A(X-11)<83 AND A( X-11 ) >65 AND RND<.
96 THEN RETURN
400 AD = 0
410 AY = 0
420 AX = X + Q(AY + AD)
430 IF AX<11 OR AX>88 THEN 460
440 AP = A(AX)
450 IF AP = Q OR AP = R AND RND>.8 OR AP= B AND RND >.5 THEN RETURN
460 AY = AY + 1
470 IF AY < 8 THEN 420
480 AD = AD + 7
490 IF AD<56 THEN 410
500 AY = 1
510 AX = X + N(AY)
520 IF AX<11 OR AX>88 THEN 540
530 IF A(AX) = N THEN RETURN
540 AY = AY + 1
550 IF AY<9 THEN 510
560 AY = 1
570 AX = X + K(AY)
580 IF AX<11 OR AX>88 THEN 600
590 IF (A(AX}:K OR A(AX)=P) AND RND>.1 THEN RETURN
600 AY = AY + 1
610 IF AY<9 THEN 570
620 MM = 1
630 RETURN
640 REM *********************************
650 Z = KM
660 y = 0
670 y = y + 1
6 8 0 x = z + t1 ( y )
690 IF X<11 OR X>88 THEN 600
700 IF A(X) = N THEN 1870
710 IF Y<8 THEN 670
720 REM *********************************
730 D = 0
740 y = 1
750 X = Z + Q(Y + D)
760 IF X<11 OR X>88 THEN 810
770 IF A(X) = B OR A(X) = Q OR A(X) = R THEN 18 7 0
780 IF A(X)<>E THEN 810
790 y = y + 1
800 IF Y<8 THEN 750
810 D = D + 7
820 IF D<49 THEN 750
830 x = z + 11
840 IF X>88 THEN 860
850 IF A(X):P THEN 1870
860 x = z - 11
870 IF X<11 THEN 180
880 IF A(X):P THEN 1870
890 GOTO 180
900 REM *********************************
910 D = 0
920 y = 1
930 X = Z + Q(Y + D)
940 IF X<11 OR X>88 THEN 1000
