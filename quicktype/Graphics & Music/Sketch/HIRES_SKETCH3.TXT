0 DIMLU(1,2):GOSUB9000:GOTO10
3 CLS0:POKE49151,4:RETURN
4 POKE49151,0:CLS:RETURN
5 XX=INT(X1/2):YY=INT(Y1/3):BY=MC+XX+YY*32:POKEBY,LU(INT(X1-XX*2),INT(Y1-YY*3))ORPEEK(BY):RETURN
6 XX=INT(X1/2):YY=INT(Y1/3):BY=MC+XX+YY*32:VL=LU(INT(X1-XX*2),INT(Y1-YY*3)):POKEBY,(NOT(NOT(VLORPEEK(BY))ORVL)):RETURN
10 GOSUB3:X=32:Y=24:X1=X:Y1=Y:C1=MC+RND(511)
20 GOSUB6
30 I=PEEK(2)ANDPEEK(17023):I$=CHR$(I):X=X+(I$="A"ANDX>0):X=X-(I$="S"ANDX<63):Y=Y+(I$="W"ANDY>0):Y=Y-(I$="Z"ANDY<47)
40 X1=X:Y1=Y:Z=USR(X)Y:IFI=32ANDZ=0THENZ=1:GOSUB5:IFPEEK(BY)>191THENPOKEBY,PEEK(BY)-64
41 IFI=13ANDZ=0THENZ=2:GOSUB5:IFPEEK(BY)<192THENPOKEBY,PEEK(BY)+64
42 IFI=66ANDZ<>0THENGOSUB6
43 IFI=62THENFORYY=0TO15:FORXX=0TO31:LPRINTCHR$(PEEK(32*YY+XX+MC));:NEXT:LPRINT:NEXT:LPRINT
44 IFI=66THENPOKE49151,4
45 IFI=67THENPOKE49151,68
50 IFZ=1ORZ=2THEN30
60 IFZ=0THENGOSUB5:GOTO20
70 STOP
9000 LU(0,0)=32:LU(0,1)=8:LU(0,2)=2:LU(1,0)=16:LU(1,1)=4:LU(1,2)=1:MC=16384:Z=32768:FORT=1TO59:READC1:POKEZ,C1:Z=Z+1:NEXT
9010 Z=16917:M$="HOIAAA":FORY=1TOLEN(M$)/2:POKEZ,(ASC(MID$(M$,2*Y-1,1))-65)*16+ASC(MID$(M$,2*Y,1))-65:Z=Z+1:NEXT:RETURN
9030 DATA 189,235,199,55,189,239,13,134,86,61,55,198,32,61,195,64,0,55,54,56,50,51,84,58,230,0,196,128,39,25
9040 DATA 198,2,194,0,72,37,6,43,2,88,88,88,88,228,0,39,8,204,64,1,164,0,39,1,92,79,126,236,227
9100 REM USE:
9110 REM X1=XCOORD:Y1=YCOORD:GOSUB5 TO SET 
9120 REM X1=XCOORD:Y1=YCOORD:GOSUB6 TO RESET
9130 REM Z=USR(XCOORD)YCOORD:GOSUB6 TO TEST POINT Z=1=COLOUR1 Z=2=COLOUR2:Z=0=NOT SET
9140 REM GOSUB3 TO TURN ON SG6
9150 REM GOSUB4 TO RETURN TO REGULAR TEXT SCREEN
