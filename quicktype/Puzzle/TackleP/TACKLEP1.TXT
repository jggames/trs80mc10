0 DIMZZ,CC,M$,MC:MC=16384:GOSUB25000:GOSUB10000:GOSUB11000:GOTO4000
7 PRINTM$;:CC=((PEEK(17024)AND1)*256+PEEK(17025))-1+MC:FORZZ=CC-LEN(M$)+1TOCC:POKEZZ,PEEK(ZZ)-64:NEXT:RETURN
1000 REM *OBTEM COMANDO
1010 IFPEEK(2)=0THENC=0:RETURN 
1020 T=PEEK(17023):IFT=C1THENC=1:RETURN 
1021 IFT=C2THENC=2:RETURN 
1022 IFT=C3THENC=3:RETURN 
1023 IFT=C4THENC=4:RETURN 
1024 IFT=C5THENC=5:RETURN 
1025 IFT=C6THENC=6:RETURN 
1030 C=0:RETURN 
1100 REM OBTEM MOVIMENTO
1110 M=0:Y1=Y+1:IFY1>=0ANDY1<MYTHENIFM(X,Y1)<>1THENM=1:YT=Y1:RETURN 
1120 GOSUB1000:ONCGOTO1200,1200,1300,1400,1300,1500:GOTO1120
1200 REM COMANDO HORIZONTAL
1210 DX=ABS(C=2)-ABS(C=1):X1=X+DX:IFNOT(X1>=0ANDX1<MX)THENRETURN 
1220 IFM(X1,Y)<>1THENM=1:XT=X1:YT=Y:RETURN 
1230 X2=X1+DX:IFX2>=0ANDX2<MXTHENIFM(X1,Y)=1THENIFM(X2,Y)=0THENM=2:M(X1,Y)=0:M(X2,Y)=1:XT=X1:YT=Y
1240 RETURN 
1300 REM COMANDO DIAGONAL
1310 Y1=Y-1:IFNOT(Y1>=0ANDY1<MY)THENRETURN 
1320 DX=C-4:X1=X+DX:IFX1>=0ANDX1<MXTHENIFM(X1,Y1)<>1THENM=1:XT=X1:YT=Y1
1330 RETURN 
1400 REM COMANDO VERTICAL
1410 Y1=Y-1:IFNOT(Y1>=0ANDY1<MY)THENRETURN 
1420 IFM(X,Y1)<>1THENM=1:XT=X:YT=Y1:RETURN 
1430 Y2=Y-2:IFY2>=0ANDY2<MYTHENIFM(X,Y2)<>1THENM=1:XT=X:YT=Y2
1440 RETURN 
1500 REM COMANDO REINICIA NIVEL
1510 M=3:RETURN 
2000 REM CICLO
2010 GOSUB1100:GOSUB2300:ONMGOTO2200,2100:RETURN
2100 REM MOVE BLOCO
2110 M(X1,Y)=0:M(X2,Y)=1:GOSUB2700:GOTO2230
2200 REM MOVE PINGUIM
2210 IFM(XT,YT)=2THENM(XT,YT)=0:CP=CP+1
2220 GOSUB2600:X=XT:Y=YT
2230 IFCP<5THEN2010
2240 RETURN 
2300 SOUND119,2:SOUND134,2
2310 RETURN 
2400 REM *MOSTRA M(I,J)
2410 K=M(I,J)
2500 REM *MOSTRA K EM I,J
2510 PRINT@32*(Y0+J)+X0+I,M$(K);:RETURN 
2600 REM *MOVE PINGUIM
2610 PRINT@32*(Y0+Y)+X0+X,E$;:PRINT@32*(Y0+YT)+X0+XT,P$;:RETURN
2700 REM *MOVE BLOCO
2710 I=X1:J=Y:GOSUB2400:I=X2:GOTO2400
3000 REM FASE
3010 GOSUB3100:RESTORE:IFF>1THENFORZZ=1TOF-1:READX,Y:FORJ=0TOMY-1:READM$:NEXT:NEXT
3011 GOSUB3300:GOSUB3400:READX,Y:FORJ=0TOMY-1:READM$:FORI=0TOMX-1:K=VAL(MID$(M$,I+1,1))
3012 M(I,J)=KAND(K<>3):GOSUB2500:NEXT:NEXT:CP=0
3020 GOSUB2000:IFM<>3THENIFCP<5THEN3020
3030 RETURN 
3100 M$="CGCDECGERRRRCEDCRRRCG":GOSUB20000
3120 RETURN 
3300 REM *APAGA MAPA
3310 FORJ=0TOMY-1:PRINT@32*(Y0+J)+X0,M2$;:NEXT:RETURN 
3400 REM *MOSTRA NUMERO DA FASE
3410 PRINT@32*14+6,RIGHT$(" "+STR$(F),2);:RETURN
4000 REM JOGO
4010 F=1:V=5:GOSUB4200:GOSUB4300
4020 GOSUB3000:IFM=3THENV=V-1:GOSUB4100:IFV=0THENGOSUB4400:GOTO4010
4030 IFM<>3THENF=F+1:IFF>10THENGOSUB4500:GOTO4010
4040 GOTO4020
4100 REM *MOSTRA REINICIOS
4110 PRINT@32*14+26+(5-V),P$;:RETURN 
4200 REM *TELA TITULO
4210 CLS 
4220 PRINT@32*1+10,;:M$=" T A C K L E ":GOSUB7 
4230 PRINT@32*3+9,;:M$=" P E N G U I N ":GOSUB7 
4240 PRINT@32*6+5,;P$;" ..... TACKLE PENGUIN";
4250 PRINT@32*8+5,;C$;" ..... KEY";
4260 PRINT@32*10+5,;B$;" ..... BLOCK";
4270 PRINT@32*14+10,;CHR$(91)"HIT ANY KEY"CHR$(93)
4280 FORZZ=1TO25:M$=INKEY$:NEXT
4290 ON-(INKEY$="")GOTO4290:RETURN 
4300 REM *TELA DE JOGO
4310 CLS
4320 M$="         TACKLE PENGUIN         ":GOSUB7 
4330 FORJ=-1TOMY:PRINT@32*(Y0+J)+X0-1,M1$;:NEXT
4340 FORJ=14TO15:PRINT@32*J,"                               ";:NEXT
4350 PRINT@32*14,"PUZZLE:";
4360 PRINT@32*14+16,"RESTARTS:";
4370 PRINT@32*15," MIDORINOTANUKI / EMERSON COSTA";
4380 RETURN 
4400 REM FIM DE JOGO SEM VIDAS
4410 PRINT@32*8+11,;:M$="GAME OVER":GOSUB7 
4420 M$="ERDCBOCBAERDCBCBA":GOSUB20000
4440 RETURN 
4500 REM FIM DE JOGO COMPLETO
4510 PRINT@32*8+11,;:M$="CONGRATS!!":GOSUB7 
4520 M$="CARARGEDCRCRDRDCDREGEDERARA":GOSUB20000
4540 M$="ARAADRDRDCDREFEFEFEFERARARA":GOSUB20000
4560 RETURN 
5000 DATA0,7
5001 DATA000000000020001111,002000000001001002,011110001001011111,101001010101001000
5005 DATA001012110001001001,001011110101101111,001010101101111000,301010100020000000
5010 DATA0,7
5011 DATA000020000000000000,001111100100010010,001000010010100110,211000000111110100
5015 DATA101112010101020101,001000000100010102,001000000000000110,300000000000011100
5020 DATA0,7
5021 DATA000200110000010100,000100110000001000,110001100000100010,001110002001100001
5022 DATA200101111100101012,001010000002100001,110000000001110010,300000000000000101
5030 DATA0,7
5031 DATA000000000000000002,000000200001100110,001001110010000001,002110000010001021
5032 DATA011010001201110010,010000100110011001,010011000001100010,300000000000000000
5040 DATA0,0
5041 DATA301100112100001010,100110100010110020,010011010101110110,101001010101011010
5042 DATA001001010101011010,001000112101010101,001011100011100010,121000111112000101
5050 DATA1,7
5051 DATA210000000002000101,100101010100101000,000002111000101211,110000001100101002
5052 DATA000100000000101010,101000100010101011,000010101000101001,130100001101001011
5060 DATA8,4
5061 DATA000000200000000020,111000002000111000,102100100000100100,101010000101101010
5062 DATA100110003010100001,100010101000100010,100100110000110020,111000100000111010
5070 DATA0,0
5071 DATA310000100002010200,100101210100010100,000000001010010000,102000000000010200
5072 DATA000001011001010000,100110000000010000,001100100110011010,100000000000010010
5080 DATA0,7
5081 DATA000100100000121121,002111011000101110,011121001011111121,000101001000100000
5082 DATA001001001000100001,001011001000100000,000010001101100001,300010001001000001
5090 DATA0,7
5091 DATA000001011010000010,111110101111110101,100101001010111012,010002100000011001
5092 DATA001001110110100011,120101012001010101,010000000000011211,300010000000110110
10000 REM INICIALIZA JOGO
10010 MX=18:MY=8: REM DIMENSOES DO MAPA
10020 DIMM(MX,MY): REM MAPA
10050 X=0:Y=0: REM POSICAO DO PINGUIM
10060 C=0: REM NUMERO DO COMANDO
10070 X1=0:Y1=0:X2=0:Y2=0: REM POSICOES PROXIMAS AO PINGUIM
10080 DX=0: REM DIRECAO DO MOVIMENTO HORIZONTAL
10090 XT=0:YT=0: REM PROXIMA POSICAO DO PINGUIM
10100 M=0: REM MOVIMENTO (0=NENHUM, 1=PINGUIM, 2=BLOCO)
10110 F=0: REM NUMERO DA FASE
10120 CP=0: REM CHAVES PEGAS
10130 V=0: REM QUANTIDADE DE VIDAS RESTANTES
10140 M$="": REM UMA LINHA DO MAPA
10150 RETURN 
11000 REM *INICIALIZA INTERFACE
11010 T=0: REM TECLA PRESSIONADA
11020 C1=ASC("A"):C2=ASC("D"):C3=ASC("Q"):C4=ASC("W"):C5=ASC("E"):C6=ASC("G"): REM COMANDOS DE TECLADO
11030 X0=16-INT(MX/2):Y0=8-INT(MY/2): REM POSICAO DO MAPA NA TELA
11050 P$="A": REM SPRITE DO PINGUIM
11060 C$="F": REM SPRITE DA CHAVE
11070 E$=" ": REM SPRITE DO ESPACO
11080 B$=CHR$(207): REM SPRITE DO BLOCO
11090 M1$="":FORI=-1TOMX:M1$=M1$+B$:NEXTI: REM FUNDO DO MAPA (BLOCOS)
11100 M2$="":FORI=0TOMX-1:M2$=M2$+E$:NEXTI: REM FUNDO DO MAPA (ESPACOS)
11110 DIMM$(3):M$(0)=E$:M$(1)=B$:M$(2)=C$:M$(3)=P$: REM MATRIZ PARA TRADUZIR VALORES DO MAPA EM SPRITES
11120 RETURN 
20000 FORCC=1TOLEN(M$):Z$=MID$(M$,CC,1):IFZ$="A"THENSOUND73,2
20001 IFZ$="B"THENSOUND93,2
20002 IFZ$="C"THENSOUND102,2
20003 IFZ$="D"THENSOUND119,2
20004 IFZ$="E"THENSOUND134,2
20005 IFZ$="F"THENSOUND141,2
20006 IFZ$="G"THENSOUND154,2
20007 IFZ$="R"THENFORZZ=1TO25:NEXT
20007 NEXT:RETURN
24999 END 
25000 REM INSTALADOR
25001 CLS0:PRINT"         TACKLE PENGUIN         ";:PRINT@64,;
25529 M$="   ORIGINAL GAME FOR FM-7/77    ":GOSUB7
25530 M$="  PROGRAMMED BY MIDORINOTANUKI  ":GOSUB7
25531 M$="       PUBLISHED IN MYCOM       ":GOSUB7
25532 M$="      BASIC MAGAZINE 1988-04    ":GOSUB7
25534 M$="        MC-1000 VERSION BY      ":GOSUB7
25535 M$=" EMERSON JOSE SILVEIRA DA COSTA ":GOSUB7
25536 M$="      (AKA ENSJO) 2017-04-09    ":GOSUB7
25537 M$="    MC-10 EDITS BY JIM GERRIE   ":GOSUB7:PRINT@32*12,;
25538 M$="USE: Q W E  = JUMPS             ":GOSUB7
25539 M$="      A   D = MOVE LEFT & RIGHT ":GOSUB7
25540 M$="          G = RESTART           ":GOSUB7
25550 ON-(INKEY$="")GOTO25550:CLS0:RETURN
