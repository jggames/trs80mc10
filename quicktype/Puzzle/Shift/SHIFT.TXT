10 DIM A(15):A=RND(-(PEEK(9)*256+PEEK(10)))
20 FOR A=0 TO 15
30 A(A)=A+1
40 NEXT A
50 FOR A=2 TO 15
60 B=RND(A)-1
70 C=A(A)
80 A(A)=A(B)
90 A(B)=C
100 NEXT A
110 FOR A=0 TO 1000
140 CLS
150 PRINT"SHIFT"
160 PRINT"-----"
170 FOR B=0 TO 3
180 PRINT
190 FOR C=0 TO 3
200 D=B*4+C
220 IF A(D)<>16 THEN PRINT LEFT$(" "+STR$(A(D))+"   ",4);
230 IF A(D)=16 THEN PRINT"  "CHR$(128)" ";:G=D
250 NEXT C
260 PRINT
270 PRINT
280 NEXT B
290 E=INT(G/4)+1
300 F=G-INT(G/4)*4+1
310 FOR B=0 TO 15
320 IF A(B)=B+1 THEN NEXT B
325 IF B=16 THEN 2000
340 PRINT@448,"NUMBER";
350 INPUT B
360 IF B<1 OR B>15 THEN 1000
370 FOR C=0 TO 15
380 IF A(C)<>B THEN NEXT C
390 B=INT(C/4)+1
400 D=C-INT(C/4)*4+1
410 IF B<>E AND D<>F THEN 1000
420 I=ABS(C-G)
430 IF D=F THEN I=INT(I/4)
440 FOR H=0 TO I-1
450 IF D>F THEN A(G+H)=A(G+H+1)
460 IF D<F THEN A(G-H)=A(G-H-1)
470 IF B>E THEN A(G+H*4)=A((G+H*4)+4)
480 IF B<E THEN A(G-H*4)=A((G-H*4)-4)
490 NEXT H
500 A(C)=16
510 NEXT A
1000 PRINT "DO OVER";
1010 GOTO 340
2000 PRINT "YOU DID IT IN";A;"MOVES"
2010 REM
2020 PRINT "TYPE Y TO PLAY AGAIN";
2030 INPUT A$
2040 IF A$="Y" THEN RUN
2050 PRINT "HOPE YOU HAD FUN":END
2060 REM JOSEPH HO 1982
