10 GOTO720
99 FORI=1TO LEN(X$):Z$=MID$(X$,I,1):IF Z$<>" " THEN PRINT@(Y*32+X+I-1),CHR$(ASC(Z$)+32);
110 NEXT:RETURN
199 PRINT@(Y*32+X),X$;:RETURN
210 NEXT:RETURN
211 X=28+6*T:Y=6*(P-1):FORI=0TO5:FORJ=0TO5:SET(X+I,Y+J,CC):NEXTJ,I:RETURN
212 X=12:Y=7-V:X$=">":GOSUB199:Y=7+V:X$="<":GOSUB199:X$="SENS":X=11:Y=7:GOSUB99:RETURN
250 RESTORE
251 READWW:IF W<>WW THEN251
252 RETURN
720 V=1:RT=1:CLS0:X=11:Y=1:X$="GYRACOLOR":GOSUB99
770 PRINT@416,"      FRAPPEZ UNE TOUCHE."
780 IF INKEY$="" THEN Z=RND(1):GOTO780
800 CLS0:FOR T=18TO30 STEP3:X=T:Y=15:X$=CHR$(48+(T-15)/3):GOSUB199:NEXT
810 FOR T=2TO14 STEP3:X=16:Y=T-1:X$=CHR$(48+(T+1)/3):GOSUB199:NEXT
820 DIM C(25):B=1
830 C=INT(RND(6)+1):IFC=1 OR C=6 THEN830
840 IF C=4 THEN A4=A4+1:IF A4=6 THEN A4=5:GOTO830
850 IF C=2 THEN A2=A2+1:IF A2=6 THEN A2=5:GOTO830
860 IF C=3 THEN A3=A3+1:IF A3=6 THEN A3=5:GOTO830
870 IF C=7 THEN A7=A7+1:IF A7=6 THEN A7=5:GOTO830
880 IF C=5 THEN A5=A5+1:IF A5=6 THEN A5=5:GOTO830
890 C(B)=C:B=B+1:IFB<>26THEN830
920 B=0:FORP=1TO5:FORT=1TO5:B=B+1:CC=C(B):GOSUB211:NEXTT,P:GOSUB212
1020 RESTORE:DIMX(25)
1040 FOR T=1TO25:X(T)=C(T):NEXTT
1060 X=0:Y=0:X$="LIGNE":GOSUB99:GOSUB1180
1061 X=0:L=A:Y=2:X$="COLONNE":GOSUB99:GOSUB1180
1062 PRINT@8,"   ";:PRINT@72,"   ";
1070 C=A
1100 GOSUB1290
1110 YY=0
1120 YY=YY+1:Z=X(5*YY):XX=0:IF YY=6THEN1170
1130 XX=XX+1:IF XX=6THEN1120
1140 IF X(5*(YY-1)+XX)<>Z THEN 1060
1150 IF XX=5 AND YY=5THEN1780
1160 GOTO1130
1170 GOTO1050
1180 FOR T=1TO100:NEXTT
1190 Z$=INKEY$:IF Z$="" THEN 1190
1200 Z=ASC(Z$):IF Z=13THEN YT=Y:V=V*-1:GOSUB212:Y=YT:RT=1-RT:SOUND200,15:GOTO1180
1210 IF Z=145THEN10000
1220 IF Z<49OR Z>53THEN1180
1230 A=Z-48:PRINT@8+Y*32,A;
1240 FORB=50TO60:SOUNDB,1:NEXTB
1250 RETURN
1290 G=C+(L-1)*5
1300 IFG=1THEN W=1620+10*RT:TE=3:A=X(G+1):GOTO1490
1320 IF G=2OR G=3OR G=4THEN W=1640+10*RT:TE=5:A=X(G+1):GOTO1490
1340 IF G=5THENW=1660+10*RT:TE=3:A=X(G+5):GOTO1490
1360 IF G=6OR G=11OR G=16THEN W=1680+10*RT:TE=5:A=X(G-5):GOTO1490
1380 IF G=21THEN W=1700+10*RT:TE=3:A=X(G-5):GOTO1490
1400 IF G=22OR G=23OR G=24THEN W=1720+10*RT:TE=5:A=X(G-6):GOTO1490
1420 IF G=25THEN W=1740+10*RT:TE=3:A=X(G-6):GOTO1490
1440 IF G=10OR G=15OR G=20THEN W=1760+10*RT:TE=5:A=X(G-6):GOTO1490
1460 A=X(G-6):TE=8
1470 W=1510-10*RT
1490 GOSUB250:FORZZ=1TO TE:READH:B=X(G+H):X(G+H)=A:A=B:GOSUB1530:NEXTZZ
1500 DATA 1500,-5,-4,1,6,5,4,-1,-6,1510,-1,4,5,6,1,-4,-5,-6
1520 RETURN
1530 Q=INT((G+H)/5)
1540 R=G+H-5*Q
1541 Q=Q+1:IFR=0THENQ=Q-1:R=5
1560 CC=X(G+H)
1570 P=Q:T=R:GOSUB211:RETURN
1620 DATA 1620,5,6,1,1630,6,5,1,1640,-1,4,5,6,1,1650,6,5,4,-1,1,1660,-1,4,5,1670,4,-1,5
1680 DATA 1680,5,6,1,-4,-5,1690,-4,1,6,5,-5,1700,1,-4,-5,1710,-4,1,-5,1720,-1,1,-4,-5,-6
1730 DATA 1730,-5,-4,1,-1,-6,1740,-1,-5,-6,1750,-5,-1,-6,1760,-1,4,5,-5,-6,1770,-5,5,4,-1,-6
1780 CLS0:X=12:Y=8:X$="GAGNE !!!!":GOSUB199:FORI=1TO15:SOUNDI*I,I:NEXT
10000 CLS0:X=10:Y=3:X$="VOULEZ VOUS":GOSUB99
10010 Y=10:X$=" 1 : REJOUER":GOSUB199
10020 Y=13:X$=" 2 : ARRETER":GOSUB199
10030 A$=INKEY$:IF A$<>"1" AND A$<>"2" THEN 10030
10040 IFA$="1" THEN RUN
10050 CLS:END
5 CLEAR40
10 DIMD(8,6),N(7,7),N$(2):GOSUB500:GOSUB800
30 GOSUB700:I=4:J=4:JO=1:XA=205:PRINT@XA,E1$(1);:PRINT@XA+32,E2$(1);:PRINT@XA+4,E1$(1);:PRINT@XA+36,E2$(1);
40 IFF=1THEN100
50 IFO=1ANDJO=2THENGOSUB200:GOTO70
60 GOSUB600
70 T(JO)=T(JO)+N(I,J):N(I,J)=0:GOSUB750:GOSUB720:JO=2+(JO=2):F=1:FORE=1TO7:IFJO=1THENIFN(I,E)<>0THENF=0
80 IFJO=2THENIFN(E,J)<>0THENF=0
90 NEXT:GOTO40
100 GOSUB900:CLS3:GOSUB720:IFT(1)=T(2)THENPRINT@202,"  EGALITE  ";:GOTO150
110 IFT(1)>T(2)THENPRINT@200,N$(1);:GOTO130
120 PRINT@200,N$(2);
130 PRINT" A GAGNE !";
150 PRINT@321,"VOULEZ-VOUS REJOUER (O/N)";:R$=INKEY$:IFR$<>"O" AND R$<>"N" THEN 150
151 IF R$="N" THEN CLS1:END
160 T(1)=0:T(2)=0:F=0:O=0:GOSUB800:GOTO30
200 FORC=1TO7:K(C)=0:NEXT:FORC=1TO7:IFC=I ORN(C,J)=0THEN240
210 M=0:FORR=1TO7:IFR=J THEN230
220 IFN(C,R)>M THENM=N(C,R)
230 NEXTR:K(C)=10+N(C,J)-M:IFM=0THENK(C)=1:IFT(2)+N(C,J)>T(1)THENCO=C:GOTO260
240 GOSUB600:NEXTC:M=0:FORC=1TO7:IFK(C)>M THENM=K(C):CO=C
250 NEXTC
260 IFCO>I THENI=I+1:GOSUB600:IFCO>I THEN260
270 IFCO<I THENI=I-1:GOSUB600:IFCO<I THEN270
280 GOSUB600:GOSUB920:GOSUB900:RETURN
500 FORI=0TO8:FORJ=1TO6:READD(I,J):D(I,J)=D(I,J)+16*(I-1):NEXTJ:NEXTI
510 E0$=CHR$(128):E1$(2)=CHR$(209):E2$(2)=CHR$(213):E1$(1)=CHR$(177):E2$(1)=CHR$(181):RETURN
520 DATA177,179,179,181,191,191,128,128,128,128,132,128,128,128,128,128,136,136,128,130,128,128,132,130,128,130,130,128
530 DATA130,130,128,130,130,128,134,130,129,129,128,129,137,132,129,129,129,129,137,129,129,129,129,129,137,137
600 XN=4*(I-1)+1+64*(J-1):PRINT@XA,E0$;:PRINT@XA+32,E0$;:PRINT@XA+4,E0$;:PRINT@XA+36,E0$;:XA=XN
610 PRINT@XN,E1$(JO);:PRINT@XN+32,E2$(JO);:PRINT@XN+4,E1$(JO);:PRINT@XN+36,E2$(JO);:IFJO=2ANDO=1THENRETURN
620 D$=INKEY$:IFD$=""THEN620
630 IFD$=CHR$(13)ANDN(I,J)<>0THENGOSUB920:RETURN
640 IFJO=2THEN680
650 IFD$="Z"ANDJ>1THENJ=J-1:GOTO600
660 IFD$="W"ANDJ<7THENJ=J+1:GOTO600
670 GOTO600
680 IFD$="Q"ANDI>1THENI=I-1:GOTO600
690 IFD$="S"ANDI<7THENI=I+1:GOTO600
699 GOTO600
700 FORI=1TO7:FORJ=1TO7:N(I,J)=RND(8):NEXTJ:NEXTI:CLS0
710 FORJ=1TO7:FORI=1TO7:GOSUB750:NEXTI:NEXTJ
720 PRINT@480,CHR$(191)+N$(1)+CHR$(191);T(1);:PRINT@496,CHR$(223)+N$(2)+CHR$(223);T(2);:RETURN
750 FORK=1TO6:PRINT@4*(I-1)+1+K+3*(K>3)+64*(J-1)-32*(K>3),CHR$(D(N(I,J),K));:NEXTK:RETURN
800 CLS3:PRINT@450,"COMBIEN DE JOUEURS (1/2)";:R$=INKEY$
801 R$=INKEY$:IF R$<>"1" AND R$<>"2" THEN 801
802 PRINT " ";R$;
820 N$(1)="JOUEUR 1":JO=1:N$(2)="JOUEUR 2":IFR$="1"THENN$(2)=" ALICE  ":O=1
830 GOSUB900:RETURN
900 FORZ=1TO1500:NEXT:RETURN
920 SOUND154,5:SOUND154,5:SOUND119,10:RETURN
5 CLEAR40
10 DIMD(8,6),N(7,7),N$(2):GOSUB500:GOSUB800
30 GOSUB700:I=4:J=4:JO=1:XA=205:PRINT@XA,E1$(1);:PRINT@XA+32,E2$(1);:PRINT@XA+4,E1$(1);:PRINT@XA+36,E2$(1);
40 IFF=1THEN100
50 IFO=1ANDJO=2THENGOSUB200:GOTO70
60 GOSUB600
70 T(JO)=T(JO)+N(I,J):N(I,J)=0:GOSUB750:GOSUB720:JO=2+(JO=2):F=1:FORE=1TO7:IFJO=1THENIFN(I,E)<>0THENF=0
80 IFJO=2THENIFN(E,J)<>0THENF=0
90 NEXT:GOTO40
100 GOSUB900:CLS3:GOSUB720:IFT(1)=T(2)THENPRINT@202,"  EGALITE  ";:GOTO150
110 IFT(1)>T(2)THENPRINT@200,N$(1);:GOTO130
120 PRINT@200,N$(2);
130 PRINT" A GAGNE !";
150 PRINT@321,"VOULEZ-VOUS REJOUER (O/N)";:R$=INKEY$:IFR$<>"O" AND R$<>"N" THEN 150
151 IF R$="N" THEN CLS1:END
160 T(1)=0:T(2)=0:F=0:O=0:GOSUB800:GOTO30
200 FORC=1TO7:K(C)=0:NEXT:FORC=1TO7:IFC=I ORN(C,J)=0THEN240
210 M=0:FORR=1TO7:IFR=J THEN230
220 IFN(C,R)>M THENM=N(C,R)
230 NEXTR:K(C)=10+N(C,J)-M:IFM=0THENK(C)=1:IFT(2)+N(C,J)>T(1)THENCO=C:GOTO260
240 GOSUB600:NEXTC:M=0:FORC=1TO7:IFK(C)>M THENM=K(C):CO=C
250 NEXTC
260 IFCO>I THENI=I+1:GOSUB600:IFCO>I THEN260
270 IFCO<I THENI=I-1:GOSUB600:IFCO<I THEN270
280 GOSUB600:GOSUB920:GOSUB900:RETURN
500 FORI=0TO8:FORJ=1TO6:READD(I,J):D(I,J)=D(I,J)+16*(I-1):NEXTJ:NEXTI
510 E0$=CHR$(128):E1$(2)=CHR$(209):E2$(2)=CHR$(213):E1$(1)=CHR$(177):E2$(1)=CHR$(181):RETURN
520 DATA177,179,179,181,191,191,128,128,128,128,132,128,128,128,128,128,136,136,128,130,128,128,132,130,128,130,130,128
530 DATA130,130,128,130,130,128,134,130,129,129,128,129,137,132,129,129,129,129,137,129,129,129,129,129,137,137
600 XN=4*(I-1)+1+64*(J-1):PRINT@XA,E0$;:PRINT@XA+32,E0$;:PRINT@XA+4,E0$;:PRINT@XA+36,E0$;:XA=XN
610 PRINT@XN,E1$(JO);:PRINT@XN+32,E2$(JO);:PRINT@XN+4,E1$(JO);:PRINT@XN+36,E2$(JO);:IFJO=2ANDO=1THENRETURN
620 D$=INKEY$:IFD$=""THEN620
630 IFD$=CHR$(13)ANDN(I,J)<>0THENGOSUB920:RETURN
640 IFJO=2THEN680
650 IFD$="Z"ANDJ>1THENJ=J-1:GOTO600
660 IFD$="W"ANDJ<7THENJ=J+1:GOTO600
670 GOTO600
680 IFD$="Q"ANDI>1THENI=I-1:GOTO600
690 IFD$="S"ANDI<7THENI=I+1:GOTO600
699 GOTO600
700 FORI=1TO7:FORJ=1TO7:N(I,J)=RND(8):NEXTJ:NEXTI:CLS0
710 FORJ=1TO7:FORI=1TO7:GOSUB750:NEXTI:NEXTJ
720 PRINT@480,CHR$(191)+N$(1)+CHR$(191);T(1);:PRINT@496,CHR$(223)+N$(2)+CHR$(223);T(2);:RETURN
750 FORK=1TO6:PRINT@4*(I-1)+1+K+3*(K>3)+64*(J-1)-32*(K>3),CHR$(D(N(I,J),K));:NEXTK:RETURN
800 CLS3:PRINT@450,"COMBIEN DE JOUEURS (1/2)";:R$=INKEY$
801 R$=INKEY$:IF R$<>"1" AND R$<>"2" THEN 801
802 PRINT " ";R$;
820 N$(1)="JOUEUR 1":JO=1:N$(2)="JOUEUR 2":IFR$="1"THENN$(2)=" ALICE  ":O=1
830 GOSUB900:RETURN
900 FORZ=1TO1500:NEXT:RETURN
920 SOUND154,5:SOUND154,5:SOUND119,10:RETURN
10 GOTO701
99 FORI=1TO LEN(X$):Z$=MID$(X$,I,1):IF Z$<>" " THEN PRINT @ (Y*32+X+I-1),CHR$(ASC(Z$)+32);
110 NEXT:RETURN
199 FORI=1TO LEN(X$):Z$=MID$(X$,I,1):PRINT @ (Y*32+X+I-1),Z$;
210 NEXT:RETURN
211 X=14+3*T:Y=3*(P-1):X=2*X:Y=Y*2:FORI=0TO5:FORJ=0TO5:SET(X+I,Y+J,CC):NEXTJ:NEXTI:RETURN
212 X=12:Y=7-V:X$=">":GOSUB199:Y=7+V:X$="<":GOSUB199:X$="SENS":X=11:Y=7:GOSUB99:RETURN
250 RESTORE
251 READWW:IF W<>WW THEN251
252 RETURN
701 CLS0
702 Y=7:X=43:FOR W=1TO4:P=0:READC,X$
704 FORI=1TO7:FORJ=1TO5
706 P=P+1:V=VAL(MID$(X$,P,1)):IF V=0THEN 710
708 SET(X+J,Y-I,C)
710 NEXTJ,I:X=X+5:NEXTW
712 DATA 5,00100001000101001010100011000110001
713 DATA 4,01110001000010000100001000010001110
714 DATA 1,10000100001000011110100001000011111
715 DATA 3,01110001000010000100001000010001110
716 X$="NATHAN":X=26:Y=4:GOSUB99
717 X$="ALICE":X=0:Y=0:GOSUB99
720 PRINT@15*32,"  (C) VIFI-INTERNATIONAL 1984  ";
721 X$="GYRACOLOR":X=11:Y=8:GOSUB99
722 FORI=1TO 5000:NEXTI
729 CLS0:X=11:Y=1:X$="GYRACOLOR":GOSUB99
730 Y=3:X=0:X$="LE BUT DU JEU EST D'ALIGNER LES CASES DE MEME COULEUR.             ":GOSUB199
740 Y=5:X$="A CHAQUE FOIS QUE VOUS POINTEZ  UNE CASE, TOUTES LES CASES":GOSUB199
750 Y=6:X=26:X$="  VOI-SINES TOURNENT DANS LE SENS DES AIGUILLES D'UNE MONTRE.         ":GOSUB199
760 X=0:Y=9:X$="VOUS POUVEZ INVERSER CE SENS EN TAPANT LA TOUCHE ENTER          ":GOSUB199
770 Y=13:X$="LORSQUE 'ALICE' AFFICHE 'O.K.', TAPEZ 'RUN', PUIS 'ENTER'       ":GOSUB199
780 CLOAD
