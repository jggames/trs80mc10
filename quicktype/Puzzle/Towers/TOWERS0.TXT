10 CLEAR 1000
20 FOR X=1 TO 4:BL$=BL$+CHR$(128):NEXT
30 BL$=BL$+CHR$(133+64)
40 FOR X=1 TO 4:BL$=BL$+CHR$(128):NEXT X
50 CLS
60 PRINT@32,"********************************";
70 PRINT@71,"THE GAME OF TOWERS"
80 PRINT@96,"********************************";
90 PRINT@161,"1- YOU PLAY (USE A,S & SPACE)."
100 PRINT@225,"2- COMPUTER'S DEMONSTRATION."
110 PRINT@289,"3- COMPUTER'S DEMONSTRATION"
120 PRINT@324,"(SLOW MOTION)."
130 R$=INKEY$:IF R$="" THEN 130
140 IF R$<>"1" AND R$="" AND R$<>"3" THEN 60
150 CLS:PRINT@230,"ONE MOMENT..."
160 GOSUB 600
170 GOSUB 640
180 GOSUB 680
190 GOSUB 720
200 GOSUB 760
210 GOSUB 800
220 GOSUB 840
230 GOSUB 880
240 CLS0
250 PRINT@480,BR$(8);
260 PRINT@491,BR$(8);
270 PRINT@502,BR$(9);
280 FOR DP=0 TO 22 STEP 11
290 FOR X=4 TO 452 STEP 32
300 PRINT@X+DP,CHR$(133+64);
310 NEXT X
320 NEXT DP
330 FOR I=1 TO 7
340 A$(I,1)=BR$(I)
350 NEXT I
360 FOR I=1 TO 7
370 A$(I,2)=BL$:A$(I,3)=BL$
380 NEXT I
390 GOSUB 920
400 CR$=CHR$(142+64)
410 CB$=CHR$(143+64)
420 P=484
430 PRINT@P,CR$;
440 IF R$="2" THEN DL=1:GOTO 1400
450 IF R$="3" THEN DL=1500:GOTO 1400
460 R$=INKEY$:IF R$="" THEN 460
470 IF R$<>" " AND R$<>"A" AND R$<>"S" AND R$<>"R" THEN460
480 IF R$="R" THEN 10
490 P1=P
500 IF R$="A" THEN P=P-11:IF P<484 THEN P=506
510 IF R$="S" THEN P=P+11:IF P>506 THEN P=484
520 PRINT@P1,CB$;
530 PRINT@P,CR$;
540 IF R$<>" " THEN 460
550 IF R$=" " THEN CC=CC+1:SOUND 150,2:GOSUB 1080
560 GOSUB 1640
570 IF A=B THEN CC=1:GOTO 460
580 IF CC=0 THEN GOSUB 1180
590 GOTO 460
600 FOR X=1 TO 4:BR$(7)=BR$(7)+CHR$(128):NEXT X
610 BR$(7)=BR$(7)+CHR$(143+16)+CHR$(138+16)
620 FOR X=1 TO 3:BR$(7)=BR$(7)+CHR$(128):NEXT X
630 RETURN
640 FOR X=1 TO 3:BR$(6)=BR$(6)+CHR$(128):NEXT X
650 BR$(6)=BR$(6)+CHR$(133) +CHR$(143)+CHR$(143)
660 FOR X=1 TO 3:BR$(6)=BR$(6)+CHR$(128):NEXT X
670 RETURN
680 FOR X=1 TO 3:BR$(5)=BR$(5)+CHR$(128):NEXT X
690 FOR X=1 TO 3:BR$(5)=BR$(5)+CHR$(143+112):NEXT X
700 BR$(5)=BR$(5)+CHR$(138+112)+CHR$(128)+CHR$(128)
710 RETURN
720 BR$(4)=CHR$(128)+CHR$(128)+CHR$(133+96)
730 FOR X=1 TO 4:BR$(4)=BR$(4)+CHR$(143+96):NEXT X
740 BR$(4)=BR$(4)+CHR$(128)+CHR$(128)
750 RETURN
760 BR$(3)=CHR$(128)+CHR$(128)
770 FOR X=1 TO 5:BR$(3)=BR$(3)+CHR$(143+80):NEXT X
780 BR$(3)=BR$(3)+CHR$(138+80)+CHR$(128)
790 RETURN
800 BR$(2)=CHR$(128)+CHR$(133+48)
810 FOR X=1 TO 6:BR$(2)=BR$(2)+CHR$(143+48):NEXT X
820 BR$(2)=BR$(2)+CHR$(128)
830 RETURN
840 BR$(1)=CHR$(128)
850 FOR X=1 TO 7:BR$(1)=BR$(1)+CHR$(143+32):NEXT X
860 BR$(1)=BR$(1)+CHR$(138+32)+CHR$(128)
870 RETURN
880 FOR X=1 TO 9:BR$(8)=BR$(8)+CHR$(143+64):NEXT X
890 BR$(8)=BR$(8)+CHR$(138+64)
900 FOR X=1 TO 9:BR$(9)=BR$(9)+CHR$(143+64):NEXT X
910 RETURN
920 I=1
930 FOR X=416 TO 32 STEP -64
940 PRINT@X,A$(I,1);
950 I=I+1
960 NEXT X
970 I=1
980 FOR X=427 TO 43 STEP -64
990 PRINT@X,A$(I,2);
1000 I=I+1
1010 NEXT X
1020 I=1
1030 FOR X=438 TO 54 STEP -64
1040 PRINT@X,A$(I,3);
1050 I=I+1
1060 NEXT X
1070 RETURN
1080 IF CC>1 THEN 1130
1090 IF P=484 THEN A=1
1100 IF P=495 THEN A=2
1110 IF P=506 THEN A=3
1120 RETURN
1130 IF P=484 THEN B=1
1140 IF P=495 THEN B=2
1150 IF P=506 THEN B=3
1160 CC=0
1170 RETURN
1180 FOR I=7 TO 1 STEP -1
1190 IF A$(I,A)<>BL$ THEN 1220
1200 NEXT I
1210 CC=0:RETURN
1220 FOR J=1 TO 7
1230 IF A$(J,B)=BL$ THEN 1250
1240 NEXT J
1250 FOR K=1 TO 7
1260 IF A$(I,A)=BR$(K) THEN 1280
1270 NEXT K
1280 FOR L=1 TO 7
1290 IF A$(J-1,B)=BR$(L) THEN 1320
1300 NEXT L
1310 L=1
1320 IF K<L THEN SOUND 122,10:RETURN
1330 A$(J,B)=A$(I,A)
1340 A$(I,A)=BL$
1350 CO=CO+1
1360 PRINT@7,CO;
1370 GOSUB 920
1380 IF A$(7,3)=BR$(7) THEN 2000
1390 RETURN
1400 REM COMPUTER'S LOGIC
1410 DN=7
1420 T1(1)=1:T2(1)=3:T3(1)=2
1430 NE=1
1440 DD(1)=DN
1450 RZ=0
1460 GOSUB 1480
1470 END
1480 NE=NE+1
1490 DD(NE)=DD(NE-1)-1
1500 T1(NE)=T1(NE-1)
1510 T2(NE)=T3(NE-1)
1520 T3(NE)=T2(NE-1)
1530 IF DD(NE)=1 THEN RZ=RZ+1:A=T1(NE):B=T2(NE):GOSUB 1610:GOTO1540
1531 GOSUB1480
1540 RZ=RZ+1:A=T1(NE-1):B=T2(NE-1):GOSUB 1610
1550 T1(NE)=T3(NE-1)
1560 T2(NE)=T2(NE-1)
1570 T3(NE)=T1(NE-1)
1580 IF DD(NE)=1 THEN RZ=RZ+1:A=T1(NE):B=T2(NE):GOSUB 1610:GOTO1590
1581 GOSUB 1480
1590 NE=NE-1
1600 RETURN
1610 FOR X=1 TO DL:NEXT X
1620 GOSUB 1180
1630 RETURN
1640 FOR I=7 TO 1 STEP -1
1650 IF A$(I,A)<>BL$ THEN RETURN
1660 NEXT I
1670 CC=0:GOTO 460
2000 M$=INKEY$:IFM$=CHR$(13)ORM$="Y"THENRUN
2010 IFM$="N"THENEND
2020 GOTO2000
REM HOT COCO OCT 1983
REM RODRIGUE DUGAL
