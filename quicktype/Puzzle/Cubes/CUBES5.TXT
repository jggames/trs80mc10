10 CLS:CLEAR750:I=32768:J=RND(-(PEEK(9)*256+PEEK(10))):GOSUB30:REM INSTALL COUNTER
20 GOTO70
30 T=16896:GOSUB31:T=I:GOSUB31:EXECI:RETURN
31 READM$:FORJ=1TOLEN(M$)STEP2:POKET,(ASC(MID$(M$,J,1))-65)*16+ASC(MID$(M$,J+1,1))-65:T=T+1:NEXT:RETURN
32 DATA HPAAAIDLDLDLPOECBGKGACEKCGPCCBDLGOAD
33 DATA INCFCABAABNMALMDDKEDJFAINNALNOPNAINPPNDLLNOLMHCGAEEPFPNNPNNMPNNNMKMGJAANHOPCMHDIPPECBGIGAIJHAIAODJ
60 REM
70 DIM C(2,17),L(1,7),K
80 FORI=0TO7
90 READL(0,I)
100 READL(1,I)
110 NEXT:GOSUB2790
120 DATA5,2,3,4,0,7,6,1,1,6,7,0,4,3,2,5
130 GOSUB2410
140 GOSUB2300:Q$="":P$="":O$=P$+CHR$(135):I=USR(0):CLS
141 A$=""+CHR$(140)+CHR$(140)+CHR$(140)+CHR$(140)+CHR$(140)+CHR$(140)+CHR$(140)+CHR$(140)+CHR$(140)+CHR$(141)
150 B$=""+CHR$(129+C(0,15))+CHR$(143+C(0,15))+CHR$(142+C(0,15))+CHR$(129+C(0,16))+CHR$(143+C(0,16))+CHR$(142+C(0,16))
161 B$=B$+CHR$(129+C(0,17))+CHR$(143+C(0,17))+CHR$(142+C(0,17))+CHR$(129+C(0,8))+""
170 C$=""+CHR$(129+C(1,15))+CHR$(131+C(1,15))+CHR$(130+C(1,15))+CHR$(129+C(1,16))+CHR$(131+C(1,16))+CHR$(130+C(1,16))
171 C$=C$+CHR$(129+C(1,17))+CHR$(131+C(1,17))+CHR$(130+C(1,17))+Q$+CHR$(143+C(0,8))+""
180 D$=""+Q$+CHR$(140+C(1,15))+CHR$(140+C(1,15))+Q$+CHR$(140+C(1,16))+CHR$(140+C(1,16))+Q$
181 D$=D$+CHR$(140+C(1,17))+CHR$(140+C(1,17))+CHR$(129+C(0,7))+CHR$(138+C(0,7))+CHR$(143+C(0,8))+""
190 E$=""+CHR$(129+C(2,15))+CHR$(143+C(2,15))+CHR$(142+C(2,15))+CHR$(129+C(2,16))+CHR$(143+C(2,16))+CHR$(142+C(2,16))
191 E$=E$+CHR$(129+C(2,17))+CHR$(143+C(2,17))+CHR$(142+C(2,17))+CHR$(129+C(0,6))+CHR$(133+C(0,7))+CHR$(138+C(0,7))
200 E$=E$+CHR$(136+C(0,8))+""
220 F$=P$+CHR$(143+C(0,6))+CHR$(133+C(0,7))+CHR$(136+C(0,7))+CHR$(135+C(1,8))+""
230 G$=Q$+CHR$(143+C(0,9))+CHR$(143+C(0,9))+Q$+CHR$(143+C(0,10))+CHR$(143+C(0,10))+Q$+CHR$(143+C(0,11))
231 G$=G$+CHR$(143+C(0,11))+Q$+CHR$(143+C(0,6))+Q$+CHR$(130+C(1,7))+CHR$(143+C(1,8))+""
240 H$=Q$+CHR$(143+C(0,9))+CHR$(143+C(0,9))+Q$+CHR$(143+C(0,10))+CHR$(143+C(0,10))+Q$+CHR$(143+C(0,11))
241 H$=H$+CHR$(143+C(0,11))+Q$+CHR$(136+C(0,6))+CHR$(133+C(1,7))+CHR$(138+C(1,7))+CHR$(136+C(1,8))+""
250 I$=P$+CHR$(135+C(1,6))+CHR$(133+C(1,7))+CHR$(136+C(1,7))+CHR$(135+C(2,8))+""
260 J$=Q$+CHR$(143+C(1,9))+CHR$(143+C(1,9))+Q$+CHR$(143+C(1,10))+CHR$(143+C(1,10))+Q$+CHR$(143+C(1,11))
261 J$=J$+CHR$(143+C(1,11))+Q$+CHR$(143+C(1,6))+Q$+CHR$(130+C(2,7))+CHR$(143+C(2,8))+""
270 K$=Q$+CHR$(143+C(1,9))+CHR$(143+C(1,9))+Q$+CHR$(143+C(1,10))+CHR$(143+C(1,10))+Q$+CHR$(143+C(1,11))
271 K$=K$+CHR$(143+C(1,11))+Q$+CHR$(136+C(1,6))+CHR$(133+C(2,7))+CHR$(138+C(2,7))+CHR$(136+C(2,8))+CHR$(135)
280 L$=P$+CHR$(135+C(2,6))+CHR$(133+C(2,7))+CHR$(136+C(2,7))+CHR$(135)
290 M$=Q$+CHR$(143+C(2,9))+CHR$(143+C(2,9))+Q$+CHR$(143+C(2,10))+CHR$(143+C(2,10))+Q$+CHR$(143+C(2,11))
291 M$=M$+CHR$(143+C(2,11))+Q$+CHR$(143+C(2,6))+Q$+CHR$(135)
300 N$=Q$+CHR$(143+C(2,9))+CHR$(143+C(2,9))+Q$+CHR$(143+C(2,10))+CHR$(143+C(2,10))+Q$+CHR$(143+C(2,11))
301 N$=N$+CHR$(143+C(2,11))+Q$+CHR$(136+C(2,6))+CHR$(135)
320 IFUSR(1)>50000THENTI=TI+USR(1):I=USR(0)
330 PRINT@52,A$;:PRINT@83,B$;:PRINT@114,C$;:PRINT@145,D$;:PRINT@176,E$;:PRINT@208,F$;:PRINT@240,G$;:PRINT@272,H$;
410 PRINT@304,I$;:PRINT@336,J$;:PRINT@368,K$;:PRINT@400,L$;:PRINT@432,M$;:PRINT@464,N$;:PRINT@496,O$;
480 PRINT@160,"ROTATION:   ";CHR$(8)CHR$(8);:GOSUB2550
490 M$=INKEY$:IFM$=""THEN490
491 IFM$>" "THENPRINTM$;
500 IFM$="-"THENL=3:CC=1:GOTO510
501 L=1:CC=.
510 IFCC=.THEN530
520 M$=INKEY$:IFM$=""THEN520
521 IFM$>" "THENPRINTM$;
530 FORQ=1TOL:IFASC(M$)>81THENONASC(M$)-81GOSUB680,800,900
550 NEXT:XX=.
560 IFM$="A"THENXX=1:GOTO630
570 IFM$="B"THENXX=2:GOTO630
580 IFM$="D"THENXX=3:GOTO630
590 IFM$="F"THENXX=4:GOTO630
600 IFM$="G"THENXX=5:GOTO630
610 IFM$="H"THENXX=6:GOTO630
612 IFM$="C"THENXX=7:GOTO630
614 IFM$="M"THENXX=8:GOTO630
616 IFM$="V"THENXX=9:GOTO630
620 IFM$="Q"THENGOSUB2510:CLS
621 IFM$="?"THENGOSUB5000
630 IFCC=1THENONXXGOSUB1700,1750,1800,1850,1900,1950,3330,3400,3480:GOTO150
631 ONXXGOSUB2000,2050,2100,2150,2200,2250,3300,3360,3440:GOTO150
650 REM
660 REM *** POUR LA ROTATION R ***
670 REM
680 T=9:R=.:GOSUB960:T=.:R=1:GOSUB960:T1=15:T2=12:T3=3:T4=6:GOSUB1140:T=3:R=.:GOSUB960:T=6:GOSUB960:
740 T=12:GOSUB960:T=15:GOSUB960:RETURN
770 REM
780 REM *** POUR LA ROTATION S ***
790 REM
800 GOSUB2210:GOSUB3450:GOSUB2110
860 RETURN
870 REM
880 REM *** POUR LA ROTATION T ***
890 REM
900 T=15:R=.:GOSUB960:T=3:R=1:GOSUB960:T1=6:T2=.:T3=12:T4=9:GOSUB1140:RETURN
950 REM
951 REM *** ROTATION D'UNE FACE ***
952 REM
960 K=-1:FORI=.TO2:FORJ=TTOT+2:IFI=1THENIFJ=T+1THENNEXT
1020 K=K+1:M(K)=C(I,J):NEXT:NEXT
1050 K=-1:FORI=.TO2:FORJ=TTOT+2:IFI=1THENIFJ=T+1THENNEXT
1090 K=K+1:C(I,J)=M(L(R,K)):NEXT:NEXT:RETURN
1130 REM
1131 REM *** TRANSFERT DES FACES ***
1132 REM
1140 K=-1:FORI=.TO2:FORJ=T1TOT1+2:K=K+1:M(K)=C(I,J):NEXT:NEXT
1220 FORI=.TO2:FORJ=.TO2:C(I,J+T1)=C(I,J+T2):C(I,J+T2)=C(I,J+T3):C(I,J+T3)=C(I,J+T4):NEXT:NEXT
1280 K=-1:FORI=.TO2:FORJ=T4TOT4+2:K=K+1:C(I,J)=M(K):NEXT:NEXT:RETURN
1350 REM
1360 REM *** ROTATION POUR -A ET +F ***
1380 FORI=.TO2:M=C(R1,15+I):C(R1,15+I)=C(2-I,R2):C(2-I,R2)=C(R3,5-I):C(R3,5-I)=C(I,R4):C(I,R4)=M:NEXT:RETURN
1420 REM
1440 REM *** ROTATION POUR +A ET -F ***
1440 FORI=.TO2:M=C(R1,15+I):C(R1,15+I)=C(I,R2):C(I,R2)=C(R3,5-I):C(R3,5-I)=C(2-I,R4):C(2-I,R4)=M:NEXT:RETURN
1480 REM
1490 REM *** ROTATION POUR D ET G ***
1510 FORI=.TO2:M=C(I,R1):C(I,R1)=C(I,R2):C(I,R2)=C(2-I,R3):C(2-I,R3)=C(I,R4):C(I,R4)=M:NEXT:RETURN
1590 REM
1600 REM *** ROTATION POUR H ET B ***
1620 FORI=.TO2:M(I)=C(T0,I):C(T0,I)=C(T0,T1+I):C(T0,T1+I)=C(T0,9+I):C(T0,9+I)=C(T0,T2+I):C(T0,T2+I)=M(I):NEXT:RETURN
1700 REM *** ROTATION -A ***
1710 T=.:R=1:GOSUB960:R1=.:R2=12:R3=2:R4=8:GOSUB1380:RETURN
1750 REM *** ROTATION -B ***
1760 T=3:R=.:GOSUB960:T0=2:T1=6:T2=12:GOSUB1600:RETURN
1799 REM *** ROTATION -D ***
1800 T=6:R=1:GOSUB960:R1=11:R2=17:R3=.:R4=5:GOSUB1510:RETURN
1850 REM *** ROTATION -F ***
1860 T=9:R=.:GOSUB960:R1=2:R2=14:R3=.:R4=6:GOSUB1380:RETURN
1899 REM *** ROTATION -G ***
1900 T=12:R=.:GOSUB960:R1=9:R2=15:R3=2:R4=3:GOSUB1510:RETURN
1950 REM *** ROTATION -H ***
1960 T=15:R=1:GOSUB960:T0=.:T1=6:T2=12:GOSUB1600:RETURN
2000 REM *** ROTATION +A ***
2010 T=.:R=.:GOSUB960:R1=.:R2=8:R3=2:R4=12:GOSUB1440:RETURN
2050 REM *** ROTATION +B ***
1760 T=3:R=1:GOSUB960:T0=2:T1=12:T2=6:GOSUB1600:RETURN
2100 REM *** ROTATION +D ***
2110 T=6:R=.:GOSUB960:R1=11:R2=5:R3=.:R4=17:GOSUB1510:RETURN
2150 REM *** ROTATION +F ***
2160 T=9:R=1:GOSUB960:R1=2:R2=6:R3=.:R4=14:GOSUB1440:RETURN
2200 REM *** ROTATION +G ***
2210 T=12:R=1:GOSUB960:R1=9:R2=3:R3=2:R4=15:GOSUB1510:RETURN
2250 REM *** ROTATION +H ***
2260 T=15:R=.:GOSUB960:T0=0:T1=12:T2=6:GOSUB1600:RETURN
2300 REM *** MELANGE DU CUBE ***
2310 GOSUB1800:GOSUB2150
2320 GOSUB1800:GOSUB880
2330 GOSUB1800:GOSUB2150
2340 GOSUB2250:GOSUB1900
2350 FORH=.TO10
2360 Q=RND(15):IFQ<9THENONQGOSUB660,780,880,1700,1750,1800,1850,1900
2380 IFQ>8THENONQ-8GOSUB1950,2000,2050,2100,2150,2200,2250
2390 NEXT:RETURN
2410 REM *** MISE EN PLACE DES COULEURS ***
2420 FORI=.TO2:FORJ=.TO2:C(I,J)=16:C(I,J+3)=48:C(I,J+6)=32:C(I,J+9)=64:C(I,J+12)=.:C(I,J+15)=112:NEXT:NEXT:RETURN
2510 REM *** FIN DE PROGRAMME ***
2520 PRINT@224,"DO YOU WANT TO";
2530 PRINT@256,"QUIT (Y/N)?";
2535 M$=INKEY$:IFM$=""THEN2535
2540 IFM$="Y"THENFI=1:GOTO2670
2541 HH=0:RETURN
2550 REM *** CUBE FINI? ***
2560 M(0)=C(0,0):M(1)=C(0,3):M(2)=C(0,6):M(3)=C(0,9)
2580 FORI=.TO2:FORJ=.TO2:IFC(I,J)<>M(0)THEN2660
2610 IFC(I,J+3)<>M(1)THEN2660
2620 IFC(I,J+6)<>M(2)THEN2660
2630 IFC(I,J+9)<>M(3)THEN2660
2640 NEXT:NEXT
2650 GOTO2670
2660 RETURN
2670 REM *** FIN DU CUBE ***
2680 CLS
2690 PRINT@5,"**********************"
2700 PRINT@37,"* THE DRAGON'S CUBES *"
2710 PRINT@69,"**********************"
2720 IFFI=1THENPRINT@192,"ALL DONE FOR TODAY, EH!":GOTO2740
2730 PRINT@192,"YOU FINISHED THE CUBE!"
2740 PRINT@224,"WORKING TIME WAS";:GOSUB3210:PRINTTE$;
2750 PRINT@288,"FOR THE PAIN IN YOUR HEAD, I"
2760 PRINT@320,"RECOMMEND ASPIRIN."
2770 PRINT@416,"DO YOU WANT TO TRY AGAIN?"
2780 M$=INKEY$:IFM$=""THEN2780
2781 IFM$="Y"THENRUN
2782 IFM$="N"THENEND
2783 GOTO2780
2790 REM *** GRAPHIQUE ***
2800 GOSUB4000
3200 RETURN
3210 REM *** MESURE TEMPS ***
3220 TI=TI+USR(1)
3230 TH$=STR$(INT(TI/179400))
3240 TI=TI-(INT(TI/179400)*179400)
3250 TM$=STR$(INT(TI/2990))
3260 TI=TI-(INT(TI/2990)*2990)
3270 TS$=STR$(INT(TI/60))
3280 TE$=TH$+"H"+TM$+"M"+TS$+"S"
3290 RETURN
3300 REM *** ROTATION +C ***
3310 R1=1:R2=7:R3=1:R4=13:GOTO1440
3330 REM *** ROTATION -C ***
3340 R1=1:R2=13:R3=1:R4=7:GOTO1380
3360 REM *** ROTATION +M ***
3370 M0=6:M1=12:GOSUB3520:RETURN
3400 REM *** ROTATION -M ***
3410 M0=12:M1=6:GOSUB3520:RETURN
3440 REM *** ROTATION +V ***
3450 V0=4:V1=16:GOSUB3610:RETURN
3480 REM *** ROTATION -V ***
3490 V0=16:V1=4:GOSUB3610:RETURN
3520 REM *** ROTATION POUR M ***
3530 FORI=.TO2:M=C(1,9+I):C(1,9+I)=C(1,M0+I):C(1,M0+I)=C(1,I):C(1,I)=C(1,M1+I):C(1,M1+I)=M:NEXT:RETURN
3610 REM *** ROTATION POUR V ***
3620 FORI=.TO2:M=C(I,10):C(I,10)=C(I,V0):C(I,V0)=C(2-I,1):C(2-I,1)=C(I,V1):C(I,V1)=M:NEXT:RETURN
4000 CLS
4001 PRINT"    ";
4002 PRINT"  THE   T";
4003 PRINT"DRAGON'S";
4004 PRINT"CUBES";
4005 PRINT" BY  ";
4006 PRINT" BRUNO ";
4007 PRINT"CARTON";
4008 PRINT"";
4009 PRINT" ?=HELP";
4010 PRINT"";
4011 PRINT"";
4012 PRINT"";
4013 PRINT"";
4014 PRINT"RS";
4015 PRINT"";
4016 PRINT"";:RETURN
5000 IFHH=1THEN5050
5010 PRINT@21,CHR$(94)"G  V  D";:PRINT@50,CHR$(95)"A";:PRINT@113,"C";:PRINT@175,"F";:PRINT@270,CHR$(95)"H";
5020 PRINT@367,"M";:PRINT@463,"B";:PRINT@325,"";:PRINT@357,"T";:PRINT@389,"S";
5030 PRINT@421,""CHR$(95)"R";:PRINT@453,"";:HH=1:RETURN
5050 PRINT@21,"        ";:PRINT@50,"  ";:PRINT@113," ";:PRINT@175," ";:PRINT@270,"  ";
5060 PRINT@367," ";:PRINT@463," ";:PRINT@325,"      ";:PRINT@357,"      ";:PRINT@389,"      ";
5070 PRINT@421,"      ";:PRINT@453,"      ";:HH=0:RETURN
