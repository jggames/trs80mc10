100 REM CLOAD MAGAZINE MARCH 1982
500 CLS:CLEAR1000:DIMA1$(6,3,3):DIMQQ(6,3,3)
510 DIMQ3(1,12,3):DIMQ1(40):DIMBL(300):F=1:X=1:BP=1:B=1:B1=1:B2=1:B3=1
520 GOTO1320
530 CLS0:PRINT@64,"SIMULATION OF";:PRINT@363,"bACK";:PRINT@384,"uNDER lEFT tOP rIGHT";:PRINT@427,"fRONT";
535 PRINT@376,"6 4 1 3";:PRINT@348,"5";:PRINT@412,"2";:PRINT@439,"FACE #'S";
540 PRINT@96,"RUBIK'S CUBE ";
590 RETURN
600 GOSUB530
605 PRINT@480,"ENTER YOUR MOVE       X TO EXIT";
606 QA=0
610 GOSUB630
620 GOTO1040
630 FORX=1TO6:B=4:C=64
640 GOSUB2400
700 FORY=1TO3:FORZ=1TO3
710 PRINT@(NA+Y*B+Z*C)/2,A1$(X,Y,Z);
720 NEXTZ,Y,X:RETURN
730 FORY=1TO3:A1$(D,Y,E)=A1$(F,Y,G):NEXTY:RETURN
740 FORZ=1TO3:A1$(D,E,Z)=A1$(F,G,Z):NEXTZ:RETURN
750 FORZ=1TO3:A1$(D,Z,E)=A1$(F,G,Z):NEXTZ:RETURN
760 FORZ=1TO3:A1$(D,E,Z)=A1$(F,Z,G):NEXTZ:RETURN
770 D=0:E=0:F=4:G=H:GOSUB730
780 D=4:E=H:F=1:GOSUB730
790 D=1:F=3:G=4-G:GOSUB730
800 D=3:E=G:F=6:GOSUB730
810 D=6:F=0:G=0:GOSUB730
820 IFH=1THENH1=5:GOSUB1010
830 IFH=3THENH1=2:GOSUB1010
840 RETURN
850 D=0:E=0:F=1:G=H:GOSUB740
860 D=1:E=G:F=2:GOSUB740
870 D=2:F=6:G=4-G:GOSUB740
880 D=6:E=G:F=5:GOSUB740
890 D=5:F=0:G=0:GOSUB740
900 IFH=1THENH1=4:GOSUB1010
910 IFH=3THENH1=3:GOSUB1010
920 RETURN
930 D=0:E=0:F=3:G=H:GOSUB740
940 D=3:E=G:F=2:GOSUB760
950 D=2:F=4:G=4-G:GOSUB750
960 D=4:E=G:F=5:GOSUB760
970 D=5:F=0:G=0:GOSUB750
980 IFH=1THENH1=1:GOSUB1010
990 IFH=3THENH1=6:GOSUB1010
1000 RETURN
1010 FORX=1TO2:A1$(0,0,X)=A1$(H1,1,X):A1$(H1,1,X)=A1$(H1,4-X,1)
1020 A1$(H1,4-X,1)=A1$(H1,3,4-X):A1$(H1,3,4-X)=A1$(H1,X,3)
1030 A1$(H1,X,3)=A1$(0,0,X):NEXTX:RETURN
1040 J=0:I=0:M=0:PRINT@0,"ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ";:PRINT@0,;
1045 IFQATHENPRINT@480,"SOLVED. HIT X TO RETURN TO MENU";
1050 B$=INKEY$:IFB$=""THEN1050
1060 IFB$=CHR$(8)THEN1040
1080 IFB$="*"THENI=1:PRINT"*";:GOTO1050
1090 IFB$="R"THENJ=2:H=3-I
1100 IFB$="L"THENJ=2:H=1+I:M=1
1110 IFB$="B"THENJ=1:H=1+I
1120 IFB$="F"THENJ=1:H=3-I:M=1
1130 IFB$="T"THENJ=3:H=1+I:M=1
1140 IFB$="U"THENJ=3:H=3-I
1160 IFB$="X"THEN1440
1170 IFJ=0THEN1050
1180 PRINTB$;
1190 B$=INKEY$:IFB$=""THEN1190
1200 IFB$=CHR$(8)THEN1040
1210 K=VAL(B$):IFK=1ORK=2ORK=3THEN1230
1220 GOTO1190
1230 PRINTK;
1240 IFM=1THENK=4-K
1250 FORL=1TOK:ONJGOSUB770,850,930:NEXTL
1260 GOSUB630:GOTO1040
1270 PRINT"SHUFFLING...":FORL=1TO20:J=RND(3):H=RND(3):ONJGOSUB770,850,930
1280 NEXTL
1290 PRINT"COMPUTER SOLVE THE CUBE (Y/N)?";
1300 A$=INKEY$:IFA$=""THEN1300
1301 PRINTA$:IFA$="Y"THENQA=1:GOTO1640
1310 GOTO600
1320 PRINT"USE ORIGINAL COLORS (Y/N)?";
1340 A$=INKEY$:IFA$=""THEN1340
1341 PRINTA$:IFA$="N"THEN1430
1342 PRINT"ONE MOMENT..."
1350 A$(1)="ˇˇ":A$(2)="üü":A$(3)="ØØ":A$(4)="èè":A$(5)="œœ":A$(6)="øø"
1360 FORX=1TO6:FORY=1TO3:FORZ=1TO3:A1$(X,Y,Z)=A$(X):NEXTZ,Y,X
1380 PRINT"SHUFFLE CUBE (Y/N)?";
1390 A$=INKEY$:IFA$=""THEN1390
1391 PRINTA$:IFA$="Y"THEN1270
1400 PRINT"CERTAIN SETUP (Y/N)?";
1410 A$=INKEY$:IFA$=""THEN1410
1411 PRINTA$:IFA$="Y"THEN1470
1415 QA=0
1420 GOTO600
1430 PRINT"ENTER THE SIX COLORS (TOP,FRONT,RIGHT,LEFT,BEHIND,UNDER). SHIFT-Q TWICE FOR EACH";
1431 INPUTA$(1),A$(2),A$(3),A$(4),A$(5),A$(6):GOTO1360
1440 CLS:PRINT"START OVER FROM BEGINNING (Y/N)?";
1450 A$=INKEY$:IFA$=""THEN1450
1451 PRINTA$:PRINT:IFA$="Y"THEN500
1460 GOTO1290
1470 FORM1=1TO6:FORM2=1TO3:FORM3=1TO3:A1$(M1,M2,M3)="--"
1480 NEXTM3,M2,M1:GOSUB530
1485 PRINT@480,"CTRL-0 OR CTRL-A THEN HIT ENTER";:POKE17026,191
1490 FORM1=1TO6:FORM2=1TO3:FORM3=1TO3
1500 PRINT@0,"ADDRESS (FACE,C,R):";M1;M2;M3;
1510 A$=CHR$(PEEK(17026)-(PEEK(17026)<128)*128):A1$(M1,M2,M3)=A$+A$:GOSUB2470
1520 A$=INKEY$:IFA$=""THEN1510
1522 IFA$=CHR$(8)THENPRINTCHR$(8)CHR$(8)"ÄÄ";:M3=M3+(M3>1):GOTO1500
1523 IFA$<>CHR$(13)THEN1510
1530 NEXTM3,M2,M1
1540 FORX=1TO6:A2$(X)="123":NEXTX

REM INCOMPLETE FOR *
1550 M4=0:FORM1=1TO6:FORM2=1TO3:FORM3=1TO3
1560 FORM5=1TOM4:IFA1$(M1,M2,M3)=A2$(M5)THEN1565
1561 GOTO1570
1565 M(M5)=M(M5)+1:IFM(M5)>9THENCC=M5:M5=M4:NEXTM5:M5=CC:CC=M3:M3=3:NEXTM3:M3=CC:CC=M2:MC=3:NEXTM2:M2=CC:GOTO1590
1566 CC=M5:M5=M4:NEXTM5:M5=CC:GOTO1580
1570 NEXTM5:M4=M4+1:IFM4>6THENCC=M3:M3=3:NEXTM3:M3=CC:CC=M2:MC=3:NEXTM2:M2=CC:CC=M1:M1=6:NEXTM1:M1=CC:GOTO1590
1571 M(M4)=1:A2$(M4)=A1$(M1,M2,M3)
1580 NEXTM3,M2,M1:CLS:GOTO1290

1590 GOSUB530:GOSUB630:PRINT@0,"ENTER CORRECTIONS (0,0,0=DONE)";:PRINT@448,""
1610 PRINT@448,;:INPUT"ENTER FACE,C,R";M1,M2,M3
1620 IFM1=0THEN1540
1625 PRINT@448,;:A1$(M1,M2,M3)="??":GOSUB2470
1630 PRINT@448,"":PRINT@448,;:INPUT"INPUT COLOR BLOCKS";A1$(M1,M2,M3):GOSUB2470:GOTO1610

1640 FORX=1TO6:A$(X)=A1$(X,2,2):NEXTX:PRINT:PRINT"THE COMPUTER IS THINKING..."

REM INCOMPLTED FORS *
1660 FORX=1TO6:FORY=1TO3:FORZ=1TO3
1670 FORQ=1TO6:IFA$(Q)=A1$(X,Y,Z)THENQQ(X,Y,Z)=Q:CC=Q:Q=6:NEXTQ:Q=CC:GOTO1690
1680 NEXTQ:CC=Z:Z=3:NEXTZ:Z=CC:CC=Y:Y=3:NEXTY:Y=CC:CC=X:X=6:NEXTX:X=CC:GOTO1590
1690 NEXTZ,Y,X

1700 RESTORE:FORB=1TO8:FORC=1TO3
1710 READX,Z,Y:Q3(0,B,C)=QQ(X,Y,Z):NEXTC,B
1720 DATA1,1,1,5,3,3,4,1,3,1,3,1,4,3,3,2,1,1
1730 DATA1,3,3,2,1,3,3,1,1,1,1,3,3,3,1,5,3,1
1740 DATA6,3,3,4,1,1,5,1,3,6,1,3,2,3,1,4,3,1
1750 DATA6,1,1,3,1,3,2,3,3,6,3,1,5,1,1,3,3,3

REM INCOMPLTED FOR *
1760 FORX=1TO8:B=Q3(0,X,1)+Q3(0,X,2)+Q3(0,X,3)
1770 IFB=10THENQ3(0,X,0)=1:GOTO1860
1780 IFB=7THENQ3(0,X,0)=2:GOTO1860
1790 IFB=6THENQ3(0,X,0)=3:GOTO1860
1800 IFB=9THENQ3(0,X,0)=4:GOTO1860
1810 IFB=15THENQ3(0,X,0)=5:GOTO1860
1820 IFB=12THENQ3(0,X,0)=6:GOTO1860
1830 IFB=11THENQ3(0,X,0)=7:GOTO1860
1840 IFB=14THENQ3(0,X,0)=8:GOTO1860
1850 CC=X:X=8:NEXTX:X=CC:GOTO1590
1860 NEXTX

REM INCOMPLETED FOR *
1870 FORX=1TO8:FORY=1TO3:IFQ3(0,X,Y)=1ORQ3(0,X,Y)=6THENQ3(0,X,1)=Y:CC=Y:Y=3:NEXTY:Y=CC:GOTO1890
1880 NEXTY:CC=X:X=8:NEXTX:X=CC:GOTO1590
1890 NEXTX

1900 FORB=1TO12:FORC=1TO2:READX,Y,Z:Q3(1,B,C)=QQ(X,Y,Z):NEXTC,B
1910 DATA1,1,2,4,3,2,1,2,3,2,2,1,1,3,2,3,1,2,1,2,1,5,2,3
1920 DATA5,3,2,4,2,1,2,1,2,4,2,3,2,3,2,3,2,1,5,1,2,3,2,3
1930 DATA6,3,2,4,1,2,6,2,1,2,2,3,6,1,2,3,3,2,6,2,3,5,2,1

REM INCOMPLETED FOR *
1940 FORX=1TO12:B=Q3(1,X,1)+Q3(1,X,2):C=Q3(1,X,1):IFQ3(1,X,2)<CTHENC=Q3(1,X,2)
1950 IFB=5THENIFC=1THENQ3(1,X,0)=1:GOTO2080
1960 IFB=3THENQ3(1,X,0)=2:GOTO2080
1970 IFB=4THENQ3(1,X,0)=3:GOTO2080
1980 IFB=6THENIFC=1THENQ3(1,X,0)=4:GOTO2080
1990 IFB=9THENIFC=4THENQ3(1,X,0)=5:GOTO2080
2000 IFB=6THENQ3(1,X,0)=6:GOTO2080
2010 IFB=5THENQ3(1,X,0)=7:GOTO2080
2020 IFB=8THENIFC=3THENQ3(1,X,0)=8:GOTO2080
2030 IFB=10THENQ3(1,X,0)=9:GOTO2080
2040 IFB=8THENQ3(1,X,0)=10:GOTO2080
2050 IFB=9THENQ3(1,X,0)=11:GOTO2080
2060 IFB=11THENQ3(1,X,0)=12:GOTO2080
2070 CC=X:X=12:NEXTX:X=CC:GOTO1590
2080 NEXTX

REM INCOMPLTED FOR *
2090 FORX=1TO12:FORY=1TO2:IFQ3(1,X,Y)=1ORQ3(1,X,Y)=6THENQ3(1,X,1)=Y:CC=Y:Y=2:NEXTY:Y=CC:GOTO2120
2100 NEXTY:FORY=1TO2:IFQ3(1,X,Y)=5ORQ3(1,X,Y)=2THENQ3(1,X,1)=Y:CC=Y:Y=2:NEXTY:Y=CC:GOTO2120
2110 NEXTY:CC=X:X=12:NEXTX:X=CC:GOTO1590
2120 NEXTX

2130 B=1:FORX=1TO8:Q1(B)=Q3(0,X,0)*2-1:Q1(B+1)=Q3(0,X,1):B=B+2:NEXTX
2140 FORX=1TO12:Q1(B)=Q3(1,X,0)*2+15:Q1(B+1)=Q3(1,X,1):B=B+2:NEXTX
2180 PRINT"*";
2190 GOTO2520
2220 Q1(0)=Q1(5):Q1(5)=Q1(13):Q1(13)=Q1(15):Q1(15)=Q1(7):Q1(7)=Q1(0):Q1(0)=Q1(6)
2221 Q1(6)=Q1(14)+1:Q1(14)=Q1(16)+2:Q1(16)=Q1(8)+1:Q1(8)=Q1(0)+2
2230 Q1(0)=Q1(21):Q1(21)=Q1(29):Q1(29)=Q1(37):Q1(37)=Q1(31):Q1(31)=Q1(0)
2231 Q1(0)=Q1(22):Q1(22)=Q1(30):Q1(30)=Q1(38):Q1(38)=Q1(32):Q1(32)=Q1(0):GOTO2340
2240 Q1(0)=Q1(1):Q1(1)=Q1(9):Q1(9)=Q1(11):Q1(11)=Q1(3):Q1(3)=Q1(0)
2241 Q1(0)=Q1(2):Q1(2)=Q1(10)+1:Q1(10)=Q1(12)+2:Q1(12)=Q1(4)+1:Q1(4)=Q1(0)+2
2250 Q1(0)=Q1(17):Q1(17)=Q1(25):Q1(25)=Q1(33):Q1(33)=Q1(27):Q1(27)=Q1(0):Q1(0)=Q1(18)
2251 Q1(18)=Q1(26):Q1(26)=Q1(34):Q1(34)=Q1(28):Q1(28)=Q1(0):GOTO2340
2260 Q1(0)=Q1(1):Q1(1)=Q1(7):Q1(7)=Q1(15):Q1(15)=Q1(9):Q1(9)=Q1(0):Q1(0)=Q1(2)
2261 Q1(2)=Q1(8)+2:Q1(8)=Q1(16)+1:Q1(16)=Q1(10)+2:Q1(10)=Q1(0)+1
2270 Q1(0)=Q1(23):Q1(23)=Q1(31):Q1(31)=Q1(39):Q1(39)=Q1(25):Q1(25)=Q1(0):Q1(0)=Q1(24)
2271 Q1(24)=Q1(32)+1:Q1(32)=Q1(40)+1:Q1(40)=Q1(26)+1:Q1(26)=Q1(0)+1:GOTO2340
2280 Q1(0)=Q1(3):Q1(3)=Q1(11):Q1(11)=Q1(13):Q1(13)=Q1(5):Q1(5)=Q1(0):Q1(0)=Q1(4)
2281 Q1(4)=Q1(12)+1:Q1(12)=Q1(14)+2:Q1(14)=Q1(6)+1:Q1(6)=Q1(0)+2
2290 Q1(0)=Q1(19):Q1(19)=Q1(27):Q1(27)=Q1(35):Q1(35)=Q1(29):Q1(29)=Q1(0):Q1(0)=Q1(20)
2291 Q1(20)=Q1(28)+1:Q1(28)=Q1(36)+1:Q1(36)=Q1(30)+1:Q1(30)=Q1(0)+1:GOTO2340
2300 Q1(0)=Q1(1):Q1(1)=Q1(3):Q1(3)=Q1(5):Q1(5)=Q1(7):Q1(7)=Q1(0):Q1(0)=Q1(2):Q1(2)=Q1(4):Q1(4)=Q1(6):Q1(6)=Q1(8):Q1(8)=Q1(0)
2310 Q1(0)=Q1(17):Q1(17)=Q1(19):Q1(19)=Q1(21):Q1(21)=Q1(23):Q1(23)=Q1(0):Q1(0)=Q1(18)
2311 Q1(18)=Q1(20):Q1(20)=Q1(22):Q1(22)=Q1(24):Q1(24)=Q1(0):GOTO2340
2320 Q1(0)=Q1(9):Q1(9)=Q1(15):Q1(15)=Q1(13):Q1(13)=Q1(11):Q1(11)=Q1(0):Q1(0)=Q1(10)
2321 Q1(10)=Q1(16):Q1(16)=Q1(14):Q1(14)=Q1(12):Q1(12)=Q1(0)
2330 Q1(0)=Q1(40):Q1(40)=Q1(38):Q1(38)=Q1(36):Q1(36)=Q1(34):Q1(34)=Q1(0):Q1(0)=Q1(39)
2331 Q1(39)=Q1(37):Q1(37)=Q1(35):Q1(35)=Q1(33):Q1(33)=Q1(0)
2340 FORX=2TO16STEP2:IFQ1(X)>3THENQ1(X)=Q1(X)-3
2350 NEXTX
2360 FORX=20TO40STEP2:IFQ1(X)=3THENQ1(X)=1
2380 NEXTX:RETURN
2400 IFX=1THENNA=285
2410 IFX=2THENNA=477
2420 IFX=3THENNA=552:C=-C
2430 IFX=4THENNA=272
2440 IFX=5THENNA=109:B=-B
2450 IFX=6THENNA=517:C=-C
2460 RETURN
2470 B=4:C=64:X=M1:GOSUB2400:PRINT@(NA+B*M2+C*M3)/2,A1$(M1,M2,M3);:RETURN
2480 BP=BP+1:BL(BP)=B:B1=INT(B/3):B2=B-B1*3+1
2490 FORB3=1TOB2:ONB1+1GOSUB2220,2240,2260,2280,2300,2320,2510
2500 NEXTB3
2510 RETURN
2520 BP=0
2530 C=19:GOSUB5000:C=21:GOSUB5000:C=23:GOSUB5000:C=17:GOSUB5000:PRINT"*";
2540 GOSUB5300:F=3:GOSUB5430:PRINT"*";
2550 GOSUB5500:PRINT"*";
2560 GOSUB5670
2570 GOSUB5700:PRINT"*";
2580 GOSUB5740:GOSUB5830
2590 IFQ1(9)<>9THENB=15:GOSUB2480:GOTO2590
3900 PRINT"*";:GOSUB4100

REM BAD ELSE REMOVAL IN DOUBLE IF *
3910 FORX=1TO39STEP2:IFQ1(X)<>XTHENIFQ1(X+1)<>1THENCC=X:X=39:NEXTX:X=CC:GOTO3915
3911 NEXTX:GOTO3920

3915 PRINT"ERROR";
3920 PRINT:INPUT"COMPUTER READY, HIT ENTER";A$
4000 GOSUB5130:GOTO1040
4100 FORX=2TOBP:B=INT(BL(X)/3)*3:C=BL(X)-B:D=INT(BL(X-1)/3)*3:E=BL(X-1)-D:IFB=DTHENBL(X-1)=18:BL(X)=BL(X)+E+1:GOTO4120
4110 NEXTX:RETURN
4120 IFC+E=2THENBL(X)=18
4130 IFC+E>2THENBL(X)=BL(X)-4
4140 IFBL(X)=19THENBL(X)=18
4150 GOTO4110
5000 D=18:IFQ1(29)=CTHENB=9:GOTO5090
5010 IFQ1(17)=CTHENB=4:GOTO5090
5020 IFQ1(19)=CTHENB=10:GOTO5090
5030 IFQ1(21)=CTHENB=1:GOTO5090
5040 IFQ1(23)=CTHENB=7:GOTO5090
5050 IFQ1(27)=CTHENB=11:GOTO5090
5060 IFQ1(31)=CTHENB=8:D=6:GOTO5090
5070 IFQ1(25)=CTHENB=6:D=8:GOTO5090
5080 GOTO5100
5090 GOSUB2480
5100 IFQ1(35)=CTHEN5110
5101 B=15:GOSUB2480:GOTO5100
5110 B=D:GOSUB2480:IFQ1(36)=1THENB=10:GOSUB2480:B=12:GOSUB2480:RETURN
5120 B=9:GOSUB2480:B=12:GOSUB2480:B=5:GOSUB2480:RETURN

5130 B1=1:J4=0:GOSUB530
5132 FORJ1=1TOBP:J2=BL(J1):J3=INT(J2/3):J2=J2-J3*3+1:IFJ3=6THEN5210
5135 PRINT@0,"MOVE  "J2;TAB(16)"# OF MOVES"B1;:B1=B1+1
5140 IFJ3=0THENJ=2:H=3:PRINT@6,"R";:GOTO5200
5150 IFJ3=1THENJ=2:H=1:J2=4-J2:PRINT@6,"L";:GOTO5200
5160 IFJ3=2THENJ=1:H=1:PRINT@6,"B";:GOTO5200
5170 IFJ3=3THENJ=1:H=3:J2=4-J2:PRINT@6,"F";:GOTO5200
5180 IFJ3=4THENJ=3:H=1:J2=4-J2:PRINT@6,"T";:GOTO5200
5190 IFJ3=5THENJ=3:H=3:PRINT@6,"U";
5200 FORL=1TOJ2:ONJGOSUB770,850,930:GOTO5220
5210 NEXTJ1:RETURN
5220 GOSUB630
5230 IFCC$="C"THENIFINKEY$=""THENPRINT@480,"HIT ANY KEY FOR SINGLE STEP    ";:GOTO5210
5231 PRINT@480,"C=CONTINUOUS, OR SPACE FOR NEXT";
5232 CC$=INKEY$:IFCC$=""THEN5232
5233 IFCC$="C"THEN5230
5234 IFCC$=" "THEN5210
5235 GOTO5232
5300 C=5:FORX=1TO4:C1(X)=0:NEXTX:FORX=1TO7STEP2:IFQ1(X)=XTHENIFQ1(X+1)=1THENC1((X+1)/2)=1
5310 NEXTX
5320 IFC1(1)=1THENIFC1(2)=1THENIFC1(3)=1THENIFC1(4)=1THENRETURN

REM INCOMPLETE FOR *
5330 FORF=1TO4
5340 IFQ1(14)=3AND(Q1(13)=1ORQ1(13)=3ORQ1(13)=5ORQ1(13)=7)THENGOSUB5400:B=9:GOSUB2480:B=15:GOSUB2480:B=11:GOSUB2480:GOTO5455
5350 IFQ1(14)=2AND(Q1(13)=1ORQ1(13)=3ORQ1(13)=5ORQ1(13)=7)THENGOSUB5400:B=2:GOSUB2480:B=17:GOSUB2480:B=0:GOSUB2480:GOTO5455
5360 IFQ1(14)=1AND(Q1(13)=1ORQ1(13)=3ORQ1(13)=5ORQ1(13)=7)THEN5365
5361 GOTO5370
5365 GOSUB5400:B=9:GOSUB2480:B=17:GOSUB2480:B=11:GOSUB2480:B=2:GOSUB2480:B=16:GOSUB2480:B=0:GOSUB2480:GOTO5455
5370 B=15:GOSUB2480

REM INCOMPLETE FOR *
5380 NEXTF:FORF=1TO4:IFC1(F)=0THENGOSUB5430:B=2:GOSUB2480:B=15:GOSUB2480:B=0:GOSUB2480:CC=F:F=4:NEXTF:F=CC:GOTO5330
5390 NEXTF
5400 IFC=Q1(13)THENC1((C+1)/2)=1:RETURN
5410 B=12:GOSUB2480:C=C+2:IFC=9THENC=1
5420 GOTO5400
5430 IFC+1=F*2THENRETURN
5440 B=12:GOSUB2480:C=C+2:IFC=9THENC=1
5450 GOTO5430

5455 CC=F:F=4:NEXTF:F=CC:GOTO5320

5500 FORF=1TO4:C1(F)=0:NEXTF

5510 FORF=1TO4:IFQ1(F*2+23)=F*2+23ANDQ1(F*2+24)=1THENC1(F)=1
5520 NEXTF

REM INCOMPLETE FOR *
5530 FORF=1TO4:IFC1(F)=0THENCC=F:F=4:NEXTF:F=CC:GOTO5540
5531 NEXTF:RETURN

5535 CC=F:F=4:NEXTF:F=CC:GOTO5530

REM UNCOMPLETED FOR *
5540 FORF=1TO4:IFQ1(37)=27ANDQ1(38)=2THEN5545
5541 GOTO5550
5545 B=3:GOSUB2480:B=17:GOSUB2480:B=5:GOSUB2480:B=17:GOSUB2480:B=11:GOSUB2480:B=15:GOSUB2480:B=9:GOSUB2480:C1(2)=1:GOTO5535
5550 IFQ1(39)=27ANDQ1(40)=1THENGOSUB6020:C1(2)=1:GOTO5535
5560 IFQ1(39)=29ANDQ1(40)=1THEN5565
5561 GOTO5570
5565 B=9:GOSUB2480:B=17:GOSUB2480:B=11:GOSUB2480:B=17:GOSUB2480:B=2:GOSUB2480:B=15:GOSUB2480:B=0:GOSUB2480:C1(3)=1:GOTO5535
5570 IFQ1(33)=29ANDQ1(34)=2THENGOSUB6030:C1(3)=1:GOTO5535
5580 IFQ1(33)=31ANDQ1(34)=2THEN5585
5581 GOTO5590
5585 B=0:GOSUB2480:B=17:GOSUB2480:B=2:GOSUB2480:B=17:GOSUB2480:B=8:GOSUB2480:B=15:GOSUB2480:B=6:GOSUB2480:C1(4)=1:GOTO5535
5590 IFQ1(35)=31ANDQ1(36)=1THENGOSUB6040:C1(4)=1:GOTO5535
5600 IFQ1(35)=25ANDQ1(36)=1THEN5605
5601 GOTO5610
5605 B=6:GOSUB2480:B=17:GOSUB2480:B=8:GOSUB2480:B=17:GOSUB2480:B=5:GOSUB2480:B=15:GOSUB2480:B=3:GOSUB2480:C1(1)=1:GOTO5535
5610 IFQ1(37)=25ANDQ1(38)=2THENGOSUB6010:C1(1)=1:GOTO5535
5620 B=15:GOSUB2480:NEXTF

REM INCOMPLETE FOR *
5630 FORF=1TO4:IFC1(F)=0THENCC=F:F=4:NEXTF:F=CC:GOTO5650
5640 NEXTF
5650 ONFGOSUB6010,6020,6030,6040
5660 GOTO5540

REM INCOMPLETE FOR?
5670 FORF=1TO4:IFQ1(13)-2=Q1(15)ORQ1(13)+6=Q1(15)THEN5675
5671 GOTO5680
5675 B=5:GOSUB2480:B=11:GOSUB2480:B=3:GOSUB2480:B=8:GOSUB2480:B=5:GOSUB2480
5676 B=9:GOSUB2480:B=3:GOSUB2480:B=6:GOSUB2480:B=15:GOSUB2480
5680 B=15:GOSUB2480:NEXTF:RETURN

REM INCOMPLETE FOR *
5700 FORF=10TO14STEP2:IFQ1(F)<>1THENCC=F:F=14:NEXTF:F=CC:GOTO5710
5701 NEXTF:RETURN

REM UNCOMPLETED FOR *
5710 FORF=2TO3:IF((Q1(10)=F)+(Q1(12)=F)+(Q1(14)=F)+(Q1(16)=F))=-3THENCC=F:F=3:NEXTF:F=CC:GOTO5800
5711 NEXTF

REM UNCOMPLETED FOR *
5720 FORF=1TO4:IF((Q1(10)=2)+(Q1(12)=2)+(Q1(14)=1)+(Q1(16)=2))=-1THENCC=F:F=4:NEXTF:F=CC:GOTO5725
5721 GOTO5730
5725 B=3:GOSUB2480:B=15:GOSUB2480:B=5:GOSUB2480:B=15:GOSUB2480:B=3:GOSUB2480:B=16:GOSUB2480:B=5:GOSUB2480:GOTO5800
5730 B=15:GOSUB2480:NEXTF

5740 IFQ1(40)=2ANDQ1(36)=2ANDQ1(38)=1THEN6190
5750 IFQ1(40)=1ANDQ1(36)=1ANDQ1(38)=2THENB=15:GOSUB2480:GOTO6190
5760 RETURN

REM INCOMPLETE FOR *
5800 FORF=1TO4:IFQ1(12)=2ANDQ1(14)=1THENCC=F:F=4:NEXTF:F=CC:GOTO5805
5801 GOTO5810
5805 B=3:GOSUB2480:B=15:GOSUB2480:B=5:GOSUB2480:B=15:GOSUB2480:B=3:GOSUB2480:B=16:GOSUB2480:B=5:GOSUB2480:RETURN
5810 IFQ1(12)=3ANDQ1(10)=1THENCC=F:F=4:NEXTF:F=CC:GOTO5815
5811 GOTO5820
5815 B=3:GOSUB2480:B=16:GOSUB2480:B=5:GOSUB2480:B=17:GOSUB2480:B=3:GOSUB2480:B=17:GOSUB2480:B=5:GOSUB2480:RETURN
5820 B=15:GOSUB2480:NEXTF
5825 STOP

REM UNCOMPLETED FOR *
5830 FORF=1TO4:IFQ1(34)=2ANDQ1(40)=2THENCC=F:F=4:NEXTF:F=CC:GOTO6100
5831 B=15:GOSUB2480:NEXTF
5840 IFQ1(35)-Q1(15)=24ANDQ1(39)-Q1(11)=24THEN5845
5841 GOTO5850
5845 B=1:GOSUB2480:B=4:GOSUB2480:B=15:GOSUB2480:B=7:GOSUB2480:B=10:GOSUB2480:B=13:GOSUB2480:B=7
5846 GOSUB2480:B=10:GOSUB2480:B=15:GOSUB2480:B=1:GOSUB2480:B=4:GOSUB2480:RETURN

REM UNCOMPLETED FOR *
5850 FORF=1TO2:IFQ1(37)-Q1(15)=24ANDQ1(39)-Q1(13)=24THENCC=F:F=2:NEXTF:F=CC:GOTO5855
5851 GOTO5860
5855 B=7:GOSUB2480:B=10:GOSUB2480:B=12:GOSUB2480:B=1:GOSUB2480:B=7:GOSUB2480:B=10:GOSUB2480:B=4
5856 GOSUB2480:B=7:GOSUB2480:B=10:GOSUB2480:B=14:GOSUB2480:B=7:GOSUB2480:B=10:GOSUB2480:RETURN
5860 B=15:GOSUB2480:NEXTF

REM INCOMPLTED FOR *
5870 FORF=1TO4:IF(Q1(39)-Q1(15)=24)AND(Q1(37)-Q1(13)<>24)THENCC=F:F=4:NEXTF:F=CC:GOTO6190
5871 B=15:GOSUB2480:NEXTF
5880 RETURN

6010 B=5:GOSUB2480:B=15:GOSUB2480:B=3:GOSUB2480:B=15:GOSUB2480:B=6:GOSUB2480:B=17:GOSUB2480:B=8:GOSUB2480:RETURN
6020 B=11:GOSUB2480:B=15:GOSUB2480:B=9:GOSUB2480:B=15:GOSUB2480:B=3:GOSUB2480:B=17:GOSUB2480:B=5:GOSUB2480:RETURN
6030 B=2:GOSUB2480:B=15:GOSUB2480:B=0:GOSUB2480:B=15:GOSUB2480:B=9:GOSUB2480:B=17:GOSUB2480:B=11:GOSUB2480:RETURN
6040 B=8:GOSUB2480:B=15:GOSUB2480:B=6:GOSUB2480:B=15:GOSUB2480:B=0:GOSUB2480:B=17:GOSUB2480:B=2:GOSUB2480:RETURN
6100 IFQ1(39)-Q1(9)=24ORQ1(33)-Q1(11)=24OR(Q1(35)-Q1(15)=24ANDQ1(36)=1)THEN6105
6101 GOTO6110
6105 B=6:GOSUB2480:B=11:GOSUB2480:B=0:GOSUB2480:B=9:GOSUB2480:B=8:GOSUB2480:B=16:GOSUB2480:B=6
6106 GOSUB2480:B=11:GOSUB2480:B=0:GOSUB2480:B=9:GOSUB2480:B=8:GOSUB2480:GOTO5830
6110 B=0:GOSUB2480:B=5:GOSUB2480:B=11:GOSUB2480:B=2:GOSUB2480:B=3:GOSUB2480:B=16:GOSUB2480:B=0
6111 GOSUB2480:B=5:GOSUB2480:B=11:GOSUB2480:B=2:GOSUB2480:B=3:GOSUB2480
6120 GOTO5830
6190 BM=14:IFQ1(37)-Q1(11)=24THENBM=12
6200 B=1:GOSUB2480:B=4:GOSUB2480:B=BM:GOSUB2480:B=2:GOSUB2480:B=3:GOSUB2480:B=10:GOSUB2480:B=0
6201 GOSUB2480:B=5:GOSUB2480:B=BM:GOSUB2480:B=1:GOSUB2480:B=4:GOSUB2480:RETURN
6210 REM MC-10 EDITS JIM GERRIE
