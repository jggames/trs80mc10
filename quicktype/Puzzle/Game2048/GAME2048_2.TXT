10 CLS:DIMG(5,5),CO$(15),I,J,Z,X,Y:I=RND(-(PEEK(9)*256+PEEK(10)))
15 FORCO=1TO8:FORI=1TO5:CO$(CO)=CO$(CO)+CHR$(143+((CO-1)*16)):NEXT:NEXT
16 FORCO=9TO15:FORI=1TO5:CO$(CO)=CO$(CO)+CHR$(137+((CO-8)*16)):NEXT:NEXT
20 M=-1
30 GOSUB1000
50 CLS
60 IFMTHENGOSUB1000
70 L=-1:WN=0
80 FORI=1TO4
90 PRINT"+------+------+------+------+"
100 PRINT"!";
110 FORJ=1TO4
120 IFG(I,J)=2048THENWN=-1:L=0
130 IFG(I,J)=0THENL=0:PRINT"      !";:GOTO150
140 CO=LOG(G(I,J))/LOG(2):L=LEN(STR$(G(I,J))):PRINTRIGHT$(CO$(CO)+RIGHT$(STR$(G(I,J)),L-1),5);LEFT$(CO$(CO),1);"!";
150 NEXT
160 PRINT
170 NEXT
180 PRINT"+------+------+------+------+"
190 X$=INKEY$:IFX$=""THEN190
200 IFWNTHENPRINT"YOU WIN!!!":SOUND200,10:SOUND100,5:SOUND225,5:END
210 M=0
220 IFX$="0"THENEND
230 IFX$<>"W"THEN300
240 FORJ=1TO4:FORZ=1TO3:FORI=2TO4:IFG(I-1,J)=0THENG(I-1,J)=G(I,J):G(I,J)=0:M=1
250 NEXT:NEXT:FORI=2TO4:IFG(I-1,J)=G(I,J)THENG(I-1,J)=G(I,J)*2:G(I,J)=0
280 NEXT:NEXT:FORJ=1TO4:FORZ=1TO3:FORI=2TO4:IFG(I-1,J)=0THENG(I-1,J)=G(I,J):G(I,J)=0:M=1
290 NEXT:NEXT:NEXT:GOTO600
300 IFX$<>"A"THEN400
310 FORI=1TO4:FORZ=1TO3:FORJ=2TO4:IFG(I,J-1)=0THENG(I,J-1)=G(I,J):G(I,J)=0:M=1
320 NEXT:NEXT:FORJ=2TO4:IFG(I,J-1)=G(I,J)THENG(I,J-1)=G(I,J)*2:G(I,J)=0
330 NEXT:NEXT:FORI=1TO4:FORZ=1TO3:FORJ=2TO4:IFG(I,J-1)=0THENG(I,J-1)=G(I,J):G(I,J)=0:M=1
340 NEXT:NEXT:NEXT:GOTO600
400 IFX$<>"S"THEN500
410 FORI=1TO4:FORZ=1TO3:FORJ=3TO1STEP-1:IFG(I,J+1)=0THENG(I,J+1)=G(I,J):G(I,J)=0:M=1
420 NEXT:NEXT:FORJ=3TO1STEP-1:IFG(I,J+1)=G(I,J)THENG(I,J+1)=G(I,J)*2:G(I,J)=0
430 NEXT:NEXT:FORI=1TO4:FORZ=1TO3:FORJ=3TO1STEP-1:IFG(I,J+1)=0THENG(I,J+1)=G(I,J):G(I,J)=0:M=1
440 NEXT:NEXT:NEXT:GOTO600
500 IFX$<>"Z"THEN580
510 FORJ=1TO4:FORZ=1TO3:FORI=3TO1STEP-1:IFG(I+1,J)=0THENG(I+1,J)=G(I,J):G(I,J)=0:M=1
520 NEXT:NEXT:FORI=3TO1STEP-1:IFG(I+1,J)=G(I,J)THENG(I+1,J)=G(I,J)*2:G(I,J)=0
530 NEXT:NEXT:FORJ=1TO4:FORZ=1TO3:FORI=3TO1STEP-1:IFG(I+1,J)=0THENG(I+1,J)=G(I,J):G(I,J)=0:M=1
540 NEXT:NEXT:NEXT:GOTO600
580 SOUND1,1:GOTO190
600 IFM=0ANDLTHENPRINT"YOU LOSE!":SOUND1,10:END
610 GOTO50
1000 X=RND(4):Y=RND(4):IFG(X,Y)=0THENG(X,Y)=2+2*INT(RND(0)*2):RETURN
1010 GOTO1000
