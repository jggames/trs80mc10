0 GOSUB900:GOTO20
1 ONABS(L(X,Y,Z))GOTO2,3,4,5
2 L(13,5,1)=L(13,5,1)-1:RETURN
3 L(2,5,1)=L(2,5,1)-1:RETURN
4 L(8,4,4)=L(8,4,4)-2:L(7,5,4)=L(7,5,4)-2:L(8,5,4)=L(8,5,4)-2:RETURN
5 L(14,4,1)=L(14,4,1)-3:RETURN
6 C=(X-1)*2+(Y-1)*2*32:IFZ=1THENIFY=4THENIFX>13ORX<2THENC=C+32
7 IFZ=5THENC=C+33
8 PRINT@C,MID$(A$(Z),A,2);:PRINT@C+32,MID$(B$(Z),A,2);:RETURN
9 REM PRINT ONE BELOW TOP
10 GOTO91

20 RR=RR+1:C=1:FORS=1TO2:FORT=1TO36:PRINT@26,143-C
30 I=RND(144):IFL(X(I),Y(I),Z(I))<3THEN50
40 GOTO30
50 FORL=1TO2000:J=RND(144):IFL(X(J),Y(J),Z(J))<3THENIFI<>JTHENL=2000:NEXT:GOTO70
60 PRINT@1*32+26,L:NEXT:T=36:NEXT:S=2:NEXT:GOTO200
70 P(C)=I:T(C)=T:C=C+1:P(C)=J:T(C)=T:C=C+1
80 X=X(I):Y=Y(I):Z=Z(I):L(X-1,Y,Z)=L(X-1,Y,Z)-1:L(X+1,Y,Z)=L(X+1,Y,Z)-1:L(X,Y,Z-1)=L(X,Y,Z-1)-2:IFL(X,Y,Z)<.THENGOSUB1
81 L(X,Y,Z)=9
85 X=X(J):Y=Y(J):Z=Z(J):L(X-1,Y,Z)=L(X-1,Y,Z)-1:L(X+1,Y,Z)=L(X+1,Y,Z)-1:L(X,Y,Z-1)=L(X,Y,Z-1)-2:IFL(X,Y,Z)<.THENGOSUB1
86 L(X,Y,Z)=9:NEXT:NEXT

90 CLS:FORT=1TO144:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):A=(T(T)-1)*2+1:ON-(Z=5)GOTO91:IFL(X,Y,Z+1)>.THENIFZ<4THEN95
91 GOSUB6
95 NEXT
96 X=7:Y=4:Z=5:GOSUB140:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):A=(T(T)-1)*2+1:GOSUB6

130 GOSUB300:REM IFINKEY$=""THEN130
131 GOSUB3000:GOTO20

140 FORT=1TO144:IFZ(P(T))=ZTHENIFY(P(T))=YTHENIFX(P(T))=XTHENCC=T:T=144
141 NEXT:T=CC:RETURN

200 FF=FF+1:GOSUB300:IFRR>99THENSTOP
219 GOSUB3000:GOTO20

300 PRINT@32*11+26,"FAIL:";:PRINT@32*12+26,FF;
310 PRINT@32*13+26,"TRIES:";:PRINT@32*14+26,RR;:FORCC=1TO2500:NEXT:RETURN

900 CLS:PRINT"MAHJONG - JIM AND CHARLIE GERRIE"
910 DIML(16,9,5),X(144),Y(144),Z(144),P(144),T(144),A$(5),B$(5),L$(5,8)
1000 A$(1)="ΙΝΒΟΒΟΒΝΔΝΚΗΘΗΓΕΘΕΚΕΙΕΔΝΑΗΑΝΐΗΐΗΑΗΔΕΚΟΒΗΔΗΕΟΐΝΑΝΑΕΐΕΐΕΑΕΚΗΒΗΕΕΕΕΔΕΖΗΔΕΒΟ  "
1010 B$(1)="ΛΟΛΟΟΗΓΟΛΟΗΟΓΟΛΟΓΟΓΟΓΗΓΗΓΗΓΟΓΗΗΟΛΗΗΗΛΟΗΟΗΗΓΗΗΗΗΗΓΗΗΟΟΗΗΟΓΟΛΟΓΗΛΟΓΗΗΗΛΟΛΗ  "
1020 A$(2)="ΩέίίέΤέΪΧΨΧΣΥΨΥΪΥΩΥΤέΡΧΡέΠΧΠΧΡΧΤΥΪίΧΤΧΥίΠέΡέΡΥΠΥΠΥΡΥΪΧΧΥΥΥΥΤΥΦΧΤΥί  "
1030 B$(2)="ΫίΫίίΧΣίΫίΧίΣίΫίΣίΣίΣΧΣΧΣΧΣίΣΧΧίΫΧΧΧΫίΧίΧΧΣΧΧΧΧΧΣΧΧίίΧΧίΣίΫίΣΧΫίΣΧΧΧΫίΫΧ  "
1040 A$(3)="ινβοβοβνδνκηθηγεθεκειεδναηανΰηΰηαηδεκοβηδηεοΰναναεΰεΰεαεκηβηεεεεδεζηδεβο  "
1050 B$(3)="λολοοηγολοηογολογογογηγηγηγογηηοληηηλοηοηηγηηηηηγηηοοηηογολογηλογηηηλολη  "
1060 A$(4)="ωύςςςύτύϊχψχσυψυϊυωυτύρχρύπχπχρχτυϊςχτχυπύρύρυπυπυρυϊχςχυυυυτυφχτυς  "
1070 B$(4)="ϋϋχσϋχσϋσσσχσχσχσσχχϋχχχϋχχχσχχχχχσχχχχσϋσχϋσχχχϋϋχ  "
1080 A$(5)="™’’’”——“•••™•”‘—‘——‘—”•’—”—•‘‘•••‘•—’—••••”•–—”•’  "
1090 B$(5)="››—“›—“›“““—“—“—““——›———›———“—————“————“›“—›“———››—  "

2011 L$(1,1)="023333333333200"
2012 L$(1,2)="000255555520000"
2013 L$(1,3)="002355555532000"
2014 L$(1,4)="233355555533332"
2015 L$(1,5)="033355555533300"
2016 L$(1,6)="002355555532000"
2017 L$(1,7)="000255555520000"
2018 L$(1,8)="023333333333200"

2021 L$(2,1)="000000000000000"
2022 L$(2,2)="000023333200000"
2023 L$(2,3)="000025555200000"
2024 L$(2,4)="000025555200000"
2025 L$(2,5)="000025555200000"
2026 L$(2,6)="000025555200000"
2027 L$(2,7)="000023333200000"
2028 L$(2,8)=L$(2,1)

2031 L$(3,1)=L$(2,1)
2032 L$(3,2)=L$(2,1)
2033 L$(3,3)="000002332000000"
2034 L$(3,4)="000002552000000"
2035 L$(3,5)="000002552000000"
2036 L$(3,6)="000002332000000"
2037 L$(3,7)=L$(2,1)
2038 L$(3,8)=L$(2,1)

2041 L$(4,1)=L$(2,1)
2042 L$(4,2)=L$(2,1)
2043 L$(4,3)=L$(2,1)
2044 L$(4,4)="000000440000000"
2045 L$(4,5)="000000440000000"
2046 L$(4,6)=L$(2,1)
2047 L$(4,7)=L$(2,1)
2048 L$(4,8)=L$(2,1)

2051 L$(5,1)=L$(2,1)
2052 L$(5,2)=L$(2,1)
2053 L$(5,3)=L$(2,1)
2054 L$(5,4)="000000100000000"
2055 L$(5,5)=L$(2,1)
2056 L$(5,6)=L$(2,1)
2057 L$(5,7)=L$(2,1)
2058 L$(5,8)=L$(2,1)

3000 CLS:PRINT"YOUR TURTLE APPROACHES..."
3001 C=1:FORZ=1TO5:FORY=1TO8:FORX=1TO15:L(X,Y,Z)=VAL(MID$(L$(Z,Y),X,1)):IFL(X,Y,Z)THENX(C)=X:Y(C)=Y:Z(C)=Z:C=C+1
3010 NEXT:NEXT:NEXT:L(15,4,1)=-4:L(1,4,1)=-2:L(7,4,5)=-3
3011 RETURN

4000 CC=.:FORG=1TO144:IFL(X(G),Y(G),Z(G))<3THENCC=CC+1
4010 NEXT:RETURN

5000 X=X(P(C)):Y=Y(P(C)):Z=Z(P(C)):A=(T(C)-1)*2+1:CC=(X-1)*2+(Y-1)*2*32:?@CC,MID$(A$(Z),A,2);:?@CC+32,MID$(B$(Z),A,2);
5010 RETURN
