0 GOSUB900:GOTO20
1 ONABS(L(X,Y,Z))GOTO2,3,4,5
2 L(13,5,1)=L(13,5,1)-1:RETURN
3 L(2,5,1)=L(2,5,1)-1:RETURN
4 L(8,4,4)=L(8,4,4)-2:L(7,5,4)=L(7,5,4)-2:L(8,5,4)=L(8,5,4)-2:RETURN
5 L(14,4,1)=L(14,4,1)-3:RETURN

6 C=(X-1)*2+(Y-1)*2*32:IFZ<2THENIFY=4THENIFX>13ORX<2THENC=C+32:GOTO8
7 IFX=7THENIFY=4THENIFZ=5ORZ=.THENIFL(X,Y,.)=5THENC=C+33
8 PRINT@C,MID$(A$(Z),A,2);:PRINT@C+32,MID$(B$(Z),A,2);:RETURN

9 X=7:Y=4:Z=S:GOSUB290:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):A=(T(T)-1)*2+1:GOSUB6:RETURN

20 CLS:PRINT"YOUR TURTLE APPROACHES...":PRINT"SEARCHES:":PRINT@172,"MAHJONG":PRINT@228,"BY CHARLIE & JIM GERRIE":GOSUB5500
25 C=1:FORS=1TO2:FORT=1TO36:PRINT@26,144-C
30 I=RND(144):IFL(X(I),Y(I),Z(I))<3THEN50
40 GOTO30
50 FORL=1TO500:J=RND(144):IFL(X(J),Y(J),Z(J))<3THENIFI<>JTHEN70
60 PRINT@58,L:NEXT:T=36:NEXT:S=2:NEXT:GOTO300
70 L=500:NEXT:P(C)=I:T(C)=T:C=C+1:P(C)=J:T(C)=T:C=C+1
71 X=X(I):Y=Y(I):Z=Z(I):L(X-1,Y,Z)=L(X-1,Y,Z)-1:L(X+1,Y,Z)=L(X+1,Y,Z)-1:L(X,Y,Z-1)=L(X,Y,Z-1)-2:IFL(X,Y,Z)<.THENGOSUB1
72 L(X,Y,Z)=9
73 X=X(J):Y=Y(J):Z=Z(J):L(X-1,Y,Z)=L(X-1,Y,Z)-1:L(X+1,Y,Z)=L(X+1,Y,Z)-1:L(X,Y,Z-1)=L(X,Y,Z-1)-2:IFL(X,Y,Z)<.THENGOSUB1
74 L(X,Y,Z)=9:NEXT:NEXT

79 PRINT@26,"","JUST A LITTLE LONGER...":GOSUB3100

80 CLS:C=53:FORT=1TO5:POKE16384+(T+10)*32+1,C+64:PRINT@(T+10)*32,MID$("οίΟ",T,1);:C=C-1:NEXT
90 FORT=1TO144:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):A=(T(T)-1)*2+1:IFZ=L(X,Y,.)THENGOSUB6
95 NEXT:S=4:GOSUB9:TP$="":FORY=6TO9:FORX=12TO15:TP$=TP$+CHR$(PEEK(16384+32*Y+X)):NEXT:NEXT:S=5:GOSUB9

100 X=7:Y=1:I=.:J=.:L=144:GP=GP+1:GOSUB880
130 Z=L(X,Y,.):A=(Q(X,Y)-1)*2+1:IFZ=4THENIFL(7,4,.)=5THENX=7:Y=4:GOTO130
131 IFX<2ORX>13THENIFY<>4THENY=4:GOTO130
132 IFX=ITHENIFY=JTHENZ=.
139 GOSUB6:FORT=1TO50:CC=ASC(INKEY$+CHR$(.)):IFCCTHENT=50
140 NEXT:PRINT@C,"ΏΏ";:PRINT@C+32,"ΏΏ";:IFCCTHEN170
150 FORT=1TO40:CC=ASC(INKEY$+CHR$(.)):IFCCTHENT=40:NEXT:GOTO170
151 NEXT:GOTO130
170 GOSUB6:IFCC=65THENIFX>1THENX=X-1:GOTO130
171 IFCC=83THENIFX<15THENON-(L(X,Y,.)=5)GOSUB178:X=X+1::GOTO130
172 IFCC=87THENIFY>1THENY=Y-1:GOTO130
173 IFCC=90THENIFY<8THENON-(L(X,Y,.)=5)GOSUB179:Y=Y+1:GOTO130
174 IFCC=32ORCC=13THEN180
175 IFCC=72THENGOSUB500:IFCC=.THENGOSUB585:GOTO230
176 IFCC=82THENGOSUB577:GOSUB585:GOTO230
177 GOTO130
178 X=X+1:RETURN
179 Y=Y+1:RETURN

180 IFITHEN190
181 IFZ=.THEN193
182 IFL(X,Y,Z)<3THENZ=.:GOSUB6:I=X:J=Y:GOTO130
183 GOTO193

190 IFZ=.THEN192
191 IFL(X,Y,Z)<3THENZ=.:GOSUB6:IFQ(X,Y)=Q(I,J)THEN200
192 Z=L(X,Y,.):GOSUB6:X=I:Y=J
193 Z=L(X,Y,.):A=(Q(X,Y)-1)*2+1:GOSUB6:I=.:J=.:SOUND1,1:GOTO130

200 SOUND200,1:XX=X:YY=Y:X=I:Y=J:GOSUB270:GOSUB280:X=XX:Y=YY:GOSUB270:GOSUB280
210 X=XX:Y=YY:I=.:J=.:L=L-2:GOSUB880:IFL>.THEN130
220 GOSUB590
230 I$=INKEY$:IFI$=""THEN230
240 IFI$="Y"THENGOSUB2100:GOTO20
250 IFI$="N"THENEND
260 GOTO230

270 Z=L(X,Y,.):L(X-1,Y,Z)=L(X-1,Y,Z)-1:L(X+1,Y,Z)=L(X+1,Y,Z)-1:L(X,Y,Z-1)=L(X,Y,Z-1)-2:IFL(X,Y,Z)<.THENGOSUB1
271 L(X,Y,Z)=9:RETURN

280 L(X,Y,.)=L(X,Y,.)-1:IFL(X,Y,.)<1THENL(X,Y,.)=.:Q(X,Y)=37:A=73:GOSUB6:RETURN
281 Z=L(X,Y,.):GOSUB290:Q(X,Y)=T(T):A=(T(T)-1)*2+1:GOSUB6:IFX=7THENIFY=4THENIFZ=4THEN289
282 RETURN

289 CC=1:FORY=6TO9:FORX=12TO15:PRINT@32*Y+X,MID$(TP$,CC,1);:CC=CC+1:NEXT:NEXT:RETURN

290 FORT=1TO144:IFZ(P(T))=ZTHENIFY(P(T))=YTHENIFX(P(T))=XTHENCC=T:T=144
291 NEXT:T=CC:RETURN

300 FF=FF+1:PRINT@64,"FAILURES:"FF;
301 GOSUB3000:GOTO20

500 PRINT@122,"q=STOP";:I=.:J=.:CC=.:XX=X:YY=Y:FORS=1TO144:X=X(P(S)):Y=Y(P(S)):Z=Z(P(S)):IFL(X,Y,Z)<3THENGOSUB550
501 NEXT:X=XX:Y=YY:PRINT@122,"      ";:RETURN

550 FORT=1TO144:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):IFL(X,Y,Z)<3THENIFT<>STHENIFT(T)=T(S)THENGOSUB560
551 NEXT:RETURN

560 CC=CC+1:A=(T(T)-1)*2+1:Z=.:GOSUB6:X=X(P(S)):Y=Y(P(S)):A=(T(S)-1)*2+1:GOSUB6:I$=INKEY$:IFI$="Q"THEN569
565 Z=Z(P(S)):A=(T(S)-1)*2+1:GOSUB6:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):A=(T(T)-1)*2+1:GOSUB6:RETURN
569 SOUND1,1:Z=Z(P(S)):A=(T(S)-1)*2+1:GOSUB6:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):A=(T(T)-1)*2+1:GOSUB6:T=144:S=144:RETURN

577 PRINT@64,RIGHT$(STR$(GW),2);"/";MID$(STR$(GP),2,2);:RETURN
585 PRINT@86,"GAME OVER.";:PRINT@86+32,"TRY AGAIN?";:GOTO596
586 PRINT@86,"  ARE YOU ";:PRINT@86+32,"   SURE?  ";:GOTO596
590 PRINT@86," YOU WON! ";:GOSUB620:PRINT@86+32,"TRY AGAIN?";:GOSUB577
596 PRINT@88+64,"        ";:RETURN

620 SOUND200,8:SOUND220,3:SOUND220,3:SOUND220,3:SOUND200,8:SOUND220,3:SOUND200,3
630 SOUND180,3:SOUND200,10:GW=GW+1:RETURN

880 PRINT@378,"TILES";:PRINT@410,L;:RETURN

900 CLS0:DIML(16,8,5),X(144),Y(144),Z(144),P(144),T(144),A$(5),B$(5),L$(5,8),Q(15,8),T,I,J,X,Y,Z,S,L,A,C,CC
910 CC=RND(-(PEEK(9)*256+PEEK(10)))
920 A$(0)="©­Ά―Ά―Ά­¤­§¨§£¥¨¥¥¨­ ­΅§΅­ § §΅­¤¥Ά§­¥¤§¥― ¥΅­΅¥ ¥ ¥ ­§Ά§¥¥¥¥¤¥¦§¦§Ά―  "
930 B$(0)="«―«――§£―«―§―£―«―£―£―§§£§£§£―£§§―£§§§£§£§§§£§§§§§£§§――§§§£―«―£§«―£§§§«―«§  "
1000 A$(1)="ΙΝΒΟΒΟΒΝΔΝΚΗΘΗΓΕΘΕΚΕΘΝΐΝΑΗΑΝΐΗΐΗΑΝΔΕΒΗΝΕΔΗΕΟΐΕΑΝΑΕΐΕΐΕΐΝΚΗΒΗΕΕΕΕΔΕΖΗΖΗΒΟ  "
1010 B$(1)="ΛΟΛΟΟΗΓΟΛΟΗΟΓΟΛΟΓΟΓΟΗΗΓΗΓΗΓΟΓΗΗΟΓΗΗΗΓΗΓΗΗΗΓΗΗΗΗΗΓΗΗΟΟΗΗΗΓΟΛΟΓΗΛΟΓΗΗΗΛΟΛΗ  "
1020 A$(2)="ΩέίίέΤέΪΧΨΧΣΥΨΥΪΥΨέΠέΡΧΡέΠΧΠΧΡέΤΥΧέΥΤΧΥίΠΥΡέΡΥΠΥΠΥΠέΪΧΧΥΥΥΥΤΥΦΧΦΧί  "
1030 B$(2)="ΫίΫίίΧΣίΫίΧίΣίΫίΣίΣίΧΧΣΧΣΧΣίΣΧΧίΣΧΧΧΣΧΣΧΧΧΣΧΧΧΧΧΣΧΧίίΧΧΧΣίΫίΣΧΫίΣΧΧΧΫίΫΧ  "
1040 A$(3)="ινβοβοβνδνκηθηγεθεκεθνΰναηανΰηΰηανδεβηνεδηεοΰεαναεΰεΰεΰνκηβηεεεεδεζηζηβο  "
1050 B$(3)="λολοοηγολοηογολογογοηηγηγηγογηηογηηηγηγηηηγηηηηηγηηοοηηηγολογηλογηηηλολη  "
1060 A$(4)="ωύςςςύτύϊχψχσυψυϊυψύπύρχρύπχπχρύτυςχύυτχυπυρύρυπυπυπύϊχςχυυυυτυφχφχς  "
1070 B$(4)="ϋϋχσϋχσϋσσχχσχσχσσχχσχχχσχσχχχσχχχχχσχχχχχσϋσχϋσχχχϋϋχ  "
1080 A$(5)="™’’’”——“•••‘—‘——‘”•’—•”—••‘‘•••—’—••••”•–—–—’  "
1090 B$(5)="››—“›—“›““——“—“—““——“———“—“———“—————“—————“›“—›“———››—  "

2011 L$(1,1)="023333333333200"
2012 L$(1,2)="000255555520000"
2013 L$(1,3)="002355555532000"
2014 L$(1,4)="233355555533332"
2015 L$(1,5)="033355555533300"
2016 L$(1,6)="002355555532000"
2017 L$(1,7)="000255555520000"
2018 L$(1,8)="023333333333200"

2021 L$(2,1)=L$(2,1)
2022 L$(2,2)="000023333200000"
2023 L$(2,3)="000025555200000"
2024 L$(2,4)="000025555200000"
2025 L$(2,5)="000025555200000"
2026 L$(2,6)="000025555200000"
2027 L$(2,7)="000023333200000"
2028 L$(2,8)=L$(2,1)

2031 L$(3,1)=L$(2,1)
2032 L$(3,2)=L$(2,1)
2033 L$(3,3)="000002332000000"
2034 L$(3,4)="000002552000000"
2035 L$(3,5)="000002552000000"
2036 L$(3,6)="000002332000000"
2037 L$(3,7)=L$(2,1)
2038 L$(3,8)=L$(2,1)

2041 L$(4,1)=L$(2,1)
2042 L$(4,2)=L$(2,1)
2043 L$(4,3)=L$(2,1)
2044 L$(4,4)="000000440000000"
2045 L$(4,5)="000000440000000"
2046 L$(4,6)=L$(2,1)
2047 L$(4,7)=L$(2,1)
2048 L$(4,8)=L$(2,1)

2051 L$(5,1)=L$(2,1)
2052 L$(5,2)=L$(2,1)
2053 L$(5,3)=L$(2,1)
2054 L$(5,4)="000000100000000"
2055 L$(5,5)=L$(2,1)
2056 L$(5,6)=L$(2,1)
2057 L$(5,7)=L$(2,1)
2058 L$(5,8)=L$(2,1)

2100 CLS5:PRINT@3,MID$(A$(1),21,26);:PRINT@35,MID$(B$(1),21,26);:PRINT@67,MID$(A$(1),47,26);
2130 PRINT@99,MID$(B$(1),47,26);:PRINT@134,MID$(A$(1),1,20);:PRINT@166,MID$(B$(1),1,20);
2140 FORT=1TO7:A=ASC(MID$("MAHJONG",T,1)):A=((A-64+10)-1)*2+1
2150 PRINT@7*32+(T+3)*2+1,MID$(A$(1),A,2);:PRINT@8*32+(T+3)*2+1,MID$(B$(1),A,2);:NEXT
2160 GOSUB5500

3000 C=1:FORZ=1TO5:FORY=1TO8:FORX=1TO15:L(X,Y,Z)=VAL(MID$(L$(Z,Y),X,1)):IFL(X,Y,Z)THENX(C)=X:Y(C)=Y:Z(C)=Z:C=C+1
3010 NEXT:NEXT:NEXT:L(15,4,1)=-4:L(1,4,1)=-2:L(7,4,5)=-3
3011 RETURN

3100 FORZ=1TO5:FORY=1TO8:FORX=1TO15:L(X,Y,Z)=VAL(MID$(L$(Z,Y),X,1)):NEXT:NEXT:NEXT
3110 L(15,4,1)=-4:L(1,4,1)=-2:L(7,4,5)=-3

3150 RESTORE:FORY=1TO8:READM$:FORX=1TO15:L(X,Y,.)=VAL(MID$(M$,X,1))
3160 NEXT:NEXT

3170 FORY=1TO8:FORX=1TO15:Q(X,Y)=37:NEXT:NEXT
3200 FORT=1TO144:X=X(P(T)):Y=Y(P(T)):Z=Z(P(T)):IFL(X,Y,.)=ZTHENQ(X,Y)=T(T)
3210 NEXT:RETURN

5500 PRINT@32*10+3,"MATCH TILES OPEN ON LEFT ";:PRINT@32*11+3,"OR RIGHT SIDE.  USE wasz ";
5520 PRINT@32*12+3,"TO MOVE & space TO SELECT";:PRINT@32*13+3,"TILES.  h=HELP. r=RESIGN.";:RETURN

6011 DATA"011111111111100"
6012 DATA"000122222210000"
6013 DATA"001123333211000"
6014 DATA"111123543211111"
6015 DATA"011123443211100"
6016 DATA"001123333211000"
6017 DATA"000122222210000"
6018 DATA"011111111111100"
