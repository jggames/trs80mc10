10 CLS
20 PRINT "MANN-WHITNEY U-TEST"
30 PRINT 
40 DIM X(25),Y(25) 
50 DIM N(2) 
60 FOR I=1 TO 2 
70 PRINT "SAMPLE";I;":" 
80 PRINT "SIZE"; 
90 INPUT N(I) 
100 FOR J=1 TO N(I)
110 PRINT "  DATA";J;
120 INPUT Y(J)
130 NEXT J 
140 FOR J=1 TO N(I) 
150 FOR K=1 TO N(I)-J 
160 C=Y(K)
170 D=Y(K+1) 
180 IF Y(K)<Y(K+1) THEN 210  
190 Y(K)=Y(K+1)
200 Y(K+1)=C
210 NEXT K 
220 NEXT J 
230 PRINT 
240 IF I=2 THEN 280  
250 FOR J=1 TO N(1)
260 X(J)=Y(J) 
270 NEXT J 
280 NEXT I 
290 R=1 
300 I=0 
310 J=0 
320 I=I+1 
330 J=J+1 
340 IF I>N(1) THEN 590  
350 IF J>N(2) THEN 630  
360 IF X(I)<Y(J) THEN 630  
370 IF Y(J)<X(I) THEN 600  
380 K=2 
390 M=I 
400 L=J 
410 R1=2*R+1 
420 R=R+2 
430 I=I+1 
440 J=J+1
450 IF I>N(1) THEN 490  
460 IF X(I)<>X(I-1) THEN 490  
470 I=I+1 
480 GOTO 520  
490 IF J>N(2) THEN 560  
500 IF Y(J)<>Y(J-1) THEN 560  
510 J=J+1 
520 R1=R1+R
530 R=R+1
540 K=K+1
550 GOTO 450  
560 X=X+(I-M)*R1/K 
570 Y=Y+(J-L)*R1/K
580 GOTO 340  
590 IF J>N(2) THEN 670  
600 Y=Y+R 
610 J=J+1 
620 GOTO 650  
630 X=X+R 
640 I=I+1
650 R=R+1 
660 GOTO 340  
670 U1=N(1)*N(2)+N(1)*(N(1)+1)/2-X
680 U2=N(1)*N(2)+N(2)*(N(2)+1)/2-Y 
690 PRINT 
700 PRINT "FIRST SAMPLE PRECEEDING, u =";U1
710 PRINT "SECOND SAMPLE PRECEEDING, U =";U2
720 END
