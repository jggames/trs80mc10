10 REM SET ARRAY AND I NSTRUCT I ONS
20 CLS
30 GOSUB 2760:S=1000
COMMAND'!
40 DIMA(11 ?? 11):FOR I =1T010:FORJ=1T010:A(I ?? J)=15:NEXTJ:NE X T I
50 FORJ=OT011:A(J,0)=100:A(J ?? 11)=100:A(O ?? J) =100:A(11,Jl=100:NEXT J
60 GOSUB2810
70 REM FIND START
80 X=RND(10):Y=1:X X =X:YY=Y
90 D=RND(3):0NDGOT0100,110,120
100 IFA(X -1 ?? Y) =15THEND=1:A(X,Y)=14:X =X -1:Z=4:GOTO 130
110 IFA(X+1,Y)=15THEND=4:A(X,Y)=11:X =X+1:Z=2:GOT0130
120 IFA C X,Y+1) =15THEND=8:A(X,Y)=7:Y=Y+1:Z=3:60TO 130
130 D2=D
140 REM BEGIN ROUTE FINDING
150 GOSUB 170:IF F=1 THEN 390
160 GOTO 180
170 F=O:IFA(X+1,Y)<>15ANDA(X -1,Y)<>15ANDA(X,Y+1) <>15ANDA(X ?? Y-1)<>15THENF=1:RETURNELSERETURN
180 R=RND(3):IFR=1THEND1=D*2:::IFD1)8THEND1=D1/16
190 IFR=2THEND1=DELSE IFR=3THEND1=D / 2:IFD1(1THEND1=8
200 REM SET ARRAY
210 IFD1=4THEN340ELSE IFD1=1THEN260ELSE IFD1=8THEN300ELSE220
220 IF A(X,Y-1)<>15THEN180
230 IFD=2THENA(X,Y)=5:Y=Y-1:GOTO 380
240 IFD=1THENA(X,Y)=9:Y=Y-1:GOT0380
250 IFD=4THENA(X,Y)=12:Y=Y-1:GOT0380
260 IFA(X -1,Y)<>15THEN180
270 IFD=2THENA(X,Y)=6:X =X -1:GOT0380
280 IFD=1THENA(X,Y)=10:X=X -1:GOT0380
290 !FD=8THENA C X,Y)=12:X=X-1:GOT0380
300 IFA(X,Y+1)<>15THEN180
310 IFD=1THENA(X,Y)=3:Y=Y+1:GOT0380
320 IFD=8THENA(X,Y)=5:Y=Y+1:GOT0380
330 IFD=4THENA(X,Y)=6:Y=Y+1:GOT0380
340 IFA(X+1,Y)<>15THEN180
350 IFD=2THENA(X,Y) =3:X =X+1:GOT0380
360 IFD=8THENA(X,Y)=9:X=X+1:GOT0380
370 IFD=4THENA C X,Y)=10:X=X+1:60T0380
380 N=N+1:D=D1:GOTO 140
390 REM DEAD END
400 IFD=1THENA(X,Y)=11:N=N+1
410 IFD=2THENA(X,Y)=7:N=N+1
SCORE 496
420 IFD=4THENA(X ?? Y) =1 4:N=N+1
430 IFD=8THENA(X,Y) =1 3:N=N+1
440 REM F I ND SPACESMI CR0-80
450 FORJ=1 T0 1 0:FOR I =1 T0 1 0:IF A(I ,J) =1 5THENX=I:Y=J:GOTO 470
460 NEX T I:NEXTJ:GOTO 520
470 IFA(X+1 ,Y))OAND A(X+1 ,Y)(1 5 THEN X=X+1:A(X,Y)=A(X ,Y)-1:D=1:X=X-1:GOTO 140
480 IFA(X-1 ,Y))OANDA(X-1 ,Y)(1 5THENA(X-1,Y) =A(X-1 ,Y) -4:D=4:GOT0 140
490 IFA(X ,Y+1))0ANDA(X,Y+1)(1 5THENA(X,Y+1) =A(X,Y+1) -2:D=2:GOTO 140
500 IF A(X,Y-1))0ANDA(X,Y-1)(1 5THENA(X,Y-1) =A(X ,Y-1) -8:D=B:GOT0 140
510 GOTO 460
520 REM MAKE EXIT
530 X 1 =RND(1 0):A(X 1,1 0)=A(X 1 ?? 1 0) -8
540 X =X X:Y=YY:GOTO 880
550 END
560 REM DISPLAY
570 CLS:PRINT "CORE ";S
580 J =l
PLAN O F THE MAZ E
";1 1 -J ;:IFJ =1 THENPRINT "
s
.. .
590 I=1:PR INT" ";ELSEPRINT" '
600 ONA(I ,J)GOTO 620,630,640,650,660,670,680,690 ?? 700,7 1 0,720,730
,740,750,760
6 1 0 PRINTCHRS(1 40);CHR$(1 9 1);CHR$(1 40) ;:GOT0770
620 PRINTCHR$(32);CHR$(1 9 1);CHR$(1 40) ;:GOTO 770
630 PRINTCHR$(1 40);CHR$(1 BB);CHR$(1 40) ;:GOT0770
640 PRINTCHR$(32);CHR$(1 8B);CHR$(1 40) ;:GOT0770
650 PRINTCHR$(1 40);CHR$(1 9 1);CHR$(32) ;:GOT0770
660 PRINTCHR$(32);CHR$(1 9 1);CHR$(32) ;:GOT0770
670 PRINTCHR$(1 40);CHR$(1 8B);CHR$(32) ;:GOT0770
680 PRINTCHR$(32);CHR$(1 BB);CHR$(32);:: GOT0770
690 PRINTCHR$(1 40);CHR$(1 43);CHR$(1 40) ;:GOT0770
700 PRINTCHR$(32);CHR$(1 43);CHR$(1 40) ;:GOT0770
710 PRINTCHR$(1 40);CHR$(1 40);CHR$(1 40) ;:GOT0770
720 PRINTCHR$(32);CHR$(1 40);CHR$(1 40) ;:GOT0770
730 PRINTCHR$(1 40);CHR$(1 43);CHR$(32) ;:GOT0770
740 PRINTCHR$(32);CHR$(1 43);CHR$(32) ;:GOT0770
750 PRINTCHR$(1 40);CHR$(1 40);CHR$(32) ;:GOT0770
760 PRINTCHR$(32);CHR$(1 40);CHR$(32) ;
770 I =I+1:IF I(=1 0 THEN600
780 PRINT:J=J+1:IFJ(=1 0 THEN590
790 PRINTa7 1 5+3* X 1," E "
8OO PRINT " 1 2 3 4 5 6 7 8 9 1 0 "
810 PRINT " YOU ARE AT " X " AND THE E X I T A T " E " " ;
820 PRINT " YOU ARE ";:: GOSUB 970
830 T=50:P 1 =PEEK(1 537 1+3*X+64* Y)
840 T=T-l:IFT(l THEN RETURN:PRINT@53,S ;
850 PRINT@ 1 1+3*X+64 *Y," X " ;:FOR I =1 T0 1 00:NE X T I
860 PRINT@ 1 1+3*X+64* Y,CHR$(P 1) ;:FOR I =1 T0 1 00:NEX T I
870 GOTO 840
880 REM SET TO GO
890 PRINT " MAZ E COMPLETE " :: PRINT
900 PRINT " EX I T I S AT ";X 1;" EAST, 1 NORTH"
910 PRINT:GOSUB95 0:PRINT
920 I NPUT " READY ";Z$
930 GOTO 1 470
940 REM HELP ROUT I NE
950 PRINT " YOU ARE AT ";X;" EAST "
960 PRINT " ";1 1 -Y;" NORTH "
970 PRINT " FAC I NG " ;
980 ONZ GOT0990 ?? 1 000 ?? 1 0 1 0,1 020
990 PRINT " NORTH " :: GOTO 1 030
1000 PRINT " EAST " ::: GOT0 1 030
1010 PRINT " SOUTH " :: GOT0 1 030
1020 PRINT " WEST "
1030 RETURN
1040 REM I NPUT ROUT I NE
1050 IFS(1 THENPRINT " SORRY YOU RAN OUT OF PO INTS ! ":END
1060 IF Y=1 1 THEN 2740
1070 PRINT;i)O," COMMAND? II;:: Z $=I NKEV$:IFZ $=" " THEN 1 07 0
1080 IF Z $=" L " THENS=S-5:Z=Z-1 :: GOTO 1 1 30
1090 IFZ $=" R " THENS=S-5 :: Z=Z+1:GOTO 1 1 30
1100 IFZ $=" H " THENS=S/2:POKE 1 6405 ?? 0 :: GOSUB 560:POKE 1 6405,1:GOT0 1470
1110 IFZ $=" F " THEN S=S-2:60TO 1 4 1 0
1120 PRINT&lO, " L FOR LEFT,R FOR R I SHT,F FOR FOREWARD,H FOR HELP";:: FOR I =1 T02000 :: NEX T I:P R INT&l0, "" ;:SOTO 1 070
1130 IFZ(1 THENZ=Z+4ELSE IFZ)4THENZ=Z-4
1140 GOSUB 1 1 50:GOTO 1470
1150 REM ROTATE AND LOOK ROUT I NE
1160 IF B>10 THEN 1260
1170 F=A(A,B)
1180 IFZ=1 THEN 1220
1190 FOR I=2TOZ
1200 F=INT(F/2)+(F-INT(F/2)*2)*8
1210 NEX T I
1220 C=F-INT(F/2)*2
1230 D=INT(F/4)-INT(F/8)*2
1240 E=INT(F/2)-INT(F/4)*2
1250 RETURN
1260 REM OUTS I DE
1270 C=O:D=O:E=-1
1280 RETURN
1290 REM NEX T CELL
1300 IFE)OTHEN 1 370
1310 IFZ=1 THENB=B-1
1320 IFZ=2THENA=A+1
1330 IFZ=3THENB=B+1
1340 IFZ=4THENA=A-1
1350 RETURN
1360 REM MESSAGE
1370 IFE=1 THENPRINT;i)532, " NO WAY ! ! " ;
1380 FORJ=1 T0 1 000:NEXTJ
1390 RETURN
1400 REM FOREWARD
1410 A=X:B=Y
1420 GOSUB 1 1 50
1430 GOSUB 1 290
1440 X=A:Y=B
1450 IF E)O THEN 1 050
1460 REM START OF 3-D D I SPLAY
1470 A=X:B=Y
1480 GOSUB 1 1 50
1490 FORT=1 T05
1500 GOSUB 1 570
1510 IF E<>O THEN 1 050
1520 GOSUB 1 290
1530 GOSUB 1 1 50
1540 IF E=2 THEN 1 050
1550 NEXTT
1560 GOTO 1050
1570 ON T SOTO 1 580,1 700,2060,2370,2590
1580 CLS:PRINT;i)O, '' LAST COMMAND ";Z $ ;:PRINT&l45, " SCORE ";S
1590 IFE(O OR E) 1 THEN RETURN
1600 VV=1 5360:FOR I =7 1 TO 967 STEP 64
1610 POKEVV+I,1 9 1
1620 POKEVV+I+44, 1 9 1
1630 NEX T I
1640 IF E=O RETURN
1650 FOR I =72 TO 1 1 4
1660 POKEVV+I,1 3 1
1670 POKE VV+I+896, 1 76
1680 NEXT I
1690 RETURN
1700 REM DEPTH 2
1710 IFE(OTHEN RETURN
1720 IF C=OTHEN 1 800
1730 K=72:M=968:P=1 40:Q=P:GOSUB 1 790
1740 K=K+1:M=M+1:P=1 76:Q=1 3 1:GOSUB 1 790:K=K+65:M=M-63:P=131:Q=176:GOSUB 1790:K=K+1:M=M+1:P=1 40:Q=1 40:GOSUB 1 790
1750 K=K+1:M=M+1:P=1 76:Q=1 3 1:GOSUB 1 790:K=K+65:M=M-63:P=131:Q=176:GOSUB 1790
1760 K=K+1:M=M+1:P=1 40:Q=1 40:GOSUB 1 790
1770 K=K+1:M=M+1:P=1 76:Q=1 3 1:GOSUB 1 790
1780 SOT0 1 840
1790 POKEVV+K,P:POKEVV+M,Q:RETURN
1800 FOR I=264 T0271
1810 POKEVV+I,1 3 1
1820 POKEVV+I+5 1 2, 1 76
1830 NEX T I
1840 IF D=O THEN 1 920
1850 K=1 1 4:M=1 0 1 0:P=1 40:Q=P:GOSUB 1 790
