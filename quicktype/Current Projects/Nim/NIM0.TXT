https://www.atarimagazines.com/compute/issue89/Nim_Ultimate_Binary_Game.php


100 PRINT"{CLR}{2 DOWN}" : PRINT TAB(17)" "{RVS} NIM"
110	 J = RND (-T1)
120	 DIM A(5), P(5), S(5), N(5)
130	 FOR J = 1 TO 4 : S(J) = J : NEXT J
140	 H$ = "{HOME}{13 DOWN}"
150	 C$ = H$ + "{35 SPACES}" + H$
160	 PRINT CHR$(8);CHR$(142)
170	 PRINT"RULES : "
180	 PRINT"{2 SPACES} EACH PLAYER PICKS AS MANY ITEMS"
190	 PRINT"{2 SPACES} AS DESIRED FROM ANY ONE ROW"
200	 PRINT
210	 PRINT"THE WINNER IS THE PLAYER WHO PICKS"
220	 PRINT"THE LAST ITEM."
230	 PRINT
240	 PRINT"WE EACH PALY IN TURN."
250	 PRINT
260	 X$ = "N" : INPUT "SHOULD I PLAY MY BEST GAME" ;X$
270	 I = .5 : IF X$ = "Y" OR X$ = "YES" THEN I = 1
280	 PRINT
290	 IF I = 1 THEN PRINT"PUNY {SPACE} HUMAN1{2 SPACES} YOU HAVEN'T A HOPE."
300	 IF I < 1 THEN PRINT"MAYBE I'LL LET YOU WIN ONE OR TWO GAMES.
310	 FOR J = 1 TO 500 : NEXT
320	 R = 1 : N9 = 99
330	 T = 0
340	 FOR J = 1 TO 4
350	 A(J) = INT (RND(1) * 7 : T = T + A(J)
360	 NEXT J
370	 IF T < 4 THEN 330
380	 FOR J = 1 TO 4
390	 P(J) = A(J) : K = INT(RND(1) * 4) + 1
400	 NEXT J
420	 M = 0 : M0 = 0
430	 PRINT"{CLR}{DOWN}PLAYER TAKING LAST ITEM";
440	 IF R = 0 THEN PRINT "LOSES"
450	 IF R = 1 THEN PRINT "WINS"
460	 PRINT
470	 IF N9 = 99 THEN PRINT "PICK AS MANY AS YOU LIKE"
480	 IF N9<99 THEN PRINT "YOU MAY PICK NO MORE THAN" ;N9
490	 PRINT
500	 R9 = 0 : T6 = 0 : T8 : T9 = 0
510	 FOR J = 1 TO 4
520	 PRINT CHR$ (J + 64); " : ";
530	 FOR K = 1 TO 9
540	 C = 209 : IF K>A(J) THEN C = 32
550	 PRINT CHR$(C);"";
560	 NEXT K
570	 PRINT : PRINT
580	 K = S(J)
590	 N = INT (A(K) / (N9 + 1)) : N(K) = A(K) - N * (N9 + 1)
600	 IF N(K) = 1 THEN T8 = T8 + 1 : T3 = K
610	 IF N(K)>1 THEN T9 = T9 + 1 : T4 = K
620	 IF A(K)>T6 THEN T6 = A(K) : T5 = K
630	 NEXT J
640	 IF M>0 THEN 680
650	 PRINT C$;
660	 X$ = "N" : INPUT" DO YOU WANT THE FIRST MOVE";X$
670	 IF X$ = "Y" OR X$ = "YES" THEN M0 = 1
680	 M = M + 1 : IF M0 = 1 THEN 900
690	 T = 0
700	 IF R = 1 THEN 770
710	 IF T9 = 0 AND T8 = 0 THEN 800
720	 J12 = T3 : IF T9>0 THEN J1 = T4
730	 X = N(J1) : IF T8 = INT (T8/2) * 2 THEN X = X - 1
740	 IF X = 0 THEN 770
750	 IF T9<2 THEN 870
760	 REM CONVENTIONAL ANALYSIS
770	 FOR J = 1 TO 4
780	 T = (T OR N(J)) AND NOT (TAND N(J))
790	 NEXT J
800	 IF J1 = T5 : X = T6 : IF X>N9 THEN X = N9
HC	810	 IF T = 0 THEN 870
EM	820	 FOR J = 1 TO 4
KK	830	 K = S(J)
BM	840	 TO = (T OR N(K)) AND NOT (T AND N(K))
EF	850	 IF TO <N(K) AND (N(K) - T0)<N9 THEN J1 = K : X = N(K) - T 0
AQ	860	 NEXT J
KX	870	 IF RND (1)>I THEN X = INT(RND(1) * T6) + 1 : J1 = T5 : IF X>N9 THEN X = N9
BK	880	 PRINT C$; "I TAKE&rdqup; ;X; "FROM ROW";CHR$(J1 + 64)
GP	890	 GOTO 1000
EE	900	 PRINT C$;"CHOOSE A ROW {SPACE} (OR {RVS} G{OFF} TO GIVE UP) : ";
XE	910	 GET X$ : IF X$ = "" THEN910
KX	920	 IF X$ = "G" THEN MO = R : GOTO 1140
HC	930	 J1 = ASC(X$) - 64 : IF JL<1 OR J1>4 THEN 900
HG	940	 IF A (J1) = 0 THEN 900
FS	950	 PRINT C$;"HOW MANY FROM ROW"CHR$(64 + J1);" : &rdqup; :
BX	960	 GET X$ : IF X$ = "&dquo; THEN 960
BB	970	 X = ASC(X$) - 48 : IF x<0 OR {SPACE}X>9 THEN 960
GP	980	 IF X = 0 OR X>A(J1) OR X> N9 THEN PRINT "????" : FOR J = 1 TO 500 : NEXT : GOTO 900
CK	990	 PRINT X
EE	1000	 PRINT "{HOME} {2 DOWN}"
FJ	1010	 FOR K = 1 TO JI : PRINT : PRINT : NEXT K
CX	1020	 PRINT TAB (3);
BS	1030	 FOR K = 1 TO X : PRINT " - "; : NEXT K
JK	1040	 A(J1) = A(J1) - X
GG	1050	 T = 0
PX	1060	 FOR J = 1 TO 4
FR	1070	 IF A(J) < > 0 THEN T = 1
HS	1080	 NEXT J
PM	1090	 M0 = 1 - M0
PK	1100	 FOR J = 1 TO 750 : NEXT J
MB	1120	 PRINT "{HOME} {4 DOWN}"
AD	1130	 GOTO 500
JC	1140	 PRINT C$;
DR	1150	 IF R = M0 THEN W0 = W0 + 1 : PRINT "I WIN!"
GK	1160	 IF R < > M0 THEN W1 = W1 + 1 : PRINT "YOU WIN!"
JH	1170	 PRINT
MG	1180	 PRINT "THAT MAKES" W1; "GAME;"
DX	1190	 IF W1 < > 1 THEN PRINT"S"
PC	1200	 PRINT " FOR YOU"
CD	1210	 PRINT "AND";WO; "FOR ME."
BG	1220	 IF I<1 AND W1 > W0 AND R < > M0 AND R1 = 0 THEN GOSUB 1380
MJ	1230	 PRINT
JP	1240	 R1 = 0
GQ	1250	 X$ = "Y : " : INPUT "PLAY AGAIN" : X$
QB	1260	 IF X$ = "N" : OR X$ = "NO" THEN END
SC	1270	 X$ = "N" : INPUT "SAME GAME AS LAST TIME" ; X$
QJ	1280	 IF X$<> "N&rdquo AND X$ <> "NO" THEN 1350
CD	1290	 IF RND (1)>.35 THEN 330
SM	1300	 IF RND (1)>.6 THEN 1330
CC	1310	 R = 1 - R : R9 = 5 : PRINT : PRINT "{RVS} RULE CHANGE"
SG	1320	 FOR J = 1 TO 500 : NEXT J
CG	1330	 IF RND (1)<.6 THEN N9 = INT (RND(1) * 4) + 3 : IF N9>5 THEN N9 = 99
QB	1340	 GOTO 330
CC	1350	 R1 = 1
JC	1360	 FOR J = 1 TO 4 : A(J) = P(J) : NEXT J
MD	1370	 GOTO 420
RC	1380	 I = Iâ†‘.75
HG	1390	 PRINT "DON'T FEEL TOO SMART."
SE	1400	 PRINT "I CAN DO BETTER!"
RK	1410	 RETURN