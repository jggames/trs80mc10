0 CLS:MC=16384
1 REM ***SHEEPDOG TRIAL***
9 REM ***RULES***
10 PRINT@10,"SHEEPDOG TRIAL";
20 PRINT@2*32,"YOU MAY CHOOSE HOW MANY SHEEP TOROUND UP. NO MORE THAN 6. IF"
21 PRINT"YOU GET TOO CLOSE TO A SHEEP IT","WILL PANIC AND IF YOU ARE TOO","FAR AWAY SHEEP WILL WANDER AT","RANDOM."
25 PRINT"MOVE DOG WITH THE CUROR KEYS.","TO USE A TURN WITHOUT MOVING","THE DOG PRESS ANY OTHER KEY."
30 PRINT@12*32+0,"PRESS ANY KEY TO PLAY."
40 IFINKEY$=""THEN40
50 CLS
90 GOTO300
100 REM ***CONV. TO CO-ORDS***
110 YS=INT(Z/33)+1
120 XS=(Z-(YS-1)*33)
130 RETURN
140 REM ***DOG CO-ORDS***
150 YD=INT(D/33)+1
160 XD=(D-(YD-1)*33)
170 RETURN
180 REM ***RANDOM MOVE***
190 XS=XS+1-INT(RND(0)*3)
200 YS=YS+1-INT(RND(0)*3)
210 GOTO865
220 REM ***CONV. TO POKE NO.***
230 WS=XS+33*(YS-1)
240 RETURN
300 REM ***NO. OF SHEEP***
310 PRINT "HOW MANY SHEEP DO YOU WANT","TO ROUND UP?"
315 INPUTNS
320 IFNS>0ANDNS<7THEN340
325 PRINT"SORRY, MORE THAN 0 AND LESS","THAN 7"
330 GOTO315
340 PRINT,,NS;"IS OKAY."
345 FORN=1TO1000
346 NEXTN
350 CLS
355 REM ***INITIALIZE***
360 DIMS(NS)
410 REM ***PEN***
420 PRINT@9*32+13,"ƒ ƒ‚";
430 PRINT@10*32+13,"…   Š";
440 PRINT@11*32+13,"…   Š";
450 PRINT@12*32+13,"„ŒŒŒˆ";
460 REM ***FENCE*** 
470 FORN=0TO31
480 POKEMC+N,46:POKE15*32+MC+N,46
490 NEXTN
500 FORN=0TO15
510 POKE32*N+MC,46:POKE32*N+MC+31,46
520 NEXTN
530 REM ***GENERATE SHEEP***
535 W=16384
540 FORN=1TONS
550 WS=RND(480)
560 IFPEEK(W+WS)<>96THEN550
570 POKEW+WS,20
580 S(N)=WS
590 NEXTN
600 REM ***PLACE DOG***
610 WD=RND(480)
620 IFPEEK(WD+W)<>96THEN610 
630 POKEWD+W,8
640 D=WD
700 REM ***START***
707 S=0
708 REM TIMER?
709 REM TIMER?
710 FORN=1TO3
715 D1=D
720 M$=INKEY$:IFM$=""THEN720
730 IFM$="S"THEND=D+1
740 IFM$="A"THEND=D-1
750 IFM$="W"THEND=D-33
760 IFM$="Z"THEND=D+33
770 IFPEEK(W+D)<>96THEND=D1
780 POKEW+D1,96
790 POKEW+D,8
800 NEXTN
810 REM ***MOVE SHEEP***
815 GOSUB140
820 FORN=1TONS
830 Z=INT(S(N))
835 GOSUB100
840 IFABS(XS-XD)>3ORABS(YS-YD)>3THEN180
843 IFABS(XS-XD)<2ANDABS(YS-YD)<2THEN180
845 IFXS>XDTHENXS=XS+1
850 IFXS<XDTHENXS=XS-1
855 IFYS>YDTHENYS=YS+1
860 IFYS<YDTHENYS=YS-1
865 GOSUB220
870 IFPEEK(W+WS)<>96THEN900
875 POKEW+S(N),96
880 POKEW+WS,20
885 S(N)=WS
900 NEXTN
910 REM ***ALL IN PEN?***
915 P=0
920 FORN=345TO347
925 IFPEEK(W+N)=20THENP=P+1
930 IFPEEK(W+N+33)=20THENP=P+1
935 IFP=NSTHEN1030
940 NEXTN
943 GOSUB2010
945 GOTO710
1000 REM ***END OF GAME***
1010 GOSUB2010
1022 GOTO1040
1025 REM ***DOG IN GATE?***
1030 IFPEEK(W+313)=8THEN1000
1035 GOTO710
1040 TM=INT(S/60)
2010 S=S+1
2040 RETURN
