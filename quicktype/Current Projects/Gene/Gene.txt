10 REM **************
11 REM **   GENE   **
13 REM **************
100 GOSUB 1000:REM MONTA A MATRIZ
101 G=0:SN=0
105 G=SI*1000:B$=" "
110 INPUT "NUMBER OF GENERATIONS ";MG
111 GOSUB 1700: REM REGRAS INICIAIS
115 SN=0 THEN INPUT"NO INICIAL E O NUMERO ";GN
120 REM MAIN LOOP
130 G=G+1
140 PRINT"GERACAO ";G
150 GOSUB 2000: REM AVALIA REGRAS
160 GOSUB 2500:REM ABANDONA AS REGRAS ANADEQUADAS
170 GOSUB 3000:REM AGRUPA AS BOAS REGRAS
180 GOSUB 3500: REM MUTACAO
190 GOSUB 4000: REM ORDENA
200 IF G<MG THEN 120
220 GOSUB5000:REM INDTROZ NOVAS REGRAS
250 END
999 :
1000 REM ROTINA PARA MONTAR O MAPA
1001 SI=20:NR=24
1010 DIM N$(20),L(20,20)
1011 DIM N(SI)
1012 DIM R$(NR),RV(NR)
1013 REM REGRAS E VALOR DAS REGRAS
1015 FOR I=1 TO SI
1010 FOR J=1 TO SI
1022 L(I,J)=1000:REM DEFEITO
1023 IF I=J THEN L(I,J)=0
1025 NEXT J:NEXT I
1030 NC=0:L=0
1032 FOR I=1 TO NR:RV(I)=0:NEXT I
1033 RESTORE
1040 REM LER HOME E NUMERO DO NO
1050 READ N$,ID
1055 PRINT N$,ID
1060 IFID<>0THENGOSUB1500
1070 IFID<>0THEN1040
1080 PRINT NC;"LOCALIZAGOES LIDAS"
1088 PRINT L;"MALHAS SEM DEFEITO"
1090 RETURN
1100 :
1500 REM NO INDIVDUAL E CONECCOES
1510 NC=NC+1
1520 IF ID<>NC THEN PRINT"CUIDADO NO";ID;" NAO FUNCIONA"
1530 N$(NC)=N$
1550 REM MONTA A NATRIZ DAS DISTANCIAS NODAIS
1560 READ NI,NT
1570 L(ID,NI)=NT
1580 REM MALHAS ZERO NAO INTERESSAM
1590 L=L+1
1600 IF NT>0 THEN 1550
1610 RETURN
1620 :
1700 REM REGRAS INICIAIS SIMULADADAS
1710 S$=LEFT$("ABCDEFGHIJKLMNOPQRSTUVWXYZ",SI)
1720 FOR R=1 TO NR
1730 R$(R)=S$
1740 PRINT S$,R
1750 I=INT(RND(0)*ST+1):J=INT(RND(0)*ST+1)
1755 IF I=1 OR J=1 THEN 1750
1760 GOSUB 6000:REM TROGA
1770 NEXT R
1775 RETURN
1777 :
2000 REM ROTINA DE AVALIAGAO DAS REGRAS
2010 T=0
2020 FORR=1 TO NR
2030 IFRV(R)<=0 THEN GOSUB 2200
2040 T=T+RV(R)
2050 NEXT R
2060 AV=T/NR:REM VALOR MEDIO
2070 PRINT"PONTUACAO MEDIA";AV
2080 RETURN
2100 :
2200 REM AVALIACAO DE REGRA UNICA
2210 S$=R$(R)
2220 P1=SN:REM NO INICIAL
2230 GT=0
2240 FOR S=1 TO LEN(S$)
2250 P2=ASC(MID$(S$,S,1))-64
2260 IF P2=SN THEN 2290
2270 GT=GT+L(P1,P2)
2280 P1=P2
2290 NEXT S
2300 RV(R)=GT+L(P2,SN)
2310 RETURN
2320 :
2500 REM ROTINA PAIA ABANDONAR REGRAS INADQUADAS
2510 FOR R=1 TO N
2515 IFRV(R)<R THEN R=RV(R)