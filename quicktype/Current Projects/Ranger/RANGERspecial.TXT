0 CLS:DIMA$(98),S$(8),K(255),X,Y,D,K,E(10,10),I,J,V,A,B,T,G,P,M,E,I(8),J(8),Q,C,B(4,2),Z,W,F,L,C1,C2,X(63),Y(63),SC:GOTO100
1 X=X+(X>1):D=1:RETURN
2 X=X+(X>1):Y=Y-(Y<84):D=2:RETURN
3 Y=Y-(Y<84):D=3:RETURN
4 X=X-(X<68):Y=Y-(Y<84):D=4:RETURN
5 X=X-(X<68):D=5:RETURN
6 X=X-(X<68):Y=Y+(Y>1):D=6:RETURN
7 Y=Y+(Y>1):D=7:RETURN
8 X=X+(X>1):Y=Y+(Y>1):D=8:RETURN
9 V=VARPTR(A$(J)):V=V-(V<0)*F:B=PEEK(V+2)*256+PEEK(V+3)+I-1:POKEB,C:RETURN
10 A=ASC(MID$(A$(J),I,1)):RETURN
15 I=16:J=7:T=T-1:IFT<0THENT=0:RETURN
16 I=I+I(D):J=J+J(D):P=PEEK(G*J+I+M):IFI<0ORI>31ORJ<0ORJ>14THEN45
17 POKEG*J+I+M,196:IFP<>128THEN40
18 POKEG*J+I+M,128:GOTO16
20 PRINT@.,MID$(A$(Y),X,G)MID$(A$(Y+1),X,G)MID$(A$(Y+2),X,G)MID$(A$(Y+3),X,G)MID$(A$(Y+4),X,G)MID$(A$(Y+5),X,G);
21 PRINTMID$(A$(Y+6),X,G)MID$(A$(Y+7),X,G)MID$(A$(Y+8),X,G)MID$(A$(Y+9),X,G)MID$(A$(Y+10),X,G)MID$(A$(Y+11),X,G);
22 PRINTMID$(A$(Y+12),X,G)MID$(A$(Y+13),X,G)MID$(A$(Y+14),X,G);:P=PEEK(16624):PRINT@240,S$(D);:IFP<>128THEN90
23 I=X/10+RND(3)-.5:J=Y/10+RND(2)-.5:IFE(I,J)THENIFRND(6)<=E(I,J)THEN50
24 H=K(PEEK(2)ANDPEEK(17023)):EXEC17150:K=PEEK(255):IFKORHTHENONKGOSUB1,7,8,5,89,6,89,3,2,89,89,4:ONHGOSUB15,80:GOTO20
25 IFX<68ORY<84THEN23
26 IFZ=0THEN23
27 POKEZ,128:Z=Z+W:IFZ>16856ORZ<16852THENW=-W:GOTO27
28 POKEZ,0:IFRND(20)=1THENPOKE49151,68:E=E-RND(10+L):GOSUB60:POKE49151,28:IFE<0THEN95
29 GOTO23
30 E(I/10,J/10)=E(I/10,J/10)-1:Q=Q-1:RETURN
40 IFRND(5)=1THEN45 
41 POKEG*J+I+M,255:IFP=0THENZ=0:POKEG*J+I+M,255:SC=SC+1000:GOTO45
42 I=I+X:J=J+Y:C=128:GOSUB9:IFP=217THENGOSUB30:SC=SC+5*L:IFQ<1THEN96
45 GOSUB60:RETURN
50 POKE49151,68:E=E-RND(10+L):GOSUB60:POKE49151,28:IFE<0THEN95
53 FORP=1TO4:IFB(P,0)THENIFABS(I-B(P,1)/10)<3ANDABS(J-B(P,2)/10)<2THENB(P,0)=B(P,0)-1:IFB(P,0)<1THEN55
54 NEXT:GOTO24
55 C=128:I=B(P,1):J=B(P,2):GOSUB9:I=I+1:GOSUB9:P=4:NEXT:GOTO20
60 PRINT@480,"";:M$=MID$(STR$(T),2)+"/":GOSUB70:PRINT@490,"";:M$=MID$(STR$(E),2)+"/":GOSUB70
65 PRINT@502,"";:M$=MID$(STR$(Q),2)+"/"
70 FORB=1TOLEN(M$):PRINTMID$(A$,(ASC(MID$(M$,B,1))-46)*2,2);:NEXT:RETURN
80 CLS0:SOUND99,1:PRINT@8,"LONG-RANG SCAN";:IFE<20THENPRINT@64,"INOPERATIVE":GOTO88
81 PRINT@64,"     0 1 2 3 4 5 6 7 8 9"
82 FORJ=0TO9:PRINTJ;TAB(4);:FORI=0TO9:?STR$(E(I,J));:NEXT:?:NEXT:C1=32*(INT(Y/10)+3)+INT(X/10)*2+7+M:POKEC1,PEEK(C1)-64
88 PRINT@480,"HIT space";:ON-(INKEY$<>" ")GOTO88:CLS0:POKE49151,28:GOSUB60
89 RETURN
90 ONK(P)GOTO91,92,93:GOTO95
91 X=RND(66):Y=RND(83):GOTO20
92 ONDGOSUB1,89,89,89,5:T=15:E=99:ONDGOSUB1,2,3,4,5,6,7,8:GOSUB300:GOSUB60:GOTO20
93 C=128:I=X+16:J=Y+7:GOSUB9:SC=SC+100:GOTO20
95 FORT=1TO10STEP2:PRINT@240,MID$(" ",T,2);:FORE=1TO150:NEXT:NEXT:E=0
96 GOSUB60:FORT=1TO999:M$=INKEY$:NEXT:CLS0:SOUND98,1:CLS:IFQ<1THENPRINT"ALL KLINGONS DEFEATED!":GOTO98
97 PRINT"U.S.S. RANGER DESTROYED."
98 PRINT"SCORE:"SC,:IFSC>X(0)THENX(0)=SC
99 PRINT"HIGH:"X(0):T=0:E=0:GOSUB81:FORT=1TO2500:NEXT:CLS0:SOUND1,1:PRINT@267,"TRY AGAIN?";:GOTO400
100 A$(1)="AAUAUUUUUAUA"
102 A$(2)="AUUAUUAUUUU"
103 A$(3)="UUUUUUUUUUAUU"
104 A$(4)="UUUAAAUUUUUU"
105 A$(5)="UUUUUUQAUUU"
106 A$(6)="UUQUAUAUUU"
107 A$(7)="UUAAQUUUAU"
108 A$(8)="UUUAUUA"
109 A$(9)="UUU"
110 A$(10)=""
111 A$(11)=""
112 A$(12)="A"
113 A$(13)="UAUUQ"
114 A$(14)="UUQU"
115 A$(15)="U"
116 A$(16)=""
117 A$(17)=""
118 A$(18)="UUQAAAQQ"
119 A$(19)="UUUUUAUUUUUAAUAQ"
120 A$(20)="UUUUUUUUQUUUUAQUAA"
121 A$(21)="UUUUUUUUUUUUUUUQ"
122 A$(22)="UUUUUUUUUUU"
123 A$(23)="UUUUUUUU"
124 A$(24)="UUUU"
125 A$(25)="UUU"
126 A$(26)="UUU"
127 A$(27)="UUUUUU"
128 A$(28)="UUU"
129 A$(29)="UA"
130 A$(30)="UUUQA"
131 A$(31)="UUU"
132 A$(32)="QUU"
133 A$(33)="UUUUAA"
134 A$(34)="UUUUUEUQU"
135 A$(35)="UUUUUU"
136 A$(36)="UUU"
137 A$(37)="UUUUUU"
138 A$(38)=""
139 A$(39)="UU"
140 A$(40)="UEUUA"
141 A$(41)="AA"
142 A$(42)="EUUAUAA"
143 A$(43)="AUUAU"
144 A$(44)="UUAAUA"
145 A$(45)="UAUUAUAAUU"
146 A$(46)="UUUUUUUAAUUUAA"
147 A$(47)="UUUUUUAUUUAUA"
148 A$(48)="AUUUUUU"
149 A$(49)="AAUAA"
150 A$(50)="AA"
151 A$(51)="A"
152 A$(52)=""
153 A$(53)=""
154 A$(54)="AUQ"
155 A$(55)="UUAQUUEQ"
156 A$(56)="UAUU"
157 A$(57)="UUQA"
158 A$(58)="UU"
159 A$(59)="UU"
160 A$(60)="U"
161 A$(61)="U"
162 A$(62)=""
163 A$(63)=""
164 A$(64)="U"
165 A$(65)="UUUU"
166 A$(66)="UUUUUUUU"
167 A$(67)="UAAUUUUUUUUUUAA"
168 A$(68)="UAAAUUUUUUUUUUAAAU"
169 A$(69)="UAAAAAAAAAAAAAAA"
170 A$(70)="UUUUUUUU"
171 A$(71)="UUUU"
172 A$(72)=""
173 A$(73)=""
174 A$(74)="U"
175 A$(75)="U"
176 A$(76)="UUUA"
177 A$(77)="UUUUQAU"
178 A$(78)="UUUUUUUA"
179 A$(79)="UUUUUU"
180 A$(80)="UUUUUQ"
181 A$(81)="UUUUUAAW"
182 A$(82)="UUUUUUUUAAAAAAAAAAAW"
183 A$(83)="UUUUUUUAAW"
184 A$(84)="UUQ"
185 A$(85)=""
186 A$(86)=""
187 A$(87)=""
188 A$(88)=""
189 A$(89)=""
190 A$(90)=""
191 A$(91)=""
192 A$(92)="UUUUUUUUUUUUU"
193 A$(93)="UUUUUUUUUUUUUUUUUUUUUU"
194 A$(94)="UUUUUUUUUUUUUUUUUUUUUUUUUUUU"
195 A$(95)="UUUUUUUUUUAAAAUUUUUUUUAAUUUUUUUUUU"
196 A$(96)="UUUUUUUUUUUUUAAAAAAUUUUUUUUUUUUUUUUUUUUUUU"
197 A$(97)="UUUUUUAAAUUUUUUUAAAAUUUUUUUUUUUAAUUUUUUUUUUUUUU"
198 A$(98)="UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUAAUUUUUUUUU"
200 K(32)=1:K(76)=2:FORT=129TO192:K(T)=1:NEXT
210 S$(1)="":S$(2)="":S$(3)="":S$(4)="":S$(5)="":S$(6)="":S$(7)="":S$(8)="":K(251)=2:K(247)=2
215 I(1)=-1:I(2)=-1:I(3)=0:I(4)=1:I(5)=1:I(6)=1:I(7)=0:I(8)=-1:K(143)=3:J(1)=0:J(2)=1:J(3)=1:J(4)=1
216 J(5)=0:J(6)=-1:J(7)=-1:J(8)=-1:M=16384:G=32:Z=16851:W=1:F=65536:C1=RND(-(PEEK(9)*256+PEEK(10))):GOSUB510
220 A$=""
225 B$="":PRINT@75,"star ranger"
226 PRINT@129,"USE: 2 KEYS FOR DIAGONALS FROM  awsz 1 FOR UP/DOWN LEFT/RIGHT.  HIT space TO FIRE AND l FOR"
227 PRINT" LONG-RANGE SCAN.":PRINT@289,"DESTROY ALL KLINGONS.":PRINT" YOU HAVE 4 BASES. bonuses:"
234 PRINT" RESCUE ESCAPE PODS AND DEFEAT   THOLIAN.":FORT=1TORND(5)
240 P=10+RND(70):K=10+RND(70):A=0:FORY=1TO5:FORX=1TO8:A=A+1:C=ASC(MID$(B$,A,1)):I=P+X:J=K+Y:GOSUB9:NEXT:NEXT:NEXT
250 X=17:Y=10:C1=40:C2=20:K=1:GOSUB280:B(K,1)=I:B(K,2)=J:C1=64:C2=78:FORK=2TO4:GOSUB280:B(K,1)=I:B(K,2)=J:NEXT
270 FORK=1TO4:B(K,0)=12:C=251:I=B(K,1):J=B(K,2):GOSUB9:C=247:I=I+1:GOSUB9:NEXT
271 PRINT@448,"LEVEL (1-3)?":M$=INKEY$:ON-(M$="")GOTO271:L=VAL(M$):IFL<1ORL>3THEN271
272 PRINT@448,"WAIT...":FORY=0TO10:FORX=0TO10:E(X,Y)=0:NEXTX,Y:Q=20+10*L:Y(0)=Q:C=217:C1=90:C2=90:X=6:Y=6:FORK=1TOQ
273 GOSUB310:NEXT:FORK=51TO53:GOSUB310:NEXT:Q=Q+3:C=143:C1=64:C2=78:X=16:Y=10:FORK=54TO63:GOSUB280
274 X(K)=I:Y(K)=J:NEXT:X=1:Y=1:E=99:T=15:D=4:CLS0:POKE49151,28:GOSUB60:GOTO20
280 I=X+RND(C1):J=Y+RND(C2):GOSUB10:IFA<>128THEN280
290 GOSUB9:RETURN
300 C1=30:C2=13:FORK=51TO50+L:I=X(K):J=Y(K):GOSUB10:IFA<>128THENGOSUB30:C=128:GOSUB9
305 Q=Q+1:C=217:GOSUB310:NEXT:RETURN
310 GOSUB280:X(K)=I:Y(K)=J:E(I/10,J/10)=E(I/10,J/10)+1:RETURN
320 I=X(K):J=Y(K):GOSUB9:RETURN
400 M$=INKEY$:IFM$=""THEN400
410 IFM$="Y"THENCLS:C=128:FORK=1TOY(0):GOSUB320:NEXT:FORK=51TO63:GOSUB320:NEXT:SC=0:GOTO270
420 ON-(M$<>"N")GOTO400:END
510 X=17150:GOSUB5100:GOSUB5100:RETURN
5100 READM$:FORI=1TOLEN(M$)STEP2
5110 H=ASC(MID$(M$,I,1))-48:IFH>9THENH=H-7
5120 L=ASC(MID$(M$,I+1,1))-48:IFL>9THENL=L-7
5130 POKEX,H*16+L:X=X+1:NEXT:RETURN
5140 DATA8D0F541B880F97FF39FD01FB08F7047F0438,4F36EC0708089702F4BFFF4D322AE11B20EF
