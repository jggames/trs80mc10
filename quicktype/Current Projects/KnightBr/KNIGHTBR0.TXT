
2 REM Adapted to 6800 TINY BASIC by Dave Hassler, 2023
3 REM Uses SWTBUG - OUTEEE is at $E1D1/#57809 (see line 15, 580)
8 PR
10 PR"  KNIGHTSBRIDGE by Tim Hartnell, 1983"
12 H=2432
13 P=276
15 V=57809
16 O=280

18 Z=224
20 GOTO760
40 IFU=5GOTO680
45 IFC=5GOTO680
50 GOSUB300
60 GOSUB490
70 IFU=5GOTO680
75 IFC=5GOTO680
80 GOSUB110
90 GOTO40

110 REM Player moves
120 Q=0
130 M=RND(66)+11
140 Q=Q+1
150 IFQ=500GOTO680
160 A=USR(P,H+M)
162 IFA<>72GOTO130
170 PR"You must move ";M
180 INPUTN
190 IFN=99THENQ=500
195 IFN=99GOTO680
200 REM move legal?
210 F=0
215 T=1
220 D=USR(P,Z+T)
222 D=D-100
225 L=M+D
230 IFL<>NGOTO240
232 A=USR(P,H+N)
235 IFA=46THENF=1
237 IFA=67THENF=1
240 IFT<9THENT=T+1
245 IFT<9GOTO220
250 IFF=0THENPR"Illegal move"
255 IFF=0GOTO180
260 IFA=67THENU=U+1
265 IFA=67THENPR"Well played!"
270 A=USR(O,H+M,46)
275 A=USR(O,H+N,72)
280 RETURN

300 REM Computer
310 R=0
315 F=0
320 R=R+1
330 K=RND(66)+11
340 IFR=500GOTO680
345 A=USR(P,H+K)
350 IFA<>67GOTO320
360 PR"I moved ";K;
370 W=1
375 A=USR(P,Z+W)
377 A=A-100
380 IFK+A<11GOTO400
385 IFK+A>77GOTO400
390 B=USR(P,H+K+A)
392 IFB=72THENF=1
394 IFB=72THENC=C+1
396 IFB=72GOTO450
400 IFW<9THENW=W+1
405 IFW<9GOTO375

410 W=1
415 A=USR(P,Z+W)
416 A=A-100
417 IFK+A<11GOTO422
419 IFK+A>77GOTO422
420 GOTO430
422 IFW<9THENW=W+1
424 IFW<9GOTO415

430 A=USR(P,Z+W)
431 A=A-100
432 B=USR(P,H+K+A)
434 IFB<>46THENIFW<8THENW=W+1
436 IFB<>46THENIFW<8GOTO430
440 IFW=8THENIFB<>46THENR=500
445 IFW=8THENIFB<>46GOTO680
450 X=K
455 Y=K+A
460 E=USR(O,H+X,46)
462 E=USR(O,H+Y,67)
463 PR" to ";Y
465 IFF=1THENPR"Gotcha!"
467 IFF=1THENF=0
470 RETURN

490 REM PR board
500 PR
510 PR"Score: Me ";C;"  You ";U
530 PR
540 PR"  1 2 3 4 5 6 7"
550 PR"  -------------"
560 M=70
565 PR M/10;" ";
570 N=1
575 A=USR(P,H+M+N)
580 E=USR(V,A)
585 E=USR(V,32)
590 N=N+1
595 IFN<=7GOTO575
597 PR
600 M=M-10
605 IFM>=10GOTO565
630 PR"  -------------"
640 PR"  1 2 3 4 5 6 7"
650 PR
660 RETURN

680 REM End of game
700 IFU=5THENPR"5 captured, you win."
710 IFC=5THENPR"5 captured, I win."
720 IFQ=500THENPR"You concede."
730 IFR=500THENPR" I concede."
740 END

760 REM Initialise
770 PR
775 PR"Stand by...."

790 X=0
792 R=0
794 Q=0
800 U=0
810 C=0

820 I=10
822 J=1
824 E=USR(O,H+I+J,46)
826 J=J+1
828 IFJ<=7GOTO824
830 I=I+10
832 IFI<=70GOTO822

840 J=1
842 E=USR(O,H+70+J,67)
844 E=USR(O,H+10+J,72)
846 J=J+1
848 IFJ<=7GOTO842

890 E=USR(O,Z+1,92)
891 E=USR(O,Z+2,79)
892 E=USR(O,Z+3,88)
893 E=USR(O,Z+4,81)
894 E=USR(O,Z+5,119)
895 E=USR(O,Z+6,112)
896 E=USR(O,Z+7,121)
897 E=USR(O,Z+8,108)

910 GOTO50
