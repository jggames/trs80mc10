0 CLEAR500:DIMCC,ZZ,M$,I$:GOTO20
1 ZZ=1:CC=32:FORCC=CCTOZZSTEP-1:I$=MID$(M$,CC,1):IFI$<"!"THEN?MID$(M$,ZZ,CC-ZZ):ZZ=CC+1:CC=ZZ+32:IFI$=""THENCC=.
2 CC=CC+(CC>255)*(CC-255):NEXT:M$="":RETURN
3 N3=N1-(N2*INT(N1/N2)):RETURN
20 DIMP$(9,10),M$(5,6),CL$(13),CG$(13),F$(4),MP$(2),MW$(2)
30 CLS
40 S$="COPYRIGHT 1987 COMPUTE!":GOSUB1460:S$="ALL RIGHTS RESERVED":GOSUB 1460:PRINT:PRINT
50 PRINT:PRINT:S$="PRESENTING":GOSUB1460:PRINT:S$="+---------------+":GOSUB1460:S$="! MYSTERY MANIA !":GOSUB1460:S$="+---------------+":GOSUB1460
60 PRINT:S$="MC-10 GENERATED MURDER MYSTERY":GOSUB1460:S$="LOGIC PROBLEMS FOR YOU TO SOLVE":GOSUB1460:S$="PRESS SPACE BAR TO CONTINUE.":GOSUB1470
70 S$="GAME CAN GENERATE 32001 DIFFERENT MYSTERIES, NUMBERED 0 TO 32000.":GOSUB1470
71 S$="YOU CAN PLAY THE SAME GAME REPEATEDLY BY CHOOSING THE SAME NUMBER, OR YOU CAN CHOOSE A DIFFERENT MYSTERY EACH TIME.":GOSUB1470
80 PRINT:INPUT"WHICH MYSTERY STORY (0-32000)";M:IFM<0ORM>32000THENPRINT"INVALID ANSWER!":GOTO80
90 CC=RND(-ABS(M))
100 N1=M:N2=99:GOSUB3:FORX=0TON3:Y=RND(0):NEXTX
110 PRINT:S$="THERE ARE FIVE DIFFICULTY LEVELS. LEVEL 1 IS EASY, WHILE LEVEL FIVE WOULD EVEN STUMP SHERLOCK HOLMES.":GOSUB1360
120 PRINT:PRINT"DIFFICULTY LEVEL (1-5)";
130 S$=INKEY$:IFS$<"1"ORS$>"5"THEN130
140 PRINTS$:L=VAL(S$)
150 PRINT:PRINT"DO YOU WANT HARD COPY OF THE":PRINT"STORY (Y/N)?";:GOSUB1430:PR=YN:PRINTY$
160 CLS
170 REM READ IN DATA
180 FORX=0TO9:FORY=0TO10:READP$(X,Y}:NEXTY:NEXTX
190 FORX=0TO2:READMP$(X):NEXTX:FORX=0TO2:READMW$(X):NEXTX
200 REM GENERATE SUSPECT NAMES
210 A=INT(RND(0}*11):B=INT(RND(0)*11):V$=P$(0,A)+" "+P$(1,B):P$(0,A)="":P$(1,B)=""
220 FORX=1TO5
230 A=INT(RND(1)' 11): AS""PS (0,A):P$(0,A) - "":IF AS-"" THEN 230
240 B=INT TRND (1) U 1) : BS=PS (1,B):P.(L,B)== ":IF BS" " " THEN 240
250 MS (21, X) =AS+" "+B'
260 NEXT X
270 FOR X=0 TO 4:FS(X)=M$(0,X+1) : NEXT X
280 FOR XC 0 TO 9: A=INT (RND (1)'5):B=INT(RND(1)'5):SWAPFICA),FI(B):NEXT X
290 S$=:::"SIX MEN, "+V$+", "+FS(0)+", "+FI(L)+", "+FS(2)+", "+FI(3)+", AND "+FS(4)+" WERE IN "+MP$(INT(RND(1)'3»+" TOGETHER. SUDDENLY, THE LIGHTS WANT OUT ." : GOSUB 1360
300 S$="WHEN THE LIGHTS CAME BACK ON, "+V$+" WAS FOUND "+MW$(INT(RND(0)*3))+".":GOSUB1360
310 PRINT:S$="THE OTHER DETECTIVES HAVE INVESTIGATED.":GOSUB1360
311 S$="THEY HAVE QUETIONED THE SUSPECTS, THE WITNESSES, AND PEOPLE WHO KNOW THE SUSPECTS.":GOSUB1360
312 S$="THEY HAVE COLLECTED PHYSICAL EVIDENCE (HAIR SAMPLES, FIBER SAMPLES, ETC.) FROM THE CRIME SCENE.":GOSUB1360
320 REM GENERATE SUSPECT DATA
330 FOR P=L TO 5
340 A=INT(RND(0)*8+2):IFP$(A,0)=""THEN340
350 MICP,0)=P$(A,0):P$(A,0)="= !J 
360 FOR V=L TO 5
370 B::::INT(RNDC1"9)+1:IF P$(A,B) "" " THEN 370
380 M$(P,V)=P$(A,B):PS CA,B)="
390 NEXT V
400 M$(P,6)=P$(A,10)
410 NEXT P
420 PRINT:M$="THEY HAVE COLLECTED 14 CLUES, BUT HAVE NOT BEEN ABLE TO SOLVE THE CRIME.":GOSUB1360
421 M$="THEREFORE, THEY HAVE CALLED IN THE CITY'S GREATEST HOMICIDE DETECTIVE.":GOSUB1360
422 S$="THAT'S you! YOU WILL NOW BE GIVEN THE CLUES, AND MUST SOLVE THE MURDER.":GOSUB1360
430 REM GENERATE CLUES
440 KS:MSC0 .6-L+(L=3)-(L=4» : C'=MI(4~0)+" "+M$(4,6-L+(L=3)-(L=4))
450 CL$(0)=M$(0,1)+" "+M$$(2,0)+" "+M$(2,1)
460 CL$(1)=M$(0,2)+" "+M$$(5,0)+" "+M$(5,2)
470 CL$(2)=M$(0,3)+" "+M$$(1,0)+" "+M$(1,3)
480 CL$(3)=M$(0,4)+" "+M$$(3,0)+" "+M$(3,4)
490 C1=(RND(0)<.5):IFC1<>0ORL=1THENCL$(4)=M$(0,5)+" "+M$(1,0)+" "+M$(1,5):GOTO500
491 CL$(4)=M$(0,5)+" "+M$(4,0)+" "+M$(4,5)
500 T$="THE SUSPECT WHO ":N$=" IS NOT THE ONE WHO "
510 A1$=M$(2,0):A2$=M$(2,4):B1$=M$(4,0):B2$=M$(4,4):GOSUB1500
520 CL$(5)=T$+A1$+" "+A2$+" "+B1$+" "+B2$
530 AII- M. (1,0): A21=MS (1,4): IF RND(1) ( .5 THEN CII- NS+M1(5,0)+" "+M$(5,2):GOTO 560
540 91$=MI(5,0):B2S="'$(5,4)
550 CIS-" "+B1S+" "+B21
560 CLI (6) ""TI+AL S+" "+A21+CL S
570 AII- MI(1,0):A21=M$(1,4):9II- MIC2,0L:B21-M.(2,4):GOSUB 15210
580 NF"'0:GOSUB 1510:CLS(7'=TLL
590 ALS::M$(1,0):A2S=M$(1,2):BIS-,.,SC2,0):92IM MIC2,2):GOSUB 15210
600 GOSUB 1510:CLI(8)=QI
610 ALS=MI (2,0':A2S=MI(2,2) :BII-M.C4,0' : B21-M. (4, 2) :GOSUB 1500
620 GOSUB 1510: CLS (9) =GLS
630 ALS=MI(1,0):A21~M$(L,5):BII-M.(4,0):B21-M$(4,5):GOSUE 1500
640 GOSUB 1510:CL$(10)-TLL
650 ALS"""'1(1,0):A21=MIC1,1):B1S""'1(4,0):B2S""MI(4,3):GOSUB 15210
660 NF=L:GOSUB 1510:CL$(1L)=TL
670 ALL=M$(2,0L:A2S=M$(2,S):B1$- MI(3,0):92S- MI(3,2):GOSUB 1500
680 GOSU9 1510:CL$(12)=GLS
690 CLS (13) ="THE MURDERER "+CI:S$-"PRES. SPACE BAR TOSEE CLUL!S.":GOSUB 1490
700 REM OUTPUT CL UES
710 FOR X-0 TO 13:CGS(X' - CL$(X):NEXT X
720 FOR X=0 TO 25:A=INT(RND(1)'14):B-INT(RND(LLI14):SWAP CBI(A),CBSCB):NEXT X
730 S$C"NO TWO SUSPECTS HAVETHE .AM. "+MI (1,6) +", "+'"'(2,6)+", "+""(3,6)+", "+"'S(4,6)+" OR "+""(5,6)+" .":GOSUB 1360
740 FOR X=0 TO B:S$=CGS(X'+".":GOSUB 13B0:PRINT:NEXT X
750 SI- "PRESS SPACE BAR TO CONTINUE. ":GOSUB 1490
760 FOR X=7 TO 13:S$=CGI(X)+".":GOSUB 1360:PRINTLNEXTX
770 SI",,"PRES!5 SPACE BAR TO MAKE AN ARREST . ":GOSUB 1490
780 REM GET PLAYER"S SOLUTION
790 H=0: PR=0: CLS: PRINT: PRINTYOU MAY NOW": PRINT
800 FOR X=0 TO 4:PRINT MIDI(STRS(X+L),2,1)") ARREST "FI(X):NEXT X
810 PRINT"6) QUIT WITHOUT SEEING SOLUTION":PRINT"7) SEE SOLUTION TO MYSTERY"
820 IFL>1THENPRINT "8) GET A HINT"
830 PRINT:PRINT"SELECT NUMBER OF YOUR CHOICE.";
840 Y$=INKEY$:IFY$<"1"ORY$>"8"THEN840
850 IFL=1ANDY$="8"THEN840
860 PRINT Y$:V=VAL(Y') :PRINT
870 IF V=6 THEN 5$="ENDING GAME. THIS WAS MYSTER Y ""+5TR$(M)+". MAKE A NOTE OFTHIS SO YOU CAN COME BACKTO THIS GAME LATER IF YOU LIKE.": GOSUB 1360: GOTO12321
880 IF V=7 THEN 940
890 IF V=8 THEN H=1:GOTO 9421
900 IF FS (V- 1) =KS THEN S$="CORRECT! CONGRATULATIONS. YOU HAVE BEEN PROMOTED TOCHIEF OF PCLICE.":GOSUB 1360:GOTO 123E1
910 S$="SORRY, YOU' 'IE ARRESTED THE WRONG SUSPECT. DO YOU WANT TO SEE THE CORRECT SOLUTION (Y/ N)?":GOSUB1360
920 GOSUE 143 0: IF YN=0 THEN 1230
930 REM EX PLAIN SOLUTION AND GIVE HINTS
940 PR=I2J:PRINT: S$="DO Y OU WANT HARD COPY OF THE E XPLANATION (Y/N) ? ":GOSUB 1360:GOSUB 1430:PR=YN
950 CLS
960 S$=CL$(4 ) +" . " : IF CL <)0 ORLE1 THEN S$=S$+" "+CLS (10)+". THEREFORE, "+M$(0,5) + " "+M$(4, 0 )+" "+M$(4 , S)+". "
970 GOSUB1360
980 IF L=L THEN S$=CL$(13 ) +",SO "+KS+" IS THE MUR-DER-ER-.":GOSUS 1360:GOTO 1230
990 S$=CL$(13)+", SO "+M$(0,5) +" IS NOT THE MUR-DER-ER.":GOSUB 1360
1000 IF H=L THEN PRINT: PRINT"WANT ANOTHER HINT (Y I N)?";: BOSUS 1430: PRINT YS:IF YN=0 THEN 7921
1010 S$=CL$(5)+".":GOSUB1360:S$=CL$(7)+".":GOSUB1360:S$=CL$(6)+".":GOSUB1360:S$="THEREFORE, ONE SUSPECT "+M$(2,0)+" "+M$(2,4)+", "+M$(4,0)+" "+M$(4,4}+", "+M$(1,0}+" "+M$(1,4)+", AND"+C1$+".":GOSUB1360
1020 S$="BUT "+CL$(0)+", "+CL$(1)+", "+CL$(2)+", AND"+M$(0,5)+" "+"+M$(4,0)+" "+M$(4,5)+".":GOSUB1360
1330 S$="PRESS SPACE BAR TO CONTINUE.":GOSUB1490
1040 S$="THEREFORE, THAT ONE SUSPECT IS "+M$(0,4)+".":GOSUB1360
1050 IFL=2THENS$="SINCE "+M$(0,4)+" "+M$(4,0)+" "+M$(4,4)+", HE IS THE MURDER.":GOSUB1360:GOTO1230
1060 S$="SF NCE " +"" (0, 4) +" "+M$(4,0)+" "+M$(4,4)+", HE I & NOT THE MUR-DER.R.":GOSUB 1360
1070 IF H=1 THEN PRINT "WANT ANOTHER HINT (YIN)?"; :GOSUB1430:PRINT YS:IF YN-" THEN 790
1980 S$=CL$(8}+". "+CL$(9)+".:,.! GOSUB 1360: S$="THEREFORE, CNE SUSPECT "+M$ (1,")+" "+M$(L,2)+", "+M$(2,O)+" "+M$(2,2)+", AND "+M$(4,0)+" "+M$ (4,2 ) +".":GOSUB 1360
1090 S$:CL$(F3}+", "+CL$(2)+","+M$(0,5)+" "+M$(4,0)+""+M$(4,:5)+", AND "+11'(21,4)+" "+M$(4,0)+" "+M$(4,4)+".":GOSUB 1360:9,="THEREFCRE, THAT ON. SUSPECT IS "+M$(0,2)+".":GOSUB 1360
1100 IF L=3 THEN S$="SINCE "+MS,E,2)+" "+1'1'(4,21)+" "+M$(4,2)+", H. IS THE MURDLLRER-.":GOSUB 1360:BOTO1230
1110 S$="SINCE "+M$(0,2)+" "+M$(4,0)+" "+M$(4,2)+", HE IS NOT THE MUR-DERER.":GOSUB 1360
1120 S$="PRESS SPACE BAR TO CONTINUE.":GOSUB 14921
1130 IF H::AL THEN PRINT "WANTANOTHER HINT (YIN)?"; :GOSUB 143E:PRINT YS:IF YN=21 THEN 7921
1140 IF CL THEN S$:CLS (4) +"."ELSE 91:CL$ (10) +". "+CL$(4)+". THEREFOR-E, "+M$(21,5)+" "+I'1S(I,0)+" "+I'1S(1,5)+". "
1150 GOSUE 1360
1160 S$=CL$(2)+", "+M$(0,4)+""+M$(I,0)+'.' "+1'1$(1,4)+", "+M$(0,2)+" "+M$(L , 0)+" "+M$(I,2)+".":GOSUB 1360: S$- "THEREFORE, "+MS (£I, 1}+" IS THE ONE WHO "+M$(L,0)+" "+M$(1,1)+".":GOSUB1360
1170 S$:::"THIS MEANS TH3.T "+M$(O,1)+" IS NOT THE SUSPECT WHO "+MS (4, 0) +" "+I'1S (4,3)+". ":GOSUB 1360
1180 S$="SINCE "+M$(0,S)+" "+M$(4,0)+" "+M$(4,5)+", "+1'1$(121,4)+" "+M$(4,0)+" "+"'S(4,4)+", AND "+MS(0,2)+" "+""(4,21)+" "+"'$(4,2)+", "+M$(0,3)+" MUST BET.HE ONE WHO "+M$(4,0)+""+M$(4,3)+".":GOSUB 136O
1190 IF L=4 THEN S$:"SINCE THE MURDERER "+CS+", ,. +KS+" IS THE MURDER-ER.":GOSUB 1360:BOTO 123"LH 1290 S$="SINCE THE MURDERER "+CS+","+M$(0,3)+" IS NOTTHE MUR-DERER.":GOSUB 1360
1210 IF H=1 THEN PRINT "WANT ANOTHER CLUE (YIN)?"; :GOSUE 1430:PRINT Y':IF YNA" THEN 7921
1220 S$="BY PROCESS OF ELIMINATION, "+K$+" IS THE MURDERER.":GOSUB1360
1230 PRINT:PRINT"DO YOU WANT TO PLAY ANOTHER":PRINT"GAME (Y/N)?":GOSUB1430:IF YN=1THENRUN
1231 PRINT:END
1240 DATA BILL, DAVI D, JOHN, TOM,FRED,LARRY,BR-IAN,JIM,ROBERT,JACK,MARTYCDNES,HAR-R-ISON,CR-AIG,DAVIS,ED
1250 DATA FOX,MARTIN,SMITH,JONES,HARRISON,CRAIG,DAVIS,EDISON,BROWN,STEVENSON,ALBERTS
1260 DATA HAS,BLACK HAIR,NO HAIR,RED HAIR-,BLOND HAIR-,BROWN HA IR, WH I T E HAI R ,GRAY HAIR,"", "" ,HAIR COL O R
1270 DATA WAS WEARING, A RED SHIRT,AN ORANGE SH I RT,A YELLOW SHIRT,A GREEN SHIRT,A BLUE SHIRT,A PUR-PIESHIRT,A WHITE SHIRT,A BLA C K SHIR-T,"",COLOR SHIRT
1280 DATA OWNS, A R E D C AR, AN 0RANGE C AR-,A YELLOW EAR, AGREEN C A R-, A BLUE CAR, APURPLE CAR,A WHITE CAR,ABLACK CAR,A SILVER CAR ,COLOR CAR
1290 DATA I S ,5 FEET TALL,5 FEET 3 INCHES TALL,S FEET6 INCHES TALL,S FEET 9 INCHES TALL,6 FEET TALL,6FEET 3 INCHES TALL,"","","",HEIGHT
1300 DATA WEIGHS,140 POUNDS, 150 POUNDS, 160 POUNDS, 170POUNDS,LS0 POUNDS,190 POUNDS,2"E POUNDS, 210 POUNDS,220 POUNDS, WEIGHT
1310 DATA WAS WEAR-ING, RED SHOES,WHITE SHOES,BROWN SHOES,BLACK SHOES,TAN SHOES,BLUE SHOES,OR-ANGE SHOES, " ", "",COLOR SHOES
1320 DATA HAS A WIFE N A MED, SUE,JOYCE,L'1AR- Y ,BETTY,PAM,CATHY,JL11,JUDY,SALLY,WIFE ' S F I RST N A MECF
1330 DATA WAS CARRYING,A R-EDUMBRELLA,AN OR-ANGE UMBRELLA,A YELLOW UMBRELLA,AGREEN UMBRELLA,A PURPLEUMBRELLA,A WHITE UMBR-ELLA,A BLACK UMBRELLA,"","",COLOR UMBRELLA
1340 DATA A RESTAURANT,AN ELEVATORFA LIBRARY,STABBED,STRANGLED,SHOT
1350 REM PRINT S$ TO SCREEN AND PRINTER
1360 M$=S$:GOSUB1:IFPRTHENLPRINTS$
1410 RETURN
1430 Y$=INKEY$:IFY$<>"Y"ANDY$<>N"THEN1430
1440 YN=0:IFY$="Y"THENYN=1
1450 RETURN
1460 PRINTTAB((32-LEN(S$))/2)S$:RETURN
1470 LOCATE448,TAB((32-LEN(S$))/2)S$;
1480 ON-(INKEY$<>" ")GOTO1475:RETURN
1490 PRINT@480,TAB((32-LEN(S$))/2)S$;:GOTO1480
1500 IFRND(0)<.5THENM$=B1$:B1$=A1$:A1$=M$:RETURN
1501 M$=B2$:B2$=A2$:A2$=M$:RETURN
1510 N$=" ":IFNFTHENN$=" IS NOT THE ONE WHO "
1520 Q$=t$=A1$+" "+A2$+N$+B1$+" "+B2$:RETURN
1600 REM COPYRIGHT 1987
1610 REM COMPUTE! PUBLICATIONS, INC.
1620 REM ALL RIGHTS RESERVED
