10 REM ROOK & KING V. KING CHESS ENDING (MKII)
30 FILES MOVES
40 DIMT$(440),U$(440),V$(l00),W$(l00)
50 DIMR(14),D(14),F(14)
60 DIMY(30)
70 REM READ IN DATA FOR CHESS NOTATION.
80 RESTORE
90 FORA1=1TO8
100 FORA1=1TO8
110 READT$(l0*A1+A)
120 NEXTA1
130 NEXTA
140 FORA2=1TO8
150 FORA3=1TO8
160 READUS(l0*A3+A2)
170 NEXTA3
180 NEXTA2
190 READZ(0),Z(1),Z(2),Z(3),Z(4),Z(5),Z(6),Z(7)
200 REM READ PARAMETERS FOR SCORING POSITIONS.
210 READA(0),A(1),A(2),A(3),A(4),A(5),A(6),A(7),A(8)
220 READB(0),B(1),B(2),B(3),B(4),B(5),B(6),B(7),B(8)
230 READC(0),C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8)
240 REM PRINTTAB(20)
250 INPUTA$
260 IFA$="END"THEN9999
270 IFA$="NEW"THEN770
280 IFA$="INFO"THEN520
290 IFA$="OFF"THEN540
300 IFA$="Cl"THEN560
310 IFA$="C2"THEN590
320 IFA$="C3"THEN610
330 IFA$="SHOW"THEN630
340 FORA4=1TO8
350 FORA5=1TO8
360 A=10*A5+A4
370 IFA$=U$(A)THEN420
380 NEXTA5
390 NEXTA4
400 PRINT"INVALID INPUT";
410 GOTO240
420 H=9-A+20*INT(A/l0)
430 A=ABS(H-H1)
440 IF(A-1)*(A-10)*(A-11)*(A-9)=0THEN470
450 PRINT"ILLEGAL MOVE";
453 H=H1
454 H2=INT(H/10)
455 H3=H-10*H2
460 GOTO240
470 H2=INT(H/10)
475 H3=H-10*H2
476 GOSUB3290
480 IFL=0THEN450
485 H1=H
490 W$(I)=A$
500 I=I+1
510 GOTO950
520 N3=1
530 GOTO24O
540 N3=0
550 GOTO240
560 REM PRINT"?";
570 INPUTA(0),A(1),A(2),A(3),A(4),A(5),A(6),A(7),A(8)
580 GOTO240
590 REM PRINT"?";
595 INPUTB(0),B(1),B(2),B(3),B(4),B(5),B(6),B(7),B(8)
600 GOTO24O
610 REM PRINT"?";
615 INPUTC(0),C(1),C(2),C(3),C(4),C(5),C(6),C(7),C(8)
620 GOTO240
630 PRINT
64O PRINT
650 PRINT
660 PRINTTAB(6);"7THITE","BLACK"
670 FORA6=1TOI
680 IFY(A6)=1THEN710
690 PRINTA6;TAB(6);V$(a6),W$(A6)
700 GOTO720
710 PRINTA6;TAB(6);V$(A6);"+”,'7$(A6)
720 NEXTA6
750 PRINT
740 P::INT
750 PRINT
760 GOTO24O
770 PRINT"TYPESTARTINGPOSITION";
780 INPUTF,G,H
790 PRINT
800 1=1
810 FI-F
820 G1=G
83O HI=H
840 F2—INT(F/lO)
850 F3=F-10*F2
860 G2=INT(G/lO)
870 C,3=0-10*G2
880 H2=INT(H/lO)
890 H3=H-10*H2
900 RE).!CHECKTHATPOSITIONISLEGAL.
910 GOSUB324O
920 IFL=1THEN950
930 PRINT"ILLEGALPOSITION";
940 GOTO24O
950 REMDECIDEONSETOFPARAMETERS
960 P=ABS(G2-H2)
970 PI=ABS(G3-H3)
980 IF(l-SGN(P-2))*(l-SGN(Pl-2))=0THEIiI25O
990 P2=ABS?F2-H2)
1C00 P3=ABS(F3-H3)
1010 P4=ABS(G2-H2)
1020 P5=ABS(H3-G31
1050 P6=ABSfF2-G2)
1040 P7=ABS(F3-G3)
1050 IFABS?P2-l}+ABS(P4-lJ+ABS(P6-2j=0TI'EN1140
ABS(P3-l)+ABs(P5-l)+ABS(P7-2)
ABS(G2-H2l+ABS(l-SGH(P2-2''
)*(H2-8]>*(H3-1)
)*(H-18;I*(H-81)
**(h-2i;)*■H-7l)
)*(H-28’l*(H-87)
1060 IP
1070 IF
1080 IF
1090 IP
1100 IF
1110 IF
1120 IF
1130 GOTO1290
1140 F=10*F2+2-SGN(F3-l)
1150 IFH3>G3THEN1210
1160 F=10*F2+7-SGN<F3-8)
1170 GOTO1210
1180 F=F3-H0*(2+SGN(l-F2))
1190 IFG2<H2THEN1210
1200 F=F3-HO*(7-SGN?F2-8)'>
1210 F2=XET(P/10)
1215 FI=F
1220 P3=F-10*F2
1230 GOTO2580
1250 FORB5=0TO8
1260 X?B5)=A(B5)
1270 NEXTB5
1280 GOTO1360
1290 FORBo=0TO8
1300 X(B6)=B?B6)
1310 NEXTB6
1320 GOTO1360
I33O IFABS?P-2)_+ABs(H.-2)
liUS-8)<>0
THEN1180
THEN3620
THEN3650
THEN1290
THEN1330
THEN1330
the::1330
THEN1333
1331 IP(G2-l)*(G2-8)*(G3-l)*(G3-8)=0
1332 GOTO1339
1333 IP(H-ll)*(H-18)*(H-8l)*(H-88)=:0
1335 GOTO12^0
1339 FORB7=0TO8
1340 x(B7)=C(B7)
1350 NEXTB7
1360 REMGENERATEALLLEGALMOVES
1365 Ml=M2=1
1370 IPP2-G2THEN1500
1380 IPP3=G3THEN1680
1390 FORA7=(lO*F2+l)TO(lO*F2+8)
1400 IFA7—FTHEN1430
1410 R(Ml)=A7
1420 Ml-Ml+1
1430 NEXTA7
1440 FORA8=(F3+10)TO(F3+80)STEP10
1450 IPA3=PTHENI48O
1460 R(Ml)=A8
1470 Ml=Ml+1
1480 NEXTA8
1490 GOTOI860
1500 IPP>GTHE-;1620
1510 PORA9-(lO*F2+l)TO(G-l)
1520 I??=A9THEN1550
1530 r(r:i)=A9
1540 Ml=Ml+1
1550 NEXTA9
1560 FORAO=(F3+10)TO(P3+80)STEP10
1570 IPAO=PTTSN1600
1580 r(::i)=ao
1590 Ml=Ml+1
1600 ‘!TEXTAO
1610 GOTO1860
1620 PORB=(G+l)TO(lO*F2+9)
1630 IP3=PTHEN1660
1640 REM)=B
1650 MlsMl+1
1660 NEXTB
1670 GOTO1560
1680 IPP>GTHEN1800
1690 PORB1=(F3+10)TO(G-10)STEP10
1700 IFB1=FTHEN173O
1710 R(Ml)=B1
1720 Ml=Ml+1
1730 NEXT31
1740 FORB2=(lO*F2+l)TO(lO*F24-8)
1750 IF32-PTHEN1780
1760 R(Ml)=B2
1770 Ml=Ml+1
1780 NEXTB2
1790 GOTOI860
1800 POR33=(G+10)TO(?3+80)STEP10
1810 IPB3=FTHEN1840
1820 R(M1)=B3
1830 Ml=Ml+1
I840 NEXTB3
1850 FORNq=(lO*F2+l)TO(lO*F2+8)
1851 IFN9=PTHEN1858
1852 R(Ml)=N9
1855 Ml=Ml+1
1858 NEXTN9
I860 M2=1
1870 POR34=0TO7
1880 G—G1+Z(B4)
ikt(g/io)
THEN1250
THEN1339
1890
1900
1910
G2
G3=G-10*G2
GOSUB353O
1920
1930
1940
1950
i960
1970
1980
1990
2000
2010
2020
2025
2030
2040
2050
2060
2070
2080
2090
2100
2110
2120
2125
2130
2140
2150
2160
2170
2180
2190
2200
2210
2220
2230
2240
2245
2250
2260
2270
2280
2290
2300
2310
2320
2330
2340
2350
2360
2370
2380
2390
2400
2410
2420
2430
2440
2450
2460
2470
2480
2490
2500
2510
2515
2520
2530
2540
2545
2550
2560
2570
2580
2590
2600
2610
2620
2630
2640
2645
2650
2660
2670
2680
2690
2700
2710
2720
2730
2740
2742
2743
2744
2745
2750
2755
2760
2770
2780
2790
2800
2810
2820
2830
2840
2850
2860
2870
2880
2890
bee:'generated
THEN2742
THEN2150
IPLs=0THEN1950
K(M2)=G
M2-M2+1
NEXTB4
REMEVERYLEGALMOVEHASNO"
G=G1
G2=INT(G/lO)
G3=G-10*G2
Ml=El-1
M2=H2-1
REMNOTSCORINGOPPOSITIONSCANSTART
15=0
IPK3=/0TEEN2050
PRINT"ROOK"
PORB8=1TOMl
P=R(B8)
P2=int(p/io)
P3=F-10*F2
GOSU3334O
I?L=0THEN2170
P(B8)=0
GOSU32750
IPEO=1
IPK3=0
PRINTP;S
D(B8)=S
GOTO2190
P(B8)=10
GOTO2120
nextB8
p-PI
P2=INT(p/lO)
P3=F-10*F2
IPN3=0THEN2245
PRINT"KING"
15=1
PORB9=1TOM2
G=K(B9)
G2=INT(G/lO)
G3-G-10*G2
GOSUB2750
IFN3=0THEN2320
PRINTG;S
E(B9)=S
NEXTB9
G=G1
G2=INT(G/lO)
G3-G-10*G2
REMFINDMOVEriTHBESTSCORE
J9=D(l)
RO=.1
FORBO=2TOMl
IPD(BO)<=J9THEN2440
J9=D(BO)
RO=BO
NEXTBO
K9=E(l)
SO=1
PORC=12TOM2
IPE(C)<=K9THEN2510
K9=E(C)
SO=C
NEXTC
RESTPRINTCOMPUTERMOVE
T(l)=0
IPK9>J9THEN2640
P=-r(ro)
PI=F
F2=i::t(p/io)
F3=F-10*F2
IPP(RO)=10THEN2610
PRINTT|(P);
V$(l)=t$(f)
GOTO240
PRINTT$(P)j"CHECK";
T(I)=1
GOTO2590
G=K(SO)
G1=G
G2=INT(G/lO)
G3sEG-10*G2
GOSU3334O
IPL=0THEN2720
PRINTU$(G)
V$(l)=U$(G)
GOTO240
Y(l)=1
printu$(g);"check";
GOTO2700
PRINTT*(p);"CHECKMATE";
V*(l)=T*(f)
V$(l)="I-IATE"
GOTO240
RE^SUBROUTINEPORSCORINGMOVES
EO=0
Q=ABS(F-H)
R=ABS(F-G)
IF(Q-l)*(Q-9)*(Q-10)*(Q-U)<>0THEN2820
IF(R-l)*(R-9)*(R-10)*(R-ll)=0THEN2820
S=-1000
GOTO3230
S=0
PORCls0TO7
H=Hl+Z(Cl)
H2=INT(H/lO)
H3H-lO*H2
GOSUB3270
IPL=0THEN2900
S=S+l

2900
2910
2920
2930
2940
2950
2960
2970
2980
2990
3000
3010
3020
3030
3040
3050
3060
3070
3075
3076
3080
3090
3100
3110
3120
3130
3140
3150
3160
3170
3180
3190
3200
3210
3220
3230
3240
3250
3260
3270
3280
3290
3300
3310
3320
3330
3340
3350
3360
3370
3380
3390
3400
3410
3420
3430
3440
3450
3460
3470
3480
3490
3500
3510
3520
3530
3535
3540
3550
3560
3570
3580
3590
3600
3610
3620
3621
3622
3623
3630
3640
3650
3651
3652
3653
366O
3670
9999
NEXTCl
R=HI
H2=INT(H/lO)
IT3=E-10*H2
IPS>0THEN3000
IF15=1THEN2800
IPF(B8)r.10THEN2980
GOTO29OO
EO=1
GOTO3230
S=X(0)*(8-S)
S=S+X(l)*(l4-ABS(G3-H3)-A3S(G2-H2))
S=S+X(2)3#c(l4-ABS(F2-H2)-ABS(P3-H3))
S=S+X(5)*(14-ABS(F2-G2)-ABS(?3-G3))
IP(F2-l]*(F2-8)*(F3-l)*(F3-8)=0
S=s+x(4)
GOTO3075
SrS+X(5)
IP(G-32)*
IP(G-67)*
IF(G2-1)X
IF(G3-1)*
S=s+x(6)
GOTO3130
S=s+x(7)
YO=ABS(F3-H3)
V-ABS(F2-H2)
IFYO>=VTHEN3170
YO=7?
XO=ABS(F2-G2)
W1^abs(P3-G3)
IFXO>=W1THEN3210
XO=W1
XO=YO/XO
S=S+X(8)*X0*(2.5-X0)
RETURN
RET.ISUBROUTINEFORCHECKI?!GLEGALITY
IF(n-SGN(F2-l))*(l-SGH(F2-8)'
TP(l+SGN(F3-l))*(l-SGN(F3-8)
“*(i-SGN(G2-8)J
*(l-SGN(G3-8)
)*(l-SGN(H2-8'
THEN3070
0-37)I-0THEN3100
G-62]I=0THEN3100
G2-7I=0the::3120
G3-7.I=0THEN3120
(l+SGIl(H3-l))*(l-SGN(H3-8)
(F-G)*(G-H)*(F-H)=0THEN
=0THEI:3470
=0THEN3470
=0THEN3470
=0THEN3470
=0THEN3470
0THEN3470
3470
THEN3470
M=ABS(G-H)
IF(m-i)*(m-9)*(m-io)*(m-ii)=0
IFF2=H2THEN34OO
ifF3<>H3THEN338O
IPF3=G3THEN3400
GOTO3470
Ls=1
GOTO3480
IFF>HTIE3440
IFG<FTHEN347O
I?G>HTHEN3470
GOTO338O
IFG>PTHEN3470
IFG<HTHEN3470
GOTO3380
L=0
RETURN
DATA1,-1,10,-10,9,-°,11,-11
DATA5,20.1,1.7,7,2,1,14,1,10
DATA9,11.5,3,11,1.1,1,6.6,1,102
DATA5,5,5.9,-2,1,16.1,2,1,50
REMSUBROUTINEFORLEGALITY0?KINGMOVES
IPF=GTHEN36OO
IF(l+SGN(G2-l))*(l-SGN(G2-8
IF(l+SGN(G3-l))*(l-SGN(G3-8
K=ABS(G-H)
IF(H-1)*(M-10)*(?T-9)*(M-11)=0THEN36OO
L=1
GOTO3610
L=0
RETURN
F=10*F2+H3
F2=ii:t(f/io)
F3=F.-10*F2
FI=F
IF(H3-8)*(H3-l)=0T"EN2742
GOTO2610
F=10*H2+F3
F2=INT(F/10)
F3-F-10*F2
IF(H2-l)*(H2-8)=0THEN2742
GOTO2610
END
