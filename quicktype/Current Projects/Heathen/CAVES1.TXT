50 CLS
60 HP=16:FH=16:ST=16:IN=16:WI=16:DE=16:CO=16:CH=16:GP=16:EX=16:W$="MAC",A$="NONE",SHI$="0":V=1:GOSUB2540
80 GOSUB4080
90 DIMC(26,26):PX=3:PY=25:F=4:A=1024:RF=0:LF=0:FF=0:PLAY"T255O1":TV=3:DIMBG(7,7):L=1
100 LE=400
110 PRINT@198,"LOADING LEVEL DATA..."
120 MNAME$="LEVEL"+STR$(L)+".MAP":OPEN"I",#1,MNAME$:FORX=0TO25:FORY=0TO25:INPUT#1,C(X,Y):NEXTY,X:CLOSE#1:CLS
130 '
140 GOSUB1560
150 GOSUB1220
160 PRINT@463,STRING$(17,131);
170 LI$="FOOL!! EVIL AWAITS YOU...":GOSUB2070:GOSUB2090
180 '
190 GOSUB340
200 IFC(PX,PY)=5THENU=USR(18):GOSUB4240:GOSUB340
210 I$=INKEY$:IFI$=""THEN210
220 IFI$="Q"THENGOSUB4020
230 IFI$="S"THENGOSUB4680
240 IFI$="C"THENGOSUB3020:GOSUB1350
250 IFI$="W"THENGOSUB1670:IFRND(50)=1THENGOSUB340:GOSUB1810
260 IFI$="Z"THENGOSUB1740
270 IFI$="D"THENF=F+1
280 IFF>4THENF=1
290 IFI$="A"THENF=F-1
300 IFF<1THENF=4
310 IFI$=CHR$(32)THENGOSUB1220:GOTO210
320 IFI$="M"THENGOSUB1480
330 I$="":GOTO180
340 '
350 IFF=1THENPRINT@7,"n";
360 IFF=2THENPRINT@7,"e";
370 IFF=3THENPRINT@7,"s";
380 IFF=4THENPRINT@7,"w";
390 IFC(PX,PY)=3THENGOSUB3790
400 IFC(PX,PY)=4THENGOSUB3950
410 IFF<>1THEN620
420 '
430 '
440 IFC(PX-1,PY)=1ORC(PX-1,PY)=5THENU=USR(7):LF=1
450 IFC(PX-1,PY)=2THENLF=1:U=USR(12)
460 IFC(PX-1,PY)=0ANDLF=1THENLF=0:U=USR(8)
470 IFC(PX+1,PY)=1ORC(PX+1,PY)=5THENU=USR(4):RF=1
480 IFC(PX+1,PY)=0ANDRF=1THENRF=0:U=USR(5)
490 IFC(PX+1,PY)=2THENRF=1:U=USR(13)
500 IFC(PX,PY-1)=0THENU=USR(3):GOTO610
510 IFC(PX,PY-1)=2THENRF=1:U=USR(11):RETURN
520 IFC(PX,PY-1)=3ORC(PX,PY-1)=4THENU=USR(16):RETURN
530 U=USR(1)
540 IFC(PX-1,PY-1)=1ORC(PX-1,PY-1)=5THENU=USR(6)
550 IFC(PX-1,PY-1)=2THENU=USR(15)
560 IFC(PX+1,PY-1)=1ORC(PX+1,PY-1)=5THENU=USR(2)
570 IFC(PX+1,PY-1)=2THENU=USR(14)
580 IFC(PX,PY-2)=0THENU=USR(9)
590 IFC(PX,PY-2)=2THENU=USR(10):RETURN
600 IFC(PX,PY-2)=3ORC(PX,PY-2)=4THENU=USR(17):RETURN
610 RETURN
620 '
630 IFF<>2THEN820
640 IFC(PX,PY-1)=1ORC(PX,PY-1)=5THENLF=1:U=USR(7)
650 IFC(PX,PY-1)=2THENLF=1:U=USR(12)
660 IFC(PX,PY-1)=0ANDLF=1THENLF=0:U=USR(8)
670 IFC(PX,PY+1)=1ORC(PX,PY+1)=5THENRF=1:U=USR(4)
680 IFC(PX,PY+1)=2THENRF=1:U=USR(13)
690 IFC(PX,PY+1)=0ANDRF=1THENRF=0:U=USR(5)
700 IFC(PX+1,PY)=0THENU=USR(3):GOTO810
710 IFC(PX+1,PY)=2THENU=USR(11):RETURN
720 IFC(PX+1,PY)=3ORC(PX+1,PY)=4THENU=USR(16):RETURN
730 U=USR(1)
740 IFC(PX+1,PY-1)=1ORC(PX+1,PY-1)=5THENU=USR(6)
750 IFC(PX+1,PY-1)=2THENU=USR(15)
760 IFC(PX+1,PY+1)=1ORC(PX+1,PY+1)=5THENU=USR(2)
770 IFC(PX+1,PY+1)=2THENU=USR(14)
780 IFC(PX+2,PY)=2THENU=USR(10):RETURN
790 IFC(PX+2,PY)=3ORC(PX+2,PY)=4THENU=USR(17):RETURN
800 IFC(PX+2,PY)=0THENU=USR(9)
810 RETURN
820 '
830 IFF<>3THEN1020
840 IFC(PX+1,PY)=1ORC(PX+1,PY)=5THENLF=1:U=USR(7)
850 IFC(PX+1,PY)=2THENLF=1:U=USR(12)
860 IFC(PX+1,PY)=0ANDLF=1THENLF=0:U=USR(8)
870 IFC(PX-1,PY)=1ORC(PX-1,PY)=5THENU=USR(4):RF=1
880 IFC(PX-1,PY)=0ANDRF=1THENRF=0:U=USR(5)
890 IFC(PX-1,PY)=2THENRF=1:U=USR(13)
900 IFC(PX,PY+1)=0THENU=USR(3):GOTO1010
910 IFC(PX,PY+1)=2THENU=USR(11):RETURN
920 IFC(PX,PY+1)=3ORC(PX,PY+1)=4THENU=USR(16):RETURN
930 U=USR(1)
940 IFC(PX+1,PY+1)=1ORC(PX+1,PY+1)=5THENU=USR(6)
950 IFC(PX+1,PY+1)=2THENU=USR(15)
960 IFC(PX-1,PY+1)=1ORC(PX-1,PY+1)=5THENU=USR(2)
970 IFC(PX-1,PY+1)=2THENU=USR(14)
980 IFC(PX,PY+2)=0THENU=USR(9)
990 IFC(PX,PY+2)=2THENU=USR(10):RETURN
1000 IFC(PX,PY+2)=3ORC(PX,PY+2)=4THENU=USR(17):RETURN
1010 RETURN
1020 '
1030 IFF<>4THENRETURN
1040 IFC(PX,PY+1)=1ORC(PX,PY+1)=5THENU=USR(7):LF=1
1050 IFC(PX,PY+1)=0ANDLF=1THENLF=0:U=USR(8)
1060 IFC(PX,PY+1)=2THENLF=1:U=USR(12)
1070 IFC(PX,PY-1)=1ORC(PX,PY-1)=5THENU=USR(4):RF=1
1080 IFC(PX,PY-1)=0ANDRF=1THENRF=0:U=USR(5)
1090 IFC(PX,PY-1)=2THENRF=1:U=USR(13)
1100 IFC(PX-1,PY)=0THENU=USR(3):GOTO1210
1110 IFC(PX-1,PY)=2THENU=USR(11):RETURN
1120 IFC(PX-1,PY)=3ORC(PX-1,PY)=4THENU=USR(16):RETURN
1130 U=USR(1)
1140 IFC(PX-1,PY+1)=1ORC(PX-1,PY+1)=5THENU=USR(6)
1150 IFC(PX-1,PY+1)=2THENU=USR(15)
1160 IFC(PX-1,PY-1)=1ORC(PX-1,PY-1)=5THENU=USR(2)
1170 IFC(PX-1,PY-1)=2THENU=USR(14)
1180 IFC(PX-2,PY)=0THENU=USR(9)
1190 IFC(PX-2,PY)=2THENU=USR(10):RETURN
1200 IFC(PX-2,PY)=3ORC(PX-2,PY)=4THENU=USR(17):RETURN
1210 RETURN
1220 '
1230 '
1240 TV=TV+1:IFTV>3THENTV=1
1250 I$=""
1260 IFTV<>1THEN1340
1270 '
1280 FORY=15TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY
1290 PRINT@18,CHR$(128);"commands";CHR$(128);:PRINT@79,"<SPACE> TO TOGGLE";:PRINT@113,"DISPLAY";
1300 PRINT@143,"<A-W-D> CLUSTER";:PRINT@175,"<K>ICK DOORS";:PRINT@207,"<M>AP DISPLAY";:PRINT@207,"<C>AST SPELLS";
1310 PRINT@239,"<M>AP DISPLAY";:PRINT@271,"<S>PEED";
1320 PRINT@335,"<Q>UIT GAME";
1330 RETURN
1340 IFTV<>2THEN1420
1350 '
1360 FORY=15TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY
1370 PRINT@(15+((17-LEN(NAME$))/2)),NAME$;
1380 PRINT@80,"STR";ST;:PRINT@89,"INT";IN;:PRINT@112,"WIS";WI;:PRINT@121,"DEX";DE;:PRINT@144,"CON";CO;:PRINT@153,"CHR";CH;
1390 PRINT@207,"LEVEL:";V;:PRINT@218,"AC";AC;:PRINT@239,"EXP:";EX;:PRINT@303,"HIT POINTS:";HP;:PRINT@335,"GOLD:";GP;
1400 PRINT@432,S1;S2;S3;S4;S5;
1410 RETURN
1420 IFTV<>3THENRETURN
1430 FORY=15TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY:PRINT@19,"inventory";:Y=47
1440 GOSUB2740:Y=Y+32
1450 GOSUB2890:Y=Y+32
1460 GOSUB2970:Y=Y+32
1470 RETURN
1480 '
1490 FORY=15TO431STEP32:PRINT@Y,STRING$(17,128);:NEXTY
1500 PRINT@19,"level";CHR$(128);"map";
1510 FORX=0TO25:FORY=0TO25
1520 IFC(X,Y)<>0THENSET(X+32,Y+2,2)
1530 NEXTY,X
1540 SET(PX+32,PY+2,3)
1550 RETURN
1560 '
1570 PRINT@0,STRING$(15,128);
1580 PRINT@32,CHR$(128);CHR$(214);STRING$(11,223);CHR$(217);CHR$(128);
1590 PRINT@64,CHR$(128);CHR$(223);CHR$(214);STRING$(9,223);CHR$(217);CHR$(223);CHR$(128);
1600 PRINT@96,CHR$(128);STRING$(2,223);CHR$(214);STRING$(7,220);CHR$(217);STRING$(2,223);CHR$(128);
1610 FORX=128TO320STEP32:PRINT@X,CHR$(128);STRING$(2,223);CHR$(218);STRING$(7,175);CHR$(213);STRING$(2,223);CHR$(128);:NEXTX
1620 PRINT@352,CHR$(128);CHR$(223);CHR$(222);CHR$(177);STRING$(7,179);CHR$(178);CHR$(221);CHR$(223);CHR$(128);
1630 PRINT@384,CHR$(128);CHR$(222);CHR$(177);STRING$(9,191);CHR$(178);CHR$(221);CHR$(128);
1640 PRINT@416,CHR$(128);CHR$(177);STRING$(11,191);CHR$(178);CHR$(128);
1650 PRINT@448,STRING$(15,131);
1660 RETURN
1670 '
1680 IFF=1ANDC(PX,PY-1)<>0THENPY=PY-1:PLAY"E":RETURN
1690 IFF=2ANDC(PX+1,PY)<>0THENPX=PX+1:PLAY"E":RETURN
1700 IFF=3ANDC(PX,PY+1)<>0THENPY=PY+1:PLAY"E":RETURN
1710 IFF=4ANDC(PX-1,PY)<>0THENPX=PX-1:PLAY"E":RETURN
1720 PLAY"T255O1C1"
1730 RETURN
1740 '
1750 IFF=1ANDC(PX,PY+1)<>0THENPY=PY+1:RETURN
1760 IFF=2ANDC(PX-1,PY)<>0THENPX=PX-1:RETURN
1770 IFF=3ANDC(PX,PY-1)<>0THENPY=PY-1:RETURN
1780 IFF=4ANDC(PX+1,PY)<>0THENPX=PX+1:RETURN
1790 PLAY"T255O1C1"
1800 RETURN
1810 '
1820 GOSUB1350
1830 LI$="YOU ENCOUNTER A MONSTER!!":GOSUB2070:GOSUB2090
1840 MO=RND(16)
1860 IFL>2AND(MO=7ORMO=5ORMO=8ORMO=11ORMO=9ORMO=10ORMO=4ORMO=13ORMO=16)THEN1840
1910 RESTORE:FORY=0TOMO-1:READMD,MHP,DAM,MA,MG:MG=RND(MG)
1930 FORX=1TO6:READA$:PRINT@Y*32,A$;
1940 NEXT:NEXT
2010 SEED=MHP
2020 MHP=RND(SEED):IFMHP<MD THEN2020
2030 LI$="A "+M$+"!":GOSUB2070:GOSUB2090
2040 IFRND(6)=1THENGOSUB2380
2050 GOSUB2130
2060 RETURN
2070 '
2080 PRINT@480+((32-LEN(LI$))/2),LI$;:RETURN
2090 '
2100 FORDLAY=1TOLE:NEXTDLAY
2110 PRINT@480,STRING$(31,143);
2120 RETURN
2130 '
2140 IFMHP<=0THENGOSUB2540:RETURN
2150 LI$="<F>IGHT, <C>AST SPELL OR <R>UN":GOSUB2070
2160 I$=INKEY$:IFI$=""THEN2160
2170 IFMHP<=0THENRETURN
2180 IFI$="F"THEN2230
2190 IFI$="C"THENGOSUB3020:GOSUB1350:IFMHP>0THENGOSUB2380:GOTO2130
2200 IFI$="R"THEN2470
2210 IFMHP<=0THENGOSUB2540:RETURN
2220 I$="":GOTO2160
2230 '
2240 GOSUB2090
2250 IF(V>=1ANDV<=3)THENCA=(19-MA)
2260 IF(V>=4ANDV<=6)THENCA=(17-MA)
2270 IF(V>=7ANDV<=9)THENCA=(14-MA)
2280 IF(V>=10ANDV<=12)THENCA=(12-MA)
2290 IFV>12THENCA=(10-MA)
2300 IFCA>20THENCA=20
2310 IFCA=1THENCA=2
2320 IFRND(20)>=(CA-DB)THENLI$="YOU HIT FOR":GOTO2340
2330 LI$="YOU MISS!!":GOSUB2070:GOSUB2090:GOTO2360
2340 '
2350 DTM=RND(PD)+SB:LI$=LI$+STR$(DTM)+" POINTS!":GOSUB2070:GOSUB2090:GOSUB2440:IFMHP<=0THENRETURN
2360 GOSUB2380
2370 GOTO2130
2380 '
2390 MTH=(19-AC-MD)
2400 IFRND(20)>=MTH THENLI$="YOU'RE HIT!!!":GOSUB2070:GOSUB2090:GOTO2420
2410 LI$="IT MISSES!!":GOSUB2070:GOSUB2090:RETURN
2420 HP=HP-RND(DAM):PRINT@303,"HIT POINTS:";HP;:IFHP<=0THENRUN"SKULL.BAS"
2430 RETURN
2440 '
2450 MHP=MHP-DTM:IFMHP<=0THENLI$="YOU DEFEAT THE "+M$+"!":GOSUB2070:GOSUB2090:I$="":MG=RND(MG):EX=EX+(10*MD)+MG:GP=GP+MG:GOSUB1560:GOSUB2540:GOSUB1350
2460 RETURN
2470 '
2480 IFRND(10)>8THENGOSUB2090:LI$="YOU CANNOT ESCAPE!":GOSUB2070:GOSUB2090:GOTO2360
2490 GOSUB2090:LI$="YOU RUN AWAY!":GOSUB2070:GOSUB2090
2500 IFC(PX+1,PY)<>0THENPX=PX+1:GOSUB2540:GOSUB1350:GOSUB1560:RETURN
2510 IFC(PX-1,PY)<>0THENPX=PX-1:GOSUB2540:GOSUB1350:GOSUB1560:RETURN
2520 IFC(PX,PY+1)<>0THENPY=PY+1:GOSUB2540:GOSUB1350:GOSUB1560:RETURN
2530 IFC(PX,PY-1)<>0THENPY=PY-1:GOSUB2540:GOSUB1350:GOSUB1560:RETURN
2540 '
2550 AC=9
2560 IFVAL(MID$(A$,1,1))=0THEN2580
2570 IFMID$(A$,2,1)="L"THENAC=7-VAL(MID$(A$,1,1))ELSEIFMID$(A$,2,1)="C"THENAC=5-VAL(MID$(A$,1,1))ELSEIFMID$(A$,2,1)="P"THENAC=3-VAL(MID$(A$,1,1))
2580 IFA$="LEA"THENAC=7ELSEIFA$="CHA"THENAC=5ELSEIFA$="PLA"THENAC=3
2590 IFSHI$<>"NONE"THENAC=AC-VAL(SHI$)-1
2600 IFDE=3THENAC=AC+3ELSEIF(DE>=4ANDDE<=5)THENAC=AC+2ELSEIF(DE>=6ANDDE<=8)THENAC=AC+1ELSEIF(DE>=13ANDDE<=15)THENAC=AC-1ELSEIF(DE>=16ANDDE<=17)THENAC=AC-2ELSEIFDE=18THENAC=AC-3
2610 IFW$="HAN"THENPD=2ELSEIFW$="DAG"THENPD=3ELSEIFW$="CLU"THENPD=4ELSEIFW$="AXE"THENPD=5ELSEIFW$="MAC"THENPD=6ELSEIFW$="SWO"THENPD=8
2620 IFVAL(MID$(W$,1,1))=0THEN2680
2630 IFMID$(W$,2,1)="S"THENPD=8
2640 IFMID$(W$,2,1)="D"THENPD=3
2650 IFMID$(W$,2,1)="C"THENPD=4
2660 IFMID$(W$,2,1)="A"THENPD=5
2670 IFMID$(W$,2,1)="M"THENPD=6
2680 IFST=3THENSB=-3ELSEIF(ST>=4ANDST<=5)THENSB=-2ELSEIF(ST>=6ANDST<=8)THENSB=-1ELSEIF(ST>=13ANDST<=15)THENSB=1ELSEIF(ST>=16ANDST<=17)THENSB=2ELSEIFST=18THENSB=3
2690 IFDE=3THENDB=-3ELSEIF(DE>=4ANDDE<=5)THENDB=-2ELSEIF(DE>=6ANDDE<=8)THENDB=-1ELSEIF(DE>=13ANDDE<=15)THENDB=1ELSEIF(DE>=16ANDDE<=17)THENDB=2ELSEIFDE=18THENDB=3
2700 IFVAL(MID$(W$,1,1))<>0THENDB=DB+VAL(MID$(W$,1,1)):SB=SB+VAL(MID$(W$,1,1))
2710 IFVAL(MID$(A$,1,1))<>0THENAC=AC-VAL(MID$(A$,1,1))
2720 IFHP>FH THENHP=FH
2730 RETURN
2740 '
2750 IFVAL(MID$(W$,1,1))<>0THEN2830
2760 IFW$="HAN"THENIW$="BARE HANDS"
2770 IFW$="DAG"THENIW$="DAGGER"
2780 IFW$="CLU"THENIW$="WOODEN CLUB"
2790 IFW$="AXE"THENIW$="HAND AXE"
2800 IFW$="MAC"THENIW$="MACE"
2810 IFW$="SWO"THENIW$="SWORD"
2820 GOTO2880
2830 IFMID$(W$,2,1)="D"THENIW$="DAGGER +"+MID$(W$,1,1)
2840 IFMID$(W$,2,1)="C"THENIW$="CLUB +"+MID$(W$,1,1)
2850 IFMID$(W$,2,1)="A"THENIW$="HAND AXE +"+MID$(W$,1,1)
2860 IFMID$(W$,2,1)="M"THENIW$="MACE +"+MID$(W$,1,1)
2870 IFMID$(W$,2,1)="S"THENIW$="SWORD +"+MID$(W$,1,1)
2880 PRINT@Y,IW$;:RETURN
2890 '
2900 IFVAL(MID$(A$,1,1))<>0THEN2950
2910 IFA$="NONE"THENIW$="ROBES"
2920 IFA$="LEA"THENIW$="LEATHER ARMOUR"
2930 IFA$="CHA"THENIW$="CHAINMAIL"
2940 IFA$="PLA"THENIW$="PLATEMAIL":GOTO2960ELSE2960
2950 IFMID$(A$,2,1)="L"THENIW$="LEATHER +"+MID$(A$,1,1)ELSEIFMID$(A$,2,1)="C"THENIW$="CHAINMAIL +"+MID$(A$,1,1)ELSEIFMID$(A$,2,1)="P"THENIW$="PLATEMAIL +"+MID$(A$,1,1)
2960 PRINT@Y,IW$;:RETURN
2970 '
2980 IFSHI$="NONE"THENRETURN
2990 IW$="SHIELD"
3000 IFSHI$<>"0"THENIS=(VAL(SHI$)-1):IW$=IW$+" +"+SHI$
3010 PRINT@Y,IW$:RETURN
3020 '
3030 SL=1
3040 FORY=15TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY
3050 PRINT@18,"spell book";
3060 ON SL GOSUB3160,3180,3200
3070 PRINT@303,"<#> TO CAST SPELL";:PRINT@335,"<0> TO ABORT";:PRINT@367,"<L> NEXT LEVEL";
3080 PRINT@432,S1;S2;S3;S4;S5;
3090 I$=INKEY$:IFI$=""THEN3090
3100 IFI$="0"THENFORY=15TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY:GOSUB2090:RETURN
3110 IFI$="L"THENSL=SL+1:IFSL>3THENSL=1
3120 IFI$="L"THENGOTO3060
3130 IFI$>="1"ANDI$<="5"THEN3220
3140 GOTO3090
3150 '
3160 FORY=47TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY:PRINT@83,"LEVEL 1";:PRINT@111,"<1>MAGIC MISSILE";:PRINT@143,"<2>SHIELD";:PRINT@175,"<3>SLEEP";:PRINT@207,"<4>CURE LIGHT";:PRINT@239,"<5>TURN UNDEAD";
3170 RETURN
3180 FORY=47TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY:PRINT@83,"LEVEL 2";:PRINT@111,"<1>KNOCK";:PRINT@143,"<2>WEB";:PRINT@175,"<3>BLESS";:PRINT@207,"<4>LESSER HOLD";
3190 RETURN
3200 FORY=47TO431STEP32:PRINT@Y,STRING$(17,143);:NEXTY:PRINT@83,"LEVEL 3";:PRINT@111,"<1>FIRE BALL";:PRINT@143,"<2>LIGHTNING BOLT";:PRINT@175,"<3>STRIKING";:PRINT@207,"<4>LOCATE EXIT";
3210 RETURN
3220 IFSL=1AND(S1<>0)THENONVAL(I$)GOSUB3260,3300,3330,3390,3430:S1=S1-1:RETURN
3230 IFSL=2AND(S2<>0)THENONVAL(I$)GOSUB3500,3520,3560,3590:S2=S2-1:RETURN
3240 IFSL=3AND(S3<>0)THENONVAL(I$)GOSUB3650,3700,3750,3780:S3=S3-1:RETURN
3250 GOSUB2090:LI$="YOU CANNOT CAST!":GOSUB2070:GOSUB2090:RETURN
3260 '
3270 GOSUB4750
3280 IFMHP>0THENDTM=(RND(6)+1)*(1+INT(V/5)):GOSUB2090:LI$="THE MISSILE SLAMS THE CREATURE!":GOSUB2070:GOSUB2090:LI$="THE "+M$+" TAKES"+STR$(DTM)+" DAMAGE!":GOSUB2070:GOSUB2090:GOSUB2440
3290 RETURN
3300 '
3310 IFMHP>0THENAC=AC-2:GOSUB2090:LI$="YOUR ARMOUR GLOWS BRIEFLY...":GOSUB2070:GOSUB2090
3320 RETURN
3330 '
3340 IFMHP<=0THENRETURN
3350 GOSUB4750
3360 IFMD-1>VTHENGOSUB218:LI$="THE "+M$+" LAUGHS!":GOSUB2070:GOSUB2090:RETURN
3370 GOSUB2090:LI$="THE MONSTER SLEEPS...":GOSUB2070:DTM=RND(PD+1)*5+SB:GOSUB2090:LI$="YOU SWING A MIGHTY BLOW...":GOSUB2070:GOSUB2090:GOSUB2440
3380 RETURN
3390 '
3400 HP=HP+RND(9)+1:IFHP>FH THENHP=FH
3410 GOSUB2090:LI$="YOU FEEL BETTER...":GOSUB2070:GOSUB2090:IFMHP<=0THENGOSUB1350
3420 RETURN
3430 '
3440 IFMHP<=0THENRETURN
3450 GOSUB4750
3460 IFMO<>1ANDMO<>4ANDMO<>5ANDMO<>10THEN3490
3470 IFMD-1>VTHENGOSUB218:LI$="NO EFFECT...":GOSUB2070:GOSUB2090:RETURN
3480 IFRND(20)>((3+MD)-V)THENGOSUB2090:LI$="THE UNDEAD DISINTEGRATES!":GOSUB2070:GOSUB2090:MHP=0:GOSUB1560:RETURN
3490 GOSUB2090:LI$="THE "+M$+" LAUGHS...":GOSUB2070:GOSUB2090:RETURN
3500 '
3510 GOSUB2090:LI$="CANNOT BE CAST AT THIS TIME!":GOSUB2070:GOSUB2090:RETURN
3520 '
3530 GOSUB4750
3540 IFRND(100)>80THENGOSUB2090:LI$="THE "+M$+" DODGES THE WEB!":GOSUB2070:GOSUB2090:RETURN
3550 GOSUB2090:LI$="THE "+M$+" IS CAUGHT!":GOSUB2070:GOSUB2090:LI$="YOU ESCAPE THE "+M$+"!!":GOSUB2070:GOSUB2090:MHP=0:GOSUB1560:RETURN
3560 '
3570 IFMHP<=0THENRETURN
3580 HP=HP+RND(4):DB=DB+1:SB=SB+1:GOSUB2090:LI$="YOU ARE BLESSED BY THE GODS...":GOSUB2070:GOSUB2090:RETURN
3590 '
3600 IFMHP<=0THENRETURN
3610 GOSUB4750
3620 IFMD>2THENGOSUB2090:LI$="THE SPELL HAS NO EFFECT!":GOSUB2070:GOSUB2090:RETURN
3630 GOSUB2090:LI$="THE "+M$+" IS HELD!!":GOSUB2070:GOSUB2090:LI$="YOU KILL THE "+M$+"!":GOSUB2070:GOSUB2090
3640 MHP=0:MG=RND(MG):EX=EX+(10*MD)+M:GP=GP+MG:GOSUB1560:RETURN
3650 '
3660 IFMHP<=0THENRETURN
3670 GOSUB4750
3680 DTM=0:FORX=1TOV:DTM=DTM+RND(6):NEXTX:GOSUB2090:LI$="THE FIRE BALL EXPLODES!!":GOSUB2070:GOSUB2090:LI$="THE "+M$+" TAKES"+STR$(DTM)+" DAMAGE!":GOSUB2070:GOSUB2090
3690 GOSUB2440:RETURN
3700 '
3710 IFMHP<=0THENRETURN
3720 GOSUB4750
3730 DTM=0:FORX=1TOV:DTM=DTM+RND(6):NEXTX:GOSUB2090:LI$="YOUR HANDS SPEW LIGHTNING!!":GOSUB2070:GOSUB2090:LI$="IT FRIES FOR"+STR$(DTM)+" DAMAGE!!":GOSUB2070:GOSUB2090
3740 GOSUB2440:RETURN
3750 '
3760 IFMHP<=0THENRETURN
3770 SB=SB+10:GOSUB2090:LI$="YOUR WEAPON GLOWS BRIGHTLY!":GOSUB2070:GOSUB2090:RETURN
3780 '
3790 '
3800 GOSUB2090:LI$="TAKE THE ELEVATOR up? (Y/N)":GOSUB2070
3810 I$=INKEY$:IFI$=""THEN3810
3820 IFI$<>"Y"ANDI$<>"N"THEN3810
3830 IFI$="N"THENGOSUB2090:GOTO3900
3840 IFI$="Y"ANDL=1THENOPEN"O",#1,"CHAR.DAT":WRITE#1,NAME$:WRITE#1,HP,FH,ST,IN,WI,DE,CO,CH,GP,EX,V:WRITE#1,W$,A$,SHI$:CLOSE#1:RUN"INN"
3850 IFI$="Y"ANDL<>1THENFORX=0TO416STEP32:PRINT@X,STRING$(15,128);:NEXTX:L=L-1:GOSUB2090:LI$="THE ELEVATOR RISES...":GOSUB2070:MNAME$="LEVEL"+STR$(L)+".MAP":OPEN"I",#1,MNAME$
3860 FORX=0TO25:FORY=0TO25:INPUT#1,C(X,Y):NEXTY,X:CLOSE#1:GOSUB2090:GOSUB1560
3870 RETURN
3880 I$=INKEY$:IFI$=""THEN3880
3890 GOSUB4080:GOTO130
3900 IFC(PX-1,PY)=1THENPX=PX-1:RETURN
3910 IFC(PX+1,PY)=1THENPX=PX+1:RETURN
3920 IFC(PX,PY-1)=1THENPY=PY-1:RETURN
3930 IFC(PX,PY+1)=1THENPY=PY+1:RETURN
3940 STOP
3950 '
3960 GOSUB2090:LI$="TAKE THE ELEVATOR down? (Y/N)":GOSUB2070
3970 I$=INKEY$:IFI$=""THEN3970
3980 IFI$<>"Y"ANDI$<>"N"THEN3970
3990 IFI$="N"THENGOSUB2090:GOTO3900
4000 IFI$="Y"THENFORX=0TO416STEP32:PRINT@X,STRING$(15,128);:NEXTX:GOSUB2090:LI$="YOU DESCEND SLOWLY...":GOSUB2070:L=L+1:MNAME$="LEVEL"+STR$(L)+".MAP":OPEN"I",#1,MNAME$:FORX=0TO25:FORY=0TO25:INPUT#1,C(X,Y):NEXTY,X:CLOSE#1:GOSUB2090
4010 GOSUB1560:RETURN
4020 '
4030 GOSUB2090:LI$="QUIT? (Y/N)":GOSUB2070
4040 I$=INKEY$:IFI$=""THEN4040
4050 IFI$="Y"THENCLS:END
4060 IFI$="N"THENRETURN
4070 GOTO4040
4080 '
4090 S1=0:S2=0:S3=0:S4=0:S5=0
4100 IFEX<1500THENV=1:S1=1:S2=0
4110 IF(EX>=1500)AND(EX<=2999)THENV=2:S1=2:S2=0
4120 IF(EX>=3000)AND(EX<=5999)THENV=3:S1=2:S2=1:S3=0
4130 IF(EX>=6000)AND(EX<=11999)THENV=4:S1=2:S2=2:S3=0
4140 IF(EX>=12000)AND(EX<=24999)THENV=5:S1=2:S2=2:S3=1
4150 IF(EX>=25000)AND(EX<=49999)THENV=6:S1=2:S2=2:S3=2
4160 IF(EX>=50000)AND(EX<=99999)THENV=7:S1=3:S2=2:S3=2:S4=1
4170 IF(EX>=100000)AND(EX<=199999)THENV=8:S1=3:S2=3:S3=2:S4=2
4180 IF(EX>=200000)AND(EX<=299999)THENV=9:S1=3:S2=3:S3=3:S4=2:S5=1
4190 IF(EX>=300000)AND(EX<=399999)THENV=10:S1=3:S2=3:S3=3:S4=3:S5=2
4200 IF(EX>=400000)AND(EX<=499999)THENV=11:S1=3:S2=3:S3=3:S4=3:S5=3
4210 IF(EX>=500000)AND(EX<=599999)THENV=12:S1=4:S2=4:S3=4:S4=4:S5=4
4220 IFEX>=600000THENV=13:S1=4:S2=4:S3=5:S4=5:S5=5
4230 RETURN
4240 '
4250 LI$="YOU FIND A CHEST!!":GOSUB 2070:GOSUB2090
4260 LI$="WILL YOU OPEN IT? (Y/N)":GOSUB2070
4270 I$=INKEY$:IFI$=""THEN4270
4280 IFI$="N"THENC(PX,PY)=1:GOSUB1560:GOSUB2090:RETURN
4290 IFI$="Y"THENGOSUB2090:GOTO4310
4300 GOTO4270
4310 RC=RND(10)
4320 IFRC=1THENLI$="IT'S EMPTY...":GOSUB2070:GOSUB2090:GOSUB1560:C(PX,PY)=1:RETURN
4330 IFRC=2ORRC=3THENCD=INT(RND(5*(V*.5))):LI$="THE CHEST EXPLODES!!!":GOSUB2070:GOSUB2090:LI$="YOU TAKE"+STR$(CD)+" POINTS DAMAGE!":GOSUB2070:GOSUB2090:HP=HP-CD:IFHP<0THENRUN"SKULL.BAS"
4340 IFRC=4THEN4360
4350 CG=RND((RC+10+L)*10):LI$="YOU FIND"+STR$(CG)+" GOLD!":GOSUB2070:GOSUB2090:C(PX,PY)=1:GP=GP+CG:EX=EX+CG:GOSUB1350:GOSUB1560:RETURN
4360 IFRND(2)=1THEN4530ELSETW$=W$:IFRND(100)>40THEN4410
4370 RC=RND(2+(INT(L/4))):W$=STR$(RC)
4380 RC=RND(5):IFRC=1THENW$=W$+"DA"ELSEIFRC=2THENW$=W$+"CL"ELSEIFRC=3THENW$=W$+"AX"ELSEIFRC=4THENW$=W$+"MA"ELSEIFRC=5THENW$=W$+"SW"
4390 TEMP$=RIGHT$(W$,3):W$=TEMP$
4400 GOTO4420
4410 RC=RND(5):IFRC=1THENW$="DAG"ELSEIFRC=2THENW$="CLU"ELSEIFRC=3THENW$="AXE"ELSEIFRC=4THENW$="MAC"ELSEIFRC=5THENW$="SWO"
4420 IFVAL(MID$(W$,1,1))<>0THEN4440
4430 IFW$="DAG"THENIW$="DAGGER"ELSEIFW$="CLU"THENIW$="CLUB"ELSEIFW$="AXE"THENIW$="HAND AXE"ELSEIFW$="MAC"THENIW$="MACE"ELSEIFW$="SWO"THENIW$="SWORD"
4440 IFVAL(MID$(W$,1,1))=0THEN4470
4450 IFMID$(W$,2,1)="D"THENIW$="DAGGER"ELSEIFMID$(W$,2,1)="C"THENIW$="CLUB"ELSEIFMID$(W$,2,1)="A"THENIW$="HAND AXE"ELSEIFMID$(W$,2,1)="M"THENIW$="MACE"ELSEIFMID$(W$,2,1)="S"THENIW$="SWORD"
4460 IW$=IW$+"+"+MID$(W$,1,1)
4470 GOSUB2090:LI$="YOU FIND A "+IW$+"!":GOSUB2070:GOSUB2090
4480 LI$="DO YOU EQUIP THE WEAPON? (Y/N)":GOSUB2070
4490 I$=INKEY$:IFI$=""THEN4490
4500 IFI$="N"THENW$=TW$:GOSUB2090:GOSUB1560:C(PX,PY)=1:RETURN
4510 IFI$="Y"THENGOSUB2090:GOSUB1560:C(PX,PY)=1:GOSUB2540:RETURN
4520 GOTO4490
4530 '
4540 TA$=A$:IFRND(100)>40THEN4570
4550 RC=RND(2+(INT(L/5))):A$=STR$(RC):RC=RND(3):IFRC=1THEN A$=A$+"LE"ELSEIFRC=2THEN A$=A$+"CH"ELSEIFRC=3THEN A$=A$+"PL"
4560 TEMP$=RIGHT$(A$,3):A$=TEMP$:GOTO4580
4570 RC=RND(3):IFRC=1THENA$="LEA"ELSEIFRC=2THENA$="CHA"ELSEIFRC=3THENA$="PLA"
4580 IFVAL(MID$(A$,1,1))<>0THEN4600
4590 IFA$="LEA"THENIA$="LEATHER"ELSEIFA$="CHA"THENIA$="CHAINMAIL"ELSEIFA$="PLA"THENIA$="PLATEMAIL"
4600 IFVAL(MID$(A$,1,1))=0THEN4630
4610 IFMID$(A$,2,1)="L"THENIA$="LEATHER"ELSEIFMID$(A$,2,1)="C"THENIA$="CHAINMAIL"ELSEIFMID$(A$,2,1)="P"THENIA$="PLATEMAIL"
4620 IA$=IA$+"+"+MID$(A$,1,1)
4630 GOSUB2100:LI$="YOU FIND "+IA$+" ARMOUR!":GOSUB2080:GOSUB2100
4640 LI$="DO YOU EQUIP THE ARMOUR? (Y/N)":GOSUB2080
4650 I$=INKEY$:IFI$=""THEN4650
4660 IFI$="N"THENA$=TA$:GOSUB2100:GOSUB1570:C(PX,PY)=1:RETURN
4670 IFI$="Y"THENGOSUB2100:GOSUB1570:C(PX,PY)=1:GOSUB2540:RETURN
4680 '
4690 GOSUB2090:LI$="INCREASE, DECREASE SPEED? (I/D)":GOSUB2070
4700 I$=INKEY$:IFI$=""THEN4700
4710 IFI$="I"THENLE=LE+50:GOSUB2090:GOTO4740
4720 IFI$="D"THENLE=LE-50:GOSUB2090:GOTO4740
4730 GOTO4700
4740 LI$="DELAY LENGTH ="+STR$(LE):GOSUB2070:GOSUB2090:I$="":RETURN
4750 '
4760 FORY=0TO5:FORX=0TO6:BG(X,Y)=PEEK(1024+(X+132+(Y*32))):NEXTX,Y
4770 U=USR(19)
4780 FORY=0TO5:FORX=0TO6:HY=Y*32:HX=X+132:P=BG(X,Y):POKE1024+HX+HY,P:NEXTX,Y
4790 RETURN
5000 DATA"SKELETON",1,8,6,7,10
5001 DATA"ӳ"
5002 DATA"ܼ"
5003 DATA""
5004 DATA"πϳϳπ"
5005 DATA"ππ"
5006 DATA"πȀ"
5007 DATA"π"
5008 DATA"π"
5009 DATA"À"
5010 DATA"߀"
5011 DATA"߀"
5012 DATA""
5013 DATA"̀π߀"
5014 DATA"؀"
5015 DATA""
5017 DATA"TROGLODYTE",02,16,12,05,12
5018 DATA"ππ"
5019 DATA"ω"
5020 DATA""
5021 DATA""
5022 DATA""
5023 DATA""
5024 DATA""
5025 DATA""
5026 DATA"ƶ"
5027 DATA""
5028 DATA""
5029 DATA""
5030 DATA"ΌΏ"
5031 DATA"΀΀΀"
5032 DATA""
5034 DATA"CAECILIA",6,48,12,6,50
5035 DATA""
5036 DATA""
5037 DATA""
5038 DATA""
5039 DATA""
5040 DATA""
5041 DATA""
5042 DATA""
5043 DATA""
5044 DATA""
5045 DATA""
5046 DATA""
5047 DATA""
5048 DATA"𰰰"
5049 DATA""
5051 DATA"VAMPIRE",9,63,40,2,50
5052 DATA""
5053 DATA""
5054 DATA""
5055 DATA""
5056 DATA""
5057 DATA""
5058 DATA"؟؟"
5059 DATA""
5060 DATA""
5061 DATA""
5062 DATA"ɟ"
5063 DATA"ó"
5064 DATA""
5065 DATA""
5066 DATA""
5068 DATA"WRAITH",4,32,36,3,60
5069 DATA"　"
5070 DATA"뀀"
5071 DATA""
5072 DATA"耰耲"
5073 DATA""
5074 DATA" "
5075 DATA""
5076 DATA" "
5077 DATA""
5078 DATA""
5079 DATA""
5080 DATA""
5081 DATA""
5082 DATA""
5083 DATA""
5085 DATA"GIANT SPIDER",3,18,12,5,5
5086 DATA"Հ"
5087 DATA"Հ"
5088 DATA""
5089 DATA""
5090 DATA""
5091 DATA""
5092 DATA""
5093 DATA"󀀀"
5094 DATA""
5095 DATA""
5096 DATA""
5097 DATA"ˀǀ"
5098 DATA""
5099 DATA"􀀀"
5100 DATA""
5102 DATA"DWARF",3,18,6,4,25
5103 DATA"Ҁ"
5104 DATA"Ѐ"
5105 DATA""
5106 DATA""
5107 DATA""
5108 DATA"Ӏ"
5109 DATA"߀"
5110 DATA"߀"
5111 DATA"߀"
5112 DATA""
5113 DATA""
5114 DATA"󔟟"
5115 DATA"ߔ"
5116 DATA"Ӕ"
5117 DATA""
5119 DATA"WIZARD",3,12,24,9,50
5120 DATA""
5121 DATA""
5122 DATA""
5123 DATA""
5124 DATA""
5125 DATA"聁ˀ"
5126 DATA"π"
5127 DATA"΀"
5128 DATA""
5129 DATA""
5130 DATA""
5131 DATA""
5132 DATA""
5133 DATA""
5134 DATA""
5136 DATA"TROLL",6,48,24,4,50
5137 DATA""
5138 DATA""
5139 DATA""
5140 DATA""
5141 DATA""
5142 DATA""
5143 DATA""
5144 DATA""
5145 DATA""
5146 DATA"Ȁ"
5147 DATA""
5148 DATA""
5149 DATA""
5150 DATA""
5151 DATA""
5153 DATA"LESSER DEMON",9,75,40,6,99
5154 DATA""
5155 DATA"°ʀ"
5156 DATA"Ϳΰ"
5157 DATA""
5158 DATA""
5159 DATA""
5160 DATA""
5161 DATA"дЀ"
5162 DATA"нـ"
5163 DATA"пɀ"
5164 DATA"ٳٳـ"
5165 DATA""
5166 DATA"ٶٶٿɿـ"
5167 DATA"ٶٶٶɀ"
5168 DATA""
5170 DATA"EVIL KNIGHT",6,48,12,03,60
5171 DATA""
5172 DATA"Ҁ"
5173 DATA"Ҁ"
5174 DATA"߀"
5175 DATA"Ӑܐ߀"
5176 DATA"ހ"
5177 DATA"߀"
5178 DATA"ހ"
5179 DATA"ހ"
5180 DATA"؀"
5181 DATA"ـ"
5182 DATA"ـ"
5183 DATA""
5184 DATA""
5185 DATA""
5187 DATA"GREEN SLIME",2,12,4,9,10
5188 DATA""
5189 DATA""
5190 DATA""
5191 DATA""
5192 DATA""
5193 DATA""
5194 DATA""
5195 DATA""
5196 DATA"π"
5197 DATA"πɀ"
5198 DATA"·ƀɇ"
5199 DATA"ʏƃƃ"
5200 DATA"Ə"
5201 DATA"Ƕ"
5202 DATA""
5204 DATA"RED DRAGON",10,90,50,4,99
5205 DATA"˴"
5206 DATA"˴"
5207 DATA"˵"
5208 DATA"³"
5209 DATA"¼"
5210 DATA"̷"
5211 DATA""
5212 DATA"Ľ"
5213 DATA"Ĵ"
5214 DATA"Ĵ"
5215 DATA""
5216 DATA""
5217 DATA"߯߯"
5218 DATA"ׯ"
5219 DATA""
5221 DATA"PIXIE",1,5,4,3,10
5222 DATA""
5223 DATA"ۀ"
5224 DATA"ۀ"
5225 DATA""
5226 DATA""
5227 DATA""
5228 DATA"ߑ"
5229 DATA"ӕ"
5230 DATA"؀"
5231 DATA"؀"
5232 DATA""
5233 DATA""
5234 DATA""
5235 DATA""
5236 DATA""
5238 DATA"KOBOLD",1,5,6,7,15
5239 DATA""
5240 DATA""
5241 DATA""
5242 DATA""
5243 DATA"򜛘"
5244 DATA""
5245 DATA""
5246 DATA""
5247 DATA"ȸȀ"
5248 DATA"˱"
5249 DATA""
5250 DATA""
5251 DATA""
5252 DATA""
5253 DATA""
5255 DATA"GUIDE GUY",1,2,1,9,2
5256 DATA"Ȁ"
5257 DATA"ŀ"
5258 DATA""
5259 DATA""
5260 DATA""
5261 DATA""
5262 DATA""
5263 DATA"ȏ"
5264 DATA""
5265 DATA""
5266 DATA""
5267 DATA"̀ʀ"
5268 DATA"À"
5269 DATA""
5270 DATA""
