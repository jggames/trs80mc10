100 INIT 101 G7=0102 G8=0110 DIM A(20,9)120 PAGE 130 PRINT "Wumpus Hunt"140 PRINT "Enter your name: ";150 INPUT N$160 PRINT "Do you wish the instructions? ";170 INPUT A$180 A$=SEG(A$,1,1)190 IF A$<>"Y" THEN 580200 PAGE 210 PRINT "     You, ";N$;", are hunting the dreaded Wumpus in his"220 PRINT "caverns, a deadly job at best.  The Wumpus lives in a den";230 PRINT " of 20 caverns,each connected to 3 other caverns by ";240 PRINT "tunnels.  As you move from cavernto cavern in search of ";250 PRINT "the Wumpus, you are aided by your sense of smell,which ";260 PRINT "warns you if you are within two caverns of the Wumpus.  You";270 PRINT " shootarrows to slay the Wumpus, but if you wander into ";280 PRINT "his cavern, he willEAT YOU!    In addition to the ";290 PRINT "perils";300 PRINT " of the Wumpus himself, 3 of the cavernscontain bottomless";310 PRINT " PITS, which are fatal, and 3 of the caverns houseSUPER-";320 PRINT "BATS, who are so annoyed by your intrusion that they pick ";330 PRINT "you upand move you to any other cavern at random, then";340 PRINT " return home.  However,all is not hopeless because you can";350 PRINT " feel drafts from the pits one cav-ern away, and can hear ";360 PRINT "squeaking of the bats one cavern away.  Of coursethe bats";370 PRINT " may move you to a cavern containing other bats, or pits, ";380 PRINT "oreven the Wumpus!  Also, the Wumpus has sucker feet ";390 PRINT "allowing him to livein a cavern with a pit, and he is too ";400 PRINT "heavy to be moved by bats.  Infact, all the perils may be ";410 PRINT "found in a single cavern.     Once you think you know ";420 PRINT "where the Wumpus is hiding, you may shootan arrow at him. ";430 PRINT "To shoot an arrow, type ""S"".  There is no limit to the";440 PRINT "number of arrows. Whenever an arrow is shot anywhere, there";450 PRINT " is a 50%chance the Wumpus will move to the next cavern";460 PRINT " afterwards. ";470 PRINT "Arrows may go5 caverns, and at each point along the";480 PRINT " way, you will be asked whichcavern to go to next.  If you";490 PRINT " wish to stop the arrow, just press RETURN.If you select";500 PRINT " an invalid cavern, one that is not connected to the cavern";510 PRINT "the arrow is in, the arrow will make random choices of ";520 PRINT "which ";530 PRINT "tunnels tofollow for the rest of its flight. It could get ";540 PRINT "the Wumpus, but it mightturn around and get YOU!  Arrows";550 PRINT " cannot shoot bats, they hide too closeto the walls.    ";560 PRINT " Ready?  Press RETURN to continue.  BE CAREFUL!!!"570 INPUT A$580 PAGE 590 PRINT "Here goes the famous Wumpus hunter ";N$600 PRINT "down into the caverns. . . . . . . . . . . . . .HUNTER ";G8601 PRINT "                                                WUMPUS ";G7610 REM ----- SCRAMBLE TUNNELS -----620 A=0630 X=0640 FOR I=1 TO 20650 FOR J=1 TO 3660 IF A(I,J)>0 THEN 940670 K=INT(RND(-1)*21)680 IF K=0 OR K=21 THEN 670690 X=X+1700 IF X<150 THEN 830710 IF A(I,3)>0 OR A(I,2)>0 THEN 620720 A(I,2)=A(I-1,2)730 L=A(I,2)740 M=I-1750 A(I-1,2)=0760 I=I-1770 X=0780 FOR N=1 TO 3790 IF A(L,N)<>M THEN 820800 A(L,N)=M+1810 GO TO 670820 NEXT N830 IF K=I THEN 670840 IF A(K,3)<>0 THEN 670850 IF A(K,1)=I OR A(K,2)=I OR A(K,3)=I THEN 670860 A(I,J)=K870 IF A(K,1)>0 THEN 900880 A(K,1)=I890 GO TO 950900 IF A(K,2)>0 THEN 930910 A(K,2)=I920 GO TO 950930 A(K,3)=I940 X=0950 NEXT J960 NEXT I970 REM ----- PLACE PITS -----980 FOR I=1 TO 3990 K=INT(RND(-1)*21)1000 IF K=0 OR K=21 THEN 9901010 IF A(K,5)=1 THEN 9901020 A(K,5)=11030 FOR J=1 TO 31040 L=A(K,J)1050 A(L,8)=11060 NEXT J1070 NEXT I1080 REM ----- PLACE BATS -----1090 FOR I=1 TO 31100 K=INT(RND(-1)*21)1110 IF K=0 OR K=21 THEN 11001120 IF A(K,6)=1 THEN 11001130 A(K,6)=11140 FOR J=1 TO 31150 L=A(K,J)1160 A(L,9)=11170 NEXT J1180 NEXT I1190 X=01200 REM ----- PLACE WUMPUS -----1210 K=INT(RND(-1)*21)1220 IF K=0 OR K=21 THEN 12101230 A(K,4)=11240 FOR N=1 TO 201250 A(N,7)=01260 NEXT N1270 FOR N=1 TO 31280 J=A(K,N)1290 A(J,7)=11300 FOR L=1 TO 31310 M=A(J,L)1320 A(M,7)=11330 NEXT L1340 NEXT N1350 REM ----- ARBITRARY FIRST PLACEMENT SECTION -----1360 IF X>0 THEN 15101370 FOR I=1 TO 201380 FOR J=4 TO 91390 IF A(I,J)<>0 THEN 14201400 NEXT J1410 GO TO 14801420 NEXT I1430 I=INT(RND(-1)*21)1440 IF I=0 OR I=21 THEN 14301450 FOR J=4 TO 61460 IF A(I,J)>0 THEN 14301470 NEXT J1480 X=11490 PAGE 1500 REM ----- PLAY SECTION -----1510 IF A(I,4)<1 THEN 15501520 PAGE 1530 PRINT N$;" was eaten by the WUMPUS!"1531 G7=G7+11540 GO TO 22701550 IF A(I,5)<1 THEN 15901560 PAGE 1570 PRINT N$;" fell into a pit --- clumsy!"1571 G7=G7+11580 GO TO 22701590 IF A(I,6)<1 THEN 16401600 PRINT N$;" got picked up by a super-bat!"1610 I=INT(RND(-1)*21)1620 IF I=0 OR I=21 THEN 16101630 GO TO 15101640 PRINT N$;" is in cavern ";I;"."1650 IF A(I,7)<1 THEN 16701660 PRINT "'I smell a Wumpus!'"1670 IF A(I,8)<1 THEN 16901680 PRINT "'I feel a draft.'"1690 IF A(I,9)<1 THEN 17101700 PRINT "'I hear squeaking.'"1710 PRINT "Tunnels lead to caverns ";A(I,1);", ";A(I,2);", & ";A(I,3);1720 PRINT ".  Enter your move: ";1730 INPUT A$1740 IF LEN(A$)=0 THEN 17301750 IF A$="S" THEN 18501760 J=VAL(A$)1770 IF J<>I THEN 18001780 PRINT "You're already there";1790 GO TO 17201800 IF J<>A(I,1) AND J<>A(I,2) AND J<>A(I,3) THEN 18301810 I=J1820 GO TO 15101830 PRINT "How you gonna get there --- through solid rock? ";1840 GO TO 17301850 L=I1860 FOR M=1 TO 51870 PRINT "Shoot for Cavern: ";1880 INPUT A$1890 IF A$="" THEN 20501900 J=VAL(A$)1910 IF J<>L THEN 19401920 PRINT "Arrow already in that cavern."1930 GO TO 18701940 IF J<>A(L,1) AND J<>A(L,2) AND J<>A(L,3) THEN 20601950 L=J1960 IF I<>L THEN 20001970 PAGE 1980 PRINT N$;" got shot by own arrow!"1981 G7=G7+11990 GO TO 15402000 IF A(L,4)<>1 THEN 20402010 PAGE 2020 PRINT "CONGRATULATIONS, ";N$;", YOU SLEW THE WUMPUS!"2021 G8=G8+12030 GO TO 22702040 NEXT M2050 GO TO 21502060 J=M2070 FOR M=J TO 52080 PRINT "Bounce ";2090 K=INT(RND(-1)*4)2100 IF K=0 OR K=4 THEN 20902110 L=A(L,K)2120 IF L=I THEN 19702130 IF A(L,4)>0 THEN 20102140 NEXT M2150 IF RND(-1)>0.5 THEN 15102160 FOR M=1 TO 202170 IF A(M,4)>0 THEN 21902180 NEXT M2190 K=INT(RND(-1)*4)2200 IF K=0 OR K=4 THEN 21902210 A(M,4)=02220 K=A(M,K)2230 IF K<>I THEN 12302240 PAGE 2250 PRINT "The Wumpus moved into ";N$;"'s Cavern!"2260 GO TO 15302270 PRINT 2280 PRINT "Cavern  Tunnels ------------------------Dangers-----------";2290 PRINT "--------------"2300 PRINT 2310 FOR I=1 TO 202320 PRINT USING "2X2D3X2D1X2D1X2D1XS":I,A(I,1),A(I,2),A(I,3)2330 GO TO A(I,4)+1 OF 2360,23402340 PRINT "-WUMPUS---";2350 GO TO 23702360 PRINT "----------";2370 GO TO A(I,5)+1 OF 2400,23802380 PRINT "Pit---";2390 GO TO 24102400 PRINT "------";2410 GO TO A(I,6)+1 OF 2440,24202420 PRINT "Bats---";2430 GO TO 24502440 PRINT "-------";2450 GO TO A(I,7)+1 OF 2480,24602460 PRINT "Wumpus scent---";2470 GO TO 24902480 PRINT "---------------";2490 GO TO A(I,8)+1 OF 2520,25002500 PRINT "Draft---";2510 GO TO 25302520 PRINT "--------";2530 GO TO A(I,9)+1 OF 2560,25402540 PRINT "Squeaking-"2550 GO TO 25702560 PRINT "----------"2570 NEXT I2580 PRINT "";2590 PRINT "To play again, press RETURN: ";2600 INPUT A$2610 GO TO 580