0 DIMC1,C2,C3,M$,M:M=16384:GOTO10
7 C1=(PEEK(17024)AND1)*256+PEEK(17025)-1+M:FORC2=1TOLEN(M$):C3=ASC(MID$(M$,C2)):POKEC1+C2,C3-(C3AND64):NEXT:?@C1-M+C2,:RETURN
10 GOSUB10700:GOTO720
99 PRINT@32*Y+X,;:M$=X$:GOSUB7:RETURN
199 PRINT@Y*32+X,X$;:RETURN
210 NEXT:RETURN
211 X=28+6*T:Y=6*(P-1):FORI=0TO5:FORJ=0TO5:SET(X+I,Y+J,CC):NEXTJ,I:RETURN
212 X=12:Y=7-V:X$=">":GOSUB199:Y=7+V:X$="<":GOSUB199:X$="DIR":X=11:Y=7:GOSUB99:RETURN
250 RESTORE
251 READWW:IFW<>WWTHEN251
252 RETURN
720 V=1:RT=1
770 PRINT@416,"      HIT ANY KEY TO BEGIN"
780 IFINKEY$=""THENZ=RND(0):GOTO780
800 CLS0:FORT=18TO30STEP3:X=T:Y=15:X$=CHR$(48+(T-15)/3):GOSUB199:NEXT
810 FORT=2TO14STEP3:X=16:Y=T-1:X$=CHR$(48+(T+1)/3):GOSUB199:NEXT
820 DIMC(25):B=1
830 C=INT(RND(6)+1):IFC=1ORC=6THEN830
840 IFC=4THENA4=A4+1:IFA4=6THENA4=5:GOTO830
850 IFC=2THENA2=A2+1:IFA2=6THENA2=5:GOTO830
860 IFC=3THENA3=A3+1:IFA3=6THENA3=5:GOTO830
870 IFC=7THENA7=A7+1:IFA7=6THENA7=5:GOTO830
880 IFC=5THENA5=A5+1:IFA5=6THENA5=5:GOTO830
890 C(B)=C:B=B+1:IFB<>26THEN830
920 B=0:FORP=1TO5:FORT=1TO5:B=B+1:CC=C(B):GOSUB211:NEXTT,P:GOSUB212
1020 RESTORE:DIMX(25)
1040 FORT=1TO25:X(T)=C(T):NEXTT
1060 X=0:Y=0:X$="ROW":GOSUB99:GOSUB1180
1061 X=0:L=A:Y=2:X$="COLUMN":GOSUB99:GOSUB1180
1062 PRINT@8,"   ";:PRINT@72,"   ";
1070 C=A
1100 GOSUB1290
1110 YY=0
1120 YY=YY+1:Z=X(5*YY):XX=0:IFYY=6THEN1050
1130 XX=XX+1:IFXX=6THEN1120
1140 IFX(5*(YY-1)+XX)<>ZTHEN1060
1150 IFXX=5THENIFYY=5THEN1780
1160 GOTO1130
1180 FORT=1TO100:NEXTT
1190 Z$=INKEY$:IFZ$=""THEN1190
1200 Z=ASC(Z$):IFZ=13THENYT=Y:V=V*-1:GOSUB212:Y=YT:RT=1-RT:SOUND200,15:GOTO1180
1210 IFZ=145THEN10000
1220 IFZ<49ORZ>53THEN1180
1230 A=Z-48:PRINT@8+Y*32,A;
1240 FORB=50TO60:SOUNDB,1:NEXTB
1250 RETURN
1290 G=C+(L-1)*5
1300 IFG=1THENW=1620+10*RT:TE=3:A=X(G+1):GOTO1490
1320 IFG=2ORG=3ORG=4THENW=1640+10*RT:TE=5:A=X(G+1):GOTO1490
1340 IFG=5THENW=1660+10*RT:TE=3:A=X(G+5):GOTO1490
1360 IFG=6ORG=11ORG=16THENW=1680+10*RT:TE=5:A=X(G-5):GOTO1490
1380 IFG=21THENW=1700+10*RT:TE=3:A=X(G-5):GOTO1490
1400 IFG=22ORG=23ORG=24THENW=1720+10*RT:TE=5:A=X(G-6):GOTO1490
1420 IFG=25THENW=1740+10*RT:TE=3:A=X(G-6):GOTO1490
1440 IFG=10ORG=15ORG=20THENW=1760+10*RT:TE=5:A=X(G-6):GOTO1490
1460 A=X(G-6):TE=8
1470 W=1510-10*RT
1490 GOSUB250:FORZZ=1TOTE:READH:B=X(G+H):X(G+H)=A:A=B:GOSUB1530:NEXTZZ
1500 DATA1500,-5,-4,1,6,5,4,-1,-6,1510,-1,4,5,6,1,-4,-5,-6
1520 RETURN
1530 Q=INT((G+H)/5)
1540 R=G+H-5*Q
1541 Q=Q+1:IFR=0THENQ=Q-1:R=5
1560 CC=X(G+H)
1570 P=Q:T=R:GOSUB211:RETURN
1620 DATA 1620,5,6,1,1630,6,5,1,1640,-1,4,5,6,1,1650,6,5,4,-1,1,1660,-1,4,5,1670,4,-1,5
1680 DATA 1680,5,6,1,-4,-5,1690,-4,1,6,5,-5,1700,1,-4,-5,1710,-4,1,-5,1720,-1,1,-4,-5,-6
1730 DATA 1730,-5,-4,1,-1,-6,1740,-1,-5,-6,1750,-5,-1,-6,1760,-1,4,5,-5,-6,1770,-5,5,4,-1,-6
1780 CLS0:X=12:Y=8:X$="YOU WIN!":GOSUB199:FORI=1TO15:SOUNDI*I,I:NEXT
10000 CLS0:X=10:Y=3:X$="PLAY AGAIN?":GOSUB99
10010 Y=10:X$=" 1 : YES":GOSUB199
10020 Y=13:X$=" 2 : NO ":GOSUB199
10030 A$=INKEY$:IFA$<>"1"ANDA$<>"2"THEN10030
10040 IFA$="1"THENRUN
10050 CLS:END
10210 NEXT:RETURN
10211 X=14+3*T:Y=3*(P-1):X=2*X:Y=Y*2:FORI=0TO5:FORJ=0TO5:SET(X+I,Y+J,CC):NEXTJ:NEXTI:RETURN
10212 X=12:Y=7-V:X$=">":GOSUB199:Y=7+V:X$="<":GOSUB199:X$="SENS":X=11:Y=7:GOSUB99:RETURN
10250 RESTORE
10251 READWW:IFW<>WWTHEN10251
10252 RETURN
10700 CLS0:DIMDA(4),DA$(4):DA(1)=5:DA$(1)="00100001000101001010100011000110001"
10701 DA(2)=4:DA$(2)="01110001000010000100001000010001110":DA(3)=1:DA$(3)="10000100001000011110100001000011111"
10702 DA(4)=3:DA$(4)="01110001000010000100001000010001110"
10703 Y=7:X=43:FORW=1TO4:P=0:C1=C1+1:C=DA(C1):X$=DA$(C1)
10704 FORI=1TO7:FORJ=1TO5
10706 P=P+1:V=VAL(MID$(X$,P,1)):IFV=0THEN10710
10708 SET(X+J,Y-I,C)
10710 NEXTJ,I:X=X+5:NEXTW
10716 X$="NATHAN":X=26:Y=4:GOSUB99
10717 X$="MC-10":X=0:Y=0:GOSUB99
10720 PRINT@15*32,"  (C) VIFI-INTERNATIONAL 1984  ";
10721 X$="GYRACOLOR":X=11:Y=8:GOSUB99
10722 FORI=1TO5000:NEXTI
10729 CLS0:X=11:Y=1:X$="GYRACOLOR":GOSUB99
10730 Y=3:X=0:X$="THE GOAL OF THE GAME IS TO ALIGNTHE BOXES OF THE SAME COLOR.    ":GOSUB199
10740 Y=5:X=0:X$="THE FIRST TIME YOU SELECT A BOX,ALL NEARBY BOXES TURN CLOCKWISE.":GOSUB199
10750 Y=7:X=0:X$="YOU CAN REVERSE THE DIRECTION   BY PRESSING THE ENTER KEY.      ":GOSUB199
10790 RETURN
