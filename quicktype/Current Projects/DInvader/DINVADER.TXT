20 CLEAR 15ii;0
30 BS=0
41Z> DIM EX ( 12)
50 NM=3: SC=0
60 CLS(0)
70 X$=CHR$(128) : X3$=X$+X$+X$: X6$=X3$+X3$
80 XL$=X6$+X6$+X6$+X6$+X6$+X$
90 XJ$=STRING$(8,X$)
100 ' FIRST SET'
110 Q1$=X$+CHR$ ( 223 ) +X$
120 Q2$=CHR$(214 ) +CHR$ ( 220) +CHR$(217i
130 R2$=CHR$ (213)+CHR$ ( 220) +CHR$ ( 218)
140 ' SECOND SET'
150 Q3$=CHR$(225) +CHR$(227) +CHR$ ( 226)
160 Q4$=CHR$ ( 236l +CHR$ ( 239) +CHR$ ( 236)
17<i.> R4$=CHR$ ( 2371 +CHR$ ( 236) +CHR$ ( 238)
18<i.> ' THI RD SET'
19<i.> Q5$=CHR$ 1 241) +CHR$ (243) +CHR$ (242)
200 Q6$=CHR$ ( 251 ) +CHR$(255l +CHR$ ( 247l
2112> R6$=CHR$ 1 243 ) +CHR$ ( 255 ) +CHR$ 1 243 1
220 Q7$=X3$
230 R7$=CHR$(248)+CHR$(128l+CHR$ ( 244l
240 Q7$=X3$
250 R6$=CHR$(243 ) +CHRS ( 255) +CHR$ ( 243)
260 G l$="": G2$="": FOR I =1T04: G1$=G1$+Q l $+X3$:
G2$=G2$+Ql$+X3$: NEXTI
270 G l$=Gl$+XJ$: G2$=G2$+XJ$: FOR I =1T04:
G1$=Gl$+Q2$+X3$: G2$=G2$+R2$+X3$: NEXTI
280 G l$=G1$+XJ$: G2$=G2$+XJ$: FOR I =1T04:
G1$=G1$+Q3$+X3$: G2$=G2$+Q3$+X3$: NEXTI
290 G1$=G1$+XJ$: G2$=G2$+XJ$: FOR I =1T04:
G1$=Gl$+Q4$+X3$: G2$=G2$+R4S+X3S: NEXTI
300 G1$=Gl$+XJ$: G2S=G2S+XJS: FOR 1 =1T04:
G1$=G1S+Q5$+X3$: G2$=G2$+Q5S+X3S: NEXTI
310 G1$=Gl$+XJ$: G2$=G2$+XJS: FOR I =1T04:
G1$=G l$+Q6S+X3S: G2$=G2$�R6S+X3$: NEXTI
320 G l$=G l$+XJ$: G2$=G2$+XJ$: FOR I =1T04:
G1S=Gl$+Q7$+X3$: G2$=G2S+R7$+X3$: NEXTI
330 LW=216: G1$=LEFTS ( G1S, 216) :G2$=LEFTS (G2S,216l
340 BA$=CHR$(174)+CHRS (172) +CHR$ ( 172l +CHR$ ( 173)
350 T$=X$+X$+BAS
360 BA$=T$+T$+T$+T$+T$
370 SHS=XS+CHR$ 1 129)+CHR$ 1131)+CHR$ ( 139)+CHRS(131) +XS
380 P I=0: Pl<=65
390 PS=13: PU=13
412>0 M l=-1: M2=-1
410 H1=32: H2=32: H3=32: H4=32
420 FOR I E=1T012: EX ( IE)=+l: NEXTI E: FOR I=1T04: LV( I ) =3
: NEXTI
430 D I=+1: LI=9
440 ' DRAW BARRIER� & SHIP'
450 PR I NT :il448, BAS;: PR I NT :il480+PS, SHS;
500
88510 GOSUB 1 000: ' DRAW I NVADAS'
52Qi GOSUB 3000: ' DROP BOMB'
53Q; GOSUB 1 500: ' TRACK MISS I LE'
540 GOSUB 35 1 0: ' MOVE BOMBS '
55Q; GOSUB 2500: ' SEE .JOY '
560 GOTO 510
57Q)
000 ' PR INT I NVADAS '
010 PI=PI+DI
020 PK=PK+2
03Q; IF PK< 63 THEN RESET < PK-3, 0 ) : RESET ( PK-2, <!)) :
SET (PK, Qi, 4 ) : SET ( PK- 1 , 0, 4 ) , GOTOl 060
1 04Qi IF PK=63 THEN RESET ( P!<-2 , QJ) : RESET ( PK-3 , 0) :
GOT0 1 <!>6Q1
1 QJ50 IF P!01 28 THEN PK= l
1 060 IF P I >=L I THEN D l =- 1 : GOTO 111 0
1 070 IF P I<=0 THEN DI=+l
1 08Qi PR I NT ;i)32+P I, G l $ ;
1 090 FOR I=1T010: NEXTI
11 QJ0 PR I NT el32+P I, G2$;
1 1-lQl RETURN
15Ql0 " TRACK MISSILE"
15H1 IF M2< 0 THEN RETURN
1 520 RESET (Ml � M2)
1 530 M2=M2-2 : IF M2< 0 THEN RETURN
1 540 P=PO I NT (M1 , M2 1 +1
1 55Ql ON P GOTO 1 630 :- 4 '!>60, 1 560, 1610:r 2100, 1 630,
1 64QJ, 1 640, 1 64 (,'J
1 56Qi SOUND 50, 1
1 57«> IF Hl=Y THEN H1=32: GOT0 161QJ
1 58Q1 IF H2=Y THEN H2=32:GOT01610
1 590 IF H3=Y THEN H3=32:GOT01610
1 6QJ�o H4=32
1610 RESET <Ml , M2l
1 620 M2=- 1 : RETURN
1 63lii SET (Ml , M2 , 5 1 : GOT01 52<21
1 640 ' GOT ONE '
1 65Qi SOUND 1 00, 1
1 660 I=INT ( IM1-2*Pi l / 12) + 1 : J=P-6
1 670 EX IJ *4-4+ I ) =-1
1 68Qi FOR I I =l T04
1 69Q1 LV IIIl=0
1 7Qi0 FOR J J=3 TO 1 STEP -1
1710 IF E X C 4 *JJ+ I I -4 ) >0 GOTO 1 740
1 72<1> NEXT .JJ
1 73QJ GOTO 1 750
1 74Q1 LV (II ) =JJ
1 75,,, NEXT I I
1 760 SC=SC+ ( 4-J ) l50
1 770 PR I NT @32,STR I NG$ 1 224, X$l ;
1 78�' SOUND 1 00, 1:PRINT ;;)1 70, " SCORE: ":SC;
1 790 Ll=I * 6+ 1J*J +J ) * 1 6-6
1800 L2=L l -32: L3=L2-32
1810 R l =LW-L 1 -6 : R2=R 1 +32: R3=R2+32
1 820 I6=I *6
1 830 G 1 $=LEFT$ (G1$,L2 ) +X6$+R I GHT$ (Gl$, R2 l : G l $=LEFT$ (G1$, L1) + X6$+RI GHT$ (G1 $,R l )
1840 G2$=LEFT$ (G2$, L2l+X6$+RI GHT$ (G2$ , R2 ) :
G2$=LEFT$ (G2$,Lll +X6$+RI GHT$ (G2$,R l )
1 850 IF J<3 GOTO 1 870
1 86 €> Gl$=LEFT$ (G1 $,L3 ) +X6$+RIGHT$ (G1$,R3):
G2$=LEFT$ (G2$ , L3l+X6$+RI GHT$ (G2$,R3)
1 870 FOR I E=12 TO 1 STEP -1
1 880 IF EX (IEJ >0 GOTO 1910
1 890 NEXT !E
1 900 CLS (0J : GOT0260
1910 J=FIX ( ( IE- 1 ) /4)+1: I=IE- (J-1 ) *4
1 920 LW= I *6+ (J*J+Jl*16
1 930 G 1$=LEFT$ (Gl$,LW ) : G2$=LEFT$ < G2$, LW)
1 94<Z> FOR 1 =4 TO 1 STEP -1
1 95Q> FOR J=1 T03
1 960 IF EX < J*4-4+IJ>0 GOTO 1 990
1 970 NEXT J
1 980 NEXT I
1 990 LI=35-6* 1
2000 FOR J=l TO 3
201 0 IF EX (J*4-3 ) >0 GOTO 2 080
2020 NEXT J
2030 FOR IE=l TO 1 1 : EX<IE)=EX (IE+ll: NEXT I E: EX (12l=-l
2040 LW=LEN (G 1$l : G 1 $=RIGHT$ (G1$, LW-6 ) :
G2$=R I GHT$ (G2$, LW-6)
205Q> LW=LW-6
2060 LI=LI+6
2070 GOT02000
2080 FOR IE=l TO 460-LW: NEXT IE
2090 DI=2*RND (2) -3:PI=RND (L I):
PRI NT @170, STRING$ (15,X$ ) ; : GOT01610
2100 RESET < PK, 0) :SOUND 230, 1 :PRI NT @PK/2,CHR$ (153);:
SOUND 230, 1: PRI NT ;j)pf</2, CHR$ ( 1 50) ;,
SOUND 230, 1: PRI NT ;iJPK/2, CHR$ ( 1 53 ) ;:
PRI NT ;j)pf</2, X$; : Pl<=64, SC=SC+5Q>0: RETURN
2500 ' MOVE ? FIRE ?'
2510 PS=INT (JOYSTl< (0l/2)
252<ci IF PS< 0 THEN PS=0
2530 IF PS:0-25 THEN PS=25
254Q> DS=SGN (PS-PU )
2550 PU=PU+DS
2560 PRI NT @480+PU, SH$;
2570 IF PU< >PS THEN GOTO 2550
2580 PRINT @480+PS,SH$ ;
2590 IF PEEJ<: (652801 =125 GOTO 2610
26,Z>Q> IF PEEi< (652801 < >253 THEN RETURN
26 10 IF M2 >0 THEN RETURN
2620 SOUND 180,1:M 1=2*PS+6:M2=28
2630 IF POI NT (Ml ,28 ) )0 THEN PRI NT ;;)448+M1 /2,X$;: M2=-1:
RETURN
264€> SET (M l, M2, 5 ) : GOSUB151 0: RETURN
3000 ' DROP BOMB '
301 0 I=RND (4 ) , I F LV ( I ) =0 THEN RETURN
3015 l<=I: FOR J=l TO I: IF LV (J)=0 THEN l<=f<- 1: NEXT J
302,Z> H=LV (I ) *4+3
3030 G= < 6*1<+P I-4) *2-13<>40 IF Hl >31 THEN Hl=H: G1=G : GOT03090
3<1>50 IF H2>31 THEN H2=H: G2=G: GOT03090
3<!>60 IF H3>31 THEN H3=H: G3=G: GOT0309<!>
3'1)70 IF H4>31 THEN H4=H: G4=G: GOT0309<!>
3<!>8f1 RETURN
3"19<1> SET I G, H, 2), RETURN
35'2>0 ' MOVE BOMBS'
351<1> H1=H1+4: H2=H2+4: H3=H3+4, H4=H4+4: K=0
3520 IF H1< 36 THEN H=H1, G=G1: GOT03570
3530 IF H2< 36 THEN H=H2: G=G2: GOTO 3570
3540 IF H3< 36 THEN H=f+3 : G=G3: GOTO 3570
3550 IF H4<36 THEN H=H4, G=G4:GOTO 3570
3560 RETURN
3570 RESET(G, H-4):IF H>31 THEN K=32: GOT03630
3580 IF H< >27 GOT03600
359<!> IF POI NT(G,28) =3 THEN RESET , G,28) : K=32: SOUND 180, 1:GOTO
36312>
3600 P=POINT IG,Hl+ l
3610 ON P GOTO 3670, 3690, 3670, 3620, 3620, 3680,
3670, 3670,3670
3620 SOUND 180,1:RESET I G,HJ :K=32
3630 IF ABS I G-Gll+ABS(H-H1) =0 THEN Hl =H+K:K=0:GOT03530
3640 IF ABS I H-H2 ) +ABS I G-G2)=0 THEN H2=H+K: K=0: GOT03540
365<<' IF ABS IH-H3l +ABS ( G-G3 ) =0 THEN H3=H+K: K=0: GOT03550
3660 H4=H4+K:K=0: RETURN
3670 SET \G, H , 2 ) ; GOTO3630
3680 M2=-1: GOT03620
3690 FOR I=l TO 5: SOUND 10,2: SOUND 10,1 : NEXT I
3700 K=32:NM=NM-1: IF NM< =0 THEN GOTO 4010 ,
ELSE GOT0363<!l
4000 ' FINISHED GAME'
4<!>10 CLS: PRINT :i)0, "SCORE
4020 IF SC>BS THEN BS=SC
";SC ;
4<!>3<!> PRINT :i)64, "BEST SCORE ";BS;
4040 IF PEEK (65280) =125 GOTO 50
4,>50 IF PEEK l 65280) =253 THEN GOTO 50 ELSE GOTO 4040
5«>00 END