0 REM01234567890123456789012345678901234567890123456
1 CLS:GOSUB10000:GOTO100
2 O=32*Y(C)+X(C):L=O+M:ON-(K(PEEK(L-2))>CANDX(C)>0)GOTO3:K=L-2:ONK(PEEK(K))GOTO15,19,19,19:GOTO19
3 PRINT@O,A$(0);:X(C)=X(C)-2:PRINT@O-2,A$(C);:D(C)=1:RETURN
4 O=32*Y(C)+X(C):L=O+M:ON-(K(PEEK(L+2))>CANDX(C)<30)GOTO5:K=L+2:ONK(PEEK(K))GOTO15,19,19,19:GOTO19
5 PRINT@O,A$(0);:X(C)=X(C)+2:PRINT@O+2,B$(C);:D(C)=2:RETURN
6 O=32*Y(C)+X(C):L=O+M:ON-(K(PEEK(L-32))>CANDY(C)>0)GOTO7:K=L-32:ONK(PEEK(K))GOTO15,19,19,19:GOTO19
7 PRINT@O,A$(0);:Y(C)=Y(C)-1:PRINT@O-32,A$(C);:D(C)=3:RETURN
8 O=32*Y(C)+X(C):L=O+M:ON-(K(PEEK(L+32))>CANDY(C)<14)GOTO9:K=L+32:ONK(PEEK(K))GOTO15,19,19,19:GOTO19
9 PRINT@O,A$(0);:Y(C)=Y(C)+1:PRINT@O+32,A$(C);:D(C)=4:RETURN
10 PRINT@R(C),A$(0);:R(C)=R(C)+32:PRINT@R(C),A$(5);:GOTO21
11 PRINT@R(C),A$(0);:R(C)=R(C)+32:PRINT@R(C),A$(5);:PRINT@0,;:FORX=2TO4:IF32*Y(X)+X(X)=R(C)THEN13
12 NEXT:STOP
13 Y=X:X=4:NEXT:PRINT@R(C),"90";:SC=SC+90:PRINT@480,;:M$=STR$(SC):GOSUB99:SOUND100,5:PRINT@R(C),A$(5);:GOSUB30:GOTO21
15 X=PEEK(K):IFX=223ORX=221THENIFX(C)<30ANDX(C)>0THENGOSUB90:B=B+(B>0):PRINT@496,;:M$=STR$(B)+" ":GOSUB99:IFB<1THENJ=0
16 IFX=195ORX=202THENPRINT@K-M,A$(0);
17 IFX=175THENIFC>1THENPRINT@O,A$(0);:PRINT@K-M,A$(C);:SOUND1,5:PRINT@K-M,"xx";:SOUND20,2:PRINT@K-M,"¯¯";:Y=C:GOSUB30
19 RETURN
20 K=K(PEEK(2)ANDPEEK(17023)):C=1:ONKGOSUB2,4,6,8,50:FORC=1TO3:ONK(PEEK(R(C)+M+32))GOTO21,21,11,21,10
21 NEXT:FORC=2TO4:IFRND(20)>GTHENON2+SGN(X(1)-X(C))GOSUB2,19,4:ON2+SGN(Y(1)-Y(C))GOSUB6,19,8:NEXT:GOTO20
22 OND(C)GOSUB2,4,6,8:ONRND(9)GOSUB2,4,6,8:NEXT:IFJTHEN20
25 IFB>0THENGOSUB300:GOTO150
26 SOUND20,10:GOTO200
30 J=J-1:A$(Y)="":B$(Y)="":X(Y)=0:Y(Y)=0:RETURN
50 X=0:O=32*Y(C)+X(C):OND(1)GOSUB51,52,53,54:RETURN
51 L=O+M:ONK(PEEK(L-2))GOTO19,19,61,19:O=O-2:PRINT@O,A$(8);:X=X+1:ON-(X<I)GOTO51:RETURN
52 L=O+M:ONK(PEEK(L+2))GOTO19,19,62,19:O=O+2:PRINT@O,A$(8);:X=X+1:ON-(X<I)GOTO52:RETURN
53 L=O+M:ONK(PEEK(L-32))GOTO19,19,63,19:O=O-32:PRINT@O,A$(9);:X=X+1:ON-(X<I)GOTO53:RETURN
54 L=O+M:ONK(PEEK(L+32))GOTO19,19,64,19:O=O+32:PRINT@O,A$(9);:X=X+1:ON-(X<I)GOTO54:RETURN
55 RETURN
61 O=O-2:GOTO65
62 O=O+2:GOTO65
63 O=O-32:GOTO65
64 O=O+32:GOTO65
65 FORX=2TO4:IF32*Y(X)+X(X)=OTHEN72
71 NEXT:STOP
72 Y=X:X=4:NEXT:PRINT@O,C$(Y);:SOUND100,5:PRINT@O,"10";:SOUND200,2:SC=SC+10:PRINT@480,;:M$=STR$(SC):GOSUB99:J=J-1
73 PRINT@O,A$(0);:A$(Y)="":B$(Y)="":X(Y)=0:Y(Y)=0:RETURN
90 Q=PEEK(9)AND128:POKE49151,Q:POKE49151,128-Q:RETURN
99 PRINTM$;:CC=((PEEK(17024)AND1)*256+PEEK(17025))-1+M:FORC1=CC-LEN(M$)+1TOCC:POKEC1,PEEK(C1)-64:NEXT:RETURN
100 DIMK(255),X(4),Y(4),O,K,R(3),G,A$(9),B$(9),D(4),X,Y,C$(4):M=16384
110 K(65)=1:K(83)=2:K(87)=3:K(90)=4:K(32)=5
120 K(ASC("Ÿ"))=2:K(ASC("™"))=2:K(ASC("ÿ"))=2:K(ASC("€"))=5:K(ASC("ù"))=2:K(ASC("·"))=1:K(ASC("ð"))=1
130 K(ASC(""))=3:K(ASC("‹"))=3:K(ASC("æ"))=3:K(ASC("Ý"))=1:K(ASC("ß"))=1:K(ASC("Ã"))=1:K(ASC("Ê"))=1
135 K(ASC("¯"))=1
140 G=19:SC=0:B=10:I=3
150 GOSUB2000:G=G-1:IFG<10THENG=10
155 IFG<15THENI=2
157 IFSC-(1000*INT(SC/1000))=0THENB=10
160 GOSUB900:X(1)=16:Y(1)=2:PRINT@32*Y(1)+X(1),A$(1);:GOTO20
200 PRINT@8,"PLAY AGAIN (Y/N)?";
210 M$=INKEY$:IFM$=""THEN210
220 IFM$="Y"THEN140
230 IFM$="N"THENEND
240 GOTO210
300 SOUND193,4
302 SOUND181,2
303 SOUND185,4
304 SOUND171,2
305 SOUND181,4
306 SOUND161,2
307 SOUND171,4
308 SOUND156,2
309 SOUND161,2
310 FORC1=1TO25:NEXT
311 SOUND210,4:RETURN
900 CLS0:PRINT@0,;
1000 PRINT"á­­¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ñ­Ñ­";
1001 PRINT"ª§ª§¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯ª§ª§";
1002 PRINT"ŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸ";
1003 PRINT"ŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸ";
1004 PRINT"ŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸŸ";
1005 PRINT"™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™";
1006 PRINT"™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™";
1007 PRINT"™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™™";
1008 PRINT"ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ";
1009 PRINT"ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ";
1010 PRINT"ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ";
1011 PRINT"ùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùù";
1012 PRINT"ùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùù";
1013 PRINT"ùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùù";
1014 PRINT"ùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùùù";
1015 PRINT"ððððððððððððððððððððððððððððððð";:PRINT@480+16,;:M$=STR$(B):GOSUB99
1020 PRINT@480,;:M$=STR$(SC):GOSUB99
1040 FORC=1TO3:X=2+RND(12)*2:Y=2+RND(6):R(C)=32*Y+X:PRINT@R(C),A$(5);:NEXT
1050 FORC=2TO4:X=2+RND(12)*2:Y=5+RND(8):X(C)=X:Y(C)=Y:PRINT@32*Y(C)+X(C),A$(C)A$(0)A$(0);:NEXT
1060 J=3
1090 RETURN
2000 A$(0)="€€":A$(1)="ÝÚ":A$(2)="‡":A$(3)="‡":A$(4)="æé":A$(5)="·»":A$(6)="––":A$(7)="““":A$(8)="ÃÃ":A$(9)="Ê€"
2010 B$(0)="€€":B$(1)="ßØ":B$(2)="‹Ž":B$(3)="‹Ž":B$(4)="æé":B$(5)="·»":B$(6)="™™":B$(7)="œœ":B$(8)="ÌÌ":B$(9)="Ê€"
2030 C$(0)="€€":C$(1)="ßß":C$(2)="  ":C$(3)="  ":C$(4)="ïï"
2040 RETURN
9998 DATA60,54,55,150,246,129,126,38,25,220,247,195,1,5,131,1,1,221,252,206,67,113,236,1
9999 DATA221,246,236,3,221,248,236,5,221,250,51,50,56,57,240,129,58,37,1,57,126
10000 FORC=0TO44:READL:POKE17227+C,L:NEXT:EXEC17227:RETURN
