0 GOTO90
1 POKEM+1535,31:IFI$="A"THENTX=-1:GOTO1112
2 IFI$="D"THENTX=1:GOTO1112
3 IFI$="W"THENTY=-1:GOTO1112
4 IFI$="S"THENTY=1:GOTO1112
5 IFI$="Q"THENNEXT:GOTO1112
6 IFI$="E"ANDHA>0ANDPS=0THENPS=1:GOTO1112
7 NEXT:GOTO1100

10 I$=INKEY$:?@505,"SHOOT ";:IFI$="A"THENTX=-1:GOTO1116
11 IFI$="D"THENTX=1:GOTO1116
12 IFI$="W"THENTY=-1:GOTO1116
13 IFI$="S"THENTY=1:GOTO1116
14 IFI$="E"THENPS=0:?@505," WALK ";:GOTO1116
15 GOTO1115

20 IFTP=143ANDRND(2)=1THEN?@TT,CHR$(159);:SOUND90,3:T1=4:NEXT:GOTO1118
21 IFTP=176THENT1=4:NEXT:GOTO1118
22 NEXT:GOTO1118

30 I$=" ":?@505,"      ";:POKEM+1535,30:IFRND(2)=1THEN38
31 IFRND(2)=1THEN35
32 TX=0:TY=0:GOTO1121
35 IFPY(0)<PY(T)THENTY=-1:GOTO1121
36 TY=1:GOTO1121
38 IFPX(0)<PX(T)THENTX=-1:GOTO1121
39 TX=1:GOTO1121

40 I$=" ":?@505,"      ";:POKEM+1535,30:IFRND(2)=1THENTX=RND(3)-2:GOTO1123
41 TY=RND(3)-2:GOTO1123

50 FORT1=-1TO1:FORT2=-1TO1:IFPEEK(M+(PX(T)+TX+T1+(PY(T)+TY+T2)*32)+1024)=208THEN55
51 NEXT:NEXT:GOTO1142
55 PF$=P$(RND(8)-1):PRINT@PX(T)+TX+T1+(PY(T)+TY+T2)*32,PF$;:NEXT:NEXT:GOTO1142

60 IFHK>0THENHK=HK-1:PRINT@PX(T)+TX+(PY(T)+TY)*32,CHR$(207);:TX=0:TY=0:NEXT:GOTO1144
61 IFRND(2)=1THENHK=1:GOTO1140
62 GOTO1144

90 DIM B$(11):M=15360
91 B$(0)="¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯":B$(1)="¯¯¯¯¯°°¯¯°°¯¯¯¯¯":B$(2)="°°°¯°ÐÈ¯°°°¯¯¯¯¯"
92 B$(3)="°°°°°ÐÐ°°°È°¯¯¯¯":B$(4)="¯°°°¯ÈÐ°¯°Ð°¯°°°":B$(5)="©©©©ÀÀÀÀÀÀÀÀ©©©©"
93 B$(6)="©ÀÀ©ÀÀÀ©ÀÀÀ©©©©©":B$(7)="©©©©ÀÀÀ©ÀÀÀ©©ÀÀ©":B$(8)="©ÀÀ©©ÀÀ©©ÀÀ©©ÀÀ©"
94 B$(9)="©©©©©ÀÀÀ©ÀÀÀ©ÀÀ©":B$(10)="©ÀÀ©©ÀÀÀ©ÀÀÀ©©©©"

100 DIMPX(20),PY(20),PB(20),PF(20),P$(7):LV=1:HP=1:HS=15.9:HA=5:HK=5:HF=20.75
142 CB=192:PS=0

152 P$(0)=CHR$(207):P$(1)="s":P$(2)="a":P$(3)="k":P$(4)="f":P$(5)=CHR$(207):P$(6)=CHR$(207):P$(7)=CHR$(207)
154 FOR T=1 TO 20:PF(T)=0:PB(T)=0:NEXT
155 PF$=""
160 BP=0
165 T=0 
170 TP=0
172 TT=0
175 TX=0
180 TY=0
181 T1=0
182 T2=0
185 BT=5
187 N=20
188 GT=0
189 BO=0

200 REM---GENERATE CITY BULDINGS
210 CLS3:FORT=0TO31
220 BT=RND(5)-1:FORTP=0TO3:IFT=31ANDTP=3THENNEXT:GOTO230
221 PRINT@BP+TP*32,MID$(B$(BT),TP*4+1,4);:NEXT
230 BP=BP+4:IFBP=32ORBP=160ORBP=288THENBP=BP+96
240 NEXT

300 REM---GENERATE ROAD
300 T=0:BT=5:BP=RND(4)-1:PX(0)=1:PY(0)=BP*4:BP=BP*128

310 IFBP=412ORBP=284ORBP=156ORBP=28THENBT=5
320 FORTP=0TO3
330 IFBP=412ANDTP=3THEN340
331 PRINT@BP+TP*32,MID$(B$(BT),TP*4+1,4);
340 NEXT
350 IFBP=412ORBP=284ORBP=156ORBP=28THENPY(0)=PY(0)+RND(2):PB(0)=176:GOTO1000
400 IF T=0 THEN BP=BP+4:T=1
410 IFT=2THEN415
411 GOTO420
415 BP=BP-128:IFRND(2)=1ANDBP>31THENBT=8:GOTO420
416 T=0:BT=9
420 IFT=3THEN425
421 GOTO430
425 BP=BP+128:IFRND(2)=1ANDBP<384THENBT=8:GOTO430
426 T=0:BT=10
430 IFT=1THEN435
431 GOTO450
435 IFRND(3)=1THENIFBP>31THENT=2:BT=6:GOTO450
436 IFRND(3)=1THENIFBP<384THENT=3:BT=7:GOTO450
437 T=0:BT=5
450 GOTO310

1000 REM---TEST START POSITIONS PRE DRAW STUFF
1001 IF LV=1 THEN PF(0)=255
1002 PRINT@PX(0)+PY(0)*32,CHR$(PF(0));
1003 FORT=1TO10:PX(T)=RND(32)-1:PY(T)=RND(15)-1:PB(T)=175:PF(T)=143:IFPEEK(M+1024+PX(T)+PY(T)*32)=175THENNEXT:GOTO1005
1004 T=T-1:NEXT
1005 FORT=1TO10:IFT<LVTHENPF(T)=143:NEXT:GOTO1007
1006 PF(T)=191:NEXT
1007 FORT=1TO10:PRINT@PX(T)+PY(T)*32,CHR$(PF(T));:NEXT
1008 PB(0)=192:IF LV=1 THEN PRINT@PX(0)+2+PY(0)*32,CHR$(235);

1010 REM---MAIN LOOP
1012 PRINT@480,"                               ";:?@505," WALK ";:POKEM+1535,31
1013 IFHP<10THEN?@482,HP;:?@480,"P:0";:GOTO1015
1014 PRINT@481,HP;:?@480,"P:";
1015 IFHS<10THEN?@487,INT(HS);:?@485,"S:0";:GOTO1017
1016 ?@486,INT(HS);:?@485,"S:";
1017 IFHA<10THEN?@492,HA;:?@490,"A:0";:GOTO1020
1018 ?@491,HA;:?@490,"A:";
1020 IFHK<10THEN?@497,HK;:?@495,"K:0";:GOTO1030
1021 ?@496,HK;:?@495,"K:";
1030 IFHF<10THEN?@502,INT(HF);:?@500,"F:0";:GOTO1040
1031 ?@501,INT(HF);:?@500,"F:";

1040 HS=HS-.1:IFHS<1THENHS=0:?@505," WEAK ";:GOTO1045
1041 ?@505," WALK ";
1045 IFPS>1THENIFHF<1THENHF=0:PS=0:CB=PB(0):PB(0)=235:PF(0)=255:PRINT@PX(0)+PY(0)*32,CHR$(255);
1050 IFPS>1THEN?@505,"DRIVE ";

1060 GT=GT+1:IFGT=1THEN1065
1061 GOTO1070
1065 FORT1=1TO20:IFPF(T1)=0THENBO=T1:T1=20:NEXT:GOTO1070
1066 NEXT:GT=0
1070 IFGT=1THEN1072
1071 GOTO1075
1072 PX(BO)=0:PY(BO)=RND(16)-1:IFPEEK(M+(PX(BO)+PY(BO)*32)+1024)<>175THENGT=0:GOTO1075
1073 GT=0:PF(BO)=143:PRINT@(PX(BO)+PY(BO)*32),CHR$(PF(BO));:PB(BO)=175
1075 IFHP=0THENPRINT@480,"ENOUGH! THIS IS THE END. AGAIN?";:GOTO5100

REM---LOOP ACTORS
1080 FORT=0TON:IFPEEK(M+(PX(T)+PY(T)*32)+1024)=159THENIFPF(T)=143THENPF(T)=00:PRINT@PX(T)+PY(T)*32,CHR$(PB(T));
1090 IFT=1THEN1095
1091 GOTO1100
1095 IFPS=2THENPS=3:T=T-1:GOTO1100
1096 IFPS=3THENHF=HF-.25:PS=2:IFHF<1THENHF=0

REM---CONTROL
1100 TX=0:TY=0
REM PLAYER
REM SAIDA DO CARRO
1110 IFT=0THENI$=INKEY$:IFPS>1THENIFI$="E"THENPS=0:CB=PB(0):PB(0)=235:PF(0)=255:PRINT@PX(0)+PY(0)*32,CHR$(255);:NEXT

1111 IFT=0ANDPS<>1THEN1

1112 IFPX(0)=31ANDPB(0)=192THEN5000
1114 IFT=0ANDPS=0THENIFHS=0THENIFRND(4)=1THENSOUND1,2:TX=0:TY=0:NEXT

1115 IFPS=1THEN10
1116 IFPS=1THENFORT1=1TO4:TT=PX(0)+T1*TX+(PY(0)+T1*TY)*32:TP=PEEK(M+TT+1024):SOUND1,1
1117 IFPS=1THEN20
1118 IFPS=1THENTX=0:TY=0:PS=0:?@505," WALK ";:HA=HA-1:NEXT

REM ZOMBIE
1120 IFPF(T)=143THEN30

REM HUMANS
1121 IFPF(T)=191THEN40
1123 IFPEEK(M+(PX(T)+PY(T)*32)+1024)=239THENPF(T)=0:PRINT@PX(T)+PY(T)*32,CHR$(PB(T));
1124 IFPF(T)=191ANDPEEK(M+(PX(T)+PY(T)*32)+1024)=159THENPF(T)=143:PRINT@PX(T)+PY(T)*32,CHR$(PF(T));

1125 REM IF PF(T)=143 AND PEEK(M+(PX(T)+PY(T)*32)+1024)=159 THEN PF(T)=00:PRINT@PX(T)+PY(T)*32,CHR$(PB(T));

1127 IFPX(T)+TX<0ORPX(T)+TX>31THENTX=0
1128 IFPY(T)+TY<0ORPY(T)+TY>14THENTY=0

1130 TP=PEEK(M+(PX(T)+TX+(PY(T)+TY)*32)+1024)
1132 IFTP=191THENIFT=0THENHP=HP+1:PRINT@PX(0)+TX+(PY(0)+TY)*32,CHR$(239);:TX=0:TY=0:NEXT
1134 IFTP=255THENIFPF(T)=143 THEN HP=HP-1:?@PX(0)+PY(0)*32,CHR$(239);:SOUND1,1:PRINT@PX(0)+PY(0)*32,CHR$(PF(0));
1136 IFTP=191THENIFPF(T)=143 THEN PRINT@PX(T)+TX+(PY(T)+TY)*32,CHR$(159);:TX=0:TY=0

1138 IFT=0THENIFTP=235THENPRINT@PX(T)+TX+(PY(T)+TY)*32,CHR$(CB);:PS=3:PF(0)=235:TP=192

1140 IFT=0ANDTP=200ANDHK>0THEN50

1142 IFT=0ANDTP=200THEN60

1144 IFT<>0THEN1200
1145 IFTP=19THENHS=HS+5:PRINT@PX(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1146 IFTP=1THENHA=HA+5:PRINT@PX(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1147 IFTP=11THENHK=HK+5:PRINT@PX(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1148 IFTP=6THENHF=HF+5:PRINT@PX(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1150 IFPS>1THENIFTP=143THENPRINT@PX(T)+TX+(PY(T)+TY)*32,CHR$(159);:HF=HF-5:NEXT
1155 IFT=0ANDPS>1THENIFTP<>192THENTX=0:TY=0:GOTO1100

REM WALK
1200 IFTP=192ORTP=169ORTP=175ORTP=207THEN1250
1201 IFT=0THEN1100
1203 NEXT:GOTO1010
1250 ?@PX(T)+PY(T)*32,CHR$(PB(T));:PX(T)=PX(T)+TX:PY(T)=PY(T)+TY:PB(T)=PEEK(M+(PX(T)+PY(T)*32)+1024):
1251 ?@PX(T)+PY(T)*32,CHR$(PF(T));:NEXT
1260 GOTO1010

5000 IFLV=10THENPRINT@480,"YOU HAVE ESCAPED!              ";:GOTO1076
5010 LV=LV+1:GOTO152
5100 M$=INKEY$
5110 IFM$="Y"THENRUN
5120 IFM$="N"THENEND
5130 GOTO5100
