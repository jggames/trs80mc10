100 REN EPIDEllIC : ANDY GMlBLE , AUG 80
11 0 !f:! CO U~lBIA COLLEGE ,1 61 9 1'71 0 AVE ~
~ VANCOUVER BC V6 J 2A2
120 I=RND(-RND(0» :POKE59468,12
13 0 POKE59458,62:REM SPEED POKE
140 T$= "MHttttHHttttHHHtt "
1 50 QP=5 1 5:QA=126 :IFPEEK(50000)THENQP=15
~1: QA 44
16 0 I G=1 60 : VI= 215 : CO=209 :GI=17 0
170 GOT0 136 0
180 PRINTCHR$(147) "HOW MANY I SLANDERS ~
«= 00)? ";: GOSUB 720 NP L(Z $)
1 90 IFNP=0THEN180
200 IFNP>100THENPRINT" TT"; :GOT0 1 80
210 PRINT"tHOI'l MANY INFECTED AT ~
START?" ;: GOSUB 1720: I=VAL Zl$)
22 0 IFNI=0THENPRINT"TT ";:GOT02 1 0
230 IFNI >NPTHENPRINT " TT ";: GOT021 0
240 PRINT"tCONTAGION TIl1E (DAYS) ? " ;:
GOSUB 720 :C T=VAL(Z $)
250 I FCT=0 THENPRINT " TT ";: GOT0240
26 0 RESTORE
270 PRINTCHR$( 1 47) :FORI=lT018:READIL,IR
280 FORJ=ILTOIR:POKEJ,IG:NEXT:NEXT
290 PRINT "hilli' =UN I NFECTED .r..Qr=CONTAGIOU
... S J:,* r= I Mr,tuNE Ii
300 PRI NT "MttHtHttHtttHHCONTAG ION"
310 PRI NT "MttttttttHtttttttHTIME "CT ;
320 IFCT>lTHENPRINT " DAYS":GOT0 340
330 PRINT " DAY"
340 RE~l GARBAGE COLLECTION FOR ARRAYS
350 POKEQA+2 , PEEK(QA) :POKEQA+3, PE EK(QA+1
) :Z9=FRE(O)
360 DH!PP(NP) , PG(NP) ,DC(NP) , NI (5 0) ,
IM(50)
370 FORI=l TONP : PG(I)=VI:NEXT
380 FORI= l TONI:PG ( I)=CO:NEXT
390 FORI=lTONP:DC ( I) =0:NEXT
400 FORI=lTONI:DC(I) =CT:NEXT
410 FORI =l TONP
420 PP(I)=INT(690*RND(1)+32901):
~IF PEEK(PP(I» >IGTHEN420
430 POKEPP(I),PG(I) :NEXT
440 ND=0
450 IM=0:PRINT"ht"TAB(7)NP-NI-IM;TAB(20)
NI;TAB(30) 1M
460 PRINT "hHtDAY " ;ND
470 ND=ND+ l: NI=0:IM=0
480 FORI=lTONP
490 REM NEW CONTAGIOUS FRm'l LAST TIf1E
500IF(PEEK(PP(I»=CO)AND(PG(I)=VI)THEND C (I) =CT
510 PG(I)=PEEK(PP(I»
520 ONINT(9*RND(1)+1)GOSUB900 , 910,920 ,
930,940,950,960,970,980
530 REM INFECTING?
540 IFPG(I)=COTHENGOSUB1060
550 REC,l INFECTED?
560 IFPG{I)=VITHENGOSUBl16 0
570 REM ONE DAY LESS
580 IFPG(I) =COTHENDC(I)=DC(I) -l
590 REM END CONTAG ION
600 IFDC(I) <0THENPG(I)=GI:POKEPP(I) , GI
610 IFPEEK(PP(I»=COTH ENNI=NI+l
620 IFPEEK(PP(I»=GITHENIM=IM+l
630 NEXT
640 IFND<=50THENNI(ND)=NI:IM(ND)=IM
650 PRINT "ht "TAB(7)NP-NI-IM"4 " ;TAB(20)
...,NI"~ .. ;TAB(30) n1 ~ "
660 IFNI >0THEN460
670 PRINTT$;:GOSUB1250
680 PRINTCHR$(147) "DAY"TAB(5) " INFECTION "
~: PRINT
690 FORND=lT050
700 FORI'lT=lT0150 :NEXT
710 PRINTND;TAB(4) ;
720 PRINTNP- NI(ND) -IM(ND) ;NI(ND) ;IM(ND):
~PR INT
730 IFNP-NI(ND)-IM(ND)=0THEN750
740 FORI=l TONP-NI (ND) - 1M (ND) : PRINT".r.J:l" ; :
~N EXT
750 IFNI(ND)=0THEN770
760 FORI=lTONI(ND) :PRINT"LQ";:NEXT
770 IFIM(ND)=0THEN790
780 FORI=lTOIM(ND) :PRINT"X*";:NEXT
790 PRINT
800 IFNI (ND)=0THEN820
810 PRINT:NEXTND
820 PRINT"tLIKE TO SEE THE CHART AGAIN ~
(Y/N)?" ;:G OSUB 1720:Q =Zl $
830 IFQ$=""THENPRINT"11"; :GOT0820
840 I FLEFT$(Q$ ,1)=" Y"THEN680
850 PRINTCHR$(147)LEFT$(T$,10) "WANT ~
ANOTHER TRY (YIN)?";: GOSUB1720:
Q$ $
860 IFQ $= ""THEN8 50
870 IFLEFT$(Q$ ,1 ) ="Y"THEN1 80
880 END
890 RE~l MOVE siR's
900 MV=39:GOSUB1000:RETURN
91 0 MV=4 0:GOSUB1000:RETURN
920 MV=41:GOSUB1000:RETURN
930 MV=-1:GOSUB1000:RETURN
940 MV=0 :GOSUB1000 :RETURN
950 MV=1:GOSUB1000:RETURN
960 MV=-41:GOSUB1000:RETURN
970 MV=-40:GOSUB1000:RETURN
980 MV=-39:GOSUB1000:RETURN
990 REM l1AKE MOVE
10 00 I FPEEK(PP(I)+MV)<>IGTHENRETURN
1 01 0 PG(I)=PEEK(PP(I»
1020 POKEPP(I),IG
1030 PP(I) =PP (I) +MV
10 40 POKEPP(I) , PG(I) :RETURN
10 50 REM INFECTING OTHERS
May, 1981, Issue 12.
1060 IFPEEK(PP(I)-41)=VITHENPOKEPP(I) - 41
..."CO
1 070 IFPEEK(PP(I)-40)=VITHENPOKEPP(I)-40
..."CO
1 080 IFPEEK(PP(I)-39)=VITHENPOKEPP ( I)-39
..."CO
1090 IFPEEK(PP(I)- l)=VITHENPOKEPP (I)- ~
...,1,CO
1100 IFPEEK(PP(I)+ l)=VITHENPOKEPP(I)+ ~
...,l, CO
11 1 0 IFPEEK(PP(I)+39)=V I THENPOK EPP(I)+39
..." CO
11 20 IFPEEK(PP(I)+40)=VITHENPOKEPP (I)+40
. , CO
11 30 IFPEEK(PP(I)+41)=VITHENPOK EPP(I)+41
..." CO
11 40 RETURN
1150 RE~l I NFECTION FRm1 OTHERS
1160 IFPEEK(PP(I)-41)=COTHENPOKEP P(I),CO
1170 IFPEEK(PP(I)-40)=COTHENPOKEP P(I),CO
1180 IFPEEK(PP(I) - 39)=COTHENPOKEP P(I) , CO
1190 IFPEEK(PP(I)- l)=COTHENPOK EP P(I) , CO
1200 I FPEEK(PP(I)+ l)=COTHENPOKEP P(I) , CO
1 210 IFPEEK(PP(I)+39)=COTHENPOKEPP(I) , CO
1 220 IFPEEK(PP(I)+40)=COTHENPOKEPP(I) , CO
1 230 IFPEEK(PP(I)+41)=COTHENPOKEPP (I) , CO
1 240 RETURN
1 250 PRINT" XPRESS ANY KEY TO ~
-,CONTINUEII
1260 GETQ$:IFQ$= ""THEN1260
1270 RETURN
1280 REM********VARIABLES***** *********
1 290 REM NP=# OF PEOPLE , NI=' I NF ECTED ~
~ HI= # OF IMHUNE
13 00 REC1 CT=DAYS FOR CONTAGIOUS,
~IG= ISLANDGRAPHIC ,
~PP=POS OF PEOPLE
1310 REM ND=# OF DAYS,VI=NOTYETINFECTED
1320 REH CO=CONTAGIOUS , PG=PEOPLEGRAPHIC
13 3 0 REC1 G I=GRAPH IC HlC1UNE, HV=I·IOVE,
~D = DAYS OF CONTAGION ~
~L EFT
1 340 REM***************************** **
13 50 REM TITLES
1 360 PRI NT "fi":FORI=32768T032807:
~P OKE I,22 :POKE I+960, 224:N XT
1370 FORI=32 808T033688STEP40:POKEI , 224 :
~POKEI+39,224:NEXT
13 80 PRI NT"hHH "
1390 PRINTTAB(9) " QJl ~ 1.
14 00 PRINTTAB(9) " L$::::::MNLLLLNM
1410 PRINT"MtHHtHt"TAB(14) "xEPIDEHIC
1420 PR I NT"MtttHHtHv"TAB(25) "ANDY ~
.,GAMBLE II
1 430 PR I NTLEFT$(T$,20)TAB(5);"DO YOU ~
NEED INSTRUCT I ONS (yiN)?";:
GOSUB 720 Q$=Z $
14 40 IFQ$=""THEN1430
1 450 IFLEFT$(Q$,1)< >"Y"THEN1 8 0
1 460 REM INSTRUCTIONS
1 470 PRINTCHR$( 14 7) "AN EPIDEMIC HAS ~
~BROKEN OUT ON A SMALL "
1480 PRINT "I SLAND. THE DISEASE I S NOT ~
...,FATAL, AND "
1490 PRINT"ONCE CONTRACTED PROVIDES ~
~IMMUNITY FOR LIFE."
1500 PRINT : PRINT " YOU ARE ALLO\'IED TO ~
CHOOSE CERTAIN "
1510 PRINT"INITIAL CONDITIONS: ": PRINT:
~PRINT:PRINTTAB(5)"THE ISLAND ~
~POPULATION"
1520 PRINT:PRINTTAB(5) "THE NUMBER ~
~ORIGINALLY INFECTED"
1530 PRINT:PRINTTAB(5) "THE NUlmER OF ~
..,OAYS FOR v1HICH THE "
1540 PRINTTAB(5) "DI SEASE IS CONTAGIOUS ~
-,- THIS ISII
1550 PRINTTAB(5) "ALSO THE DURATION OF ~
~THE DISEASE."
1560 PRINT : PRINT :PRINT "THE ISLANDERS ~
~llILL MOVE ABOUT RANDOMLY ,"
1570 PRINT"INFECTING OTHERS IF CONTAGIOU
..,5. n ;
1580 PRINT "THOSE ~IHOARE HIMUNE IHLL NOT ~
~B E INFECTED. "
1590 PRINT: GOSUB1 250
1600 PRINTCHR$(147) "THIS WILL CONTINUE ~
UNTIL THE DISEASE HAS RUN ITS ~
..,COURSE 11;
1610 PRINT" (UNTIL THERE ARE NO I'IORE ~
~INFECTED PERSONS). "
1620 PRINT:PRINT"YOU ~IILL THEN BE GIVEN ~
~A DAY-BY-DAY BAR CHART OF THE ";
1630 PRINT "IHSTORY OF THE EPIDE~lIC, "
1640 PRINT "UP TO A ~IAXn1U~1 OF 50 DAYS ."
1650 PRINT:GOSUB1250
1 660 GOT0180
1670 DATA32902 , 32911, 32940 , 32955
1680 DATA32978 , 32996 , 33015,33040,33050 ,
33083 33090 33123 33130 33162
1690 DATA33171 , 33203 , 33213 , 33244 , 33254,
~33285 ,3 3297 33325
1700 DATA33337 , 33362 ,33376 , 33398 , 3341 7 ,
33437,33459,33475 33501 33515
1710 DATA33544 , 33556 , 33585 , 33592
1720 Z$="":Zl$= "n
1730 PRINT"£",, ";: FORI=lT050: NEXTI
1740 PRINT" ",," ;: FORI=lT050 : NEXTI
1750 GETZ$:IFZ$= ""THEN1730
1760 IFZ$ <>CHR$(20)THEN18 1 0
1770 IFZ$=""THEN1730
1780 ZZ=LEN(Zl$) :IFZZ <lTHEN1730
1790 Zl$=LEFT$(Zl $ , ZZ - l) :PRINT"",,";
1800 GOT01 730
1810 IFZ$=CHR$(13)ORZ$=CHR$(141)THEN1850
1820 PRINTZ$;
1830 Zl$=Zl $+Z$
1840 GOT01730
1850 FORI=l T01 0 : GETZ$ : NEXTI
1860 PRI NT
1870 RETURN
