   1 REM "SCHATZOEKEN" OR TREASURE SEARCH
   5 DIM D(3,2)
   7 DIM T(20)
   8 Z$=" YOU ARE IN THE ENTRANCE HALL"
  10 LR=0:C$="ÙÙÙÙÙÙÙÙÙÙÙÙ"+CHR$(143)+CHR$(143)+CHR$(143)+CHR$(143)+"ÙÙÙÙÙÙÙÙÙÙÙÙÙÙ"
  20 AR=5
  25 FOR I=1 TO 20
  30 T(I)=1
  35 NEXT I
  37 PS=0
  40 S=0
  60 TR=0
  65 C1=RND(-(PEEK(9)*256+PEEK(10))) 
  70 B$="9BE9AF9DG9CHAHIBIJCJKDEKEFLFGMGHNIOQJOPKPTLMRMNSLRTOQUPTUNQS9RS"
  80 R1=0
  82 R2=0
  84 R3=0
  95 GOTO 1300
 150 CLS 
 160 REM CAVES PLOT
 165 FOR I=0 TO 14
 170 IY=INT(RND(0)*12+2)
 175 IX=INT(RND(0)*27+2)
 180 PRINT@32*IY+IX,"€";
 185 IF RND(0)>.5 THEN PRINT@32*(IY-1)+IX-1,MID$("€ˆ",RND(2),1);
 190 PRINT@32*IY+IX+1,"ˆ";
 195 PRINT@32*(IY+1)+IX,MID$("€ˆ",RND(2),1);
 200 IF RND(0)>.6 THEN PRINT@32*(IY+1)+IX+1,"„";
 205 PRINT@32*I,"Ù";:PRINT@32*I+31,"Ù";
 210 NEXT I
 212 POKE16384+480,217:POKE16895,217:PRINT@1,C$;:PRINT@32*15+1,LEFT$(C$,31);
 214 PRINT@17,STR$(R1);:PRINT@32*15+17,STR$(R2);
 215 N=11
216 GOTO 216
 220 M=1
 222 IF T(PR)=1 THEN PRINT AT IY,IX+1;"*";
 224 T(PR)=0
 225 REM MONSTER PLOT
 230 DEM=INT (RND*4)
 235 FOR I=1 TO DEM
 240 D(I,1)=INT (RND*19+1)
 245 D(I,2)=INT (RND*30+1)
 250 PRINT AT D(I,1),D(I,2);"M";
 255 NEXT I
 265 REM HERO MOVEMENT
 275 PRINT AT N,M;"X";
 280 IF INKEY$<>"F" THEN 300
 285 IF AR=0 THEN 300
 290 AR=AR-1
 295 GOSUB 1000
 298 PRINT AT 21,0;"ARROWS: ";AR;
 300 N1=N
 305 M1=M
 310 M=M+(1 AND INKEY$="8")-(1 AND INKEY$="5")
 315 N=N+(1 AND INKEY$="6")-(1 AND INKEY$="7")
 320 Q1=PEEK (Q+33*N+M)
 325 IF Q1>62 THEN GOTO 2000
 330 IF Q1=23 AND TR<50 THEN TR=TR+10
 335 IF Q1=8 THEN GOTO 800
 338 IF ABS(10-N)=10 THEN GOTO 2000
 339 IF PR=21 THEN GOTO 355
 340 IF DEM=0 AND RND<.03 THEN DEM=1
 342 IF RND<.3+TR/200 THEN GOSUB 1200
 345 PRINT AT N1,M1;" ";
 350 GOTO 265
 355 GOSUB 3000
 360 GOTO 345
 800 REM ROOM CHANGEOVER 
 805 CLS
 810 LR=PR
 812 IF PR<>21 THEN 815
 813 PR=INT (RND*19+1)
 814 GOTO 825
 815 IF N=0 THEN PR=R1
 820 IF N=20 THEN PR=R1
 822 IF PR=0 THEN GOTO 1505
 825 PRINT AT 3,2;"YOU ARE IN THE TUNNEL"
 830 PRINT AT 5,2;"BETWEEN";LR;"AND";PR
 835 PRINT AT 8,2;"YOU HAVE ";AR;"ARROWS";
 840 PRINT AT 11,2;"YOUR SCORE IS";TR+S
 915 IF PR=21 THEN 2050
 920 R$=B$(PR*3-2)
 925 R1=CODE (R$)-37
 930 R$=B$(PR*3-1)
 935 R2=CODE (R$)-37
 940 R$=B$(PR*3)
 945 R3=CODE (R$)-37
 960 IF R1=LR THEN R1=R3
 965 IF R2=LR THEN R2=R3
 970 GOTO 150
1000 REM FIRE
1003 IF PR=21 THEN GOSUB 3000
1005 IF RND<.5 THEN GOSUB 1200
1010 F$=INKEY$
1015 IF F$="" OR F$="F" THEN GOTO 1000
1020 Y1=N
1025 X1=M
1030 MY=0+(1 AND F$="6")-(1 AND F$="7")
1035 MX=0+(1 AND F$="8")-(1 AND F$="5")
1040 X1=X1+MX
1045 Y1=Y1+MY
1050 IF ABS (15-X1)=15 OR ABS (10-Y1)=10 THEN GOTO 1125
1053 IF PEEK (Q+33*Y1+X1)<>0 THEN GOTO 1070
1055 PRINT AT Y1,X1;"+";
1060 PRINT AT Y1,X1;" ";
1065 GOTO 1040
1070 DH=DEM
1075 FOR I=1 TO DH
1080 Y=D(I,1)
1085 X=D(I,2)
1090 IF X<>X1 OR Y<>Y1 THEN GOTO 1115
1095 PRINT AT Y1,X1;"+";
1098 S=S+5
1100 D(I,1)=D(DEM,1)
1105 D(I,2)=D(DEM,2)
1110 DEM=DEM-1
1115 NEXT I
1117 IF PR=21 THEN FX=X1
1118 IF PR=21 THEN FY=Y1
1120 PRINT AT Y1,X1;" ";
1125 RETURN 
1200 REM MONSTER FLEES
1201 FOR I=1 TO DEM
1205 X=D(I,2)
1210 Y=D(I,1)
1215 PRINT AT Y,X;" ";
1220 Y=Y+SGN(N-Y)
1225 X=X+SGN(M-X)
1235 PRINT AT Y,X;"M";
1238 IF X=M AND Y=N THEN GOTO 2000
1240 D(I,1)=Y
1245 D(I,2)=X
1250 NEXT I
1255 RETURN 
1295 REM START
1297 CLS 
1300 PRINT "WELCOME TO THE TREASURE CAVES"
1301 PRINT 
1305 PRINT "YOU ARE IN A NETWORK OF CAVES."
1310 PRINT "YOU ARE LOOKING FOR GOLD."
1315 PRINT "IF YOU ARE CAREFUL ENOUGH"
1320 PRINT "YOU CAN REACH THE TREASURE"
1322 PRINT "BUT WATCH OUT."
1325 PRINT "THERE ARE MONSTERS WHO WANT TO"
1330 PRINT "EAT YOU. HITTING THE WALLS"
1335 PRINT "ALSO MEANS INSTANT DEATH."
1340 PRINT "YOU ARE IN THE ENTRANCE HALL"
1341 PRINT
1342 PRINT "CHOOSE CAVE 1,2,3 OF 4";
1345 INPUT PR
1350 IF PR<1 OR PR>4 THEN 1345
1360 LR=0
1500 GOTO 915
1505 PRINT "YOU ARE IN THE ENTRANCE HALL"
1510 PRINT "YOUR TREASURE IS SAFE HERE"
1511 PRINT 
1515 PRINT "YOUR SCORE IS ";S+TR;" POINTS",,
1518 PRINT "YOU HAVE ";AR; "ARROWS.",
1520 PRINT "ARE YOU GOING IN AGAIN"
1525 INPUT F$
1530 IF F$(1)="N" THEN PRINT "YOU SCORED";S+TR;"POINTS"
1532 IF F$(1)="N" THEN PRINT "CHIKEN"
1535 IF F$(1)="N" THEN END
1540 S=S+TR
1545 TR=0
1550 PRINT "HOW MANY ARROWS DO YOU WANT?",,,
1560 PRINT "THEY COST 4 POINTS EACH",,,
1570 INPUT F
1580 IF F*4>S THEN 1650
1590 S=S-F*4
1600 AR=AR+F
1610 GOTO 1342
1650 CLS 
1655 PRINT "  YOU CANNOT AFFORD THEM",,,
1660 GOTO 1550
2000 REM DEATH OF A HERO
2005 CLS 
2010 PRINT AT 5,1;"UNFORTUNATELY YOU'RE DEAD"
2015 PRINT AT 8,1;"YOU SCORED:";S+TR;"POINTS"
2020 IF S+TR<50+PS THEN GOTO 3500
2025 S=S-15
2028 PS=S+TR
2029 PRINT "YOU PLAYED WELL:"
2030 PRINT "I WILL DEDUCT 15 POINTS"
2031 PRINT 
2032 PRINT "FOR DAMAGE TO YOUR BODY"
2033 PRINT 
2034 PRINT 
2035 PRINT "YOU MAY CONTINUE";
2036 FOR I=1 TO 50
2037 NEXT I
2038 CLS 
2040 GOTO 1505
2045 REM TREASURE
2050 PRINT AT 0,0;
2052 CLS 
2055 FOR I=-10 TO 10
2058 AI=ABS I
2060 PRINT TAB 0;C$( TO AI);
2065 PRINT TAB (30-AI);C$( TO A1)
2070 NEXT I
2075 PRINT AT 0,10;C$( TO 10)
2080 PRINT AT 20,10;C$( TO 10)
2085 PRINT AT 10,0;"Ù";TAB 29;"€"
2086 DEM=1
2087 QW=INT (RND*4)
2090 FOR I=1 TO QW+1
2095 PRINT AT 12+I,12+(RND*2);"***";
2100 NEXT I
2105 N=10
2106 MY=-1
2107 MX=0
2108 K=18
2109 J=7
2110 M=2
2111 FX=J
2112 FY=K
2115 GOTO 265
2999 REM VAL
3000 IF PEEK (Q+33*(K+MY)+J+MX)=0 THEN GOTO 3015
3002 AD=MY
3005 IF AD=0 THEN MY=MX
3006 IF AD=0 THEN MX=0
3007 IF AD<>0 THEN MY=0
3008 IF AD<>0 THEN MX=0-AD
3015 J=J+MX
3020 K=K+MY
3025 PRINT AT K,J;"{Y}";
3030 IF RND>.5 THEN PRINT AT FY,FX;"{Y}"
3032 IF RND<.25 THEN GOSUB 1200
3035 RETURN 
3500 REM SECOND CHANCE
3502 FOR I=1 TO 50
3503 NEXT I
3505 CLS 
3510 PRINT "WANT TO PLAY AGAIN?(Y/N)"
3515 INPUT Z$
3520 IF Z$="N" THEN 9990 
3525 IF Z$="Y" THEN 1297
3530 IF Z$="" THEN 3510
9990 END
