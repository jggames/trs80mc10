0 CLEAR500:DIMC1,C2,MC,M$:MC=16384:GOTO4000
1 C2=1:C1=32:FORC1=C1TOC2STEP-1:I$=MID$(M$,C1,1):IFI$<"!"THEN?MID$(M$,C2,C1-C2):C2=C1+1:C1=C2+32:IFI$=""THENC1=.
2 C1=C1+(C1>255)*(C1-255):NEXT:M$="":RETURN
3 FORI=MC+384TO16895:POKEI,32:NEXT:RETURN
5 M$=INKEY$:IFM$=""THEN5
6 RETURN
7 C1=(PEEK(17024)AND1)*256+PEEK(17025)-1+MC:FORC2=1TOLEN(M$):POKEC1+C2,ASC(MID$(M$,C2))AND63:NEXT:?@C1-MC+C2,;:RETURN
8 I$="":C2=(PEEK(17024)AND1)*256+PEEK(17025)+MC:POKEC2,96:C1=C2-M
9 GOSUB5:IFM$=CHR$(13)THENPOKEC2,32:RETURN
10 IFM$=CHR$(8)THENIFI$<>""THENI$=LEFT$(I$,LEN(I$)-1):POKEC2,32:C2=C2-1:POKEC2,96
11 IFM$<" "ORM$>"^"ORC2>MC+510THEN9
12 POKEC2,ASC(M$)AND63:C2=C2+1:POKEC2,96:I$=I$+M$:GOTO9
20 CLS0
30 IFDU<>1THEN7000
60 CLS0:PRINT@18,"IT'S NIGHT";
70 GOSUB3
80 PRINT@384,;:M$=A$+"? ":GOSUB7:A$="":GOSUB8:E$=I$:IFLEN(E$)=1THEN1300
90 FORI=1TOLEN(E$):IFMID$(E$,I,1)=" "THEN110
100 NEXT:A$="I DON'T UNDERSTAND":GOTO2000
110 O$=LEFT$(E$,I-1):V$=RIGHT$(E$,LEN(E$)-I)
120 V$=LEFT$(V$,4):O$=LEFT$(O$,4)
200 IFV$<>"EXAM" THEN410
201 IFDU=1THENA$="DARK":GOTO70
202 IFR<>1THEN260
210 IFO$="PICTURE"THEN26$="WELL, A BIT STRANGE"
220 IFO$="CARBON"ANDA(6)=0THENA$="OH, A KEY!":A(6)=1
230 IFO$="PRE"THEN26$="PRETTY COLORFUL"
240 IFO$="TABLE"ANDA(2)=0THENA$="THERE'S A PIECE OF PAPER":A(2)=1
250 IFO$="TRES"ANDA(27)=2THENA$="THERE'S A BOARD":A(7)=1:A(27)=3
260 IFR<>2THEN290
261 IFO$="REGA"ANDA(10)<2THENA$="CHISEL":A(10)=1
270 IFO$="REGA"ANDA(9)<2THENA$=A$+" & BLOOD PRESERVES":A(9)=1
280 IFO$="BODE"ANDA(14)<2THENA$="THERE'S A NOTE!":A(14)=1
285 IFO$="SARG"ANDA(13)<2THENA$="A CROSS":A(13)=1
290 IFR<>3THEN310
291 IFLEFT$(O$,2)="WC"ANDA(18)<2THENA$="HOOK":A(18)=1
300 IFO$="WASC"THENA$="'IN BLOOD LIES THE KEY'"
305 IFO$="VENT"ANDA(7)=4THEN6000
310 IFR<>4THEN350
311 IFO$="KUEH"ANDA(28)=1THENA$="LEG OF LAMB":A(20)=1
320 IFO$="KAST"ANDA(30)=1THENA$="OH, PIPES AND MATCHES":A(19)=1
330 IFO$="AUSG"ANDA(21)<2THENA$="A KNIFE":A(21)=1
340 IFO$="BANK"THENA$="NOTE: 'DRINK BLOOD'"
350 IFO$="BODE"ANDA(24)<2ANDR=5THENA$="A PIECE OF PAPER":A(24)=1
360 IFO$="BOX"ANDA(22)=1ANDR=5THENA$="PLIERS":A(26)=1
370 IFO$="HOEH"ANDA(29)=1ANDR=5THENA$="SCREWDRIVER":A(25)=1
380 IFO$="FENS"THENA$="IT'S RAINING"
390 IFO$="HAND"ANDA(16)=2THENA$="A MONOGRAM: G.D."
395 IFA$=""THENA$="NOTHING SPECIAL
396 GOTO2000
410 IFV$<>"NEHM"THEN700
411 IFR<>1THEN500
420 IFO$<>"IMAGE"ORA(1)<>0THEN450
421 PRINT@384,"NAILED!!!"
425 PRINT@416,;:M$="GET STARTED WITH WHAT? ":GOSUB7:GOSUB8:E$=I$
430 IFE$<>"PLIERS"ORA(26)<>2THEN1200
440 A$="AAH!! A SAFE!":A(27)=1:A(1)=1
450 IFO$<>"ZETT"ORA(2)<>1THEN460
455 A$="YOU'LL NEVER FIND THE STONES":A(2)=2
460 IFO$="CANDLE"ANDA(3)=1THENA$=OK$:A(3)=2
470 IFO$="SCHL"ANDA(6)=1THENA$=OK$:A(6)=2
480 IFO$="BRET"ANDA(7)=1THENA$=OK$:A(7)=2
490 IFO$="STAU"ANDA(8)=1THENA$=OK$:A(8)=2
495 GOTO2000
500 IFR<>2THEN610
501 IFO$="BLOOD"ANDA(9)=1THENA$=OK$:A(9)=2
510 IFO$="MEIS"ANDA(10)=1THENA$=OK$:A(10)=2
530 IFO$="ZETT"ANDA(14)=1THENA$="5873":A(14)=2:GOTO2000
540 IFO$<>"CROSS"ORA(13)<>1THEN2000
545 PRINT@384,;:M$="YOU FELL INTO THE COFFIN.":GOSUB7
550 PRINT@416,;:M$="THE DUST IS POISONOUS!":GOSUB7
555 PRINT@448,;:PRINT"HOW WILL YOU PROTECT YOURSELF?":PRINT@480,;:GOSUB7:GOSUB8:E$=I$
560 IFRIGHT$(E$,5)<>"TOWEL"ORA(16)<>2THEN600
570 PRINT@384,;:M$="THE COFFIN IS CLOSED. THERE":GOSUB7:PRINT@416,;:M$="ARE 4 SCREWS. HOW WILL YOU FREE":GOSUB7
575 PRINT@448,;:M$="YOURSELF? ":GOSUB7:GOSUB8
580 E$=I$:IFRIGHT$(E$,11)<>"SCREWDRIVER"ORA(25)<>2THEN605
590 A(13)=2:A$=OK$:GOTO30
600 A$="DUSTY":GOTO3000
605 A$="CHOKED":GOTO3000
610 IFR<>3THEN630
611 IFO$="HAND"THENA(16)=2:A$=OK$
620 IFO$="HAKE"ANDA(18)=1THENA$=OK$:A(18)=2
630 IFR<>4THEN660
631 IFO$="ZUEN"ANDA(19)=1THENA$=OK$:A(19)=2:A(30)=2
640 IFO$="LAMB"ANDA(20)=1THENA$=OK$:A(20)=2:A(28)=2
650 IFO$="MESS"ANDA(21)=1THENA$=OK$:A(21)=2
660 IFO$="ZETT"ANDA(24)=1THENA$="'PAINTINGS OFTEN HIDE VALUABLES'":A(24)=2
670 IFO$="SCHR"ANDA(25)=1ANDR=5THENA$=OK$:A(25)=2:A(29)=2
680 IFO$="ZANG"ANDA(26)=1ANDR=5THENA$=OK$:A(26)=2:A(22)=2
685 IFO$="DIET"ANDA(12)=1THENA$=OK$:A(12)=2
689 IFA$=""THENA$="YOU CAN'T"
690 GOTO2000
700 IFV$<>"STEL"THEN780
701 IFR<>1THEN740
710 IFO$<>"TISC"THEN1200
711 IFA(2)<>2THEN730
720 A$=OK$:A(3)=1:GOTO70
730 A$="SLIPPED":GOTO3000
740 IFR<>3ORLEFT$(O$,2)<>"WC"THEN1200
750 IFA(7)<>3THEN770
751 IFA(11)=1ANDA(15)=1THENA$="KERPLUNK":GOTO3000
760 A(7)=4:A$=OK$:GOTO70
770 A$="FALLEN INTO TOILET":GOTO3000
780 IFV$<>"DRUE"THEN800
781 IFO$<>"KNOP"THEN1200
790 IFR=2THENA(11)=-A(11)+1:GOTO795
791 A(15)=-A(15)+1
795 A$="CLICK":GOTO2000
800 IFV$<>"OEFF"THEN1020
801 IFR<>1THEN820
805 IFO$="CANN"ANDA(5)=0THENA(5)=1:A(8)=1:A$="AH, A VACUUM CLEANER"
806 IFO$="CANN"THEN2000
810 IFO$<>"TRES"ORA(27)<>1THEN1200
811 PRINT@416,;:M$="WHICH COMBINATION? ":GOSUB7:GOSUB8:E$=I$
815 IFE$="5873"THENA$=OK$:A(27)=2:GOTO820
816 A$="WRONG!"
820 IFR<>4THEN840
821 IFO$="KAST"ANDA(30)=0THENA$=OK$:A(30)=1
830 IFO$="KUEH"ANDA(28)=0THENA$=OK$:A(28)=1
840 IFR<>5ORO$<>"KIST"THEN950
850 IFA(22)<>0THEN1200
860 PRINT@384,;:M$="LOCKED! HOW DO YOU OPEN IT?":GOSUB7
870 GOSUB8:E$=I$:IFE$<>"DIETRICH"ORA(12)<>2THEN1200
880 PRINT@72,"":PRINT@104,"qq":PRINT@136,""
890 PRINT@168,"":PRINT@199,"":PRINT@229,""
900 PRINT@384,;:M$="COUNT D. SLEEPS HERE. YOU'RE":GOSUB7
910 PRINT@416,;:M$="TRAPPED! HE'S GOING TO BITE YOU!":GOSUB7
920 PRINT@448,;:M$="WHAT WILL YOU DO? ":GOSUB7:GOSUB8:E$=I$
930 IFLEFT$(E$,5)="CROSS"ANDA(13)=2THENA$=OK$:A(26)=1:A(22)=1:GOTO30
940 A$="SLURP...":GOTO3000
950 IFO$<>"BLOOD"ORA(9)<>2THEN1020
960 GOSUB3
970 PRINT@384,;:M$="OPEN WITH WHAT? ":GOSUB7
980 GOSUB8:E$=I$:IFE$<>"CHISEL"ORA(10)<>2THEN1200
990 PRINT@416,;:M$="AND AS HAMMER? ":GOSUB7:E$=I$
1000 IFE$<>"LAMB LEG"ORA(20)<>2THEN1200
1010 A$=OK$:A(9)=2:GOTO70
1020 IFV$<>"DRIN"ORO$<>"BLOOD"ORA(9)<>2THEN1050
1030 A$="GAGG, BUT THERE'S A LOCKPICK!"
1040 A(9)=4:A(12)=1:GOTO70
1050 IFV$="ABLE"ANDO$="BRET"ANDR=3ANDA(7)=2THENA$=OK$:A(7)=3
1060 IFV$="ANZU"ANDR=4ANDA(19)=2THENA$="EXPLODED":GOTO3000
1070 IFV$="ANZU"ANDO$="KERZ"ANDA(3)=2ANDA(19)=2THENA$=OK$:DU=2
1075 IFV$="ANZU"ANDO$="KERZ"ANDA(3)=2ANDA(19)=2THEN20
1080 IFA$=""ANDV$<>"ZEH"THENA$="I DON'T UNDERSTAND"
1085 IFV$<>"PULL"THEN2000
1090 IFO$="PREVENT"ANDA(2)>1ANDR=1ANDA(4)=0THENA$=OK$:A(4)=1
1095 IFA$<>OK$THENA$="DOESN'T WORK"
1100 IFO$<>"STEI"ORR<>5ORA(29)<>0THEN2000
1110 GOSUB3
1130 PRINT@384,;:M$="LOOSEN IT WITH WHAT? ":GOSUB7:GOSUB8:E$=I$
1140 IFE$<>"KNIFE"ORA(21)<>2THEN1200
1150 A(29)=1:A$="BOOM... AH, A CAVE!":GOTO2000
1200 A$="DOESN'T WORK":GOTO2000
1300 IFR<>1THEN1340
1301 IFE$="W"ANDA(4)=1THENR=4:GOTO20
1310 IFE$<>"N"THEN1332
1311 IFA(31)=1THENR=3:GOTO20
1320 PRINT@416,;:M$="HOW SHOULD I OPEN IT? ":GOSUB7:GOSUB8:E$=I$
1330 IFLEFT$(E$,4)="KNOB"THENA(31)=1:R=3:GOTO20
1331 GOTO1580
1332 IFE$<>"U"THEN1580
1333 IFA(18)=3THENR=2:GOTO20
1334 PRINT@416,;:M$="HOW DO YOU OPEN THE TRAP DOOR? ":GOSUB7:GOSUB8:E$=I$
1336 IFE$<>"HANDLE"ORA(18)<>2THEN1580
1338 A(18)=3:R=2:GOTO20
1340 IFR=2ANDE$="H"THENR=1:GOTO20
1550 IFR=3ANDE$="S"THENR=1:GOTO20
1560 IFR=5ANDE$="E"THENR=4:GOTO20
1570 IFR=4ANDE$="E"THENR=1:GOTO20
1572 IFR<>4ORE$<>"W"THEN1580
1573 IFA(6)=3THENR=5:GOTO20
1574 PRINT@416,;:M$="OPEN IT WITH WHAT? ":GOSUB7:GOSUB8:E$=I$:IFE$<>"KEY"ORA(6)<>2THEN1580
1576 A(6)=3:R=5:GOTO20
1580 A$="NO WAY THROUGH"
2000 IFDU=1THEN2290
2001 IFR<>1THEN2120
2002 IFA(5)=1THENPRINT@142,"";:REM COLOR2
2010 IFA(3)=2THENPRINT@15,"":PRINT@47,"";:REM COLOR1
2020 IFA(2)=2THENPRINT@272,"";
2030 IFA(6)=1THENPRINT@328,"$-+";:GOTO2040
2031 PRINT@328,"";:REM COLOR4
2040 IFA(27)>0THENPRINT@148,"";:PRINT@180,"";:PRINT@212,"";:REM COLOR6
2050 IFA(18)=3THENPRINT@246,"";:PRINT@278,"";:PRINT@310,"";:REM COLOR1
2060 IFA(18)=3THENPRINT@342,"";:PRINT@375,"";
2070 IFA(31)=1THENPRINT@136,"";:PRINT@168,"";:PRINT@200,"";:REM COLOR1
2080 IFA(30)=1THENPRINT@232,"";:PRINT@264,"";
2090 IFA(4)=1THENPRINT@97,"";:PRINT@129,"";:PRINT@161,"";:REM COLOR1
2100 IFA(4)=1THENPRINT@193,"";:PRINT@225,"";:PRINT@257,"";
2110 IFA(4)=1THENPRINT@289,"";:PRINT@321,"";
2120 IFR<>2THEN2160
2121 IFA(11)=1THENPRINT@242,"*an ":GOTO2130
2122 PRINT@242,"*UP"
2130 IFA(14)>1THENPRINT@371,"";
2140 IFA(10)>1THENPRINT@146,"";
2150 IFA(9)>1THENPRINT@137,"";
2160 IFR<>3THEN2200
2161 IFA(15)=1THENPRINT@82,"()";:REM COLOR6
2170 IFA(15)=0THENPRINT@82,"  ";:REM COLOR6
2180 IFA(16)>1THENPRINT@162,"";:PRINT@192,"";:PRINT@225,"";:REM COLOR1
2190 IFA(16)>1THENPRINT@257,"";:PRINT@289,"";
2200 IFR<>4THEN2260
2201 IFA(30)>0THENPRINT@85,"";:REM COLOR2
2210 IFA(30)>0THENPRINT@117,"";:PRINT@149,"";
2220 IFA(28)>0THENPRINT@202,"";:PRINT@234,"";
2230 IFA(28)>0THENPRINT@266,"";:PRINT@298,"";
2240 IFA(6)>2THENPRINT@98,"";:PRINT@130,"";:PRINT@162,"";:PRINT@194,"";
2250 IFA(6)>2THENPRINT@226,"";:PRINT@258,"";:PRINT@290,"";:PRINT@322,"";
2260 IFR<>5ORA(29)=0THEN2290
2270 PRINT@155," ";:PRINT@187," ";
2280 IFA(25)<2THENPRINT@155,"I";:PRINT@187,"";:REM COLOR3
2290 M=M+5:IFM=60THENM=0:H=H+1
2300 MI$=MID$(STR$(M),2):IFM=5THENMI$="05":GOTO2310
2301 IFM=0THENMI$="00"
2310 H$=STR$(H):PRINT@18,H$":"MI$;
2320 IFH=3THENA$="GO HOME":GOTO3000
2330 IFH=18ANDM=0THENPRINT@384,"it's getting dark!!!";:FORI=0TO1E3:NEXT
2340 IFH=20ANDM=0THENDU=1
2350 IFH<>24ORM<>0THEN70
2360 M=5:REM COLOR5
2370 PRINT@139,"";:PRINT@170,"OO";:PRINT@202,"";
2380 PRINT@234,"";:PRINT@266,"";
2390 PRINT@384,"AHHH, A GHOST! YOU'RE ALMOST CUT BY"
2400 M$="WHAT DO YOU DEFEND YOURSELF WITH? ":GOSUB7
2410 GOSUB8:E$=I$
2420 IFE$<>"VACUUM CLEANER"ORA(8)<>2THEN2500
2430 A$="SAVED":GOTO20
2500 A$="TERRIFIED"
3000 CLS0
3010 GOSUB3
3020 PRINT@168,"";:PRINT@181,"";:PRINT@200,"";:PRINT@213,"";
3030 PRINT@171,"YOU DIED.";:PRINT@384,;:M$="REASON:":GOSUB7:PRINT@416,;:M$=A$:GOSUB7:PRINT@448,;:M$="(HEHE...)":GOSUB7
3040 PRINT@480,;:M$="TRY AGAIN (Y/N)? ":GOSUB7
3050 M$=INKEY$:IFM$="N"THENEND
3060 IFM$<>"Y"THEN3050
3061 RUN
4000 CLS:PRINT" the diamonds ";
4010 PRINTTAB(9)"COUNT D."
4020 PRINT:PRINT:PRINTTAB(12)"(C) 1985":PRINT
4030 PRINTTAB(7)"WOLFGANG WESEMANN"
4040 FORI=0TO2E3:NEXT:CLS
4050 M$="ALL HELL'S BREAKING LOOSE AT INTERPOL.":GOSUB1
4065 M$="A MILLIONAIRE'S DAUGHTER, SIRMEL, DISAPPEARED 3 DAYS AGO!":GOSUB1
4070 M$="HIS WIFE FOUND HER MONDAY MORNING ROBBED OF HER JEWELRY AND HER BLOOD, LYING ON HER PERSIAN COUCH.":GOSUB1
4090 M$="THE PERPETRATOR HAS DISAPPEARED. "
4100 M$=M$+"SUSPICION IMMEDIATELY FALLS ON THE YOUNG COUNT D. FOR THE FOLLOWING REASONS:":GOSUB1:GOSUB4990
4110 CLS:M$="1. HE HAS NEITHER AN ALIBI, NOR AN EXPLANATION FOR HIS DISAPPEARANCE.":GOSUB1
4125 M$="2. SINCE HE BECAME HEIR TO HIS ESTATE IN TRANSYLVANIA, HE'S HAD TO PAY A "
4130 M$=M$+"HORRENDOUS INHERITANCE TAX AND IS NOW IN DEBT.":GOSUB1:GOSUB4990
4160 CLS:M$="TODAY THE COUNT LIVES IN A 4.5-ROOM APARTMENT IN A petty-bourgeois area.":GOSUB1
4175 M$="IT IS SUSPECTED THAT THE COUNT HAS HIS LOOT THERE.":GOSUB1
4185 M$="YOU ARE ASSIGNED TO SEARCH THE APARTMENT.":GOSUB1
4190 M$="COMMANDS ARE MADE IN 2 WORDS:":GOSUB1
4195 PRINT"NOUN (SPACE) VERB"
4200 PRINT:PRINT"E.G. EXAMINE WINDOW":PRINT:GOSUB4990
4210 CLS:M$="NOUN AND VERB CAN BE SHORTENED TO 4 LETTERS EACH WITH A SPACE "
4225 M$=M$+"BETWEEN THEM.":GOSUB1
4230 M$="IF THE COMPUTER ASKS FOR AN OBJECT, THE NAME MUST ALWAYS BE ENTERED IN FULL":GOSUB1
4245 M$="THE FOLLOWING COMMANDS ARE AVAILABLE:":GOSUB1:PRINT:GOSUB4990
4250 CLS:PRINT:PRINT"-LOOK","-TAKE":PRINT
4252 PRINT"-CLIMB (ON)","-PRESS":PRINT
4254 PRINT"-OPEN","-LIGHT":PRINT
4256 PRINT"-PULL","-ROTATE":PRINT
4258 PRINT"-DROP":PRINT:PRINT:GOSUB4990
4300 DIMA(31):R=1:OK$="NA GUT":H=16:H$="16.00":GOTO20
4990 PRINT"          PRESS <enter>         "
4995 IFINKEY$<>CHR$(13)THEN4995
4996 RETURN
6000 CLS:PRINT"         THE DIAMONDS         "
6010 PRINTTAB(9)"OF COUNT D."
6020 PRINT:PRINT"CONGRATULATIONS!!! IT'S DONE!"
6030 PRINT"YOU SUCCEEDED IN FINDING THE DIAMONDS"
6040 PRINT"FINDING THE DIAMONDS!!!":PRINT:PRINT:PRINT:GOTO3040
7000 CLS:IFR<>1THEN8000
7010 PRINT"II";
7020 PRINT"";
7030 PRINT"";
7040 PRINT"ፏ";
7050 PRINT"OOݏ";
7060 PRINT"ꏅwcՏ";
7070 PRINT"׏";
7080 PRINT"ꏅ";
7090 PRINT"";
7100 PRINT"肷";
7110 PRINT"󄏃";
7120 PRINT"";
7190 PRINT:A$="LIVING ROOM":GOTO2000
8000 IFR<>2THEN9000
8010 PRINT"";
8020 PRINT"";
8030 PRINT"";
8040 PRINT"";
8050 PRINT"mm";
8060 PRINT"";
8070 PRINT"";
8080 PRINT"jAUS";
8090 PRINT"";
8100 PRINT"";
8110 PRINT"+";
8120 PRINT"";
8140 A$="CELLAR":GOTO2000
9000 IFR<>3THEN10000
9010 PRINT"";
9020 PRINT"܌";
9030 PRINT"ܰ؏";
9040 PRINT"";
9050 PRINT"͏";
9060 PRINT"";
9070 PRINT"υŰŏ";
9080 PRINT"υΏÏ";
9090 PRINT"GDŰŏϏ";
9100 PRINT"ȃʌ";
9110 PRINT"ɰǟ";
9120 PRINT"ϟ";
9170 A$="BATHROOM":GOTO2000
10000 IFR<>4THEN11000
10010 PRINT"";
10020 PRINT"";
10030 PRINT"";
10040 PRINT"󌍊O";
10050 PRINT"";
10060 PRINT"ŏ";
10070 PRINT"Ϗˍ";
10080 PRINT"IϏÁ";
10090 PRINT"ΌŅ";
10100 PRINT"ȇ̄";
10110 PRINT"";
10120 PRINT"";
10140 A$="KITCHEN":GOTO2000
11000 PRINT"հڰڰڰڰڰ";
11000 PRINT"հհװڰհ";
11000 PRINT"հڰްհװհ";
11000 PRINT"ܰװڰհհӰڰ";
11000 PRINT"հڰްڰӰհ۰";
11000 PRINT"ڰðհհհװڰ";
11000 PRINT"̰ܰʰڰڰڰհӰڰ";
11000 PRINT"ݰ̰̰ʰӰհڰ۰";
11000 PRINT"հΰܰӰڰհٰ";
11000 PRINT"ŰXȰӰհ";
11000 PRINT"Ȱװ";
11000 PRINT"ְٰ";
11130 A$="TOWER ROOM":GOTO2000
