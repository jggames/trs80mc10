99 REM *END-GAME BY J.F.WHITE
100 CLS:GOTO1050
110 GOSUB230
120 GOSUB230
130 FORP3=-1TO1
140 IFA(X+P3,Y-AO)=-CZ*ADTHENQ=Q-AO*CG
150 IFP3=0THEN170
160 IFA(X+P3,Y-AO)=-AOTHENQ=Q-AO*CG
170 NEXT
180 N=N+1
190 GOSUB630
200 GOSUB680
210 GOSUB14080
220 RETURN
230 REM**EVALUATION
240 RX=A(X,Y):A(X,Y)=A(I,J):A(I,J)=0
250 Q=0
260 FORIZ=1TO8
270 IFA(1,IZ)=AOORA(8,IZ)=AQTHENQ=Q-AD/CH
280 FORJZ=1TO8
290 Q=Q+A(IZ,JZ)
300 IFA(IZ,JZ)=0THEN340
310 IFA(IZ,JZ)=CDTHENQ=Q+(9-JZ)*(9-JZ)*CC:MA=MA+1:GOTO340
320 IFA(IZ,JZ)=AO*CZTHENGOSUB410:GOTO340
330 IFA(IZ,JZ)=-CDTHENQ=Q-JZ*JZ*CC:MB=MB+1
340 NEXT
390 A(I,J)=A(X,Y):A(X,Y)=RX
400 RETURN
410 FORP3=-2TO2STEP4
420 IFIZ+P3<1ORIZ+P3>8ORJZ+P3<1ORJZ+P3>8THEN440
430 IFA(IZ+P3,JZ)=CZ*ADORA(IZ,JZ+P3)=CZ*ADTHENQ=Q+AD*CE:GOTO440
440 NEXT
450 FORI7=-1TO1:FORJ7=-1TO1
460 IFA(IZ+I7,JZ+J7)=0THEN480
470 Q=Q-((A(IZ+I7,JZ+J7)=2*AD)*CD/CK)
480 NEXT:NEXT:Q=Q+3*AD/CK
490 IFA(TZ+CD,JZ-AO)=-ADORA(IZ-CD,JZ-AD)=-AOTHENQ=Q-5*AD
500 Q=Q+((IZ<3)+(IZ>6)+(JZ<3)+(JZ>6))*AO/CJ:RETURN
510 FORP2=-1TO1:IFP2+X>8THEN580
520 FORQ2=Y-ADTO(4-4*AO)STEP-AO
530 QP=QP+A(P2+X,Q2)
540 NEXT
550 FORQ2=1TO8
560 GQ=GQ+A(P2+X,Q2)
570 NEXT
580 NEXT
590 FORQP=0THENQ=Q+CG*AD
600 IFY=1THENQ=Q*.5
610 Q=Q+QP*CD/CH+GQ/CM:QP=0:QG=0
620 RETURN
630 REM**MOVE STORAGE
640 AA(N)=X:BB(N)=Y
650 AB(N)=I:BC(N)=J
660 Q(N)=Q
670 RETURN
680 REM**EVALUATE CAPTURES
690 IFQA(K)-Q(N)>.80ANDFL=1THEN710
700 GOTO790
710 REM**3RD LEVEL
720 FORI5=-1TO1:FORJ5=-1TO1
730 IFI5=0ANDJ5=0THEN750
740 IFA(AA(N)+I5,BB(N)+J5)=CZ*ADTHENQ(N)=Q(N)-A(AB(N),BC(N)):GOSUB30:NG=1
750 NEXT:NEXT
760 IFNG=1THENNG=0:GOTO790
770 IFA(AA(N)+AO,BB(N)-AO)=-AOTHENQ(N)=Q(N)-A(AB(N),BC(N)):GOSUB30:GOTO790
780 IFA(AA(N)-AO,BB(N)-AO)=-AOTHENQ(N)=Q(N)-A(AB(N),BC(N)):GOSUB30
790 IFQ(N)<S0THENS0=Q(N):S1=AA(N):S2=BB(N):S3=AB(N):S4=BC(N)
800