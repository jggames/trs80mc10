REM Transactor Magazine Volume 3 Issue 01

100 DIMC(5) ,F(5) ,D(13) :REM V3 . APR3/81

120 PRINT" [CLP. DNJONTARIO INCOME TAX 1980 TAXATION YEAR"

130 PRINT"['' RVS]J BUTTERFIELD"

140 FORJ=lTO90 :IFPEEK(J+32768) =32THENNEXTJ

150 L=J

16 INPUT" [DN] INSTRUCTIONS";Z$:IFASC(Z$)=7 8GOTO240

170 PRINT" [DN] ONTARIO INCOME TAX FOR 1980"

18U PRINT" [DN] FOLLOW YOUR FORM: THIS PROGRAM WILL"

190 PKiNT"HELP WITH THE ARITHMETIC."

200 PRINT" [DN]FOR 'NIL' ITEMS, JUST PRESS 'RETURN'."

210 PRINT" [DNjFOR 'MULTIPLE' ENTRIES, ENTER AMOUNT"

220 PRINT"AND PRESS '+' INSTEAD OF 'RETURN' TO"

230 PRINT"SIGNAL MORE ITEMS TO COME.[DN]"

240 INPUT" PRINTER (Y/N) " ; Z $ : IFASC ( Z $) =89THENOPEN2 , 4 : P5=-l

250 DEFFNS(M)-(M+S-ABS(M-S) )/2

26 DEFFNB(M) =^ (M+B+ABS (M-B) )/2

270 DEfFNP(M) ==INT(M*P/100 + .49)

280 DEFFNI(M)=INT(M*100+.5)

290 GOSUB1340

300 P1=1:GOSUB1440

310 I$="INCOME FROM EMPLOYMENT" :GOSUB1490

320 P=3:E=5E4:GOSUB1380:I=FNS(FNP(I) ) :I$="LESS EMPLOYMT EXPENS" :GOSUB1400

330 I$="*NET EMPL EARNINGS" :GOSUB1420

340 I$="DIVD FROM CDN CORP" :GOSUB1510

350 D(0)=I:I$="INTEREST & INV INCM" :GOSUB1510

360 D(1)=I:I$="CANADIAN CAPITAL GAINS" :GOSUB1510

370 D(4)=I:I$="ALL OTHER INCOME" :GOSUB1510

3 8U I$="**TOTAL INCOME**" :GOSUB1420

3 90 D(2)=I:P1=2:GOSUB14 40:GOSUB1720

400 PRINT"LESS: " :G0SUB13 80 : I$="CPP CONTRIBUTIONS" :GOSUB1490

410 I$="UIC PREMIUMS" :GOSUB1510

420 I$="OTHER DEDUCTIONS" :GOSUB1510

430 I$=" *TOT DEDUCTIONS: ":GOSUB1420

440 I=C(C):I$-" *NET INCOME* " :D ( 3 ) =1 :G0SUB17 20

450 PRINT" [RVS] EXEMPTIONS: ":GOSUB13 80

460 I==289E3 :I$=-"BASIC EXEMPTION" :G0SUB16 80

470 I$="AGE EXEMPT" :COSUB1510:I$="MARRIED EXEMPT" :GOSUB1510

480 I$="DEPNDT CHILD EXMPT" :GOSUB1510 : I $="OTHER EXMPT" :GOSUB1510

490 I$=" *TOTAL EXEMPT*" :GOSUB1420 : D ( 12) =1

500 I$=" **LINE 46**":GOSUB1660

510 GOSUB13 80:GOSUB1360:I$="MEDICAL EXPENSES" :GOSUB1490

520 IFl=0GOTO550

530 GOSUB1380:P=3:I=FNP(D{3) ) :I$="*LESS 3% N. I . " :GOSUB1400

540 I$="ALLOWABLE MED EXP" :GOSUB1660

550 I$="CHARITABLE DONATNS" :GOSUB1510 : I=C (C)
560 C=C-1:B=1E4:I=FNB(I) : I$="**STANDARD DEDCTM**" :G0SUE16 8U

57 S=1E5:I=FNS(D(0)+D(1)+D{4) ) :D(10)=I

580 IFl>OTHENI$="*I, D & CG DEDUCTION" :GOSUB1700

590 I$="ALL OTHER DEDUCTIONS" :GOSUB1510

600 I$="**TOTAL DEDUCTIONS" :GOSUB1420

610 I$=" **TAXABLE INCOME**" :GOSUB1660 :D ( 5) =1 :G0SUB1 840

620 IFi<=30E5ANDD(0)=0THENPRINT"YOU MAY USE TAX TABLE .. OR..."

630 P1=1:GOSUB1460

640 DATA108360, 35849, 43

650 DATA70434, 21058, 39

660 DATA43344, 11306, 36 " [CLR] " = clear screen

670 DATA25284,5526,32 "[HOME]" = cursor home

680 DATA19866,4009,28 "[UP]" = cursor up

690 DATA16254,3106,25 " [DN] " = cursor down

700 DATA12642,2276,23 " [CL] " = cursor left

710 DATA9030,1517,21 " [CR] " - cursor riglit

720 DATA5418,831,19 "[RVS]" = reverse mode on

730 DATA3612,506,18 "[OFF]" = reverse mode oft

7 40 DATA1806,199,17 "[ ' ]" = 1 space

750 DATA903,54,16

760 DATA0,0,6

77 DATA-1

780 READX,Y,P:IFI<X*100GOTO780

790 T=Y*100:P$="ON FIRST $"+STR$(X)+" TAX IS "+STR$? ( Y ) :GOSUBl 820

800 J=I-X*100:1=FNP(J)

810 P$="ON RMG $"+STR$ (J/100) +" TAX AT"+STR$ ( P) +"% IS $"+STR$ ( l/lOO )

820 GOSUB1820

830 I = I+T:GOSUB1340:C=C-1:I$ = "TOTAL FED INCM TAX" :G0SUB16 8Ll

840 S=I:P=25: I=FNS(FNP(D(0) ) ) :D(11)-I

850 IFi>0THENGOSUB1380:I$="DIV TAX CREDIT" :GOSUB1400

860 I$=" *BASIC FEDERAL TAX*" : I=C (C) :G0SUB17 20 :G0SUB1 840 :D ( 6 ) =1

870 IFK2E4GOTO900

880 lFi<=2222E2THENI=2E4 :GOTO900

890 P=9:S=5E4:I=FNS(FNP(I) )

900 G0SUB13 80: I $= "GENERAL TAX REDUCTION" :GOSUB1400

910 I$=" **FEDERAL TAX**" :GOSUB1660:D(7)=I

920 GOSUB13 80:I$="FOREIGN TAX PAID" :GOSUB1510 : IFI-0GOTO980

93 V^=I:I$ = "FORGN INCOME" :GOSUB1510 :K = I :X= (D ( 3 ) -D ( 1 0) ) / 1 00 : Y= (D (7 ) +D { 11 ) ) /lOO

940 S=INT(K/X*Y)

950 P$=STR$(K/100)+"/"+STR$(X)+"*"+STR$(Y)+" ="+STR$ ( S/1 00 ) :GOSUB1820

960 I=FNS(W) :I$=" â€” DEDUCT :" :GOSUB1400

97 PKiNT".. ANOTHER COUNTRY. .." :GOTO920

980 C=C-1:I$="FEDERAL TAX PAYABLE" :GOSUB1420 : D ( 8) -I :G0SUB1 840

990 D1=D(6) :IFD(5)<182E3THENDl-0

1000 P=44:I=FNP(D1)

1010 I$="BASIC ONTARIO TAX" :G0SUB17 20 : D ( 9) -I

1020 READX:IFX<>-lGOTO1020

1030 P$=" ==ONTARIO PROPERTY & SALES TAX-- " :G0SUB1 820 :C0SUB13 40

1040 INPUT"ARE YOU ELIGIBLE FOR THESE CREDITS Y[CL CL CL]";Z$

1050 IFASC(Z$)<>89GOTO1170

1060 I$="TOTAL RENT PAYMENTS" :GOSUB1490 : IFI=0THENC=C-1 :GOTO10 8U

1070 P=20:I=FNP(I) :I$="*20% OF RENT" :GOSUB1400

1080 I$="PROPERTY TAXES&COLLG RES" :GOSUB1510

1090 I=C(C) :P=10:X=FNP(I) : I$="*OCCUPANCY COST*" :GOSUB1420 iGOSUBl 840 :C (C+1 ) =0

1100 GOSUB1340

1110 S=18E3:I=FNS(I) :!$=" ADD. . " :G0SUB16 80 : I=X: I$=" TO. . " :GOSUB17 00

1120 I$="PROPERTY TAX CREDIT" :GOSUB1420

1130 P=1:I=FNP(D(12) ) :I$="SALES TAX CREDIT" :GOSUB1700

1140 I$="TOTAL CREDITS" :GOSUB1420

1150 D1=D(5) :IFD1<182E3THEND1=0

1160 GOSUB13 80:P=2:I=FNP{D1) : I$="LESS(B) ~" :GOSUB1400

1170 B=0:S=5E4:I=FNS(FNB(C(C)) ) :I$="ONTARIO P & S CREDITS" :GOSUB1400

1180 GOSUB1360:I$="ONT POLITICAL TAX CREDIT" :GOSUB1490

1190 I$="*TOTAL ONT TAX CREDITS" : I=C (C-1) +1 :D(13) =1 :GOSUB1400

1200 GOSUB1340

1210 P1=4:GOSUB1440:GOSUB1340:I=D(8) :I$="FEDERAL TAX PAYABLE" :G0SUB1 400

1220 I$="POLIT/BUS/EMPLMT CREDIT" :GOSUB1510 :X=D( 8) +D( 9) -I

1230 C=C-1: I $= "ONTARIO TAX PAYABLE" : I=D(9) :GOSUB1720

1240 C=C-1:I$="T0TAL PAYABLE" : I=X:GOSUB1720 :GOSUB1840

1250 GOSUB13 80:I$="TAX DEDUCTED PER SLIPS" :GOSUB1490

1260 I$="ONTARIO TAX CREDITS" : I=D(13) :GOSUB1700

127 I $=" OVERPAYMENTS/ INSTALMENTS" :GOSUB1510

1280 I$="CHILD TAX CREDIT" :GOSUB1510

1290 I=C(C) :C=3:I$="**T0TAL CREDITS**" :GOSUB1720 :GOSUB1840

1300 C=2 : I $=" BALANCE DUE" : I=X-I : IFI<OTHENI$="REFUND: " : I=ABS( I)

1310 GOSUB1720:PRINT:IFP5THENFORJ=lTO10:PRINT#2:NEXTJ:CLOSE2

1320 END

1330 REM CLEAR ALL ACCUMS

13 40 C=1:C(1)=0:GOSUB1360:GOSUB1360

1350 REM MOVE TO SUBTOTAL

1360 C=C+1:F(C)=1:C(C)=0:RETURN

137 REM MOVE TO NEG SUBTOTAL

1380 C=C+1:F(C)=-1:C{C)=0:RETURN

13 90 REM SUM I INTO NEXT HIGHER TOTAL

1400 C(C)=I

1410 REM SUM C(C) INTO NEXT HIGHER TOT

1420 I=C(C) :F=F(C) :C=C-1 :C(C) =C (C) +I*F:GOTO1720

143 REM PRINT PAGE ID

1440 P$=" ===PAGE":GOTO1470

1450 REM PRINT SCHED ID

1460 P$=" ===SCHEDULE"

1470 GOSUB1900:P$=STR$(P1)+" OF RETURN===" :GOTO1820

1480 REM PROMPT NEW VALUE

1490 C(C)=0

1500 REM PROMPT INPUT

1510 I=0:GETZ$:PRINTI$;"? " ;

1520 Y$="":PRINT CHR$ (166) " [CL] " ;

153 GETZ$:IFZ$=""GOTO153

1540 Z=ASC(Z$) :IFZ>47ANDZ<58GOTO1630

1550 IFZ$="-"ANDY$=""GOTO1630

1560 IFZ$="."GOTO1630

1570 IF(Z=1570RZ=20)ANDY$<>""THENY$=LEFT$(Y$,LEN{Y$)-1) :PRINT"[CL ' ] " ; :GOTO1640

1580 IF Z$<>"+" THEN 1600

1590 PRINT" [DN] " ; : I=I+VAL(Y$) :F0RJ=1T0LEN(Y$) :PRINT" [CL] ";: NEXT: GOTOl 520

1600 IFZ=13ANDI=0THENPRINT" [UP] " ;

1610 IFZ=13THENI=FNI(I+VAL(Y$)) : PRINT :G0T017 00

1620 GOTO153

1630 Y$=Y$+Z$
1640 PKINTZ$; :GOTO153 165 REM FORCE NON NEGATIVE 1660 B=0:I=FNB(C{C)) 167 REM SET VALUE TO I 1680 C(C)=0

16 90 REM ADD VALUE 1700 C(C)=C(C)+I

1710 REM PRINT 1$, VALUE

1720 P$=I$:GOSUB1900:M=1E8:GOSUB1860

17 3 J=ABS{I) :Z$=" ":Z=0

1740 D=INT(J/M) :J=J-D*M:IFD=ZTHENP$=" ":GOTO1760

1750 Z$=",":Z=10:P$=CHR${D+48)

1760 GOSUB1900:M=M/10:IFM=1E4THENP$-Z?:GOSUB1900

1770 IFM=10THENP$=" . " :GOSUB1900 : Z=M

17 80 IFM>=lGOTO17 40

1790 IFi<0THENP$="CR":GOSUB1900: REM NOTE: NO SQUARE BR/vCKETi:'. HERE

18U0 GOTO1840

18l0 REM PRE PRINT

1820 GOSUB1900

IBjO REM NEW LINE

1840 P$=CHR$(13) +CHR$(10) :GOTO1900

1850 REM COLUMN TAB

18b0 IFP5THENPRINT#2,LEFT$(S$,41-C*10) ;

1870 IFL>70THENPRINTLEFT$(S$,41-C*10) ;

1880 P$=LEFT$(S$,25-LEN(I$))

1890 REM PRINT

1900 IFP5THENPRINT#2,P$;

1910 PRINTP$; : RETURN

