0 CLEAR300:CLS:DIMZZ,CC,M$,I$:GOTO10
1 ZZ=1:CC=32:FORCC=CCTOZZSTEP-1:I$=MID$(M$,CC,1):IFI$<"!"THEN?MID$(M$,ZZ,CC-ZZ):ZZ=CC+1:CC=ZZ+32:IFI$=""THENCC=.
2 CC=CC+(CC>255)*(CC-255):NEXT:M$="":RETURN
7 PRINTM$;:CC=((PEEK(17024)AND1)*256+PEEK(17025))-1+MC:FORZZ=CC-LEN(M$)+1TOCC:POKEZZ,PEEK(ZZ)-64:NEXT:RETURN
9 GOSUB1:GOTO8200
10 NR=44:NT=34:NP=6:NV=29:NO=NT+NP
20 DIMAC(NR,6),VB$(NV),OB$(NO),RM$(NR),TD$(NT),VN(NV),TL(NT),TF(NT)
99 REM init 
100 RM=1:WD=1:IC=3
120 FORI=1TONR:READRM$(I):NEXT:FORI=1TONV:READVB$(I),VN(I):NEXT:FORI=1TONO:READOB$(I):NEXT
150 FORI=1TONT:READTD$(I),TL(I),TF(I):NEXT:FORI=1TONR:READAC(I,1),AC(I,2),AC(I,3),AC(I,4),AC(I,5),AC(I,6):NEXT
199 REM main 
200 IFWD=0THEN400
205 IFWD=-1THENPRINT"IT IS TOO DARK TO SEE.":GOTO400
210 CLS:WD=0:M$=RM$(RM):GOSUB1
220 K=0:I$="":FORI=1TONT:IFTL(I)<>RMTHEN270
250 IFK=0THENI$=I$+"visible items: ":K=1
260 I$=I$+TD$(I)+", "
270 NEXT:IFI$<>""THENM$=LEFT$(I$,LEN(I$)-2)+".":GOSUB1
300 I$="exits: ":FORI=1TO6:IFAC(RM,I)<>0THENI$=I$+OB$(NT+I)+", "
330 NEXT:IFI$<>""THENM$=LEFT$(I$,LEN(I$)-2)+".":GOSUB1
399 REM commands
400 INPUTC$:L=LEN(C$):IFL=0THENPRINT"EXCUSE ME?":GOTO400
420 C1$="":C2$="":C2=0:X=0
430 FORI=1TOL:A$=MID$(C$,I,1):A=ASC(A$):IFA>=97ANDA<=122THENA$=CHR$(A-32)
450 IFA$<>" "THEN460
455 IFC2$<>""THENCC=I:I=L:NEXT:I=CC:GOTO500
457 X=1:GOTO490
460 IFX=0THENC1$=C1$+A$:GOTO490
470 C2$=C2$+A$
490 NEXT
500 VB$=C1$:C1$=LEFT$(C1$,5):NN$=C2$:C2$=LEFT$(C2$,5)
520 FORC1=1TONV:IFVB$(C1)=C1$THENCC=C1:C1=NV:NEXT:C1=CC:C1=VN(C1):GOTO600
540 NEXT:M$="I DON'T KNOW THE VERB "+VB$:GOTO9
600 IFC2$=""THEN700
610 FORC2=1TONO:IFOB$(C2)=C2$THENCC=C2:C2=NO:NEXT:C2=CC:GOTO700
630 NEXT
640 M$="I DON'T KNOW THE OBJECT "+NN$:GOTO9
699 REM preliminary filtering of commands
700 IFC2>NT+NPANDC1<>7ANDC1<>7THEN640
710 IFC2<NT+NPANDC2>NTTHENIFC1<>7THEN8010
720 IFC2>NTTHEN750
730 IFTL(C2)<>RMANDTL(C2)<>0THENM$="IT ISN'T HERE.":GOTO9
750 ONC1GOTO1000,1000,1000,1000,1000,1000,1100,1200,1300,1400,1500,1800,1900,2000,2100,2200,2300,2400,2500,2900
770 ONC1-20GOTO2600,2700,2800:STOP
999 REM directions
1000 IFAC(RM,C1)=0THENPRINT"YOU CAN'T GO THAT WAY.":GOTO200
1020 RM=AC(RM,C1):WD=1:GOTO8200
1099 REM go
1100 IFC2=0THEN8050
1105 IFC2<=NTTHEN8040
1110 C1=C2-NT:GOTO1000
1199 REM eat
1200 IFC2=0THEN8050
1298 GOTO8200
1299 REM chop
1300 IFC2=0THEN8050
1398 GOTO8200
1399 REM talk
1400 IFC2=0THEN8050
1498 GOTO8200
1499 REM turn
1500 IFC2=0THEN8050
1598 GOTO8200
1599 REM verb
1600 IFC2=0THEN8050
1698 REM verb
1700 IFC2=0THEN8050
1798 GOTO8200
1799 REM get 
1800 IFC2=0THEN8050
1801 IFIC>6THENM$="YOU CAN ONLY CARRY 6 ITEMS.":GOTO9
1805 IFTF(C2)=0THENM$="THAT'S BEYOND YOUR ABILITY.":GOTO9
1810 IFTL=0THENM$="YOU ALREADY HAVE IT!":GOTO9
1830 TL(C2)=0:GOTO8000
1899 REM drop
1900 IFC2=0THEN8050
1998 GOTO8200
1999 REM inventory
2000 IC=0:I$="YOU ARE CARRYING: ":FORI=1TONT:IFTL(I)=0THENI$=I$+TD$(I)+", ":IC=1
2030 NEXT:IFIC=0THENI$=I$+"NOTHING. "
2050 M$=LEFT$(I$,LEN(I$)-2)+".":GOTO9
2099 REM clean
2100 IFC2=0THEN8050
2198 GOTO8200
2199 REM read
2200 IFC2=0THEN8050
2298 GOTO8200
2299 REM shoot/kill
2398 M$="THAT WON'T WORK.":GOTO9
2399 REM unlock
2400 IFC2=0THEN8050
2498 GOTO8200
2499 REM open
2500 IFC2=0THEN8050
2598 GOTO8200
2599 REM look
2600 IFC2=0THEN2698
2698 WD=1:GOTO8200
2699 REM clean
2700 IFC2=0THEN8050
2798 GOTO8200
2799 REM examine
2800 IFC2=0THEN8050
2898 M$="YOU SEE NOTHING SPECIAL.":GOTO9
2899 REM listen
2900 IFC2<>0THEN8040
2910 GOTO8020
7999 REM messages
8000 PRINT"OK.":GOTO8200
8010 PRINT"THAT'S SILLY!":GOTO200
8020 PRINT"NOTHING HAPPENS.":GOTO8200
8030 PRINT"YOU CAN'T DO THAT NOW.":GOTO8200
8040 PRINT"WHO'S YOUR ENGLISH TEACHER?":GOTO200
8050 PRINT"PLEASE GIVE AN OBJECT.":GOTO200
8199 REM completion routines
8200 REM put them here 
8298 GOTO200
8299 REM additional completion here

9001 DATA"IN A LARGE OFFICE. A LARGE WINDOW IS HERE AND SOME ROSEWOOD FURNITURE."
9002 DATA"ON A LANDING. A STAIRWAY LEADS SOUTH TO THE STREET."
9003 DATA"ON THE BRICK STREET IN FRONT OF SCOTLAND YARD."
9004 DATA"IN THE CAB TRAVELING THRU THE STREETS OF LONDON. IT'S A BEAUTIFUL NIGHT."
9005 DATA"IN THE HANSOM CAB. IT IS PARKED IN FRONT OF A LARGE MANOR."
9006 DATA"STANDING BY THE FRONT PORCH OF CROWLEY ESTATE. STEPS LEAD UP TO THE FRONT DOOR."
9007 DATA"IN A PLUSH ENTRY HALL. THE FURNISHINGS ARE OPULENT."
9008 DATA"AT THE SOUTH END OF A LONG NORTH/SOUTH HALL."
9009 DATA"IN THE CENTER OF ALONG NORTH/SOUTH HALL."
9010 DATA"AT THE NORTH END OF A LONG NORTH/SOUTH HALL."
9011 DATA"IN AN ELEGANT MUSIC ROOM. OLD PORTRAITS LINE THE WALLS."
9012 DATA"IN THE PARLOR. IT HAS VICTORIAN FURNITURE AND PLUSH PERSIAN CARPETS."
9013 DATA"IN A DIMLY LIT ROOM. A SMALL FIGURE IS DISCOVERED IN THE DARKNESS."
9014 DATA"IN A BOOK FILLED STUDY. BOOK SHELVES LINE THE WALLS. A LARGE DESK IS HERE."
9015 DATA"IN THE KITCHEN. THERE IS BLOOD SPLATTERED ON THE WALLS AND A POOL ON THE FLOOR."
9016 DATA"IN AN EXQUISITE DINING ROOM.WITH A HUGE OAK TABLE AND A CRYSTAL CHANDELIER."
9017 DATA"IN A WELL STOCKED FOOD PANTRY WITH SHELVES AND SHELVES OF FOOD. A CLOSED DOOR IS EAST."
9018 DATA"IN A VERY SHORT EAST/WEST HALL."
9019 DATA"IN A SMALL STORAGE ROOM. A NAILED SHUT DOOR IS SOUTH, AND A PLYWOOD WALL IS NORTH."
9020 DATA"IN A DARKENED ROOM STREWN WITH SCIENTIFIC INSTRUMENTS. A DOORWAY IS WEST, AND A HOLE IN THE WALL IS SOUTH."
9021 DATA"IN A DINGY LOOKING ROOM. AN ANCIENT NUMERAL LOCK IS ON A DOOR ON THE NORTH WALL."
9022 DATA"IN A DAMP BRICK WALLED ROOM. A STAIRWAY IS EAST, AND A CLOSED DOOR IS TO THE SOUTH. THERE IS A TERRIBLE STENCH!"
9023 DATA"AT THE SOUTH END OF A NORTH/SOUTH HALL."
9024 DATA"IN THE CENTRE OF A NORTH/SOUTH HALL."
9025 DATA"AT THE FAR NORTH END OF A NORTH/SOUTH HALLWAY. A DOORWAY IS TO THE WEST."
9026 DATA"IN A STARK ROOM. THE WALLS, CEILING, AND FLOOR ARE ALL RED BRICK."
9027 DATA"IN A BRILLIANT CRYSTAL ROOM. A TOWERING FIGURE IN WHITE STANDS IN THE CENTER."
9028 DATA"FAR EAST IN AN EAST/WEST HALL. A DOORWAY IS TO THE NORTH."
9029 DATA"IN A SHORT HALLWAY. DOORWAYS ARE NORTH AND SOUTH."
9030 DATA"IN A LOW CEILINGED CRYPT. IT IS FULL OF DUST AND COBWEBS."
9031 DATA"IN THE 'DOGFOOD GRILL' IN EL PASO, TEXAS. A TRUCK DRIVER HAS PASSED OUT WITH HIS FACE IN A BOWL OF CHILI."
9032 DATA"IN A DIM SHIMMERING ROOM. A GHOSTLY FIGURE IS SEATED AT A CONCERT PIANO."
9033 DATA"IN A LARGE DESERTED ROOM. THERE IS NOTHING IN VIEW."
9034 DATA"IN A DAMP MUSTY PASSAGE. A ROPE HANGS THROUGH A HOLE IN THE FLOOR."
9035 DATA"IN A GREAT SILVER ROOM. THE WALLS ARE A SHIMMERING HAZE."
9036 DATA"IN A WIDE, DARK, SMELLY PIT. A LOW WAILING MOAN PERMEATES THE DARKNESS."
9037 DATA"IN A STONE ROOM STREWN WITH ANIMAL BONES. A HUGE, UGLY RAT IS HERE."
9038 DATA"IN A SMELLY PIT WITH A DIRT FLOOR. FUNGUS GROWS ON THE WALLS. A DOOR IS EAST."
9039 DATA"IN A VERY EERIE CHAMBER. THE WALLS ARE PAINTED BLACK, AND STRANGE SYMBOLS ARE DRAWN ON THE FLOOR."
9040 DATA"IN A BRILLIANT GREEN ROOM. THE LIGHT MAKES YOU SQUINT. THERE IS A BEAUTIFUL FOUNTAIN HERE."
9041 DATA"IN A GIGANTIC CAVERN STRETCHING EAST AND WEST. THE ODOR IS SICKENING."
9042 DATA"AT THE GATES OF HELL IN A MAZE OF PASSAGES. 'IT' IS UPON YOU."
9043 DATA"ON A HIGH PINNACLE OVERLOOKING THE BURNING PITS OF HELL. THE DEMON IS OUTLINED IN FLAMES."
9044 DATA"STARTING THE GAME OVER. BY THE GRACE OF A MYTHICAL SPIRIT. YOUR LIFE IS SPARED. CONTINUE ON."

9050 DATAN,1,S,2,E,3,W,4,U,5,D,6,GO,7,EAT,8,CHOP,9,TALK,10,UNSC,11,TURN,11
9055 DATATAKE,12,GET,12,DROP,13,THROW,13,INVEN,14,I,14,CLEAN,15,READ,16
9060 DATASHOOT,17,KILL,17,UNLOC,18,OPEN,19,LISTE,20,WAIT,20,LOOK,21
9065 DATACLEAN,22,EXAMI,23

9100 DATAROOM,FOOD,NAMEP,CALEN,ID,PHONE,MOZAR,AXE,BOOK,CABIN,KEY,CRYST,BOOK,DESK,CRANK,CHEST,NOTE,SHILL,GROWTH,TABLE
9101 DATADOOR,VIAL,CRUCIFIX,ROPE,SHIELD,CLUB,RAT,BEAMS,REVOL,WINDO,VICTR,OPENE,CAB,DEMON,NORTH,SOUTH,EAST,WEST,UP,DOWN

9150 DATAROOM,-1,-1,A PLATE OF DELICIOUS FOOD,-1,0,NAMEPLATE,1,1,CALENDAR,1,1,"I.D. CARD",0,1,PHONE,1,0,MOZART,-1,0
9151 DATAHAND AXE,-1,1,BOOK,-1,1,CABINET,-1,0,KEY,-1,1,CRYSTAL BALL,-1,0,SILVER BOOK,-1,0,DESK,-1,0,CRANK,-1,0
9152 DATACHEST,-1,0,OLD NOTE,-1,0,40 SHILLINGS,0,1,GROWTH,-1,0,TABLE,-1,0,DOOR,-1,0,VIAL,-1,0,CRUCIFIX,-1,0,ROPE,-1,0
9153 DATAGOLD SHIELD,-1,0,SILVER CLUB,-1,0,RAT,-1,0,BEAMS,-1,0,REVOLVER,0,1,WINDOW,1,0,VICTROLA,-1,0,LETTER OPENER,-1,0
9154 DATAHANDSOME CAB,-1,0,DEMON,-1,0

9201 DATA,2,,,,
9202 DATA1,3,,,,
9203 DATA2,4,,,,
9204 DATA3,,,5,,
9205 DATA,,4,6,,
9206 DATA7,,5,,,
9207 DATA,6,8,12,,
9208 DATA9,,0,7,,
9209 DATA10,8,,,,
9210 DATA15,9,,,,
9211 DATA12,,,,,
9212 DATA13,11,7,,,
9213 DATA,12,14,,,
9214 DATA,,,13,,
9215 DATA,10,,16,,
9216 DATA17,,15,,,
9217 DATA,16,18,,,
9218 DATA,,19,17,,
9219 DATA20,,,18,,
9220 DATA,19,,21,,
9221 DATA22,,20,,,
9222 DATA,21,23,,,
9223 DATA24,,,22,,
9224 DATA25,23,,,,
9225 DATA,24,,26,,
9226 DATA,,25,27,,
9227 DATA29,28,26,,,
9228 DATA,28,,30,,
9229 DATA36,27,,0,,
9230 DATA31,,28,32,,
9231 DATA,30,,,,
9232 DATA33,,30,,,
9233 DATA,32,,,34,
9234 DATA,,35,,,33
9235 DATA,,,34,,
9236 DATA37,29,,,,
9237 DATA,36,,38,,
9238 DATA39,,37,,,
9239 DATA44,38,40,,,
9240 DATA,,,39,,
9241 DATA42,39,,,,
9242 DATA,41,43,,,
9243 DATA,,44,42,,
9244 DATA,,,43,,
