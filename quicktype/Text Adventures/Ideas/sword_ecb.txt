	1 REM SWORD.ECB
    2 LET D1=0,F9=0,D2=0,D3=0
    3 LET X1=0,V1=0,F1=0,C1=0,C2=0
    4 LET D4=0,F5=0,E1=0,F8=0
    5 LET G1=0,I2=0,P3=0
    8 LET I3=PEEK(52227)
    9 FOR X=1 TO I3: LET Z=RND(0): NEXT X
   10 PRINT "&K&J&JSWORDS AND SORCERY&J"
   20 PRINT "GOOD LUCK.  YOU WILL NEED IT!"
   22 PRINT
   23 GOSUB 5000
   30 IF RND(0)>.7 THEN 200
   40 PRINT "A DRYAD WISHES TO GUIDE YOU."
   50 PRINT "WILL YOU LET HER?"
   60 GOSUB 3000
   70 ON I1 GOTO 80,120
   80 LET F1=0
   90 IF RND(0)>.2 THEN  GOSUB 3100
  100 GOTO 200
  120 LET F1=1
  200 LET W1=F1
  210 PRINT "THERE ARE THREE PATHS INTO THE"
  211 PRINT "FOREST. ONE IS CORRECT."
  220 LET C1=INT(3*RND(0)+.9999)
  222 LET Y1=INT(3*RND(0)+.9999)
  225 IF RND(0)>.4 THEN  LET Y1=C1
  230 PRINT "DO YOU WISH TO CONSULT AN ORACLE?"
  240 GOSUB 3000
  250 ON I1 GOTO 400,260
  260 PRINT "HOW MANY MAIDENS SHOULD"
  270 PRINT "BE SACRIFICED? ---=>";
  280 INPUT V1
  285 LET V1=INT(V1)
  290 IF V1>2*RND(0) THEN 320
  295 PRINT "THE ORACLE IS OFFENDED"
  300 LET C2=C2-1
  320 IF V1*F1<10*RND(0) THEN 350
  330 GOSUB 3100
  350 IF C2<0 THEN 388
  360 IF RND(0)<.4-(V1/10) THEN 388
  370 PRINT "THE ORACLE SAYS PATH";Y1
  380 LET P1=1
  381 GOTO 400
  388 PRINT "THE SIGNS ARE UNCLEAR"
  400 PRINT "CHOOSE PATH 1,2 OR 3 ---=>";
  410 INPUT X1
  415 LET X1=INT(X1)
  420 IF X1>3 THEN 400
  425 IF X1<1 THEN 400
  426 LET L1=100*(RND(0)+1)
  427 IF X1=C1 THEN 444
  431 LET C2=C2-2
  432 LET L1=L1+50
  444 LET C2=C2+1
  445 LET T1=0
  450 LET C2=C2+.5*RND(0)+F1+P1+.2*V1*SGN(5.1-V1)
  490 LET C3=0
  520 PRINT "YOU HAVE COME TO A FORK IN THE PATH"
  525 LET C1=INT(2*RND(0)+.9999)
  530 LET Z1=W1-F1
  531 IF Z1=-1 THEN  LET Z1=0
  532 LET S1=8-Z1-G1/(1+Z1)
  533 IF Z1=0 THEN  LET Z1=-1
  535 IF S1<4 THEN  LET S1=4
  540 IF 3.5*RND(0)>C2 THEN  LET L1=L1+1
  545 LET L2=7+20*RND(0)
  550 LET L0=L2
  560 IF F1=0 THEN 660
  570 PRINT "DO YOU WANT TO ASK THE NYMPH    WHICH ONE?"
  580 GOSUB 3000
  590 ON I1 GOTO 660,600
  600 IF RND(0)>.5+C2/50 THEN 650
  610 PRINT "SHE SAYS ";C1
  620 GOTO 740
  650 PRINT "SHE DOES NOT KNOW"
  655 GOTO 740
  660 PRINT "WILL YOU CAST LOTS TO DECIDE?"
  670 GOSUB 3000
  674 ON I1 GOTO 740,680
  680 PRINT "THE LOT SAYS"
  685 IF RND(0)>.5+C2/10 THEN 700
  690 LET X1=C1
  695 GOTO 730
  700 IF C1=2 THEN  LET X1=1
  710 IF C1=1 THEN  LET X1=2
  730 PRINT X1
  740 PRINT "DO YOU CHOOSE 1 OR 2 ---=>";
  750 INPUT X1
  755 LET X1=INT(X1+.0001)
  760 IF X1>2 THEN 740
  770 IF X1<1 THEN 740
  780 LET D0=0
  790 IF X1<>C1 THEN 820
  800 LET C2=C2+RND(0)*SGN(.5-RND(0))
  810 LET C3=0
  815 GOTO 840
  820 LET C2=C2-.2
  830 LET C3=-1
  840 IF T1=0 THEN 890
  890 LET L2=L2-S1
  895 LET I2=I2+1
  900 IF E1<>0 THEN 940
  910 IF RND(0)>.15+2*F1 THEN 940
  920 PRINT "YOU FIND AN ENCHANTED SWORD"
  925 LET C2=C2+.2
  926 LET E1=1
  940 IF RND(0)-.5*(F1+C3)<.95 THEN 960
  950 PRINT "SNAKE!!!"
  955 GOSUB 3490
  960 LET T1=T1+1
  970 IF RND(0)>.8+(C2+C3)/30 THEN  GOSUB 4500
 1200 IF RND(0)>.95 THEN  GOSUB 7000
 1300 IF RND(0)<.03 THEN  GOSUB 6100
 1310 LET P3=0
 1350 IF RND(0)>.99+(C2-I2/10)/100 THEN  GOSUB 6300
 1445 IF W1=0 THEN 1460
 1450 IF RND(0)>.95+(C2+C3)/50 THEN  GOSUB 5100
 1460 IF RND(0)<.95 THEN 1500
 1470 PRINT "GOLD! HOW MANY SACKS"
 1475 PRINT "WILL YOU TAKE? ---=>";
 1480 INPUT X1
 1490 LET G1=G1+INT(X1)
 1500 IF T1>10-2*F1 THEN  GOSUB 3500
 1510 IF RND(0)>.05 THEN 1540
 1520 PRINT "YOU MEET AN ESCAPED SLAVE GIRL"
 1530 LET W1=W1+1
 1540 IF L2>0 THEN 840
 1550 LET L1=L1-L0*.85
 1560 IF L1<20 THEN  GOSUB 4000
 1570 IF C3<>-1 THEN 520
 1580 IF RND(0)<.9 THEN 520
 1590 IF RND(0)>.5 GOSUB 6100
 1595 PRINT "DEAD END"
 1600 LET L2=L2+L0
 1615 LET L1=L1+L0
 1616 LET C3=0
 1700 GOTO 840
 2980 GOTO 840
 2990 PRINT "THE PRINCESS IS STILL IN CAPTIVITY."
 2991 PRINT "TRY AGAIN??"
 2997 GOSUB 3000
 2998 IF I1=1 THEN 8406
 2999 GOTO 1
 3000 PRINT "<&G> Enter Y=yes or N=no ---=>";
 3002 INPUT (1,0)I$
 3003 PRINT
 3005 IF LEN(I$)=0 THEN  LET I$="N"
 3010 IF I$(1,1)="Y" THEN  LET I1=2: RETURN
 3011 IF I$(1,1)="y" THEN  LET I1=2: RETURN
 3015 IF I$(1,1)="N" THEN  LET I1=1: RETURN
 3016 IF I$(1,1)="n" THEN  LET I1=1: RETURN
 3020 GOTO 3000
 3025 RETURN
 3100 PRINT "THE NYMPH IS VERY OFFENDED"
 3105 PRINT "SHE CURSES YOU AND GOES"
 3110 LET F1=0
 3112 LET W1=0
 3115 LET C2=C2-1
 3120 RETURN
 3490 PRINT "YOU ARE HURT"
 3500 PRINT "YOU MUST REST"
 3502 PRINT "YOU HAVE GONE";I2*S1;" km."
 3510 LET T1=0
 3515 GOSUB 5000
 3520 LET D3=D3+1+W1-F1
 3530 IF D3<4-W1+F1 THEN 3700
 3540 IF D4<>0 THEN 3650
 3550 PRINT "YOU ARE OUT OF FOOD"
 3560 LET D4=1
 3561 LET C2=C2-RND(0)
 3570 GOTO 3700
 3650 LET F5=F5+1
 3660 LET C2=C2-RND(0)+.2*F1
 3700 IF RND(0)>1-(I2+F8)/100 THEN 3715
 3702 PRINT "TIME TO MOVE ON."
 3705 IF F5<7 THEN  RETURN
 3710 PRINT "YOU STARVE TO DEATH"
 3711 GOTO 2990
 3715 PRINT "YOU ARE CAPTURED BY GOBLINS"
 3720 IF E1<>1 THEN 3800
 3725 PRINT "THEY WANT YOUR SWORD"
 3730 PRINT "WILL YOU TRADE IT FOR FREEDOM?"
 3735 GOSUB 3000
 3740 ON I1 GOTO 3800,3750
 3750 PRINT "AGREED"
 3751 LET E1=-.8
 3752 IF P3=1 THEN  PRINT "THEY THROW YOU BACK IN THE PIT"
 3755 GOTO 3705
 3800 LET D9=INT(3*RND(0)+.9999)
 3805 IF G1<D9 THEN 3850
 3810 PRINT "THE GOBLIN LORD FREES YOU"
 3820 PRINT "FOR";D9;" BAGS OF GOLD"
 3825 LET G1=G1-D9
 3830 GOTO 3752
 3850 IF W1>0 THEN 3880
 3860 PRINT "YOU ARE ENSLAVED AND DIE IN PRISON"
 3870 GOTO 2990
 3880 PRINT "YOU ARE SOLD TO THE SATYRS"
 3890 GOSUB 5130
 3891 GOTO 3752
 4000 IF R1<>0 THEN 4200
 4020 PRINT "YOU ARE AT THE ENTRANCE"
 4021 PRINT "TO THE DUNGEON"
 4022 PRINT "THERE IS A GUARD"
 4025 GOSUB 7990
 4110 LET R1=1
 4111 LET W1=W1+1
 4120 PRINT "YOU HAVE RELEASED THE PRINCESS"
 4125 GOSUB 3500
 4200 IF L1>0 THEN  RETURN
 4205 IF R1<>1 THEN 4275
 4207 PRINT "YOU MADE IT!!!!"
 4210 PRINT "YOU ARE A HERO"
 4215 IF G1<2 THEN 4240
 4220 PRINT "YOU MARRY THE PRINCESS"
 4225 GOTO 2990
 4240 PRINT "TOO BAD YOU ARE TOO POOR"
 4245 PRINT "TO MARRY THE PRINCESS"
 4247 PRINT "YOU LIVE THE REST OF YOUR LIFE"
 4250 PRINT "IN QUIET POVERTY"
 4255 GOTO 2990
 4275 IF R1<>-2 THEN 4305
 4280 PRINT "YOU LET THE PRINCESS BE"
 4285 PRINT "TAKEN ALIVE BY SATYRS"
 4290 PRINT "YOU ARE JUSTIFIABLY TORTURED"
 4295 PRINT "TO DEATH"
 4300 GOTO 2990
 4305 PRINT "YOU HAVE FAILED"
 4310 GOTO 4247
 4500 PRINT "TROLL!!!"
 4510 PRINT "WILL YOU FIGHT?"
 4520 GOSUB 3000
 4530 ON I1 GOTO 4540,4560
 4540 GOSUB 4700
 4550 RETURN
 4560 IF E1=0 THEN 4580
 4570 IF RND(0)>.2 THEN 4580
 4574 PRINT "THE TROLL RUNS"
 4576 RETURN
 4580 IF RND(0)+.3*E1>.5 THEN 4610
 4585 IF RND(0)>.3 THEN 4590
 4586 GOSUB 3490
 4587 RETURN
 4590 PRINT "YOU ARE KILLED"
 4600 GOTO 2990
 4610 PRINT "THE TROLL IS DEAD"
 4620 IF RND(0)+.05*E1<.4 THEN  GOSUB 3490
 4630 RETURN
 4700 PRINT "RUN!!"
 4710 LET L1=L1+4*S1*(RND(0)-.7)
 4720 LET T1=T1+1
 4725 IF RND(0)>.7 THEN  GOSUB 6100
 4730 RETURN
 5000 FOR I1=1 TO 200
 5001   LET X1=RND(0)
 5003 NEXT I1
 5004 RETURN
 5100 PRINT "OH NO! SATYRS."
 5105 IF E1<>1 THEN 5130
 5110 IF RND(0)<.5 THEN 5130
 5120 PRINT "THEY RUN FROM YOUR SWORD"
 5125 RETURN
 5130 PRINT "THEY WILL GO IF YOU FIGHT"
 5135 PRINT "THEIR CHAMPION"
 5140 GOSUB 3000
 5145 ON I1 GOTO 5200,5160
 5160 GOSUB 7990
 5165 IF RND(0)<.2 THEN 5200
 5170 RETURN
 5200 PRINT "THE SATYRS WANT THE FEMALES"
 5205 LET W1=F1=0
 5206 IF R1=1 THEN  LET R1=-2
 5210 PRINT "WILL YOU ALLOW THIS"
 5220 GOSUB 3000
 5230 ON I1 GOTO 5240,5260
 5240 PRINT "THEY KILL YOU AND TAKE THE WOMEN"
 5250 GOTO 2990
 5260 PRINT "THE WOMEN ARE TAKEN"
 5270 IF RND(0)<.03 THEN 5310
 5280 PRINT "THEY CURSE YOU"
 5290 LET C2=-5
 5310 IF RND(0)>.3 THEN  RETURN
 5320 PRINT "THE SATYRS KILL YOU ANYWAY"
 5340 GOTO 2990
 6100 PRINT "YOU HAVE FALLEN INTO A PIT."
 6105 LET P3=1
 6110 IF RND(0)>.5 THEN  GOSUB 3490
 6120 PRINT "YOU MUST ESCAPE. WILL YOU"
 6130 PRINT "TRY TO CLIMB OUT 1, OR"
 6140 PRINT "YELL FOR HELP 2?  ---=>";
 6150 INPUT X1
 6151 LET X1=INT(X1)
 6152 IF X1<1 THEN 6120
 6153 IF X1>2 THEN 6120
 6154 LET P7=0
 6155 ON X1 GOTO 6160,6200
 6160 IF RND(0)<.5-P7/10 THEN 6180
 6162 PRINT "YOU FALL WHILE TRYING TO CLIMB"
 6164 PRINT
 6165 IF RND(0)<.2 THEN  GOSUB 3490
 6167 LET P7=P7+1
 6168 IF P7<5 THEN 6160
 6170 PRINT "TOO DEEP. YELL FOR HELP."
 6172 GOTO 6200
 6180 PRINT "YOU ARE OUT"
 6181 RETURN
 6200 FOR I1=1 TO 2
 6201   PRINT "HELP!!"
 6202 NEXT I1
 6203 GOSUB 5000
 6204 IF RND(0)<.3 THEN 6200
 6205 PRINT "A ROPE HAS BEEN LOWERED"
 6207 LET P3=0
 6210 LET Y1=INT(3*RND(0)+.9999)
 6215 ON Y1 GOTO 6220,6225,6230
 6220 GOSUB 4500
 6221 RETURN
 6225 GOSUB 3715
 6226 RETURN
 6230 PRINT "YOU ARE RESCUED BY A WOMAN"
 6231 LET W1=W1+1
 6232 RETURN
 6300 PRINT "IT IS THE NECROMANCER...."
 6305 IF RND(0)>.6 THEN 6392
 6310 IF F1<>1 THEN 6326
 6320 PRINT "THE NYMPH GOES MAD."
 6324 LET W1=W1-1
 6325 LET F1=0
 6326 IF E1=1 THEN 6375
 6330 IF W1=0 THEN 6350
 6335 LET W1=0
 6340 PRINT "THE WOMEN ARE SENT TO HIS"
 6345 PRINT "UNDEAD AS PLAYTHINGS"
 6350 PRINT "YOU ARE TRANSFORMED INTO"
 6351 PRINT "A GELDED WATER BUFFALO"
 6352 PRINT "AND DRIVEN INTO A PIT."
 6360 PRINT "BOY DID YOU LOSE!"
 6370 GOTO 2990
 6375 PRINT "HE TAKES YOUR SWORD"
 6376 LET E1=-1.5
 6380 PRINT "YOU ARE CAST INTO A PIT"
 6385 GOSUB 6110
 6390 RETURN
 6392 GOSUB 4700
 6395 RETURN
 7000 PRINT "UGH! RATS, MILLIONS OF THEM."
 7010 GOSUB 4700
 7020 RETURN
 7990 LET W3=2
 7991 LET H1=1
 7992 LET H2=1
 7993 LET W2=1+.3*RND(0)
 7995 LET H3=2+SGN(E1)
 8000 PRINT "IT IS A LARGE TROLL"
 8040 PRINT "THE BATTLE BEGINS"
 8050 PRINT "YOU CIRCLE FOR POSITION"
 8051 FOR I1=1 TO 20
 8052   LET X1=RND(0)
 8053 NEXT I1
 8055 LET W3=W3-.05
 8056 LET H1=H1-.05
 8057 LET H2=H2-.05
 8060 PRINT "HE ATTACKS!"
 8070 LET X1=1+INT(2.9999*RND(0))
 8080 ON X1 GOTO 8090,8100,8110
 8090 PRINT "HE TAKES A WILD CUT"
 8091 GOTO 8120
 8100 PRINT "HE THRUSTS AT YOUR BODY"
 8105 GOTO 8120
 8110 PRINT "HE TRIES A HEAD CUT"
 8120 IF RND(0)>.5+.3*H2/W2 THEN 8350
 8130 LET X1=1+INT(2.5*RND(0))
 8140 ON X1 GOTO 8150,8160,8170
 8150 PRINT "YOU STOP HIS BLOW ON YOUR SWORD"
 8151 PRINT "AND BACK AWAY"
 8155 GOTO 8050
 8160 PRINT "YOU DUCK UNDER HIS SWORD"
 8161 PRINT "TO ATTACK"
 8165 GOTO 8175
 8170 PRINT "YOU PARRY THEN ATTACK"
 8175 FOR I1=1 TO H3
 8180   IF RND(0)>.1 THEN 8190
 8185   PRINT "YOU MISSED HIM!"
 8186   GOTO 8250
 8190   LET X1=1+INT(2.999*RND(0))
 8195   ON X1 GOTO 8200,8220,8230
 8200   PRINT "YOU GOT HIS LEG"
 8205   LET W2=W2-H2/5
 8206   LET W3=W3-H2/5
 8210   GOTO 8250
 8220   PRINT "YOU HAVE SLASHED HIS ARM"
 8225   LET W2=W2-H2/3
 8226   LET W3=W3-H2/5
 8227   GOTO 8250
 8230   PRINT "YOU SCORE TO HIS BODY"
 8245   LET W2=W2-.1
 8246   LET W3=W3-.25
 8250 NEXT I1
 8251 IF W2<.1 THEN  LET W2=.1
 8255 IF W3>.05 THEN 8050
 8260 PRINT "HE IS DOWN!!"
 8265 PRINT "YOU HAVE FINISHED HIM OFF"
 8290 RETURN
 8350 PRINT "YOU ARE HIT!"
 8355 LET H1=H1-.2
 8356 LET H2=H2-.2
 8357 IF H1<.05 THEN 8370
 8360 PRINT "YOU STAGGER AWAY"
 8361 GOTO 8050
 8370 PRINT "YOU ARE DOWN!!!"
 8380 PRINT "HE CLOSES FOR THE KILL"
 8390 IF RND(0)>.1+E1/20 THEN 8400
 8392 PRINT "YOU MAKE A LUCKY THRUST!!"
 8395 PRINT "HE IS DEAD!!!!"
 8396 RETURN
 8400 PRINT "YOU ARE KILLED"
 8405 GOTO 2990
 8406 END
