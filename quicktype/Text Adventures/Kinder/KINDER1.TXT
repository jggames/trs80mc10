0 CLEAR500:ZZ=0:CC=0:M$="":MC=16384:NV=48:NN=32:DIMV$(NV),V(NV),N$(NN),MAP$(9,8,1),O$(NN),O(99,1),W$(11):GOTO8000
1 ZZ=1:CC=32:FORCC=CC TOZZ STEP-1:I$=MID$(M$,CC,1):IFI$=" "ORI$=""THEN?MID$(M$,ZZ,CC-ZZ):ZZ=CC+1:CC=ZZ+32:IFI$=""THENCC=0
2 CC=CC+(CC>255)*(CC-255):NEXT:M$="":RETURN
7 PRINTM$;:CC=((PEEK(17024)AND1)*256+PEEK(17025))-1+MC:FORZZ=CC-LEN(M$)+1TOCC:POKEZZ,PEEK(ZZ)-64:NEXT:RETURN
20 M$="LOCATION: "+MAP$(X,Y,Z):GOSUB1
21 INPUTA$:IFA$=""THENPRINT"WHAT?":GOTO20
22 FORI=1TO11:W$(I)="":NEXT:N$="":N2$="":N3$="":V$="":S=1:V=0:O=0:W=1:FORI=1TOLEN(A$)+1
24 IFMID$(A$,I,1)=" "THENW$(W)=MID$(A$,S,I-S):S=I+1:W=W+1:IFW=11THENI=255
25 IFMID$(A$,I,1)=""THENW$(W)=MID$(A$,S)
26 NEXT:IFW=1THENV$=LEFT$(A$,3):GOTO30
28 V$=LEFT$(W$(1),3):N$=LEFT$(W$(2),3):N2$=LEFT$(W$(3),3):N3$=LEFT$(W$(4),3)
30 V=0:FORI=1TO NV:IFV$=V$(I)THENV=I:I=NV
32 NEXT
34 O=0:FORI=1TO NN:IFN$=O$(I)THENO=I:I=NN:GOTO50
36 IFN2$=O$(I)THENO=I:I=NN:W$(2)=W$(3):GOTO50
38 IFN3$=O$(I)THENO=I:I=NN:W$(2)=W$(4)
40 NEXT
50 PRINTW$(1),W$(2),V(V),O
90 ONV(V)GOTO1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300
150 GOTO20
1000 REM MOVE
1010 PRINT"MOVING ";:A=0:B=0:C=0:D=V-42:IFW>1THEND=O-24
1011 IFZ>0THENOND GOTO1060,1060,1060,1060,1050,1055
1020 ONDGOTO1030,1035,1040,1045,1050,1055:STOP
1030 Y=Y-1:IFY<1THEN1060
1031 B=1:GOTO1060
1035 Y=Y+1:IFY>8THEN1060
1036 B=-1:GOTO1060
1040 X=X+1:IFX>9THEN1060
1041 A=-1:GOTO1060
1045 X=X-1:IFX<1THEN1060
1046 A=1:GOTO1060
1050 Z=Z+1:IFZ=1ANDMAP$(X,Y,0)="FOREST"THENC=-1:GOTO1060
1051 GOTO1060
1055 Z=Z-1:IFZ=0THENC=1:GOTO1060
1056 GOTO1060
1060 REM MORE GENERIC CHECKS
1061 IFA>0OR B>0 ORC>0THENPRINTW$(2):GOTO1070
1069 X=X+A:Y=Y+B:Z=Z+C:PRINT:PRINT"CAN'T GO THERE.":GOTO1070
1070 GOTO2500
1100 REM GET
1200 REM PUT
1300 REM VIOLENCE
1400 REM FOOD
1500 REM LOOK
1600 REM COMMUNICATE
1700 REM MAKE
1800 REM USE/PUSH
1900 REM PUL/MOVE
2000 REM OPEN/UNLOCK/CLOSE/LOCK
2100 REM TURN
2200 REM STAY/WAIT
2300 REM INVENTORY

2500 REM NEW POST ACTION ROUTINE
2900 GOTO20

8000 CLS:PRINT"PLEASE WAIT...":FORI=1TONV:READV$(I):NEXT
8010 FORI=1TONV:READV(I):NEXT
8020 FORI=1TONN:READN$(I),O(I,0),O(I,1):O$(I)=LEFT$(N$(I),3):NEXT
8030 FORY=1TO8:FORX=1TO9:READMAP$(X,Y,Z):MAP$(X,Y,1)="UP A TREE":NEXT:NEXT
8090 X=8:Y=5:Z=0:GOTO20

9000 DATAGO,ENT,RUN,JUM,CLI,SWI,GET,TAK,GIV,DRO,THR,HIT,KIL,BRE,SHO,SMA,EAT,DRI,EXA,LOO,SEA,REA
9010 DATACAL,GRE,ASK,TAL,FIX,REP,MAK,USE,PUS,PUL,MOV,OPE,UNL,CLO,LOC,TUR,STA,WAI,LIG,INV,N,S,E,W,U,D
9020 DATA 1,  1,  1,  1,  1,  1,  2,  2,  2,  2,  2,  3,  3,  3,  3,  3,  4,  4,  5,  5,  5,  5
9030 DATA 6,  6,  6,  6,  7,  7,  7,  8,  8,  9,  9, 10, 10, 10, 10, 11, 12, 12, 8,13,1,1,1,1,1,1

9100 DATAPAPER,9,5,LEVER,9,5,HANDGUN,9,5,MAN,9,5,UNCONSCIOUS MAN,9,5,DOOR,9,5
9110 DATATREE,9,5,LOG,9,5,FIRE PIT,9,5,PILE OF DIRT,9,5
9120 DATASHOVEL,9,5,MOOSE,9,5,DEAD MOOSE,9,5,BEAR,9,5,DEAD BEAR,9,5
9130 DATADYNAMITE STICK,9,5,RIVER,9,5,LAKE,9,5,CHIPMUNK,9,5,BAG OF PEANUTS,9,5,KEY,9,5,SIGN,9,5,MAP,9,5,FLASHLIGHT,9,5
9140 DATANORTH,-10,0,SOUTH,-11,0,EAST,12,0,WEST,-13,0,UP,-14,0,DOWN,-15,0,STILL,-16,0,INV,-17,0


9200 DATAFOREST,FOREST,BY A PIPELINE,FOREST,FOREST,FOREST,FOREST,LAKESIDE,LAKE
9205 DATAFOREST,S/W CORNER PIPEHOUSE,BEHIND PIPEHOUSE,S/E CORNER PIPEHOUSE,FOREST,FOREST,FOREST,FOREST,LAKESIDE
9210 DATAFOREST,FOREST,W SIDE PIPEHOUSE,INSIDE PIPEHOUSE,E SIDE PIPEHOUSE,FOREST,FOREST,LAKESIDE,LAKE
9220 DATAFOREST,S/W CORNER,FRONT OF PIPEHOUSE,S/E CORNER OF PIPEHOUSE,HIKING TRAIL,HIKING TRAIL,HIKING TRAIL,LAKESIDE,LAKE
9230 DATAHIKING TRAIL,TUNNEL,BY A PIPELINE,HIKING TRAIL,HIKING TRAIL,HIKING TRAIL,FORK IN THE TRAIL,HIKING TRAIL,AT THE HOTEL
9240 DATAFOREST,FOREST,BY A PIPELINE,IN THE FOREST,IN THE FOREST,IN THE FOREST,IN THE FOREST,LAKESIDE,LAKE
9250 DATAFOREST,FOREST,BY A PIPELINE IN A ROCKY GULLY,IN THE FOREST,FOREST,FOREST,FOREST,LAKESIDE,LAKE
9260 DATAFOREST,FOREST,BY A PIPELINE,FOREST,FOREST,FOREST,FOREST,LAKESIDE,LAKE
