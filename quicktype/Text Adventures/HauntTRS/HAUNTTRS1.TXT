0 CLS0:CLEAR500:DIMCC,ZZ,M$,I$:K$="KILL GHOST":R$="READ SIGN"GOTO10
1 ZZ=1:CC=32:FORCC=CCTOZZSTEP-1:I$=MID$(M$,CC,1):IFI$<"!"THEN?MID$(M$,ZZ,CC-ZZ):ZZ=CC+1:CC=ZZ+32:IFI$=""THENCC=.
2 CC=CC+(CC>255)*(CC-255):NEXT:M$="":RETURN
3 IFT$="GET"ORT$="READ"ORT$="OPEN"ORT$="DROP"ORT$="POUR"ORT$="DRINK"ORT$="SMASH"THENGOSUB3010
4 IFT$="PAPER"ORT$="KEY"ORT$="KNIFE"ORT$="ROPE"ORT$="ARMOR"ORT$="CABINET"ORT$="SCROLL"ORT$="SWORD"ORT$="SIGN"THENGOSUB3110
5 RETURN
6 M$="SORRY, ONLY ONE PLUGH PER CUSTOMER.":GOSUB1:RETURN
9 M$="I DON'T UNDERSTAND.":GOSUB1:RETURN

10 PRINT"ÄÄÄÄÄÄÄÄÄÄÄÄÄÄ—ÄÄÄÄÄÄÄÄÄhauntedÄ";
11 PRINT"ÄÄÄÄÄ—“ÄÄÄÄÄÄÄ◊€–ÄÄÄÄÄÄ“ÄÄhouseÄ";
12 PRINT"ÄÄÄÄ—ﬂﬂ“ÄÄÄÄ—ﬂﬂﬂ€ÄÄÄÄ—◊ﬂ“ÄÄÄÄÄÄÄ";
13 PRINT"ÄÄÄ—ﬂﬂﬂﬂ“ÄÄÄ‹ﬂﬂﬂﬁ‹ÄÄ”ﬂﬂüﬂ“ÄÄÄÄÄÄ";
14 PRINT"ÄÄ—ﬂﬂﬂﬂﬂﬂ“ÄÄÄﬂ’Ä⁄ÄÄÄ—ﬂﬂﬂ⁄ÄÄÄÄÄÄÄ";
15 PRINT"—◊ﬂﬂﬂﬂﬂﬂﬁ‹ÿÄ–ﬂ”€⁄–––’⁄’ê⁄ÄÄÄÄÄÄÄ";
16 PRINT"ÄÄﬂﬂ◊Äﬂﬂ€–”””◊ﬂﬂ⁄ﬁﬁﬁﬂ€◊”ﬂ“ÄÄÄÄÄÄ";
17 PRINT"ÄÄﬂﬂ’—ﬂﬂﬂ◊ﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ“ÄÄÄÄÄ";
18 PRINT"ÄÄﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ“ÄÄÄÄ";
19 PRINT"ÄÄﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ”–ÄÄ";
20 PRINT"ÄÄﬂﬂﬂﬂﬂﬂ‹‹ﬂ‹›ﬂ‹‹›ﬂﬂ‹‹‹›ﬂ‹›‹›‹‹ÄÄ";
21 PRINT"ÄÄﬂﬂﬂﬂﬂﬂÄÄ⁄Ä’ﬂ––’ﬂ⁄“›‹›ﬂÄ’–’ÄÄÄÄ";
22 PRINT"ÄÄﬂﬂÄŸ◊ﬂÄÄ⁄Ä’ﬂ––‘ﬂﬁÄ’Ä’ﬂÄ’–’ÄÄÄÄ";
23 PRINT"ÄÄﬂﬂÄ⁄’ﬂﬂﬂﬂﬂﬂﬂ–Äêﬂﬂﬂﬂﬂﬂﬂﬂﬂ”◊“ÄÄÄ";
24 PRINT"ÄÄﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂﬂ”””◊”ÄÄ";
25 PRINT"ÄÄ‹‹‹Ä‘ÄÄÄÄÄÄ‘–ÄÄ‘‹‹‹‹‹‹‹‹–––‘ÿ";
50 PA=0:KY=0:KN=0:RP=0:AR=0:CA=0:SC=0:SW=0:SI=0:BU=0
60 G1=1:G2=1:G3=1:G4=1:G5=0:G6=0:G7=0:G8=0:G9=1:G0=1:SW=0:SI=0
70 GOSUB130

100 M$="HAUNTED HOUSE IS A VERY SIMPLE GAME. THERE ARE NO TREASURES TO FIND.":GOSUB1
110 M$="THERE ARE NO SCORES TO KEEP. THERE IS NO TIME LIMIT.":GOSUB1
120 M$="YOU ONLY HAVE ONE TASK-- GET OUT OF THE HOUSE ALIVE!!":GOSUB1:GOSUB130:GOTO150

130 REM PRESSAKEY:
140 A$=INKEY$:IFA$=""THEN140
141 CLS:RETURN

150 CLS
160 PRINT
170 PRINT "HAUNTED HOUSE"
180 PRINT
190 M$="GENERATIONS HAVE PASSED SINCE THE MCDANIEL FAMILY MYSTERIOUSLY DISAPPEARED.":GOSUB1
200 M$="IT IS SAID THAT A STRANGER CAME TO VISIT ON THAT COLD, "
210 M$=M$+"AUTUMN DAY MANY YEARS AGO, BUT NO ONE KNOWS FOR SURE.":GOSUB1
220 GOSUB140
230 M$="THEIR HOUSE HAS BEEN VACANT FOR DECADES NOW.":GOSUB1:M$="IT'S TWO STORY IMAGE IS "
240 M$=M$+"FORLORN AND LOOMING, VISIBLE ONLY FROM THE NARROW, WINDING ROAD THAT "
250 M$=M$+"IS DISTORTED BY VEGETATION FROM THE SURROUNDING FOREST.":GOSUB1
260 M$="THE STONE WALL THAT ENCOMPASSES THE HOUSE IS DISCOLORED AND BROKEN FROM "
270 M$=M$+"YEARS OF NEGLECT, IT'S IRON GATE RUSTY AND WORN BY ANGRY SEASONS.":GOSUB1:GOSUB140
280 M$="THE WINDOWS ARE BOADED-- THE HOUSE IS QUIET AND CONTENTED, NOT "
290 M$=M$+"ACCUSTOMED TO VISITORS.":GOSUB1:M$="THE WIND IS RESTLESS TODAY, BLOWING FALLEN "
300 M$="LEAVES IN ALL DIRECTIONS.":GOSUB1:M$="AS YOU WALK TOWARDS THE ENTRANCE OF THE HOUSE, "
310 M$=M$+"THE WIND GROWS DISTANT AND WEAK.":GOSUB1:M$="SUDDENLY, THE CALM AND SILENCE IS "
320 M$=M$+"BROKEN BY SOUNDS FROM WITHIN THE HOUSE!":GOSUB1
330 PRINT
340 M$="DO YOU HAVE THE COURAGE TO ENTER?":GOSUB1

350 REM GETYINPUT:
360 A$=INKEY$:IFA$<>"Y"THEN360

370 CLS
380 PRINT"HAUNTED HOUSE!!"

400 REM OUTSIDE OF HOUSE
410 M$="YOU ARE AT THE OUTSIDE OF THE HOUSE. THERE IS A CRUMPLED PIECE OF PAPER ON THE GROUND.":GOSUB1
411 PRINT"THE FRONT DOOR IS CLOSED."
420 INPUTT$:GOSUB3:IFT$="PLUGH"ORT$="SAY PLUGH"THENM$="YOU MATERIALIZE INSIDE THE DOOR.":GOTO510
460 IFT$="GET PAPER"THENPA=1:PRINT"OK":GOTO420
470 IFT$="READ PAPER"ANDPA=1THENM$="IT SAYS, "+CHR$(34)+"MAGIC WORD - PLUGH."+CHR$(34):GOSUB1:GOTO420
480 IFT$="READ PAPER"ANDPA=0THENM$="YOU AREN'T CARRYING IT.":GOSUB1:GOTO420
481 IFT$="OPEN DOOR"THENM$="THE DOOR CAN'T BE OPENED.":GOSUB1:GOTO420
483 IFT$="DOOR"ORT$="PAPER"ORT$="EXAMINE PAPER"THENM$="WHAT SHOULD I DO WITH IT?":GOSUB1:GOTO420
486 IFT$="LOOK"ORT$="LOOK PAPER"ORT$="N"ORT$="S"ORT$="E"ORT$="W"THEN410
488 IFT$="QUIT"THENEND
490 IFLEFT$(T$,3)="INV"ORT$="I"THENGOSUB2910:GOTO420
492 GOSUB9:GOTO420

500 REM FOYER
510 M$="YOU ARE AT THE FOYER.":GOSUB1
520 INPUTT$:GOSUB3:IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6:GOTO510
533 IFT$="DROP PAPER"THENPA=0:PRINT"OK":GOTO510
534 IFT$="E"THEN610
535 IFT$="S"THEN1210
536 IFT$="W"THEN GOTO1310
537 IFT$="DOOR"ORT$="PAPER"THENM$="WHAT SHOULD I DO WITH IT?":GOSUB1:GOTO520
538 IFT$="LOOK"ORT$="N"THEN510
539 IFT$="QUIT"THENEND
540 IFLEFT$(T$,3)="INV"ORT$="I"THENGOSUB2910:GOTO520
550 GOSUB9:GOTO520

600 REM LIVING ROOM
610 M$="YOU ARE AT THE LIVING ROOM.":GOSUB1
620 IFKN=0THENM$="A KNIFE IS LEVITATING IN THE MIDDLE OF THE ROOM.":GOSUB1
630 IFSC=0THENM$="THERE IS A MYSTERIOUS SCROLL ON THE GROUND.":GOSUB1
640 INPUTT$:GOSUB3:IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6:GOTO610
653 IFT$="E"THEN710
654 IFT$="W"THEN510
655 IFT$="GET SCROLL"THENSC=1:PRINT"OK":GOTO640
656 IFT$="READ SCROLL"ANDSC=0THENM$="YOU AREN'T CARRYING IT.":GOSUB1:GOTO640
657 IFT$="READ SCROLL"ANDSC=1THENM$="IT SAYS, "+CHR$(34)+"THERE IS ESCAPE FROM THE SECOND FLOOR!"+CHR$(34):GOSUB1:GOTO640
658 IFT$="GET KNIFE"ANDPA=0THENM$="THE KNIFE FLOATS OUT OF YOUR REACH.":GOSUB1:GOTO640
659 IFT$="GET KNIFE"ANDPA=1THENKN=1:PRINT"OK":GOTO640
660 IFT$="N"ORT$="S"THENM$="SUDDENLY THE KNIFE WHOOSHES DOWN AND SLITS YOUR THROAT! YOU ARE DEAD.":GOSUB1:END
661 IFT$="QUIT"THEN END
662 IFLEFT$(T$,3)="INV"ORT$="I"THENGOSUB2910:GOTO640
663 GOSUB9:GOTO640

700 REM DINING ROOM
710 M$="YOU ARE AT THE DINING ROOM.":GOSUB1
720 INPUTT$
730 GOSUB3
732 IFT$="PLUGH"ORT$="SAY PLUGH"THENM$="SORRY, ONLY ONE PLUGH PER CUSTOMER.":GOSUB1:GOTO710
733 IFT$="S"THEN810
734 IFT$="W"THEN610
735 IFT$="LOOK"ORT$="N"ORT$="E"THEN710
736 IFT$="QUIT"THENEND
737 IFLEFT$(T$,3)="INV"ORT$="I"THENGOSUB2910:GOTO720
738 GOSUB9:GOTO720

800 REM KITCHEN
810 M$="YOU ARE AT THE KITCHEN.":GOSUB1
820 IFBU=0THENM$="A BUCKET OF WATER IS ON THE FLOOR.":GOSUB1
830 INPUTT$:GOSUB3:IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6:GOTO810
843 IFT$="N"THEN710
844 IFT$="W"THEN1210
845 IFT$="S"ANDKN=1THENM$="A SUIT OF ARMOUR HERE FLEES WHEN IT SPOTS YOUR KNIFE.":GOSUB1:GOTO910
846 IFT$="S"ANDKN=0THENM$="YOU ARE IN THE BREAKFAST ROOM. AN ANIMATED ARMOUR SUIT THROWS YOU OUT!":GOSUB1:GOTO810
847 IFT$="GET BUCKET"THENBU=1:PRINT"OK":GOTO820
848 IFT$="POUR WATER"ORT$="POUR BUCKET"THENM$="THE GROUND IS WET. THE BUCKET MAGICALLY REFILLS.":GOSUB1:GOTO820
849 IFT$="DRINK WATER"ANDBU=0THENM$="YOU AREN'T CARRYING IT.":GOSUB1:GOTO820
850 IFT$="DRINK WATER"ANDBU=1THENM$="YOU FEEL SICK. IN FACT, YOU JUST DIED! IT WAS POSION.":GOSUB1:END
851 IFT$="LOOK"ORT$="E"THEN810
852 IFT$="QUIT"THENEND
853 IFLEFT$(T$,3)="INV"ORT$="I"THENGOSUB2910:GOTO820
854 GOSUB9:GOTO820

900 REM BREAKFAST ROOM
910 M$="YOU ARE AT THE BREAKFAST ROOM.":GOSUB1
920 INPUTT$
930 GOSUB3
930 IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6:GOTO910
930 IFT$="N"THEN810
930 IFT$="E"THEN1010
930 IFT$="LOOK"ORT$="S"ORT$="W"THEN910
930 IFT$="QUIT"THENEND
930 IFLEFT$(T$,3)="INV"ORT$="I"THENGOSUB2910:GOTO920
930 GOSUB9:GOTO920

1000 REM SERVANTS QUARTERS1
1010 M$="YOU ARE AT THE SERVANTS QUARTERS. THERE IS A CABINET ON ONE WALL.":GOSUB1
1020 INPUTT$:GOSUB3:IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6:GOTO1010
1041 IFT$="N"THEN1110
1042 IFT$="W"THEN910
1043 IFT$="OPEN CABINET"THENM$="IT'S EMPTY.":GOSUB1:GOTO1020
1044 IFT$="GET CABINET"THENM$="DON'T BE RIDICULOUS!":GOSUB1:GOTO1020
1045 IFT$="LOOK"ORT$="S"ORT$="E"THEN1010
1046 IFT$="QUIT"THENEND
1047 IFLEFT$(T$,3)="INV"ORT$="I"THENGOSUB2910:GOTO1020
1048 GOSUB9:GOTO1020

1100 REM SERVANTS QUARTERS2
1110 M$="YOU ARE AT THE SERVANTS QUARTERS. THERE IS A CABINET ON ONE WALL.":GOSUB1
1120 INPUTT$:GOSUB3:IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6:GOTO1110
1141 IFT$="S"THEN1010
1142 IFT$="OPEN CABINET"THENM$="THERE IS A KEY IN IT.":GOSUB1:GOTO1120
1143 IFT$="GET KEY"THENKY=1:PRINT"OK":GOTO1120
1144 IFT$="LOOK"ORT$="N"ORT$="E"ORT$="W"THEN1110
1145 IFT$="QUIT"THENEND
1146 IFLEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910:GOTO1120
1147 GOSUB9:GOTO1120

1200 REM DEN
1210 M$="YOU ARE AT THE DEN.":GOSUB1
1220 INPUTT$
1230 GOSUB3
1240 IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6:GOTO1210
1242 IFT$="N"THEN510
1243 IFT$="E"THEN810
1244 IFT$="LOOK"ORT$="S"ORT$="W"THEN1210
1245 IFT$="QUIT"THENEND
1246 IFLEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910:GOTO1220
1247 GOSUB9:GOTO1220

1300 REM EAST_END_HALL:
M$="YOU ARE AT THE EAST END OF THE HALL.":GOSUB1
INPUT9: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO1310
IF T$="N" THEN GOTO GREEN_BEDROOM
IF T$="E" THEN GOTO510
IF T$="W" THEN GOTO WEST_END_HALL
IF T$="LOOK" OR T$="S" THEN GOTO1310
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT9
GOSUB9: GOTO INPUT9

1400 REM WEST_END_HALL:
M$="YOU ARE AT THE WEST END OF THE HALL. A LOCKED DOOR BARS THE WAY SOUTH.":GOSUB1
INPUT10: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO WEST_END_HALL
IF T$="N" THEN GOTO BLUE_BEDROOM
IF T$="E" THEN GOTO1310
IF (T$="S" OR T$="OPEN DOOR") AND KY = 1 THEN GOTO MASTER_BEDROOM
IF (T$="S" OR T$="OPEN DOOR") AND KY = 0 THEN M$="YOU'LL NEED A KEY TO GET THROUGH THAT DOOR.":GOSUB1: GOTO INPUT10
IF T$="LOOK" OR T$="W" THEN GOTO WEST_END_HALL
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT10
GOSUB9: GOTO INPUT10

1500 REM GREEN_BEDROOM:
M$="YOU ARE AT THE GREEN BEDROOM. THERE'S A PANEL ON THE WEST WALL.":GOSUB1
INPUT11: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO GREEN_BEDROOM
IF T$="S" THEN GOTO1310
IF T$="PANEL" OR T$="OPEN PANEL" OR T$="GO PANEL" THEN GOTO SECRET_PASSAGE
IF T$="LOOK" OR T$="N" OR T$="E" OR T$="W" THEN GOTO GREEN_BEDROOM
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT11
GOSUB9: GOTO INPUT11

1600 REM SECRET_PASSAGE:
M$="YOU ARE AT THE SECRET PASSAGE.":GOSUB1
IF RP=0 THEN M$="A ROPE IS NEARBY.":GOSUB1
INPUT12: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO SECRET_PASSAGE
IF T$="E" THEN GOTO GREEN_BEDROOM
IF T$="W" THEN GOTO BLUE_BEDROOM
IF T$="GET ROPE" THEN RP=1: PRINT"OK": GOTO INPUT12
IF T$="LOOK" OR T$="N" OR T$="S" THEN GOTO SECRET_PASSAGE
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT12
GOSUB9: GOTO INPUT12

1700 REM BLUE_BEDROOM:
M$="YOU ARE AT THE BLUE BEDROOM. THERE'S A PANEL ON THE WEST WALL.":GOSUB1
INPUT13: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO BLUE_BEDROOM
IF T$="S" THEN GOTO WEST_END_HALL
IF T$="PANEL" OR T$="OPEN PANEL" OR T$="GO PANEL" THEN GOTO SECRET_PASSAGE
IF T$="LOOK" OR T$="N" OR T$="E" OR T$="W" THEN GOTO BLUE_BEDROOM
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT13
GOSUB9: GOTO INPUT13

1800 REM MASTER_BEDROOM: ' MASTER BEDROOM
M$="YOU ARE IN THE MASTER BEDROOM. A WALL OF RAGING FIRE BLOCKS THE WAY EAST.":GOSUB1
INPUT14: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO MASTER_BEDROOM
IF T$="N" THEN GOTO GREEN_BEDROOM
IF T$="E" THEN M$="ARE YOU JUST GOING TO WALK RIGHT THROUGH THAT RANGING FIRE?":GOSUB1: GOTO INPUT14
IF T$="YES" THEN PRINT"OK": GOTO LIBRARY
IF T$="NO" THEN M$="A WISE DECISION.":GOSUB1: GOTO INPUT14
IF T$="LOOK" OR T$="W" OR T$="S" THEN GOTO MASTER_BEDROOM
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT14
GOSUB9: GOTO INPUT14

1900 REM LIBRARY:
M$="YOU ARE AT THE LIBRARY. THERE IS A HOLE IN THE CEILING.":GOSUB1
INPUT15: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO LIBRARY
IF T$="W" THEN GOTO BLUE_BEDROOM
IF T$="DROP ROPE" THEN RP=0: ROPECEILING = 1: M$="INSTANTLY THE ROPE UNWINDS AND LEVITATES TO THE HOLE IN THE CEILING!":GOSUB1: GOTO INPUT15
IF (T$="CLIMB ROPE" OR T$="JUMP ROPE") AND ROPECEILING = 1 THEN M$="YOU DROP EVERYTHING YOU HAD TO CLIMB THE ROPE. YOU REACH THE SECOND FLOOR.":GOSUB1: PA=0: KY = 0: KN=0: RP=0: AR=0: CA=0: SC=0: GOTO DIMLY_ROOM_SWORD
IF T$="LOOK" OR T$="N" OR T$="E" OR T$="S" THEN GOTO LIBRARY
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT15
GOSUB9: GOTO INPUT15

2000 REM DIMLY_ROOM_SWORD:
M$="YOU ARE IN A DIMLY LIT ROOM. THERE IS A HOLE IN THE FLOOR.":GOSUB1
IF SW=0 THEN M$="THERE IS A MAGIC SWORD ON THE FLOOR.":GOSUB1
INPUT16: INPUT ":", T$
GOSUB3
IFT$="PLUGH"ORT$="SAY PLUGH"THENGOSUB6: GOTO DIMLY_ROOM_SWORD
IF T$="E" THEN GOTO DIMLY_ROOM_GHOST1
IF T$="W" THEN GOTO DIMLY_ROOM_GHOST3
IF T$="S" THEN GOTO DIMLY_ROOM_GHOST2
IF T$="GET SWORD" THEN SW=1: PRINT"OK": GOTO INPUT16
IF T$="READ SWORD" THEN M$="AN INCRIPTION READS, "+CHR$(34)+"GHOST KILLER."+CHR$(34)+"":GOSUB1: GOTO INPUT16
IF T$="DROP SWORD" AND SW=1 THEN SW=0: PRINT"OK": GOTO INPUT16
IF T$="DROP SWORD" AND SW=0 THEN M$="YOU'RE NOT CARRYING IT.":GOSUB1: GOTO INPUT16
IF T$="CLIMB ROPE" THEN M$="YOU FALL THROUGH THE HOLE AND BREAK YOUR NECK! YOU ARE DEAD.":GOSUB1: END
IF T$="LOOK" OR T$="N" THEN GOTO DIMLY_ROOM_SWORD
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT16
GOSUB9: GOTO INPUT16

2100 REM DIMLY_ROOM_GHOST1:
M$="YOU ARE IN A DIMLY LIT ROOM.":GOSUB1
IF G1=1 THEN M$="THERE IS A GHOST HERE.":GOSUB1
IF G5=1 THEN M$="THE BODY OF A DEAD GHOST IS ON THE FLOOR.":GOSUB1
INPUT17: INPUT ":", T$
GOSUB3
IF T$=K$ AND G1=1 AND SW=1 THEN G1=0: G5=1: M$="YOUR MAGIC SWORD ENABLES YOU TO KILL THE GHOST!":GOSUB1: GOTO INPUT17
IF T$=K$ AND G1=1 AND SW=0 THEN M$="YOU CAN'T KILL A GHOST WITH YOUR BARE HANDS.":GOSUB1: GOTO INPUT17
IF T$=K$ AND G5=1 THEN M$="THE POOR THING'S ALREADY DEAD.":GOSUB1: GOTO INPUT17
IF T$="KILL SWORD" THEN M$="OUCH! YOU HURT YOUR HAND.":GOSUB1: GOTO INPUT17
IF T$="DROP SWORD" AND SW=1 THEN SW=0: PRINT"OK": GOTO INPUT17
IF T$="DROP SWORD" AND SW=0 THEN M$="YOU'RE NOT CARRYING IT.":GOSUB1: GOTO INPUT17
IF T$="W" THEN GOTO DIMLY_ROOM_SWORD
IF (T$="N" OR T$="E" OR T$="S") AND G5=1 THEN GOTO DIMLY_ROOM_GHOST1
IF (T$="N" OR T$="E" OR T$="S") AND G1=1 THEN M$="THE GHOST WILL NOT LET YOU PASS!":GOSUB1: GOTO INPUT17
IF T$="LOOK" THEN GOTO DIMLY_ROOM_GHOST1
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT17
GOSUB9: GOTO INPUT17

2200 REM DIMLY_ROOM_GHOST2:
M$="YOU ARE IN A DIMLY LIT ROOM.":GOSUB1
IF G2=1 THEN M$="THERE IS A GHOST HERE.":GOSUB1
IF G6=1 THEN M$="THE BODY OF A DEAD GHOST IS ON THE FLOOR.":GOSUB1
INPUT18: INPUT ":", T$
GOSUB3
IF T$=K$ AND G2=1 AND SW=1 THEN G2=0: G6=1: M$="YOUR MAGIC SWORD ENABLES YOU TO KILL THE GHOST!":GOSUB1: GOTO INPUT18
IF T$=K$ AND G2=1 AND SW=0 THEN M$="YOU CAN'T KILL A GHOST WITH YOUR BARE HANDS.":GOSUB1: GOTO INPUT18
IF T$=K$ AND G6=1 THEN M$="THE POOR THING'S ALREADY DEAD.":GOSUB1: GOTO INPUT18
IF T$="KILL SWORD" THEN M$="OUCH! YOU HURT YOUR HAND.":GOSUB1: GOTO INPUT18
IF T$="DROP SWORD" AND SW=1 THEN SW=0: PRINT"OK": GOTO INPUT18
IF T$="DROP SWORD" AND SW=0 THEN M$="YOU'RE NOT CARRYING IT.":GOSUB1: GOTO INPUT18
IF T$="N" THEN GOTO DIMLY_ROOM_SWORD
IF (T$="W" OR T$="E" OR T$="S") AND G6=1 THEN GOTO DIMLY_ROOM_GHOST2
IF (T$="W" OR T$="E" OR T$="S") AND G2=1 THEN M$="THE GHOST WILL NOT LET YOU PASS!":GOSUB1: GOTO INPUT18
IF T$="LOOK" THEN GOTO DIMLY_ROOM_GHOST2
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT18
GOSUB9: GOTO INPUT18

2300 REM DIMLY_ROOM_GHOST3:
M$="YOU ARE IN A DIMLY LIT ROOM.":GOSUB1
IF G3 = 1 THEN M$="THERE IS A GHOST HERE.":GOSUB1
IF G7=1 THEN M$="THE BODY OF A DEAD GHOST IS ON THE FLOOR.":GOSUB1
INPUT19: INPUT ":", T$
GOSUB3
IF T$=K$ AND G3 = 1 AND SW=1 THEN G3 = 0: G7=1: M$="YOUR MAGIC SWORD ENABLES YOU TO KILL THE GHOST!":GOSUB1: GOTO INPUT19
IF T$=K$ AND G3 = 1 AND SW=0 THEN M$="YOU CAN'T KILL A GHOST WITH YOUR BARE HANDS.":GOSUB1: GOTO INPUT19
IF T$=K$ AND G7=1 THEN M$="THE POOR THING'S ALREADY DEAD.":GOSUB1: GOTO INPUT19
IF T$="KILL SWORD" THEN M$="OUCH! YOU HURT YOUR HAND.":GOSUB1: GOTO INPUT19
IF T$="DROP SWORD" AND SW=1 THEN SW=0: PRINT"OK": GOTO INPUT19
IF T$="DROP SWORD" AND SW=0 THEN M$="YOU'RE NOT CARRYING IT.":GOSUB1: GOTO INPUT19
IF T$="E" THEN GOTO DIMLY_ROOM_SWORD
IF T$="W" AND G7=1 THEN GOTO DIMLY_ROOM_UNKILL1
IF (T$="N" OR T$="W" OR T$="S") AND G7=1 THEN GOTO DIMLY_ROOM_GHOST3
IF (T$="N" OR T$="W" OR T$="S") AND G3 = 1 THEN M$="THE GHOST WILL NOT LET YOU PASS!":GOSUB1: GOTO INPUT19
IF T$="LOOK" THEN GOTO DIMLY_ROOM_GHOST3
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT19
GOSUB9: GOTO INPUT19

2400 REM DIMLY_ROOM_UNKILL1:
M$="YOU ARE IN A DIMLY LIT ROOM. THERE IS A GHOST HERE.":GOSUB1
INPUT20: INPUT ":", T$
GOSUB3
IF T$=K$ AND SW=1 THEN G4=0: G8=1: M$="YOUR MAGIC SWORD ENABLES YOU TO KILL THE GHOST!":GOSUB1: GOTO INPUT20
IF T$=K$ AND SW=0 THEN M$="YOU CAN'T KILL A GHOST WITH YOUR BARE HANDS.":GOSUB1: GOTO INPUT20
IF T$="KILL SWORD" THEN M$="OUCH! YOU HURT YOUR HAND.":GOSUB1: GOTO INPUT20
IF T$="DROP SWORD" AND SW=1 THEN SW=0: PRINT"OK": GOTO INPUT20
IF T$="DROP SWORD" AND SW=0 THEN M$="YOU'RE NOT CARRYING IT.":GOSUB1: GOTO INPUT20
IF T$="E" THEN GOTO DIMLY_ROOM_GHOST3
IF T$="N" AND SW=0 AND SOUTH = 1 THEN GOTO DIMLY_ROOM_UNKILL2
IF T$="S" AND SW=0 THEN SOUTH = 1: GOTO DIMLY_ROOM_UNKILL1
IF (T$="N" OR T$="S" OR T$="W") AND SW=1 THEN M$="THE GHOST WILL NOT LET YOU PASS!":GOSUB1: GOTO INPUT20
IF T$="LOOK" THEN GOTO DIMLY_ROOM_UNKILL1
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT20
GOSUB9: GOTO INPUT20

2500 REM DIMLY_ROOM_UNKILL2:
M$="YOU ARE IN A DIMLY LIT ROOM. THERE IS A GHOST HERE.":GOSUB1
INPUT21: INPUT ":", T$
GOSUB3
IF T$="DROP SWORD" AND SW=0 THEN M$="YOU'RE NOT CARRYING IT.":GOSUB1: GOTO INPUT21
IF T$="KILL SWORD" THEN M$="OUCH! YOU HURT YOUR HAND.":GOSUB1: GOTO INPUT21
IF T$=K$ AND SW=0 THEN M$="YOU CAN'T KILL A GHOST WITH YOUR BARE HANDS.":GOSUB1: GOTO INPUT21
IF T$="E" THEN GOTO DIMLY_ROOM_GHOST3
IF T$="W" THEN GOTO DIMLY_ROOM_UNKILL3
IF T$="S" THEN GOTO DIMLY_ROOM_UNKILL1
IF T$="LOOK" OR T$="N" THEN GOTO DIMLY_ROOM_UNKILL2
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT21
GOSUB9: GOTO INPUT21

2600 REM DIMLY_ROOM_UNKILL3:
M$="YOU ARE IN A DIMLY LIT ROOM. THERE IS A GHOST HERE.":GOSUB1
INPUT22: INPUT ":", T$
GOSUB3
IF T$="DROP SWORD" AND SW=0 THEN M$="YOU'RE NOT CARRYING IT.":GOSUB1: GOTO INPUT22
IF T$="KILL SWORD" THEN M$="OUCH! YOU HURT YOUR HAND.":GOSUB1: GOTO INPUT22
IF T$=K$ AND SW=0 THEN M$="YOU CAN'T KILL A GHOST WITH YOUR BARE HANDS.":GOSUB1: GOTO INPUT22
IF T$="E" THEN GOTO DIMLY_ROOM_UNKILL2
IF T$="S" THEN GOTO DIMLY_ROOM_ENDGAME
IF T$="LOOK" OR T$="N" OR T$="W" THEN GOTO DIMLY_ROOM_UNKILL3
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT22
GOSUB9: GOTO INPUT22

2700 REM DIMLY_ROOM_ENDGAME:
M$="YOU ARE IN A DIMLY LIT ROOM. THERE IS A RUSTY OLD SIGN LAYING ON THE GROUND.":GOSUB1
INPUT23: INPUT ":", T$
GOSUB3
IFT$="GET SIGN"THENSI=1: PRINT"OK": GOTO INPUT23
IFT$=R$AND SI=0 THEN M$="YOU ARE NOT CARRYING IT.": GOTO INPUT23
IFT$=R$AND SI=1 THEN READSI=1: M$="THE SIGN SAYS, "+CHR$(34)+"THERE ARE THREE EXITS FROM THIS ROOM. ONLY ONE IS TRUE... YOU MUST KNOW, BUT NOT BE BURDENED BY THIS CLUE!."+CHR$(34)+"":GOSUB1: GOTO INPUT23
IF T$="DROP SIGN" THEN SI=0: PRINT"OK": GOTO INPUT23
IF T$="N" THEN GOTO DIMLY_ROOM_UNKILL2
IF T$="E" OR T$="W" OR T$="S" THEN
    IF SI=1 OR READSI=0 THEN
        M$="YOU FALL THROUGH A TRAP DOOR TO YOUR DEATH!":GOSUB1: END
    ELSE M$="YOU WALK THROUGH A DOOR AND FIND YOURSELF ON A BALCONY. YOU CLIMB DOWN A TREE AND ESCAPE TO SAFETY! CONGRATULATIONS! YOU MADE IT!":GOSUB1: END
    END IF
END IF
IF T$="LOOK" THEN GOTO DIMLY_ROOM_ENDGAME
IF T$="QUIT" THEN END
IF LEFT$(T$,3)="INV"ORT$="I"THEN GOSUB2910: GOTO INPUT23
GOSUB9: GOTO INPUT23


2900 REM INVENTORY
2910 I$="":IFPA=1THENI$=I$+"CRUMPLED PAPER, "
2911 IFKY=1THENI$=I$+"KEY, "
2912 IFKN=1THENI$=I$+"KNIFE, ":GOSUB1
2913 IFRP=1THENI$=I$+"ROPE, ":GOSUB1
2914 IFBU=1THENI$=I$+"WATER BUCKET, ":GOSUB1
2915 IFSC=1THENI$=I$+"SCROLL, ":GOSUB1
2916 IFSW=1THENI$=I$+"MAGIC SWORD, ":GOSUB1
2917 IFSI=1THENM$="RUSTY SIGN":GOSUB1
2920 IFI$=""THENI$="NOTHING, "
2930 M$="YOU ARE CARRYING: "+LEFT$(I$,LEN(I$)-2)+".":GOSUB1
2950 RETURN

3000 REM GETNOUN:
3010 V$=T$
3020 INPUT"WHAT";N$
3030 T$=V$+" "+N$
3040 RETURN

3100 REM GETVERB:
3110 N$=T$
3120 INPUT"WHAT DO YOU WANT ME TO DO WITH  IT";V$
3130 T$=V$+" "+N$
3140 RETURN

4000 REM CONVERSION TO BASIC
4010 REM DONALD FOSTER
4020 REM MC-10 EDITS JIM GERRIE
