1 REM THE WIZARD'S SWORD - P. KIRSCH - #20
5 GOTO200
10 ONAGOTO0,0,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46
13 PRINTJ$"CROSSROADS":W=5:N=15:E=9:S=4:Z1=0:KD=0:GOTO320
14 PRINTJ$"ICE":W=35:N=3:E=36:S=4:RD=0:GOTO320
15 PRINTJ$"MOON":W=6:N=5:E=3:S=5:KD=1:GOTO320
16 PRINTJ$"RIDDLES. THERE IS A STATUE HERE":W=7:E=5:GOTO1700
17 PRINTJ$"OOPS":W=8:E=6:GOTO320
18 PRINTJ$"DEAD ENDS":W=8:N=8:E=7:S=8:GOTO320
19 PRINTJ$"SUN":W=3:N=9:E=10:S=9:KD=3:GOTO320
20 PRINTJ$"DARKNESS":W=9:E=11:GOTO320
21 PRINTJ$"DREAMS":W=10:E=12:GOTO320
22 PRINTJ$"THE DRAGON":W=11:E=13:GOTO320
23 PRINTJ$"HILLS":W=12:GOTO320
24 PRINT"IN A DARK CAVE":W=13:GOTO320
25 PRINTJ$"STARS":W=15:N=16:E=15:S=3:KD=2:GOTO320
26 PRINTJ$"ALL-WAYS":W=18:N=21:E=22:S=15:WN=0:GOTO320
27 PRINTJ$"THE SHIFTING SANDS":N=18:SY=1:GOTO320
28 PRINTJ$"4 CORNERS":W=19:N=20:E=16:S=17:GOTO320
29 PRINTJ$CHR$(34)"POOF"CHR$(34):E=18:GOTO320
30 PRINTJ$"THE CONDOR":S=18:GOTO320
31 PRINTJ$"HORACE GREELY":W=24:N=15:E=15:S=16:GOTO320
32 QW=QW+1:PRINTJ$"THE DWARVES";:W=16:E=23:IFDC=0THENPRINT". THERE IS A DWARF CHILD HEREPLAYING WITH AND LOOKING THROUGH WHAT APPEARS TO BE A":PRINTA$(P):GOTO320ELSEPRINT"":GOTO320
33 PRINTJ$"THE DWARVES. THERE ARE MANY HUTS HERE":W=22:E=22:GOTO320
34 PRINTJ$"OF SILVER":W=24:N=24:E=21:S=24:GOTO320
35 PRINT"IN HUT #1. ON THE WALL ARE CRUDE ETCHINGS, ONE OF A RED  KINGDOM, A BLUE KINGDOM, A YELLOW KINGDOM, AND A GREEN KINGDOM":S=23:GOTO320
36 PRINT"IN HUT #2":S=23:GOTO320
37 PRINT"IN HUT #3":S=23:GOTO320
38 PRINTJ$"MANY PATHS":W=29:N=28:E=28:S=30:GOTO320
39 PRINTJ$"MEDUSA":W=29:N=29:E=28:S=29:GOTO320
40 PRINTJ$"MEDUSA":W=29:N=28:E=31:S=29:GOTO320
41 PRINTJ$"MEDUSA":W=28:N=32:E=29:S=29:GOTO320
42 PRINTJ$"MEDUSA":W=28:N=28:E=28:S=31:Z1=0:PRINT"A STRANGE GREEN DOOR BLOCKS YOUR WAY"GD$:GOTO320
43 PRINTJ$"ALMOST THERE":PRINT"THERE IS A WOODEN DOOR HERE"SD$:S=32:GOTO320
44 S=33:PRINTJ$"THE SPIDER":GOTO320
45 PRINTJ$"ICE":W=36:N=4:E=4:S=4:GOTO320
46 PRINTJ$"ICE":W=4:N=4:E=4:S=35:GOTO320
200 CLEAR300:DIMA$(27),A(27),B$(27),D(27),C(20),P(22)
210 FORA=1TO27:READA$(A),A(A):NEXT:FORA=1TO27:READB$(A):NEXT:FORA=5TO27:READD(A):NEXT
220 J$="IN THE VALLEY OF ":A=3:P=22:KD$(1)="YELLOW":KD$(2)="BLUE":KD$(3)="RED":KD$(4)="GREEN":P(20)=23:P(21)=20:P(22)=21:GS$="BARRING YOUR WAY"
300 N=0:W=0:E=0:S=0:X5=0:CLS:IFA<35IFA>5IFA<>15IFA<>9PRINT"YOU'RE IN THE "KD$(KD)" KINGDOM"
303 IFEY=1PRINT"EVERYTHING IS DARK, BUT YOU CAN FEEL THE HOT BREATH OF HISSING  SNAKES BEHIND YOU":PRINT:PRINT:PRINT:PRINT:GOTO381
305 PRINT"YOU'RE ";
306 IFA=22IFQW>1IF(DC=0)*(RND(25)<15)THENDC=1:QX=1:A(24)=0ELSEIFDC=1IFRND(5)<>3A(24)=-22:QX=1:DC=0
310 GOTO10
320 IFSY=1IFSS<6IFSN=0SS=SS+1:IFSS=5A(27)=17
321 IFDR=2IF((A=36)*(A(19)=0)*(I2=1))+((A=35)*(SW=0)*(I1=1))A(26)=-A:A$(26)="DRAGON":DR=3
322 IFGW=0IFA(12)=-1IFA(13)=-1IFA(14)=-1IFA(15)=-1IFA(16)=-1GW$=" (GLOWING)":GW=1
340 IFXV=0IFSW=1FORHI=1TO20:IFC(HI)>11IFC(HI)<17C(HI)=0
341 IFXV=0IFSW=1NEXT:XV=1
357 PRINT:IFN+W+E+S>0PRINT"VISIBLE EXITS: ";
358 FORB=1TO4:B(B)=0:NEXT
360 IFW>0B(1)=W:PRINT" WEST";
361 IFN>0B(2)=N:PRINT" NORTH";
362 IFE>0B(3)=E:PRINT" EAST";
363 IFS>0B(4)=S:PRINT" SOUTH";
370 PRINT:PRINT:IFZ2=0IFA=10ORA=14THEN375
371 FORB=1TO27:IFABS(A(B))=ATHENC=C+1:GOTO373
372 NEXT:PRINT:GOTO375
373 IFC=1PRINT"VISIBLE ITEMS:"
374 PRINT"  "A$(B):GOTO372
375 IFZ1>0Z1=Z1+1:IFZ1=5Z1=0
376 IFZ1=0IF(A=12ANDDR=1)ORA(9)=-AOR(A=34ANDSK=0)FORHI=1TO2000:NEXT:PRINT"SUDDENLY YOU FEEL TREMENDOUS FEAR,":PRINT"AND ARE DEADLY AFRAID.":PRINT"YOU RUN OFF":FORHI=1TO1000:NEXT:A=A1:GOTO5100
377 IFUN=2IF(UC=0)*(A>34)THENPRINT"UNICORN MISSES YOU, AND RAMS":PRINT"ITS HORN AGAINST THE ICEBERG":PRINT"SMASHING IT TO PIECES":UN=1:A$(A-33)="CHUNKS OF ICE":A(A-17)=A:UC=1:GOTO5100ELSEIFA<35PRINT"IT MISSES YOU...":GOTO1840
378 IFUN=2IFUC=1IFA>34PRINT"UNICORN MISSES YOU AGAIN AND":PRINT"RAMS ITS HORN INTO THE ICEBERG,":PRINT"BUT THIS TIME IT GETS STUCK.":PRINT"IT CAN'T FREE ITSELF":UN=3:A$(25)="ANGRY UNICORN (STUCK IN ICEBERG)":GOTO5100
379 IFA=5ORA=15ORA=9ORA=28IFA1=3OREK=1PRINT"YOU HAVE ENTERED THE "KD$(KD)" KINGDOM":EK=0
380 IFA=12IFDR=0PRINT"YOU SEE A GROUP DWARVES SURROUNDING THE POOR CHAINED DRAGON. TWOOF THEM ARE MERCILESSLY KICKING THE POOR BEAST ON ITS REAR END  WHILE THE OTHERS ARE HOLDING WIENERS ON LONG WOODEN STICKS,"
381 IFMS>0THENMS=MS+1ELSEIFA=12IFDR=0PRINT"ROASTING THEM EACH TIME THAT THE POOR DRAGON YELPS AND SPITS OUTFIRE"
382 IF(A=6)*(RS=0)THENPRINTCHR$(34)"WHAT IS IT THAT NO MAN WANTS,":PRINT"YET NO MAN WANTS TO LOSE?"CHR$(34)ELSEIFA=17IF(SN=0)*(SS=5)SN=1:PRINT"THE SANDS HAVE SHIFTED..."
383 IFA=11IFRD=0PRINT"YOU FALL ASLEEP...":FORHI=1TO2000:NEXT:PRINT"YOU AWAKEN ONE DAY LATER...":FORHI=1TO20:IFC(HI)<>0THENPRINT"DURING THE NIGHT SOMEONE STOLE SOMETHING...":A(C(HI))=27:C(HI)=0:RD=1ELSENEXT
384 IF(DC=0)*(QX=1)THENPRINTA$(24)" REAPPEARS..."ELSEIFDC=1IFQX=1PRINTA$(24)" DISAPPEARS..."
385 QX=0:IFDR=3PRINT"DRAGON SAYS, "CHR$(34)"BECAUSE YOU HAVE FREED ME, I WILL HELP YOU AGAIN"CHR$(34):PRINT"IT BREATHES HOT FIERY BREATH ONTO THE ICEBERG AND MELTS IT":PRINT"THE DRAGON THEN VANISHES FOREVER MORE":A(26)=0
386 IF(MS=0)*(SK=1)*(A=34)THENPRINT"ON A WALL, YOU SEE A":PRINT"TERRIFYING SHADOW CREEPING UP BEHIND YOU.":PRINT"WHAT DO YOU FEED SNAKES?":MS=1ELSEIFDR=3THENDR=4:A$(A-33)="PUDDLE OF WATER":A(A-17)=A:GOTO5000
387 IFMS=2ORMS=3THENPRINT"SHE'S GETTING CLOSER"ELSEIFMS=4THENPRINT"YOU CAN FEEL THE HOT BREATH OF THE SNAKES"ELSEIFMS>4PRINT"A SNAKE HAS BITTEN YOU":GOTO6700
388 IFA=19IFWN=0FORHI=1TO2000:NEXT:PRINT"P O O F":A=14+RND(9):GOTO5100
390 ONERRORGOTO3000:C=0:X5=0:PRINT:PRINT"WHAT DO YOU WANT TO DO";:INPUTA$:PRINT:IFA$="LOOK"THEN300ELSEIFA=7IFA$="W"IFFF=0PRINT"OOPS...":PRINT"MAGICAL FORCEFIELD STOPS YOU":GOTO390
391 IFA=12IFA$="E"IFDR=0THENPRINT"THE DWARVES NOTICE YOU AND":PRINT"RUN OFF IN ALL DIRECTIONS":DR=1:GOTO5100ELSEIFDR=1PRINT"GIANT DRAGON BLOCKS YOUR PATH":PRINT"IT LIES THERE MOANING":GOTO390
392 IFMS>0IFA$="S"PRINT"RIGHT INTO MEDUSA":GOTO6700
394 FORB=1TO4:IFA$=B$(B)THEN395ELSENEXT:GOTO409
395 IFB(B)<>0THENA1=A:A=B(B):X5=76:IF(UN=0)*(A1=3)*(A$="N")THENUN=1:PRINT"UNICORN WAKES UP...":A=A1:A$(25)="ANGRY UNICORN (IT HATES PEOPLE)":GOTO5100ELSEIFUN=1IFA(25)=-A1THENX5=99:PRINT"UNICORN KICKS UP DUST,":PRINT"AND STARTS TO CHASE YOU,":A(25)=-A
396 IFX5=99PRINT"HIS SINGLE HORN APPEARING":PRINT"MENACINGLY LARGER":UN=2:FORHI=1TO2300:NEXT
397 IFX5=76ORX5=99THENZ5=0:Z2=0:Z4=0:GOTO300
407 PRINT"YOU CAN'T MOVE THAT WAY":GOTO390
409 IFA$<>"I"THEN425ELSEPRINT"YOU ARE CARRYING:":IFSW=1PRINT"THE WIZARD'S SWORD"GW$:PRINT"   ATTACHED TO THE SWORD IS:":FORHI=12TO16:IFA(HI)=-1THENPRINT"   A "A$(HI):JS=1
410 IFSW=1NEXT:IFJS=0PRINT"   NOTHING"
416 JS=0:FORK=1TO20
418 IFC(K)<>0PRINT" "A$(C(K))
420 NEXT:GOTO390
425 FORB=5TO27:F=LEN(B$(B)):IFLEFT$(A$,F)=B$(B)THEN450ELSENEXT:PRINT"I DON'T KNOW WHAT "CHR$(34)A$CHR$(34)" MEANS":GOTO390
450 D$=RIGHT$(A$,(LEN(A$)-F)-1):E$=RIGHT$(D$,3):IFD$="PLASTIC"PRINT"PLEASE REPEAT AND USE COLOR OF "D$:PRINT"(FOR EXAMPLE, "B$(B)" RED)":GOTO390
451 IFA(9)=-AIFD$="CONDOR"IFB$(B)<>"LOOK"PRINT"CONDOR FLAPS ITS GIANT WINGS":PRINT"AND ANGRILY FLIES OFF TO SOMEWHERE ELSE":A(9)=-(RND(9)+14):A$(9)=D$:GOTO5100
452 IFD(B)<>1THEN490
453 IFA(9)=-AIFE$="KEY"IFZ4=0THEND$="CONDOR":GOTO451ELSEJ=17:PRINT"AS YOU REMOVE THE KEY,":PRINT"CONDOR WAKES UP AND FLIES AWAY":A(9)=0:GOTO480
454 IFE$="LUE"IF(A=22ANDP=AANDDC=0)THEN1800ELSEIFA(22)<>ATHENPRINT"THERE'S NO "A$(22)" HERE":GOTO390ELSEJ=22:GOTO480
455 IFE$="RED"IF(A=22ANDP=21ANDDC=0)THEN1800ELSEIFA(21)<>ATHENPRINT"THERE'S NO "A$(21)" HERE":GOTO390ELSEJ=21:GOTO480
456 IFE$="LOW"IF(A=22ANDP=20ANDDC=0)THEN1800ELSEIFA(20)<>ATHENPRINT"THERE'S NO "A$(20)" HERE":GOTO390ELSEJ=20:GOTO480
457 IFE$="WEL"IFA(12)=ATHENJ=12:GOTO480ELSEIFA(13)=ATHENJ=13:GOTO480ELSEIFA(14)=ATHENJ=14:GOTO480ELSEIFA(15)=ATHENJ=15:GOTO480ELSEIFA(16)=ATHENJ=16:GOTO480
463 FORJ=1TO27:IFE$=RIGHT$(A$(J),3)ANDA=ABS(A(J))THEN469
464 NEXT
465 PRINT"THERE'S NO "D$" HERE.":GOTO390
469 IFE$="ORD"IFSW=0SW=1:A(18)=0:GOTO5050
479 IFA(J)<0PRINT"YOU CAN'T CARRY THAT":GOTO390
480 IF(SW=1)*((J>11)*(J<17))THENA(J)=-1:GOTO5050ELSEFORK=1TO20:IFC(K)=0THENC(K)=J:A(J)=-1:GOTO5050ELSENEXT
490 IFD(B)<>2THEN620
491 IF(SW=1)*(E$="ORD")THENPRINT"SWORD REFUSES TO LET GO.":PRINT"IT CLINGS ON TO ITS NEW MASTER":GOTO390ELSEIFE$="WEL"OR(A(12)=-1ANDE$="DOM")ORE$="GTH"ORE$="EEP"ORE$="AGE"ORE$="GHT"PRINT"WISE WIZARDS DO NOT DROP MAGIC JEWELS":GOTO390
492 IFD$="YELLOW"IFA(20)=-1J=20:IFPO=0THEN1850ELSEA$(20)=LEFT$(A$(20),23):A$(20+PO)=LEFT$(A$(20+PO),P(20+PO)):PO=0:IFB$(B)="REMOVE"THEN5050ELSE1850
493 IFD$="RED"IFA(21)=-1J=21:IFPO=0THEN1850ELSEA$(21)=LEFT$(A$(21),20):A$(19+PO)=LEFT$(A$(19+PO),P(19+PO)):PO=0:IFB$(B)="REMOVE"THEN5050ELSE1850
494 IFD$="BLUE"IFA(22)=-1J=22:IFPO=0THEN1850ELSEA$(22)=LEFT$(A$(22),21):A$(18+PO)=LEFT$(A$(18+PO),P(18+PO)):PO=0:IFB$(B)="REMOVE"THEN5050ELSE1850
500 FORJ=1TO27:IFE$=RIGHT$(A$(J),3)IFA(J)<>-1THEN505ELSE510
505 NEXT
510 FORK=1TO20:IFC(K)=JTHENC(K)=0:A(J)=0:GOTO525ELSENEXT
513 PRINT"YOU'RE NOT CARRYING IT":GOTO390
525 A(J)=A
530 PRINT"OK!"
590 GOTO5100
620 IFD(B)<>3THEN660ELSEIFE$="ROD"IFA(4)=-1IF(A=18)*(WN=0)WN=1:PRINT"P O O F":GOTO390
622 PRINT"NOTHING HAPPENED":GOTO390
660 IFD(B)<>4THEN670ELSEIFE$="WEL"THENPRINT"RUB WHICH COLOR?":PRINT"(FOR EXAMPLE, RUB AQUAMARINE)":GOTO390ELSEIFA(13)=-1IFE$="RED"IFA=10ORA=14THENPRINT"IT'S GETTING LIGHT":Z2=1:GOTO5100ELSEPRINT"NOTHING SEEMS TO HAPPEN":GOTO390
661 IFE$="LUE"IFA(15)=-1IF(SK=0)*(A=34)THENSK=1:PRINT"SPIDER FALLS ASLEEP":A$(11)="SLEEPING SPIDER":GOTO5100ELSEIF(A(9)=-A)*(Z4=0)THENZ4=1:PRINT"CONDOR FALLS ASLEEP":A$(9)="SLEEPING CONDOR":GOTO5100ELSEPRINT"NO EFFECT...":GOTO390
662 IF(E$="VER")*(A(16)=-1)THENPRINT"YOU FEEL STRONGER...":Z5=1:GOTO390ELSEIFE$="EEN"IFA(14)=-1PRINT"YOU FEEL BRAVE...":Z1=1:GOTO390
663 IFE$="LOW"IFA(12)=-1THENIF(RS=0)*(A=6)PRINT"THE WORD 'LAWSUIT' FLASHES THROUGH YOUR MIND":GOTO390ELSEPRINT"YOU DON'T FEEL ANY SMARTER":GOTO390
670 IFD(B)<>5THEN700ELSEIF(E$="LUE"ANDA(22)=-1)OR(E$="RED"ANDA(21)=-1)OR(E$="LOW"ANDA(20)=-1)THENPRINT"ON WHAT? (EXAMPLE: ON RED)":GOTO390ELSE491
700 IFD(B)<>6THEN730ELSEIFA=23IFE$="HUT"THENPRINT"WHICH ONE, 1, 2, OR 3":PRINT"(ENTER NUMBER OF CHOICE)";:INPUTA$:IFA$="1"THENA=25:GOTO300ELSEIFA$="2"THENA=26:GOTO300ELSEIFA$="3"THENA=27:GOTO300ELSEPRINT"THERE ARE ONLY 3 HUTS":GOTO390
702 IF(A=13)*(E$="AVE")THENA=14:GOTO300ELSEIFE$="OOR"IF(A=32)*(GD=2)THENA=33:GOTO300ELSEIFA=33IFSD=1A=34:A1=33:GOTO300
730 IFD(B)<>7THEN788ELSEIFUN=3IFA(25)=-AIFE$="ORN"PRINT"YOU PULL THE POOR UNICORN FREE":PRINTCHR$(34)"THANK YOU,"CHR$(34)" IT SAYS. "CHR$(34)"HUMANS AREN'T SO BAD AFTER ALL.":PRINT"LET ME GIVE YOU A SMALL PRESENT"CHR$(34):X5=30
732 IFX5=30PRINT"IT DROPS SOMETHING AT YOUR FEET":PRINT"AND VANISHES FOR EVERMORE":UN=4:A(25)=0:A(13)=A:GOTO5000
788 IFD(B)<>8THEN800ELSEIFSW=0THENPRINT"YOU HAVE NO SWORD":GOTO390ELSEIF(A=12)*(E$="GON")*(DR<3)THENPRINT"YOU BARELY BRUISED IT":GOTO390ELSEIFSK=0IFA=34IFE$="DER"PRINT"YOU CAN'T KILL IT":GOTO390
791 IF(A=22)*((E$="ILD"ORE$="ARF"))THENPRINT"I WON'T LET YOU KILL THE "A$(24):GOTO390ELSEIFMS>0IFGW=0IFE$="USA"PRINT"SWORD IS POWERLESS":GOTO390
792 IF(A(9)=-A)*(D$="CONDOR")THENPRINT"YOU STRIKE A BLOW, BUT":Z4=0:GOTO451ELSEIFMS>1IFE$="USA"PRINT"YOU TURN AROUND,":IFEY=0THENPRINT"AND STARE INTO HER FACE.":PRINT"YOU HAVE BEEN TURNED INTO STONE":GOTO6700ELSEX5=31
793 IFX5=31PRINT"YOU STRIKE A HEAVY BLOW.":PRINT"YOU HOLD HER DISMEMBERED HEAD UP HIGH":PRINT"AND STAND IN TRIUMPH":GOTO6710
800 IFD(B)<>9THEN830ELSEIF(A=26)*(E$="EST")*(HC=0)THENPRINT"IT'S LOCKED ":GOTO390ELSEIFE$="OOR"IFA=32IFGD=0THENPRINT"IT'S LOCKED":GOTO390ELSEIFGD=1GD$=" BUT IS OPEN":GD=2:GOTO5050
802 IFA=33IFE$="OOR"IFSD=0IFZ5=0THENPRINT"THE DOOR SEEMS TO BE STUCK":GOTO390ELSEPRINT"OOF...OKAY...":SD$=" WHICH IS OPEN":SD=1:GOTO5100
804 IF(E$="AIN"ANDDR<3ANDA=12)OR(A=6ANDE$="TUE"ANDFF=0)PRINT"TRY: UNLOCK":GOTO390
830 IFD(B)<>10THEN850ELSEIFA=33IFE$="OOR"IFSD=1THEN1000ELSE802
832 IFA=14IFE$="DER"IFGF=0IFZ5=0THENPRINT"IT'S FAR TOO HEAVY TO MOVE":GOTO390ELSEGF=1:PRINT"YOU SEE SOMETHING":A(12)=A:GOTO5100
850 IFD(B)<>11THEN900ELSEIF(A=32)*(E$="OOR")*(GD=0)*(A(8)=-1)THENPRINT"OK. DOOR'S UNLOCKED":GD=1:GOTO390ELSEIFA=6IFE$="TUE"ORE$="ASE"IFFF=0IFRS=1IFA(19)=-1THENPRINT"CLICK":FF=1:GOTO390ELSEPRINT"YOU NEED A YELLOW KEY":GOTO390
860 IFA(17)=-1IFHC=0IFA=26IFE$="EST"PRINT"YOU OPEN THE HOPE CHEST":PRINT"AND OUT SPRINGS BOB HOPE.":PRINT"HE THANKS YOU FOR RESCUING HIM.":PRINT"HE GIVES YOU SOMETHING":PRINT"AND RUNS OFF":A(8)=-1:C(20)=8:HC=1:GOTO5000
870 IFA=12IFDR=1IFE$="AIN"ORE$="GON"IFA(27)=-1THENPRINT"YOU FREED THE DRAGON!":PRINT"HE IS SO GRATEFUL THAT HE DROPS":PRINT"A PRESENT AT YOUR FEET":PRINT"AND THEN VANISHES":DR=2:A(21)=A:A(26)=0:GOTO5000ELSEPRINT"YOU NEED A RED KEY":GOTO390
900 IFD(B)<>12THEN910ELSEPRINTCHR$(34)D$CHR$(34):IFA=6IFRS=0IFD$="LAWSUIT":PRINT"STATUE MOVES ONE OF ITS ARMS":PRINT"AND DROPS SOMETHING NEAR YOUR FEET.":PRINT"YOU ALSO HEAR A SLIDING SOUND":PRINT"NEAR THE BASE OF THE STATUE":RS=1:A(20)=6:GOTO5000
905 GOTO390
910 IFD(B)<>13THEN925ELSEIFEY=1THENPRINT"HOW?":GOTO390ELSEIFE$="ERG"ORE$="ICE"IF(A=35)*(SW=0)*(A(18)=0)THENPRINT"THERE'S A FROZEN SWORD":I1=1:GOTO390ELSEIFA=36IFA(19)=0PRINT"YOU SEE A YELLOW KEY DEEP IN THE ICE":I2=1:GOTO390
911 IFE$="ROD"IFA(4)=-1PRINT"THE WORD 'POOF' IS ETCHED IN IT":GOTO390
912 IF(E$="DOR")*(A(9)=-A)THENPRINT"THERE'S A BLUE KEY HANGING AROUND ITS NECK":GOTO390ELSEIFA=6IFRS=1IFE$="ASE"ORE$="TUE"PRINT"THERE'S A YELLOW KEYHOLE IN THE BASE":GOTO390
914 IF(DR<2)*(A=12)*(E$="GON")THENPRINT"THE CHAIN'S RED":GOTO390ELSEIFE$="LOW"IFA(20)=-1IFPO=0PRINT"EVERYTHING LOOKS YELLOW":IFKD=1THEN390ELSEA2=5:KD=1:EK=1:GOTO1830ELSEIFPO=1THENPRINT"EVERYTHING LOOKS ORANGE":GOTO390ELSEX5=55
915 IFX5=55IFPO=2PRINT"EVERYTHING LOOKS GREEN":IFKD=4THEN390ELSEA2=28:KD=4:EK=1:GOTO1830
916 IFE$="RED"IFA(21)=-1IFPO=0PRINT"EVERYTHING LOOKS RED":IFKD=3THEN390ELSEA2=9:KD=3:EK=1:GOTO1830
917 IFE$="RED"IFA(21)=-1IFPO=1THENPRINT"EVERYTHING LOOKS ORANGE":GOTO390ELSEIFPO=3PRINT"EVERYTHING LOOKS PURPLE":GOTO390
918 IFE$="LUE"IFA(22)=-1IFPO=0PRINT"EVERYTHING LOOKS BLUE":IFKD=2THEN390ELSEA2=15:KD=2:EK=1:GOTO1830
919 IFE$="LUE"IFA(22)=-1IFPO=2THENPRINT"EVERYTHING LOOKS GREEN":IFKD=4THEN390ELSEKD=4:A2=28:EK=1:GOTO1830ELSEIFPO=3PRINT"EVERYTHING LOOKS PURPLE":GOTO390
920 IFA=13IFE$="ILL"PRINT"THERE'S A CAVE":GOTO390
922 PRINT"YOU SEE NOTHING SPECIAL":GOTO390
925 IFD(B)<>16THEN940ELSEIFE$="YES"IFMS=0THENPRINT"NOT NOW...WAIT FOR MEDUSA":GOTO390ELSEEY=1:PRINT"YOU COVER YOUR EYES WITH ONE HAND":GOTO5100
940 IFD(B)<>19THEN1000
941 IFE$="LOW"IFA(20)=-1IFPO=0IFA(21)=-1M=20:N=21:D$="YELLOW":U$="RED":PO=1:GOTO1810
942 IFE$="LOW"IFA(20)=-1IFPO=0IFA(22)=-1M=20:N=22:D$="YELLOW":U$="BLUE":PO=2:GOTO1810
943 IFE$="RED"IFA(21)=-1IFPO=0IFA(20)=-1THENE$="LOW":GOTO941
944 IFE$="RED"IFA(21)=-1IFPO=0IFA(22)=-1M=21:N=22:D$="RED":U$="BLUE":PO=3:GOTO1810
945 IFE$="LUE"IFA(22)=-1IFPO=0IFA(20)=-1THENE$="LOW":GOTO942ELSEIFA(21)=-1THENE$="RED":GOTO944
1000 PRINT"SORRY, YOU CAN'T DO THAT":GOTO390
1700 IFRS=0THENPRINT"AND IN ONE HAND IT APPEARS TO BE HOLDING SOMETHING. AS YOU      APPROACH, ITS LIPS MOVE AND IT BEGINS TO SPEAK":GOTO320
1701 PRINT"":GOTO320
1800 PRINT"DWARF CHILD WON'T GIVE IT TO YOU":GOTO390
1810 A$(M)=A$(M)+" (CLINGING TO A PIECE OF "+U$+" PLASTIC)":Y=Y+1:IFY=2THENY=0:PRINT"OK":GOTO390
1811 U$=D$:M=N:GOTO1810
1830 PRINT"SUDDENLY EVERYTHING SPINS,":PRINT"AND BEGINS TO FADE.":PRINT"AS THINGS REAPPEAR, YOU FIND":PRINT"YOU ARE ELSEWHERE":A=A2:MS=0:GOTO5000
1840 PRINT"AND STANDS THERE FOR A MOMENT":PRINT"DISORIENTED":UN=1:PRINT:GOTO378
1850 IFA<>22ORDC=1THEN510ELSEPRINT"DWARF CHILD TRADES HIS "A$(P):PRINT"FOR YOUR "A$(J):A(J)=0:FORHI=1TO20:IFC(HI)=JTHENC(HI)=P:A(P)=-1:P=J:GOTO5100ELSENEXT
2000 DATAICEBERG,-4,ICEBERG,-35,ICEBERG,-36,SHORT ROD,10,TALL HILL,-13,LARGE BOULDER,-14,STATUE,-6,GREEN KEY,0,GIANT CONDOR,-20,HOPE CHEST,-26,GIANT SPIDER,-34
2010 DATAYELLOW JEWEL OF WISDOM,0,RED JEWEL OF LIGHT,0,GREEN JEWEL OF COURAGE,19,BLUE JEWEL OF SLEEP,8,SILVER JEWEL OF STRENGTH,24,BLUE KEY,0,THE WIZARD'S SWORD,0,YELLOW KEY,0,PIECE OF YELLOW PLASTIC,0,PIECE OF RED PLASTIC,0,PIECE OF BLUE PLASTIC,0,"",0
2020 DATADWARF CHILD,-22,SLEEPING UNICORN,-3,CHAINED DRAGON,-12,RED KEY,0
2100 DATAW,N,E,S,GET,DROP,REMOVE,GIVE,WAVE,RUB,PUT,GO,ENTER,PULL,FREE,KILL,ATTACK,OPEN,MOVE,PUSH,UNLOCK,ANSWER,SAY,LOOK,CLOSE,COVER,ON
2110 DATA1,2,2,2,3,4,5,6,6,7,7,8,8,9,10,10,11,12,12,13,16,16,19
3000 PRINTA$" WHAT?":RESUME390
5000 C=0:PRINT:INPUT"HIT ENTER";A$:GOTO300
5050 PRINT"OK"
5100 C=0:FORHI=1TO2000:NEXT:GOTO300
6700 PRINT"YOU'RE DEAD"
6710 PRINT"THIS ADVENTURE IS OVER"
8010 CLS:PRINTCHR$(32);:PRINT@332,"T H E   W I Z A R D ' S   S W O R D":PRINT@395,">";:FORA=1TO35:PRINT"-";:FORB=1TO50:NEXTB:NEXTA:PRINT">":FORA=1TO2000:NEXT
8020 CLS:PRINT"  AN APPRENTICE BY TRADE, YOU HAVE BEEN SUMMONED BY YOUR        MASTER, THE WIZARD OF ZZARG, TO HIS DEATHBED, WHERE YOU LISTEN  TO HIS LAST DYING WORDS -- THE BEGINNING OF YOUR QUEST, WHICH"
8030 PRINT"COULD EARN YOU THE TITLE OF WIZARD AND THE RIGHT TO HIS SWORD,  WHICH, WHEN PROPERLY FITTED, IS VERY MAGICAL.":PRINT
8040 PRINT"  "CHR$(34)"MY SON,"CHR$(34)" THE WIZARD COMMENCES, "CHR$(34)"I AM IN MY FINAL HOURS. YOU  HAVE BEEN CHOSEN TO REPLACE ME. YOU MUST PROVE YOUR WORTHINESS  BY SLAYING THE EVIL WHICH HAS LONG DARKENED THE KINGDOMS. THE"
8050 PRINT"EVIL I SPEAK OF IS MEDUSA. SHE ALONE DWELLS IN THE GREEN        KINGDOM. YOU MUST TRAVERSE THE LAND IN SEARCH OF THIS PLACE TO  FIND THIS CREATURE AND DESTROY HER.";
8060 PRINT" I AM AN OLD WIZARD. ONLY HE WHO DESTROYS MEDUSA CAN REPLACE ME."CHR$(34)
8070 PRINT:LINEINPUT"HIT ENTER";A$
8080 CLS:PRINT"  THE WIZARD CONTINUES, "CHR$(34)"YOU MUST FIRST FIND MY SWORD, WHICH    LEFT ME AS MY SPELLS AND CHARISMA GREW WEAK. MY WISDOM IS YET   STRONG. FIND MY SWORD. YOU WILL NEED IT ";
8090 PRINT"TO SLAY MEDUSA.":PRINT"  "CHR$(34)"YOU MUST ALSO FIND 5 JEWELS. THESE JEWELS, WHEN FOUND, WILL  MAGICALLY ATTACH THEMSELVES TO THE SWORD. IF YOU HAVE FOUND ALL 5 OF THE JEWELS YOU MAY THEN PROCEED TO ENTER THE GREEN"
8100 PRINT"KINGDOM IN SEARCH OF MEDUSA. THE SWORD WILL BE MAGICAL AND      PERMIT YOU TO DESTROY HER ONLY IF ALL OF THE JEWELS ARE ON.":PRINT"  "CHR$(34)"EACH JEWEL ALSO HAS A DIFFERENT POWER WHICH, WHEN USED"
8110 PRINT"PROPERLY, WILL AID YOU IN YOUR ADVENTURE. THE YELLOW JEWEL, FOR INSTANCE, WILL GIVE YOU WISDOM. TO USE EACH JEWEL YOU MUST RUB  IT."CHR$(34):PRINT:LINEINPUT"HIT  ENTER";A$
8120 CLS:PRINT"  BEWARE OF MEDUSA,"CHR$(34)" THE WIZARD RELATES. "CHR$(34)"HER STARE CAN TURN    YOU INTO STONE. DO NOT LOOK AT HER."
8130 PRINT"  "CHR$(34)"THE ANSWER TO THE RIDDLE IS..."CHR$(34)
8140 PRINT"  THEN THE WIZARD DIES. HIS BODY GLOWS COMPLETELY WHITE, THEN   VANISHES, LEAVING NO TRACE. YOU STARE AT THE EMPTY COT FOR A FEWMOMENTS THEN REFLECT ON HIS LAST WORDS. YOU LEAVE THE SMALL HUT"
8150 PRINT"IN SEARCH OF MEDUSA, KNOWING THAT YOU MUST FIRST LOCATE THE     WIZARD'S SWORD AND THE 5 JEWELS THAT CAN ENDOW IT WITH POWER."
8160 PRINT:PRINT:LINEINPUT"HIT ENTER";A$:RUN"ADV38/BAS"
