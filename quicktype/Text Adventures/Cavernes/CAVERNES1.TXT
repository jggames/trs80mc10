0 CLS:DIMA$(69),A(69):FORCC=22TO65:READA$(CC):NEXT

10 INPUT "NO.= ";D:INPUT"NIVEAU(0-5)= ";F:F=4*F

20 FOR G=13 TO 21:E=D+15*G:GOSUB 290:A(G)=INT(E):NEXT G
30 C=5:A(67)=0:GOSUB 180:GOTO 100

35 A$(66)="":IF C>100 THEN C=C-100*INT(C/100)
40 G=B-INT(B):FOR H=1 TO 3:G=G*10:A(8+H)=INT(G)+7+(H+1)*10:G=G-INT(G):NEXT H
50 SOUND1,1:PRINT"VOUS ETES DANS":PRINT "UN ";A$(I);" ";A$(K);" ";A$(J)
60 IF INT(A)>40-F THEN G=57+INT(B)/20:PRINT "IL Y A UN ";A$(G):A$(66)=A$(G)
70 FOR G=1 TO 10:IF A(11+G)=C THEN PRINT"VOUS TROUVEZ":PRINT"L-ANNEAU #";G
75 NEXT G:PRINT "IL Y A"
80 FOR G=1 TO 7 STEP 2:A$(69)="":IF G=7 THEN A$(69)=" "
85 K=G:GOSUB 280:IF K>=4 THEN K=G+1:J=K/2+61:GOSUB 280:K=22+INT(K/2):PRINT"UN ";A$(K);" A";A$(69);A$(J)
90 NEXT G:RETURN

100 PRINT:PRINT"ORDRE ";
105 M$=INKEY$:IFM$=""THEN105
106 PRINTM$
120 IF M$="S" THEN K=1:GOTO 160

130 IF M$="D" THEN K=3:GOTO 160

140 IF M$="F" THEN K=5:GOTO 160

150 IF M$="G" THEN K=7:GOTO 160

151 IF M$="H" THEN 190

152 IF M$="J" THEN 210

153 IF M$="L" THEN 300

154 IF M$="=" THEN 400

159 GOTO 100

160 G=K:A(68)=K:GOSUB 280:IF K<4 THEN 270
170 K=G+1:GOSUB 280:IF K/2-INT(K/2)<>0 THEN IF INT(A)>40-F THEN PRINT"LE MONSTRE VOUS ARRETE":GOTO 100

180 FOR G=1 TO 2:C=C-4+A(68):E=C+D:GOSUB 290:A(G)=E:NEXT G:GOSUB 35:GOTO 100

189 REM "H"
190 FOR G=12 TO 21:IF A(G)=0 PRINT "OK.":A(G)=0
200 NEXT G:GOTO 100

209 REM "J"
210 I=0:PRINT"VOUS AVEZ":FOR G=12 TO 21:IF A(G)=0 THEN H=G-11:PRINT "L-ANNEAU #";H:I=1
220 NEXT G:IF I=0 THEN PRINT "RIEN"
225 GOTO 100

229 REM "K"
230 IF A$(66)="" THEN 100
240 G=INT(N)-10*INT(B/10):IF A(G+12)=0 THEN PRINT "OK.":A(67)=1+A(67):A$(66)="":FOR H=2 TO 8 STEP 2:K=H:GOSUB 280
250 IF A(G+12)=0 THEN IF K/2-INT(K/2)<>0 THEN A=A+1/10^H
260 IF A(G+12)=0 THEN NEXT H:GOTO 100
270 PRINT "NON!":GOTO 100

279 REM "T"
280 K=(INT(A*10^K))-(10*INT(A*10^(K-1))):RETURN

289 REM "R"
290 E=ABS(SIN(E)*100):RETURN

299 REM "L"
300 PRINT"SCORE: ";A(67):END

399 REM "="
400 GOSUB 35:GOTO 100

522 DATA E PORTE
523 DATA " CHEMIN"
524 DATA E ROUTE
525 DATA " TUNNEL"
526 DATA E TRAPPE
527 DATA VIEUX
528 DATA SALE
529 DATA GRAND
530 DATA PETIT
531 DATA TRISTE
532 DATA SOMBRE
533 DATA ETRANGE
534 DATA LARGE
535 DATA ANCIEN
536 DATA LARGE
537 DATA ROMAIN
538 DATA GREC
539 DATA PERDU
540 DATA DESERT
541 DATA HUMIDE
542 DATA SOMBRE
543 DATA EN BOUE
544 DATA BRALA
545 DATA MAUDIT
546 DATA EN LAVE
547 DATA TUNNEL
548 DATA TEMPLE
549 DATA TOMBEAU
550 DATA CAVEAU
551 DATA LOCAL
552 DATA COULOIR
553 DATA TUNNEL
554 DATA PUITS
555 DATA TUNNEL
556 DATA VOLCAN
557 DATA DRAGON
558 DATA SORCIER
559 DATA TROLL
560 DATA LION
561 DATA VAMPIRE
562 DATA U NORD
563 DATA " L-EST"
564 DATA U SUD
565 DATA L-OUEST
