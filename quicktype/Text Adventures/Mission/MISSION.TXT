1 REM ==== <ADVENTURE MISSION> ====
2 REM Author: MICHEL BRASSINNE
3 REM Games & Strategy number 29 - pages 44-48
4 REM Resumption: DOMINIQUE RIOUAL 
5 REM Version: 1.0 of 12/17/2017
6 REM
7 REM
10 REM ==== <INITIALIZATION> ===
20 REM
25 GOSUB 3100
30 DIM N (15), E (15), S (15), O (15), V $ (13), O $ (18), L (15), OB (18), G $ (18)
40 G $ (1) = "UN": G $ (2) = "A": G $ (4) = "DE LA": G $ (5) = "DES": TT = 23
50 Z $ = "YOU ARE": LU = 20
60 DF $ = "IT Sounds Difficult, Right?": CF $ = "IT'S DONE!": RA $ = "NOTHING SPECIAL"
70 REM ---- <TOPOLOGY> ------
80 FOR L = 1 TO 15
90 READ N (L), E (L), S (L), O (L)
100 NEXT L: L = 1
110 DATA 2,0,0,0,5,3,1,4
120 DATA 0,0,0,2,0,2,0,0
130 DATA 6,0,2,0,8,7,5,0
140 DATA 0,0,0,6,11,0,6,9
150 DATA 10,8,0,0,12,11,9,0
160 DATA 13,15,8,10,0,13,10,0
170 DATA 0,14,11,12,0,0,15,13
180 DATA 14,0,0,11
190 REM --- <CASES.OBJETS> -
200 FOR I = 1 TO 18
210 READ OB (I): NEXT I
220 DATA 3,5,4,0,1,0,0,8,0,0,0,0,0,15,0,0,0,0,0,0
230 REM - <DATAVERBES> ---
240 FOR I = 1 TO 13
250 READ V $ (I): NEXT I
260 DATA "SET", "TAKE", "OPEN", "CLOSE", "LEAF", "EXPLORE", "PICK UP", "READ", "ROTATE", "REMOVE", "LOOK", "LIFT", "TO SCRATCH"
270 REM --- <DATA.GENRE> -----
280 FOR I = 1 TO 18
290 READ G $ (I): NEXT I
300 DATA "ONE", "OF THE", "ONE", "ONE", "ONE", "ONE", "ONE", "ONE", "ONE", "ONE", "ONE", "ONE" , "ONE", "ONE", "ONE", "ONE", "ONE", "DES"
310 REM - <DATA.NOM> -----
320 FOR I = 1 TO 18
330 READ O $ (I): NEXT I
340 DATA "SKELETON", "FOAM", "CALENDAR", "TRAPPE", "ENTRY", "BOX", "KEY"
341 DATA "CABINET", "BOOK", "PAPER", "BUTTON", "CHEST", "TABLE", "GRID", "INGOT"
342 DATA "UNIFORM", "CANDLE", "MATCH"
350 GOTO 570
360 REM === <PRGM.PRINCIPAL> ===
370 IF PEEK (37) <23 THEN 380
371 PRINT "> Press a key": GET ENTREE $
372 HOME: GOTO 570
380 IF AL <> 0 THEN AL = AL - 1
385 INPUT "> Action?"; A $
390 IF A $ = "" THEN 370
395 IF A $ = "LUX" THEN CHEAT = 1: PRINT "Cheater !!": GOTO 370
400 IF LEN (A $)> 1 THEN 960
410 IF A $ = "N" AND N (L)> 0 THEN L = N (L): GOTO 570
420 IF A $ = "E" AND E (L)> 0 THEN L = E (L): GOTO 570
430 IF A $ = "S" AND S (L)> 0 THEN L = S (L): GOTO 570
440 IF A $ = "O" AND O (L)> 0 THEN L = O (L): GOTO 570
450 IF A $ = "I" THEN GOSUB 470: GOTO 370
455 IF A $ = "V" THEN GOSUB 3000: GOTO 370
456 IF A $ = "A" THEN GOSUB 3060: GOTO 370
460 PRINT "IMPOSSIBLE ...": GOTO 370
470 REM --- <INVENTARY> ----
480 TS = 0
490 PRINT "You are transporting:"
491 PRINT "----------------"
500 FOR I = 1 TO 18
510 IF OB (I) = 50 THEN PRINT "-"; O $ (I): TS = TS + 1
520 NEXT I
530 IF OB (18) = 50 THEN PRINT "("; LU; "MATCHES)"
540 IF TS = 0 THEN PRINT "NOTHING!"
550 RETURN
560 REM -------------------------
570 GOSUB 640
580 IF LU = 0 THEN PRINT "YOU HAVE NO LONGER MATCH!": OB (18) = 0
585 IF CHEATING = 1 THEN GOTO 600
590 IF LU = 0 OR (L> 4 AND AL = 0) THEN PRINT "IT'S NIGHT BLACK!": GOTO 370
600 GOSUB 920
610 GOTO 370
620 REM --- <DESCRIPTION> ---
630 REM
640 IF CHEATING = 1 THEN 645
641 IF L> 4 AND AL = 0 THEN RETURN
645 HOME
650 ON L GOSUB 670,690,710,730,750,770,790,830,860,860,880,860,860,860,900
655 PRINT
660 RETURN
670 REM CASE- # 1 ----------
680 PRINT Z $; "OUTSIDE AT THE FOOT OF A CLIFF AND TOWARDS NORTH"; : RETURN
690 REM CASE- # 2 ----------
700 PRINT Z $; "AT A CROSSROADS NS, EO": RETURN
710 REM CASE- # 3 ----------
720 PRINT Z $; "IN A FAIR DARK ROOM": RETURN
730 REM CASE- # 4 ----------
740 PRINT Z $; "IN A DUSTY PART": RETURN
750 REM CASE- # 5 ----------
760 PRINT Z $; "IN A WET CORRIDOR NS": RETURN
770 REM CASE- # 6 ----------
780 PRINT Z $; "IN A PASSAGE (NES)": RETURN
790 REM CASE- # 7 ----------
800 IF IM <5 THEN PRINT "A LONG SLIDING CORRIDOR (EO)": IM = IM + 1: GOTO 820
810 PRINT "IT'S AN IMPASSE": IM = 0: GOTO 370
820 INPUT "> Action?"; A $: GOTO 800
830 REM CASE- # 8 ----------
840 PRINT Z $; "IN AN ALMOST EMPTY ROOM"
850 RETURN
860 REM CASE- # 9.10.12.13.14 ---
870 PRINT Z $; "IN A NARROW CORRIDOR": RETURN
880 REM CASE- # 11 ----------
890 PRINT Z $; "IN ONE PIECE (NSEO)": RETURN
900 REM CASE- # 15 ----------
910 PRINT Z $; "IN ONE PIECE (NO)": RETURN
920 REM - <OBJECTS.PRESENTS> -
930 FOR I = 1 TO 18
940 IF OB (I) = L THEN PRINT "YOU SEE"; G $ (I); ""; O $ (I)
950 NEXT I
951 PRINT "________________________________________"
955 RETURN
960 REM ===== <ANALYZER> =====
970 V $ = "": N $ = "": T = 0: F = 0
980 GOSUB 1060
990 GOSUB 1160
1000 IF X = 0 THEN 370
1010 GOSUB 1230
1020 IF Y = 0 THEN 370
1030 GOSUB 1300
1040 GOTO 370
1050 REM --- (1) .CUTTING> ---
1060 IF RIGHT $ (A $, 1) = "S" THEN F = 1
1070 FOR I = 1 TO LEN (A $) - F
1080 B $ = MID $ (A $, I, 1)
1090 IF B $ = CHR $ (32) OR B $ = CHR $ (39) THEN T = T + 1: GOTO 1130
1100 ON T GOTO 1130,1120
1110 V $ = V $ + B $: GOTO 1130
1120 N $ = N $ + B $
1130 NEXT I
1140 IF N $ = "" THEN PRINT "YES, BUT WHAT?"
1150 RETURN
1160 REM - (2). VERIF-VERB> -
1170 X = 0
1180 FOR I = 1 TO 13
1190 IF V $ = V $ (I) THEN X = I
1200 NEXT I
1210 IF X = 0 THEN PRINT "I DON'T KNOW '"; V $; "'"
1220 RETURN
1230 REM - (3). VERIF-NAME> -
1240 Y = 0
1250 FOR I = 1 TO 18
1260 IF N $ = O $ (I) THEN Y = I
1270 NEXT I
1280 IF Y = 0 THEN PRINT "THERE IS NO '"; N $; "'"
1290 RETURN
1300 REM - <ANSWERS / ACTIONS> -
1310 ON X GOSUB 1330,1410,1530,1650,1710,1770,1820,1840,1910,1960,2030,2210,2300
1320 RETURN
1330 REM ----- <POSER> -----
1340 IF Y <> 6 THEN GOTO 1380
1350 IF Y = 6 THEN PRINT "OR"; : INPUT R $
1360 IF R $ = "IN THE BOX" THEN PRINT "OK": TF = TF - 10
1370 IF TF <3 THEN OB (14) = 0: S (2) = 1
1380 IF OB (Y) <> 50 THEN PRINT "YOU DON'T HAVE THIS ITEM!": GOTO 1400
1390 IF OB (Y) = 50 THEN PRINT OB $ (Y); "EST POSE": OB (Y) = L
1400 RETURN
1410 REM ----- <TOP> -----
1420 IF TS> 5 THEN PRINT "YOU ARE TOO LOADED": RETURN
1430 IF Y = 1 OR Y = 4 OR Y = 5 OR Y = 8 OR Y = 11 OR Y = 12 THEN PRINT DF $: GOTO 1520
1440 IF Y <> 15 THEN 1490
1450 IF Y = 15 THEN PRINT "HOW MUCH?": INPUT C $
1460 IF VAL (C $)> 20 THEN PRINT "C'EST TROP": GOTO 1450
1470 TF = TF + VAL (C $)
1480 IF VAL (C $)> 3 THEN OB (14) = 2: S (2) = 0
1490 IF OB (Y) = L THEN PRINT "IT IS DONE!": OB (Y) = 50: GOTO 1520
1500 IF OB (Y) = 50 THEN PRINT "YOU ALREADY HAVE IT!": GOTO 1520
1510 PRINT "I DON'T SEE '"; N $; "HERE!"
1520 RETURN
1530 REM ----- <OPEN> ----
1540 IF Y = 1 OR Y = 2 OR Y = 5 OR Y = 7 OR Y = 11 THEN PRINT DF $: GOTO 1520
1550 IF Y = 3 THEN PRINT "YOU SEE CARDBOARD!": GOTO 1640
1560 IF Y = 4 AND OB (6) <> 50 THEN PRINT "CLICK! THERE IS A LEAD BOX INSIDE !!": TF = TF + 1: OB (6) = 5: GOTO 1640
1570 IF Y = 6 THEN PRINT "THERE IS A KEY INSIDE !!" : OB (7) = 5: GOTO 1640
1580 IF Y = 8 THEN PRINT "CLICK! THERE IS A BOOK INSIDE !!": TF = TF + 1: OB (9) = 8: GOTO 1640
1590 IF Y = 14 THEN PRINT "CLICK! A HATCH OPENS UNDER YOUR FEET ... HELLO BEYOND!": PRINT: PRINT: PRINT: END
1600 IF Y = 9 THEN PRINT "YES, ON WHICH PAGE ..!": GOTO 1640
1610 IF Y = 10 THEN PRINT "IT IS OPEN": GOTO 1640
1620 IF BT = 0 AND Y = 12 THEN PRINT "GOOD IDEA, HOW DO YOU DO IT?": GOTO 1640
1630 IF BT = 1 AND Y = 12 THEN PRINT "CLICK! IT OPENS ... IT IS FILLED WITH GOLD BARS?": TF = TF + 1: OB (15) = L
1640 RETURN
1650 REM ----- <CLOSE> -----
1660 IF Y = 1 OR Y = 2 OR Y = 3 OR Y = 5 OR Y = 7 OR Y = 11 THEN PRINT DF $: GOTO 1700
1670 IF Y = 6 OR Y = 9 OR Y = 10 THEN PRINT CF $: GOTO 1700
1680 IF Y = 12 THEN OV = 0
1690 IF Y = 4 OR Y = 8 OR Y = 12 THEN PRINT CF $: TF = TF - 1
1700 RETURN
1710 REM ----- <LIFT> ---
1720 IF Y = 3 THEN PRINT "THE DATES CHALLENGE ...": GOTO 1760
1730 IF Y = 9 AND FL = 0 THEN PRINT "UN PAPIER FOMBE": OB (10) = 8: FL = 1: GOTO 1760
1740 IF Y = 9 AND FL = 1 THEN PRINT "IT IS EMPTY": GOTO 1760
1750 PRINT DF $
1760 RETURN
1770 REM ----- <SEARCH> ---
1780 IF Y = 12 THEN OB (15) = L: GOTO 2190
1790 IF Y = 16 THEN PRINT "IN THE POCKET, THERE ARE MATCHES": OB (18) = 3: GOTO 1810
1800 PRINT RA $
1810 RETURN
1820 REM ----- <PICKUP> ---
1830 GOTO 1410
1840 REM ----- <READ> -------
1850 IF Y = 1 OR Y = 2 OR Y = 4 OR Y = 5 OR Y = 6 OR Y = 7 OR Y = 8 OR Y = 12 THEN PRINT DF $: GOTO 1900
1860 IF Y = 3 THEN PRINT "YOU READ ... JULY 25, 1944": GOTO 1900
1870 IF Y = 9 THEN PRINT "YOU READ ... ONCE UPON A TIME ...": PRINT: FOR I = 1 TO 600: U = INT (RND (1) * 36) +54: PRINT CHR $ (U ) ;: NEXT I: GOTO 1900
1880 IF Y = 10 THEN PRINT "YOU READ ... U40.W25.U12": GOTO 1900
1890 IF Y = 11 THEN PRINT "IT IS IN POSITION"; TT
1900 RETURN
1910 REM ----- <TURN> ---
1920 IF Y = 1 OR Y = 2 OR Y = 4 OR Y = 5 OR Y = 8 OR Y = 12 THEN PRINT DF $: GOTO 1950
1930 IF Y = 3 OR Y = 6 OR Y = 7 OR Y = 9 OR Y = 10 THEN PRINT RA $: GOTO 1950
1940 IF Y = 11 THEN GOTO 2330
1950 RETURN
1960 REM ----- <RELEVER> ---
1970 IF Y = 1 OR Y = 4 OR Y = 5 OR Y = 8 OR Y = 11 OR Y = 12 THEN PRINT DF $: GOTO 2020
1980 IF Y = 6 OR Y = 7 OR Y = 9 OR Y = 10 THEN PRINT CF $: PRINT RA $: GOTO 2020
1990 IF Y = 2 AND TA = 0 THEN PRINT "A TRAP APPEARS ...": TA = 1: OB (4) = 5: GOTO 2020
2000 IF Y = 2 AND TA = 1 THEN PRINT "IL N'Y A NOTHING ELSE": GOTO 2020
2010 IF Y = 13 THEN GOTO 2280
2020 RETURN
2030 REM ----- <WATCH> -
2040 IF Y = 1 THEN PRINT "IT HAS A GREEN UNIFORM": OB (16) = 3: OB (18) = 3: GOTO 2200
2050 IF Y = 2 THEN PRINT "SHE IS GREEN": GOTO 2200
2060 IF Y = 3 THEN GOTO 1840
2070 IF Y = 4 THEN PRINT "THIS IS A NORMAL TRAP": GOTO 2200
2080 IF Y = 5 THEN PRINT "IT APPEARS TO DATE FROM 40 YEARS AGO": GOTO 2200
2090 IF Y = 6 THEN PRINT "IT IS NOT CLOSED": GOTO 2200
2100 IF Y = 7 THEN PRINT RA $: GOTO 2200
2110 IF Y = 8 THEN PRINT "IT HAS TWO DOORS": GOTO 2200
2120 IF Y = 9 THEN PRINT "HYDRAULIC BOXES BY LEON SHMURZ": GOTO 2200
2130 IF Y = 10 THEN GOTO 1880
2140 IF Y = 11 THEN GOTO 1840
2150 IF Y = 12 AND OV = 0 THEN PRINT "IT IS EQUIPPED WITH A BUTTON": GOTO 2200
2160 IF Y = 13 THEN PRINT "IT REPRESENTS A MILITARY": GOTO 2200
2170 IF Y = 14 THEN PRINT "SHE IS HUGE. IT IS WRITTEN 'LING.> 3 = DEAD'": GOTO 2200
2180 IF Y = 16 THEN PRINT "IT IS ALL MITE": OB (18) = 3: GOTO 2200
2190 IF Y = 12 AND OV = 1 THEN PRINT "IT IS FILLED WITH GOLD BARS": GOTO 2200
2200 RETURN
2210 REM ----- <LIFT> -
2220 IF Y = 5 OR Y = 8 OR Y = 11 OR Y = 12 THEN PRINT DF $: GOTO 2290
2230 IF Y = 3 OR Y = 6 OR Y = 9 THEN PRINT RA $: GOTO 2290
2240 IF Y = 1 THEN PRINT "IT WRAPS UP": GOTO 2290
2250 IF Y = 2 THEN GOTO 1960
2260 IF Y = 4 THEN GOTO 1530
2270 IF Y = 7 OR Y = 10 THEN PRINT "BEL EFFORT!": GOTO 2290
2280 IF Y = 13 THEN PRINT "THERE IS A CHEST BEHIND": OB (11) = 15: OB (12) = 15: GOTO 2290
2290 RETURN
2300 REM ----- <GRATTER> -----
2310 IF OB (18) = 50 AND LU> 0 THEN LU = LU - 1: AL = 5: PRINT "SCRRITCH, LA LUMIERE FUSE": RETURN
2320 PRINT "YOU DON'T HAVE ONE": RETURN
2330 CHEST OPENING
2340 FOR I = 1 TO 5
2350 INPUT "IN WHICH SENSE (D OR L) ->"; S $
2360 IF S $ = "G" THEN SG = - 1: GOTO 2380
2370 SG = 1
2380 INPUT "HOW MANY SCREENS? ->"; CR
2390 TT = TT + (CR * SG): PRINT "BUTTON IN POSITION"; TT
2400 IF TT = 0 THEN GOTO 2340
2410 IF TT = 37 AND I = 3 THEN GOTO 2430
2420 NEXT I
2430 IF TT = 37 THEN PRINT "CLICK! LE CHEST OPENS": OV = 1: OB (15) = L: TF = TF + 1: GOTO 370
2440 PRINT "IT DOES NOT OPEN"
2450 INPUT "START AGAIN? (Y / N)"; R $
2460 IF R $ = "N" THEN GOTO 1950
2470 GOTO 2340
3000 REM ----- <Vocabulary> ---
3005 PRINT: PRINT "Vocabulary:"
3006 PRINT "-----------"
3008 K = 0
3010 FOR I = 1 TO 13
3015 IF K = 1 THEN PRINT TAB (15); V $ (I): GOTO 3025
3020 PRINT V $ (I);
3025 K = 1-K
3030 NEXT I
3035 PRINT: PRINT "Help: A"
3040 PRINT
3050 RETURN
3059 REM ---- <Help> -----
3060 PRINT "Enter a sentence:"
3070 PRINT "<verb> <article> <name>"
3075 PRINT "Go to: NSE O"
3080 PRINT "Inventory: I Vocabulary: V"
3085 PRINT
3090 RETURN
3100 REM ========= <INTRO> =========
3105 TEXT: HOME
3110 TITLE $ = "ADVENTURE MISSION"
3120 LTITER = LEN (TITLE $)
3130 XMIN = 20-INT (LTITER / 2)
3140 Y = 7
3150 FOR I = 1 TO LT
3160 C $ = MID $ (TITLE $, I, 1)
3170 IF I / 2 = INT (I / 2) THEN GOTO 3240
3180 FOR J = 1 TO Y
3190 HTAB XMIN + I: VTAB J: PRINT C $
3200 GOSUB 3400
3210 IF J <Y THEN HTAB XMIN + I: VTAB J: PRINT CHR $ (32)
3220 NEXT J
3230 GOTO 3300
3240 FOR J = 22 TO Y STEP -1
3250 HTAB XMIN + I: VTAB J: PRINT C $
3260 GOSUB 3400
3270 IF J> Y THEN HTAB XMIN + I: VTAB J: PRINT CHR $ (32)
3280 NEXT J
3300 NEXT I
3310 HTAB XMIN + 1: VTAB Y: FLASH: PRINT TITLE $: NORMAL
3320 VTAB Y + 5
3325 PRINT "J&S n29 Oct.1984 ** MICHEL BRASSINNE **"
3327 PRINT "Adapted by Dominique Rioual - 2017"
3328 PRINT "_______________________________________"
3330 PRINT "You are walking in the mountains,"
3340 PRINT "hands in pockets. Summer has been"
3350 PRINT "dry and some trees are dead. One"
3360 PRINT "of them suggests the entry of a"
3370 PRINT "cave."
3375 PRINT "You decide to venture there ..."
3380 PRINT: PRINT: PRINT "PRESS A KEY TO BEGIN";
3385 GET C $
3390 RETURN
3400 REM ----- <TEMPO> ---
3410 FOR K = 1 TO 20: NEXT K
3420 RETURN

