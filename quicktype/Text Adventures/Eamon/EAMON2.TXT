

20 M$="YOU WAIT FOR THE KNIGHT MARSHAL TO RETURN, FIDGETTING ONLY A LITTLE.":GOSUB1
50 GOTO1000


REM ARTIFACTS.txt
101 DATADIAMONDS,200,1,3,3,,,,0
102 DATAAXE,25,2,4,,,1,1,6
103 DATABOTTLE,50,6,2,5,100,6,2,0
104 DATASWORD,25,2,4,,-10,5,1,8
105 DATAGOLD COINS,50,,2,8,,,,0
106 DATARING,150,1,5,,,,,0
107 DATAMACE,40,2,4,,10,3,1,4
108 DATASPICES,100,1,3,18,,,,0
109 DATABOOK,250,7,3,19,7,2,1,0
110 DATATROLLSFIRE,100,3,3,,25,5,1,10
111 DATAJEWELS,1000,1,5,26,,,,0
112 DATACHEST,,1,300,14,,,,0
113 DATAEMPTY BOTTLE,1,1,1,,,,,0
114 DATARUBY,250,1,1,37,,,,0
115 DATAIVORY SWORD,200,3,5,11,15,5,1,8
116 DATALONG BOW,35,3,5,,10,2,1,8
117 DATAOLD STAFF,30,3,3,,10,3,1,4
118 DATABROADSWORD,90,3,11,,5,5,2,5
119 DATACHEST,1250,1,50,29,,,,0
120 DATAGOLDEN EGG,250,1,7,36,,,,0
121 DATACAT IDOL,140,1,10,28,,,,0
122 DATASILVER DAGGER,40,3,1,18,5,5,1,2
123 DATASKINS,30,1,4,35,,,,0
124 DATACLUB,1,3,5,,,3,1,4
125 DATADEAD BLACK RAT,,,5,,,,,0
126 DATADEAD BROWN RAT,,,5,,,,,0
127 DATADEAD TAN RAT,,,5,,,,,0
128 DATADEAD HERMIT,,,75,,,,,0
129 DATADEAD GORILLA,,,200,,,,,0
130 DATADEAD HEINRICH,,,100,,,,,0
131 DATADEAD MIMIC,,,300,,,,,0
132 DATADEAD PRIEST,,,75,,,,,0
133 DATADEAD CYNTHIA,,,50,,,,,0
134 DATADEAD PIRATE,,,300,,,,,0
135 DATADEAD WOLF,,,65,,,,,0
136 DATADEAD CAVEMAN,,,155,,,,,0
137 DATADEAD ELF,,,103,,,,,0
138 DATADEAD BOOK-EATER,,,200,,,,,0
139 DATADEAD PYTHON,,,120,,,,,0
140 DATADEAD OLD MAN,,,110,,,,,0
141 DATADEAD BOY,,1,65,,,,,0
142 DATADUST,,1,200,,,,,0
143 DATADEAD BIRD,,1,35,,,,,0
144 DATADEAD HARVEY,,1,220,,,,,0

REM DESC.txt
200 DATA37,44,9,20
201 DATA"*AT THE ENTRANCE OF A CAVE. SOUTH A SIGN SAYS 'BEGINNERS ONLY.' n-- THE ROAD BACK TO TOWN."
202 DATA"*IN A DARK n/s TUNNEL. NORTH YOU SEE OUTSIDE. SOUTH-- FLICKERING TORCH LIGHT."
203 DATA"*IN A SMALL SIDE CHAMBER. IT IS COLD HERE, AND THE ONLY LIGHT COMES FROM THE LARGE CHAMBER."
204 DATA"*IN A HUGE CHAMBER. BURNING TORCHES LINE THE WALLS. TUNNELS LEAD n AND s, AND SMALL CHAMBERS ARE e & w."
205 DATA"*IN A SMALL CHAMBER. IT IS VERY COLD. THE ONLY LIGHT COMES FROM THE LARGE CHAMBER."
206 DATA"*IN A SMALL, STARK CELL WITH A DOOR TO THE e."
207 DATA"*AT THE n END OF A LONG HALL. A TUNNEL GOES n. e & w ARE DOORS (BOLTED SHUT). THE HALL GOES s."
208 DATADETAI"
209 DATA"*IN A SMALL, STARK CELL WITH A DOOR w."
210 DATA"*IN A SMALL, STARK CELL WITH A DOOR e."
211 DATA"*IN THE MIDDLE OF THE LONG n/s HALL. BOLTED DOORS e & w."
211 DATA"*IN A SMALL, STARK CELL WITH A DOOR ON THE WEST SIDE."
212 DATA"*IN A SMALL, STARK CELL WITH A DOOR ON THE EAST SIDE."
213 DATA"*AT THE SOUTH END OF THE LONG HALL. TO YOUR GREAT SHOCK THERE ARE TWO DOORS TO THE EAST AND WEST. THE HALL GOES NORTH FROM HERE, AND A BROKEN PASSAGE GOES SOUTH."
214 DATA"*IN A SMALL, STARK CELL WITH A DOOR ON THE WEST SIDE."
215 DATA"*IN A TUNNEL GOING NORTH AND SOUTH. THE SIDES OF THE TUNNEL ARE VERY BROKEN AND ROUGH. YOU SEE TORCHLIGHT TO THE SOUTH."
216 DATA"*IN A SECRET EAST/WEST PASSAGE.YOU HEAR A FAINT MELODY COMING FROM THE EAST."
217 DATA"*IN AN EAST/WEST PASSAGE. YOU CAN VERY CLEARLY HEAR RELIGIOUS MUSIC BEING PLAYED, AND CAN SMELL INCENSE FROMTHE EAST."
218 DATA"*IN THE TEMPLE. PICTURES OF GREAT DEEDS COVER THE WALLS. THERE ARE TWO ALTARS HERE, ONE COVERED WITH GOLD PAINT AND THE OTHER STAINED WITH BLOOD. THE ONLY EXIT LEADS TO THE WEST."
219 DATA"*IN WHAT WAS ONCE OBVIOUSLY A LIBRARY. MOST OF THE BOOKS HAVE BEEN DESTROYED, WITH THE SCRAPS LYING ON THE GROUND. A DOOR, TORN FROM ITS HINGES, ALSO LIES ON THE GROUND. THE EXIT IS TO THE EAST."
220 DATA"*IN A T-INTERSECTION.A BRIGHTLYBURNING TORCH IS BOLTED TO THE SOUTH WALL. DARK TUNNELS LEAD NORTH AND EAST. TO THE WEST IS A PLACE WHERE ONCE A DOORSTOOD, BUT IT HAS BEEN TORN FROM ITS HINGES."
221 DATA"*IN A DARK EAST/WEST TUNNEL. YOU CAN SEE TORCHLIGHT BOTH DIRECTIONS."
222 DATA"*AT THE TOP OF A FLIGHT OF STAIRS. A TORCH IS ON THE WALL. IT LOOKS VERY DARK DOWN THERE. A TUNNEL HEADS WEST."
223 DATA"*AT THE BOTTOM OF A FLIGHT OF A LIGHT CAN BE SEEN UP AT THE TOP OF THESTAIRS, AND A VERY DIM LIGHT CAN BE SEENDOWN THE TUNNEL TO THE EAST."
224 DATA"*IN AN EAST/WEST TUNNEL. DIM LIGHT CAN BE SEEN IN BOTH DIRECTIONS. THERE IS A NARROWER TUNNEL LEADING TO THE SOUTH HERE."
225 DATA"*IN AN EAST/WEST TUNNEL.YOU SEELIGHT TO THE EAST, AND FEEL A COOL WIND COMING FROM THERE. IN THE WIND YOU SMELLA HINT OF SALT."
226 DATA"*IN A SMALL BAY. HIGH WALLS SURROUND YOU SO THAT THE ONLY EXIT IS BACK IN THE TUNNEL TO THE WEST. TO THE EAST, ON THE BANK OF THE SEA, IS A BROKEN OLD BOAT."
227 DATA"*IN A N/S TUNNEL. THERE ARE CHAMBERS TO THE EAST AND WEST AND A DIM LIGHT CAN BE SEEN AHEAD TO THE SOUTH."
228 DATA"*IN A VERY TINY CHAMBER. IT IS VERY DUSTY AND DIRTY IN HERE. THERE'S NOT MUCH LIGHT IN HERE. THE PLACE SEEMS TO SMELL LIKE A TOMB. THE ONLY EXIT IS EAST."
229 DATA"*IN A SMALL DUSTY CHAMBER THAT WAS USED FOR A STORAGE PLACE FOR PIRATES TO STASH THEIR TREASURES UNTIL THEY COULD FIND A SUITABLE PLACE TO BURYIT. THE EXIT IS WEST."
230 DATA"*STANDING AT AN EAST/WEST/NORTH INTERSECTION. THERE IS A TORCH BOLTED TO THE WALL HERE. TO THE EAST YOU CAN'T SEE ANYTHING. THERE IS A LITTLE LIGHT COMING FROM THE WEST."
231 DATA"*AT A BEND IN THE TUNNEL. THE TUNNEL BENDS FROM THE WEST TO THE SOUTH HERE. YOU CANNOT MAKE OUT ANY DETAIL AHEAD."
232 DATA"*IN A N/S TUNNEL. THE WALLS HAVE A COLD, FROSTY FEEL. THERE IS A CHAMBER TO THE SOUTH."
233 DATA"*IN A LARGE NATURAL CAVERN. THEREARE STALAGTITES AND STALAGMITES ALL OVERIN HERE. WATER DRIPS FROM THE CEILING TOA POOL IN THE CENTER OF THE ROOM. THE ONLY EXIT IS NORTH."
234 DATA"*IN AN EAST/WEST TUNNEL. THERE ISA CHAMBER TO THE SOUTH. AND A LARGER ONETO THE WEST."
235 DATA"*IN A CHAMBER THAT HAS BEEN VERY CAREFULLY CUT FROM THE SURROUNDING ROCK.IT IS VERY NEAT AND DRY, BUT CONTAINS NOFURNISHINGS OF ANY SORT. THE ONLY EXIT IS NORTH."
236 DATA"*IN A LARGE CAVERN. THE CEILING IS VERY HIGH IN HERE. THERE IS A TORCH BOLTED SECURELY TO THE WALL HERE THAT PROVIDES ENOUGH LIGHT FOR YOU TO SEE. THE ONLY EXIT IS EAST."
237 DATA"*IN A SMALL SECRET CLOSET. IT IS VERY DARK. DOOR IS TO S."

"THERE IS AN ORNAMENTAL SILVER DAGGER ON THE ALTER."
"THERE ARE ANIMAL SKINS SITTING IN A SMALL PILE HERE."
"THERE IS A LARGE CLUB HERE."
"THERE IS A DEAD BLACK RAT HERE."
"THERE IS A DEAD BROWN RAT HERE."
"THERE IS A DEAD TAN RAT HERE."
"THE HERMIT'S BODY LIES DEAD HERE."
"THE SHAGGY CORPSE OF A GORILLA IS HERE."
"THE DEAD BODY OF HEINRICH LIES HERE."
"THE DEAD BODY OF THE CHEST-MIMIC IS SPRAWLED ON THE GROUND."
"THE PRIEST LIES DEAD HERE, STILL WITH A LOOK OF MANIACAL HATRED ON HIS FACE."
"THE DEAD BODY OF THE GIRL CYNTHIA LIES HERE."
"THE DEAD BODY OF THE PIRATE IS HERE."
"THE DEAD BODY OF THE WOLF IS HERE."
LY BECOMES ALIVE AND TWO TENTACLES COME OUTOF THE SIDE, HOLDING YOU FAST. ANOTHER TENTACLE RISES FROM THE TOP AND ATTEMPTSTO HURT YOU."
"THE CAVE MAN LIES SPRAWLED ON THE FLOOR."
N'T MAKE OUT, BRIGHT GREEN FLAME SURROUNDS THE BLADE OF HIS SWORD."
"THE ELF LIES DEAD AND BLOODIED."
E FLAMEON HIS SWORD DIES ALSO."
"THE SLOBOVIAN BOOK-EATER HAS EATEN HIS LAST BOOK AND LIES DEAD ON THE FLOOR."
SWORD'S BLADE."
"THE PYTHON'S COILS WILL NEVER TRAP ANY MORE ADVENTURERS."
SOME BURN DAMAGE UNTIL THE SWORD (HEARING YOUR CRIES OF PAIN?) EXTINGUISHES ITS FLAME."
"YOU SEE THE DEAD BODY OF THE OLD MAN."
"THE DEAD BODY OF THE BOY IS HERE."
"THE MUMMY DISINTEGRATED INTO A PILE OF DUST WHEN HE HIT THE FLOOR."
"YOU SEE THE DEAD BODY OF THE LARGE BIRD THAT ATTACKED YOU."
"THE DEAD BODY OF HARVEY OF TEAD IS HERE."


REM MONSTERS.txt:

BLACK RAT
2
10
0
10
3
5
0
0
0
30
1
1
BROWN RAT
2
10
0
10
3
5
0
0
0
30
1
1
TAN RAT
2
10
0
10
3
5
0
0
0
30
1
1
HERMIT
13
22
50
75
5
75
0
0
2
55
1
6
GORILLA
12
15
0
60
8
200
0
0
0
45
1
4
HEINRICH
15
5
65
100
6
100
0
1
4
12
1
8
MIMIC
5
5
0
100
0
300
0
0
0
40
1
3
PRIEST
10
6
0
100
18
75
0
1
7
25
1
4
CYNTHIA
3
20
95
5
18
50
0
0
-1
0
0
0
PIRATE
5
20
0
10
26
300
0
0
10
60
1
10
WOLF
8
8
5
60
12
65
0
0
0
40
1
4
CAVEMAN
10
10
25
40
11
155
0
0
24
55
1
6
ELF
11
14
45
80
9
103
5
1
16
45
1
4
SLOBOVIAN BOOK-EATER
20
20
0
80
19
200
-10
0
0
65
1
10
"PYTHON"
8
12
0
50
37
120
-5
0
0
40
1
3
OLD MAN
11
12
70
40
35
110
0
1
17
50
1
4
BOY
5
5
100
50
29
65
5
0
-1
15
1
2
MUMMY
23
10
0
100
28
225
-30
0
0
50
2
4
CONDOR
7
12
0
100
36
30
0
0
0
45
1
4
HARVEY OF TEAD
22
19
60
110
33
220
0
2
18
70
1
6

Text found in Super_Eamon_Beginners_Cave.dsk/EAMON.NAME.txt:

THE BEGINNERS CAVE
6
6
?D$;0

Text found in Super_Eamon_Beginners_Cave.dsk/EAMON.ROOM NAMES.txt:

THE CAVE ENTRANCE
"THE CAVE ENTRANCE"
UNNEL
THE WEST SIDE CHAMBER
A DARK N/S TUNNEL
THE E SIDE CHAMBER
THE W SIDE CHAMBER
THE N END OF A LONG PASSAGE
A LARGE CHAMBER
A W CELL
THE EAST SIDE CHAMBER
ASSAGE
AN E CELL
A W CELL
THE S END OF A LONG PASSAGE
"THE NORTH END OF A LONG PASSAGE."
ROKEN N/S PASSAGE
AN EAST CELL
WITH FAINT MUSIC
AN E/W TUNNEL WITH LOUD MUSIC
A W CELL
THE LIBRARY
THE MIDDLE OF A LONG PASSAGE
AN E/W TUNNEL
AN EAST CELL
STAIRWAY
THE BOTTOM OF A STAIRWAY
A WEST CELL
L
AN E/W TUNNEL SMELLING OF SALT
THE SOUTH END OF A LONG PASSAGE
AN EAST CELL
"A BROKEN N/S PASSAGE."
AN E/W TUNNEL WITH FAINT MUSIC
AN E/W TUNNEL WITH LOUD MUSIC
THE TEMPLE
THE LIBRARY
A T-INTERSECTION--N AND E/W
AN E/W TUNNEL
THE TOP OF A STAIRWAY
THE BOTTOM OF A STAIRWAY
A E/W/S 'T' INTERSECTION.
"AN E/W TUNNEL SMELLING OF SALT."
THE PIRATE'S COVE
A N/S TUNNEL.
A TINY DIRTY CHAMBER.
A SMALL E CHAMBER.
A N/E/W INTERSECTION.
A BEND IN THE TUNNEL.
A N/S TUNNEL.
A LARGE CAVERN.
AN EAST/WEST TUNNEL.
A NEAT DRY CHAMBER.
A LARGE CAVERN.
N.
"IN A SECRET CLOSET."

Text found in Super_Eamon_Beginners_Cave.dsk/EAMON.ROOMS.txt:

26
-99
2
0
0
0
0
1
1
4
0
0
0
0
1
0
0
4
0
0
0
1
2
7
5
3
0
0
1
0
0
0
4
0
0
1
0
0
7
0
0
0
1
4
10
8
6
0
0
1
0
0
0
7
0
0
1
0
0
10
0
0
0
1
7
13
11
9
0
0
1
0
0
0
10
0
0
1
0
0
13
0
0
0
1
10
15
14
12
0
0
1
0
0
0
13
0
0
1
13
20
-16
0
0
0
1
0
0
17
15
0
0
1
0
0
18
16
0
0
1
0
0
0
17
0
0
1
0
0
20
0
0
0
1
15
0
21
19
0
0
1
0
0
22
20
0
0
1
0
0
0
21
0
23
1
0
0
24
0
22
0
1
0
27
25
23
0
0
1
-37
0
26
24
0
0
1
0
0
0
25
0
0
1
24
30
29
28
0
0
1
0
0
27
0
0
0
1
0
0
0
27
0
0
1
27
0
31
34
0
0
1
0
32
0
30
0
0
1
31
33
0
0
0
0
1
32
0
0
0
0
0
1
0
35
30
36
0
0
1
34
0
0
0
0
0
1
0
0
34
0
0
0
1
0
25
0
0
0
0
1

Text found in Super_Eamon_Beginners_Cave.dsk/FRESH MEAT.txt:

1
VANCE
18
17
17
0
0
0
0
5
-10
20
10
0
0
M
17
-200
3
CLUB
3
10
1
4
NONE
0
0
0
0
NONE
0
0
0
0
NONE
0
0
0
0

Text found in Super_Eamon_Beginners_Cave.dsk/MAIN PGM.bas:


600 REM*MAIN LOOP
610 PRINT
620 IF SPD THEN SPD=SPD -1: IF NOT SPD THEN MD(0,2)=MD(0,2)/2:MD(0,10)=MD(0,10) -2 *MD(0,2): IFRND(0)>.8 THEN PRINT "YOUR SPEED SPELL HAS JUST EXPIRED!": PRINT
630 IF INT(V(ROOM)/2)<>V(ROOM)/2 THEN PRINT DK$;"READ EAMON.ROOM NAMES,R";ROOM: INPUT A$: PRINT DK$: PRINT "*STANDING IN": PRINT " ";A$: PRINT
640 IF INT(V(ROOM)/2)=(V(ROOM)/2) THEN PRINT DK$;"READ EAMON.DESC,R";ROOM: INPUT A$: PRINT DK$: PRINT A$: PRINT :V(ROOM)=V(ROOM) +1
650 FOR M=1 TO NM: IF MD(M,5)=ROOM AND MD(M,15)=1 THEN PRINT MN$(M);" IS HERE.": PRINT
660 IF MD(M,5)=ROOM AND NOT MD(M,15) THEN PRINT DK$;"READ EAMON.DESC,R";M +300: INPUT A$: PRINT DK$: PRINT A$:MD(M,15)=1: PRINT : IF M=10 THEN R=2: GOSUB 23800
670 NEXT : FOR A=1 TO NZ: IF AD(A,4)=ROOM AND AD(A,9) THEN PRINT "YOU SEE ";AN$(A);"."
680 IF AD(A,4)=ROOM AND NOT AD(A,9) THEN PRINT DK$;"READ EAMON.DESC,R";A +100: INPUT A$: PRINT DK$: PRINT A$:AD(A,9)=1: PRINT
690 NEXT A: FOR A=A TO NA: IF AD(A,4)=ROOM THEN PRINT "YOUR ";AN$(A) +" IS HERE."
700 NEXT
710 PRINT:INPUT" YOUR COMMAND";A$
720 IFLEFT$(A$,1)=" "THENA$=MID$(A$,2):GOTO720
730 IFA$=""THENA$=CZ$:ONA$=""THEN775:PRINT"("A$")"
740 CZ$=A$:FORA=2TOLEN(A$):IFMID$(A$,A,1)<>" "THENNEXT
750 V$=LEFT$(A$,A-1):S$=MID$(A$,A+1)
760 IFLEFT$(S$,1)=" "THENS$=MID$(S$,2):GOTO760
770 FORC=1TO6:IFLEFT$(C$(C),LEN(V$))=V$ GOTO790
772 NEXT:F=0:FORA=7TONC:IFC$(A)=V$THENC=A:GOTO790
773 IFLEFT$(C$(A),LEN(V$))=V$THENF=F+1:C=A:IFF>1THEN775
774 NEXT:IFFTHEN790
775 PRINT"HUH? I ONLY UNDERSTAND THESE COMMANDS-- ";:SPEED=225:FORC=1TONC:PRINTC$(C),
776 NEXT:SPEED=255:PRINT:GOTO710
780 IFC$(C)=S$THENS$=V$:V$=C$(C)
790 ONCGOTO3000,3000,3000,3000,3000,3000,4000,4000,5000,6000,6000,7000,8000,9000,10000:IFC<1ORC>31THEN800
791 ONC-15GOTO11000,12000,13000,14000,15000,15000,16000,23000,17000,19000,20000,21000,22000,24000,25000,26000

800 REM*COMMANDS RETURN TO HERE
810 IFNOTNBTLTHEN1030
820 FORM=1TONM:IFMD(M,5)<>ROOMORMD(M,15)=2THEN990
830 M2=MD(M,14)-(MD(M,14)=2):X=INT(41*RND(0)-20):X=X+(X=0):MR=FD(M2)/TD(M2)+X
840 IFMD(M,4)ROOMTHEN MD(M,5)=R2:M2=MD(M,14):TD(M2)=TD(M2)-MD(M,1):FD(M2)=FD(M2)-MD(M,13):GOTO990
845 IFMD(M,14)=2THEN990
850 IFMD(M,14)=3THEN890
860 OF=M:IFTD(3)=MD(0,1)THENDF=0:GOSUB7500:GOTO990
870 FORM2=1TONM:IFMD(M2,5)=ROOMANDMD(M2,14)=3ANDRND(0)<.25ANDMD(M2,15)<2THENDF=M2:GOSUB7500:M2=200:NEXTM2:GOTO990
880 NEXTM2:DF=0:GOSUB7500:GOTO990
890 OF=M
900 FORM2=1TONM:IFMD(M2,5)=ROOMANDMD(M2,14)=1THENDF=M2:GOSUB7500:M2=200:NEXTM2:GOTO990
910 NEXTM2
990 NBTL=(FD(1) 1 AND AD(A,2) <4 THEN NW=NW +1
1030 NEXT A: PRINT DK$;"OPEN EAMON.MONSTERS,L128": DIM MN$(NM),MD(NM,15): FOR A=1 TO NM: PRINT DK$;"READ EAMON.MONSTERS,R";A: INPUT MN$(A): FOR A2=1 TO 12: INPUT MD(A,A2): NEXT A2,A
1040 PRINT DK$;"OPEN FRESH MEAT": PRINT DK$;"READ FRESH MEAT": INPUT REC: INPUT MN$(0),MD(0,1),MD(0,2),CH: FOR A=1 TO 4: INPUT SA(A): NEXT : FOR A=1 TO 5: INPUT WA(A): NEXT : INPUT AE,SEX$,GOLD,BANK,AC
1050 NW=NW +4: DIM WN$(NW),WT(NW),WO(NW),WD(NW),WP(NW),WS(NW): FOR A=1 TO 4: INPUT WN$(A),WT(A),WO(A),WD(A),WS(A): NEXT : PRINT DK$;"CLOSE"
1055 REM >>> PRINT DK$;"DELETE FRESH MEAT"
1060 PRINT DK$;"OPEN EAMON.DESC,L256": PRINT DK$;"OPEN EAMON.ROOM NAMES,L64": PRINT DK$;"OPEN EAMON.ROOMS,L64"
1070 FOR W2=1 TO 4: IF WN$(W2)<>"NONE" THEN NA=NA +1:AN$(NA)=WN$(W2):AD(NA,2)=2:AD(NA,3)=2:AD(NA,4)=-1:AD(NA,5)=WO(W2):AD(NA,6)=WT(W2):AD(NA,7)=WD(W2):AD(NA,8)=WS(W2): NEXT :W2=4
1080 WZ=W2:WT=W *WZ
1090 FOR W2=1 TO WZ: FOR A=1 TO NA -WZ: IF AN$(A)=WN$(W2) THEN AN$(A)=AN$(A) +"#": FOR A=0 TO 0: NEXT :GOTO1090
1100 NEXT A,W2:EA=0:MD(0,8)=0:A2=INT(AC/2): IF A2 *2<>AC THEN MD(0,8)=1:EA=-5
1110 IF A2 THEN MD(0,8)=MD(0,8) +A2:EA=EA -A2 *10: IF A2=3 THEN MD(0,8)=MD(0,8) +2:EA=EA -30
1120 IF NA >NZ THEN MD(0,10)=(EA +AE) *( -EA >AE) +WO(1) +WA(WT(1)) +2 *MD(0,2):MD(0,7)=0:MD(0,9)=NZ +1:MD(0,11)=WD(1):MD(0,12)=WS(1):MD(0,14)=3
1130 READ NC: DIM C$(NC): FOR C=1 TO NC: READ C$(C): NEXT :R2=1
1140 FOR S=1 TO 4:S2(S)=SA(S): NEXT : DIM V(NR):ROOM=1:ND=6
1150 R2=1
1200 PRINT
1240 PRINT "THE KNIGHT MARSHAL RETURNS, AND TELLS YOU THAT IT IS OKAY FOR YOUR TO ENTER NOW THAT HE HAS STIRRED UP ALL THE MONSTERS!"
1300 GOTO3500
1910 DATA 31
1920 DATA NORTH,SOUTH,EAST,WEST,UP,DOWN,GET,TAKE,DROP,LOOK,EXAMINE,ATTACK,FLEE,GIVE,INVENTORY,BLAST,HEAL,POWER,SPEED,SMILE,WAVE,SAY,READ,READY,LIGHT,OPEN,PUT,DRINK
1930 DATA FREE,ENTER,TROLLSFIRE
2000 REM*DONE
2010 PRINT : PRINT "(HIT ANY KEY TO CONTINUE) ";: POKE -16368,0: GET A$: PRINT
2020 PRINT DK$"CLOSE": IF SPD THEN MD(0,2)=MD(0,2)/2
2030 IF DIE GOTO2500
2040 FOR W=1 TO 4:WN$(W)="NONE": NEXT :W2=1: FOR A=1 TO NA: IF AD(A,2) >1 AND AD(A,2) <4 AND AD(A,4)=-1 THEN WN$(W2)=AN$(A):WP(W2)=A:W2=W2 +1:AD(A,4)=0
2050 NEXT A: IF W2 <6 GOTO2300
2060 HOME : VTAB 5: PRINT "AS YOU START TO ENTER THE MAIN HALL,": PRINT "LORD WILLIAM MISSLEFIRE APPEARS AND": PRINT "TELLS YOU, 'YOU HAVE TOO MANY WEAPONS": PRINT "TO KEEP THEM ALL--4 IS THE LEGAL LIMIT.": PRINT : PRINT "YOUR WEAPONS ARE--"
2070 FOR W=1 TO W2 -1: PRINT SPC( 4);W;"--";WN$(W): NEXT : PRINT : PRINT "ENTER THE NUMBER OF THE WEAPON TO SELL (1-";W2 -1;") "
2080 VTAB PEEK(37): HTAB 23: INPUT A$:W5=VAL(A$): IF W5 <1 OR W5 >W2 -1 OR W5<>INT(W5) GOTO2080
2090 AD(WP(W5),4)=-1:WN$(W5)=WN$(W2 -1):WP(W5)=WP(W2 -1):W2=W2 -1: IF W2 >5 GOTO2060
2300 FOR W=1 TO 4: IF WP(W) THEN WT(W)=AD(WP(W),6):WO(W)=AD(WP(W),5):WD(W)=AD(WP(W),7):WS(W)=AD(WP(W),8)
2310 NEXT W: HOME : VTAB 5: PRINT "AS YOU DELIVER YOUR TREASURES TO SAM": PRINT "SLICKER, THE LOCAL BUYER FOR SUCH": PRINT "THINGS, HE EXAMINES YOUR GOODS AND": PRINT "PAYS YOU ";
2320 TP=0: FOR A=1 TO NA: IF AD(A,4)<>-1 GOTO2350
2330 IF AD(A,2)<>0 THEN AD(A,1)=AD(A,1) *CH/10
2340 TP=TP +AD(A,1)
2350 NEXT A: PRINT TP;" GOLD PIECES.": PRINT
2360 GOLD=GOLD +TP: IF GOLD <0 THEN GOLD=0
2370 PRINT : PRINT "(HIT ANY KEY TO CONTINUE) ";: GET A$: PRINT
2500 ONERR GOTO2500
2510 HOME : VTAB 5: PRINT "INSERT EAMON MASTER DISK": PRINT " OR SUPER EAMON DISK,": PRINT : PRINT " AND PRESS ";B$;B$;: POKE -16368,0
2520 GET A$: IF A$<>"C" GOTO2520
2530 PRINT A$
2540 IF DIE THEN PRINT DK$;"OPEN THE ADVENTURER,S6,D1": PRINT DK$;"DELETE THE ADVENTURER":GOTO2900
2550 PRINT DK$;"OPEN CHARACTERS,L150,S6,D1": PRINT DK$;"WRITE CHARACTERS,R";REC: PRINT MN$(0): PRINT MD(0,1): PRINT MD(0,2): PRINT CH: FOR A=1 TO 4: PRINT SA(A): NEXT
2560 FOR A=1 TO 5: PRINT WA(A): NEXT : PRINT AE: PRINT SEX$: PRINT GOLD: PRINT BANK: PRINT AC: FOR A=1 TO 4: PRINT WN$(A): PRINT WT(A): PRINT WO(A): PRINT WD(A): PRINT WS(A): NEXT
2570 PRINT DK$;"OPEN THE ADVENTURER": PRINT DK$;"WRITE THE ADVENTURER": PRINT MN$(0): PRINT REC: PRINT DK$;"CLOSE"
2900 PRINT DK$;"RUN MAIN HALL,S6,D1"
3000 REM*MOVE COMMAND
3010 IF NBTL AND S$<>"FLEE" THEN PRINT : PRINT "YOU CAN'T DO THAT WITH UNFRIENDLIES ABOUT!": PRINT :GOTO600
3020 FOR D=1 TO 6: IF LEFT$(V$,1)<>MID$ ("NSEWUD",D,1) THEN NEXT
3030 R2=RD(D): IF R2 >100 GOTO3300
3040 IF R2 >0 GOTO3500
3050 REM*SPECIAL MOVES
3060 IF R2=-99 THEN PRINT : PRINT "YOU SUCCESSFULLY RIDE OFF INTO THE": PRINT " SUNSET.":GOTO2000
3170 IF NOT R2 GOTO3490
3250 GOTO3490
3300 IF AD(R2 -100,7)=0 THEN R2=AD(R2 -100,5):GOTO3040
3310 IF AD(R2 -100,6)=0 THEN R2=AD(R2 -100,5):GOTO3040
3320 PRINT : PRINT "THE ";AN$(R2 -100);" BLOCKS THE WAY!":GOTO600
3490 PRINT : PRINT "YOU CAN'T GO THAT WAY!":V(ROOM)=0:GOTO600
3500 REM*MOVE IT
3530 R3=ROOM:ROOM=R2: GOSUB 3600
3540 PRINT DK$;"READ EAMON.ROOMS,R";ROOM:NX=0: FOR X=1 TO ND: INPUT RD(X): IF V(ROOM) >1 THEN RD(X)=ABS(RD(X))
3550 IF RD(X) >0 AND RD(X) <=NR THEN NX=NX +1
3560 NEXT : INPUT NL: PRINT DK$:LT=NL OR LM
3590 GOTO600
3600 REM*CHECK REACTIONS ON MONSTERS
3610 TD(1)=0:TD(3)=MD(0,1):FD(1)=0:FD(3)=MD(0,13)
3620 FOR M=1 TO NM
3625 IF MD(M,5)=R3 THEN IF MD(M,14)=3 OR (MD(M,14)=1 AND 200 *RND(0)ROOM GOTO3900
3640 IF MD(M,14) GOTO3670
3650 FR=MD(M,3): IF FR AND FR<>100 THEN FR=FR + INT((CH -10)/2)
3660 MD(M,14)=1: IF FR >(100 *RND(0)) THEN MD(M,14)=2: IF FR >(100 *RND(0)) THEN MD(M,14)=3
3670 A=MD(M,14):FD(A)=FD(A) +MD(M,13):TD(A)=TD(A) +MD(M,1)
3900 NEXT M:NBTL=(TD(1) >0): RETURN
4000 REM*GET
4010 GOSUB 4900
4020 IF S$="ALL" GOTO4160
4030 IF S$="TORCH" THEN PRINT : PRINT "ALL TORCHES ARE BOLTED TO THE WALL AND": PRINT "CANNOT BE REMOVED.": PRINT :GOTO800
4120 EMB=ROOM +200:WHER=ROOM:HA=RO: GOSUB 4810: IF NOT FO THEN PRINT : PRINT "I SEE NO ";S$;" HERE!": PRINT :GOTO600
4130 GOSUB 4200: IF NOT GT GOTO600
4135 IF WT +AD(A,3) >10 *MD(0,1) THEN PRINT : PRINT "IT IS TOO HEAVY FOR YOU.": PRINT :GOTO600
4140 PRINT : PRINT "GOT IT.":AD(A,4)=-1:SZ=SZ +AD(A,0):WT=WT +AD(A,3): PRINT : IF AD(A,2) <2 OR MD(0,9)<>-1 GOTO800
4150 GOTO17000
4160 PRINT : FOR A=1 TO NA: IF AD(A,4)<>ROOM GOTO4190
4170 GOSUB 4200: IF NOT GT GOTO4190
4175 IF WT +AD(A,3) >10 *MD(0,1) THEN PRINT AN$(A);" IS TOO HEAVY":GOTO4190
4180 PRINT AN$(A) +" TAKEN.":AD(A,4)=-1:WT=WT +AD(A,3)
4190 NEXT : PRINT :GOTO800
4200 REM*SPECIAL EFFECTS OF PICKING SOMETHING UP
4210 GT=1
4290 RETURN
4700 REM*MONST SEARCH
4705 WH=RO:HA=-1:EMB=RO
4710 FO=0: FOR X=1 TO NM: IF S$<>MN$(X) AND LEFT$(MN$(X), LEN(S$))<>S$ AND RIGHT$(MN$(X), LEN(S$))<>S$ GOTO4750
4720 IF MD(X,5)=WHER OR MD(X,5)=HAVE OR MD(X,5)=EMB THEN FO=1: RETURN
4750 NEXT : RETURN
4800 REM*ARTIF SEARCH
4805 WH=RO:HA=-1:EMB=RO
4810 FO=0: FOR A=1 TO NA: IF AN$(A)<>S$ AND LEFT$(AN$(A), LEN(S$))<>S$ AND RIGHT$(AN$(A), LEN(S$))<>S$ GOTO4850
4820 IF AD(A,4)<>WHER AND AD(A,4)<>HAVE AND AD(A,4)<>EMB THEN4850
4830 FO=1: RETURN
4850 NEXT : RETURN
4900 REM*ROUTINE TO GET S$ IF NOT SPECIFIED.
4905 IF S$="" THEN PRINT : PRINT C$(C);" WHAT";: INPUT S$:GOTO4900
4910 RETURN
5000 REM*DROP COMMAND
5010 GOSUB 4900
5020 IF S$="ALL" GOTO5100
5030 FOR A=1 TO NA: IF (AN$(A)<>S$ AND LEFT$(AN$(A), LEN(S$))<>S$ AND RIGHT$(AN$(A), LEN(S$))<>S$) OR AD(A,4)<>-1 THEN NEXT : PRINT : PRINT "YOU AREN'T CARRYING A ";S$: PRINT :GOTO600
5040 WT=WT -AD(A,3):AD(A,4)=ROOM: PRINT : PRINT AN$(A);" DROPPED.": PRINT
5042 IF A=LS THEN LS=0:LC=0:LM=0:LT=NL: PRINT : PRINT "THE ";AN$(A);" GOES OUT."
5050 IF WT >10 *MD(0,1) THEN PRINT "YOU SUDDENLY FIND YOU CANNOT CARRY ALL OF THE ITEMS YOU ARE CARRYING, AND THEY ALL FALL TO THE GROUND.": PRINT :GOTO5100
5060 IF MD(0,9) >0 THEN IF AD(MD(0,9),4)<>-1 THEN MD(0,9)=-1
5070 GOTO800
5100 FOR A=1 TO NA: IF AD(A,4)=-1 THEN PRINT AN$(A);" DROPPED.":AD(A,4)=ROOM
5110 NEXT A:WT=0:GOTO5060
6000 REM ///LOOK COMMAND
6010 LK=0: IF S$="" GOTO6070
6020 FOR A=1 TO NZ: IF AN$(A)=S$ AND (AD(A,4)=ROOM OR AD(A,4)=-1 OR AD(A,4)=200 +ROOM) THEN GOSUB 6200:LK=1:AD(A,9)=1
6025 IF AN$(A)=S$ AND AD(A,4)=200 +ROOM THEN LK=1:AD(A,4)=ROOM
6030 NEXT A: IF LK GOTO800
6040 FOR A=1 TO NM: IF MN$(A)=S$ AND MD(A,5)=ROOM THEN PRINT DK$;"READ EAMON.DESC,R";A +300: INPUT A$: PRINT DK$: PRINT : PRINT A$: PRINT :LK=1:A=NM
6050 NEXT A: ON LK GOTO800:V(ROOM)=V(ROOM) +1:GOTO800
6070 FOR X=1 TO ND: IF RD(X) <0 AND RD(X)=> -NR THEN PRINT : PRINT "YOU FOUND A SECRET PASSAGE ";C$(X);"!":RD(X)=ABS(RD(X)):V(ROOM)=2
6080 NEXT
6090 FOR A=1 TO NZ: IF AD(A,4)=ROOM +300 THEN AD(A,4)=ROOM:LK=1
6100 NEXT : IF LK THEN PRINT : PRINT "YOU FOUND SOMETHING."
6150 V(ROOM)=V(ROOM) +1:GOTO800
6200 REM*READ ART DESC
6210 IF A=3 OR A=13 THEN PRINT "THE BOTTLE SAYS, 'HEALING POTION'": RETURN
6310 PRINT DK$;"READ EAMON.DESC,R";A +100: INPUT A$: PRINT DK$: PRINT : PRINT A$: PRINT
6320 RETURN
7000 REM*ATTACK COMMAND
7010 GOSUB 4900: IF NOT LT THEN PRINT : PRINT "YOU SWING WILDLY --- AND HIT NOTHING.":GOTO800
7110 GOSUB 4700: IF NOT FO GOTO7150
7120 M=X:GOTO7290
7150 WH=RO:HAV=RO:EMB=RO +200: GOSUB 4810: IF NOT FO THEN PRINT : PRINT "ATTACK WHO?":GOTO600
7160 IF AD(A,2)<>8 AND AD(A,2)<>4 THEN PRINT : PRINT "THAT WOULD BE STUPID.":GOTO600
7170 S=7:K=6: IF AD(A,2)=4 THEN S=S -1:K=K -1
7180 D2=0: FOR X=1 TO MD(0,11):D2=D2 + INT(RND(0)*MD(0,12) +1): NEXT :AD(A,S)=AD(A,S) -D2: IF AD(A,S) <=0 THEN AD(A,S)=0:AD(A,K)=0: PRINT : PRINT "THE ";AN$(A);" SHATTERS!":GOTO800
7190 PRINT : PRINT "WHAM!! YOU HIT THE ";AN$(A);"!":GOTO800
7290 IF MD(0,9)=-1 THEN PRINT : PRINT "YOU HAVE NO WEAPON READY!": PRINT :GOTO600
7300 OF=0:DF=M: GOSUB 7500: IF NOT HIT GOTO7360
7310 IF INC THEN W2=AD(MD(0,9),6):WA(W2)=WA(W2) +2
7320 IF -EA <=AE GOTO800
7330 IFINT(100*RND(0)+1)<=MD(0,10)THEN7360
7340 A=2: IF EA +AE=-1 THEN A=1
7350 AE=AE +A:MD(0,10)=MD(0,10) +A
7360 IF MD(DF,14)=1 OR DF=0 GOTO800
7370 MD(DF,3)=MD(DF,3)/2: FOR M=1 TO NM: IF MD(M,5)=ROOM AND MD(M,14) >1 THEN MD(M,14)=0
7380 NEXT M:R3=ROOM: GOSUB 3600:GOTO800
7400 REM*MONSTER TRIES TO PICK UP WEAPON
7410 IF MD(OF,10)=0 THEN RETURN
7420 FOR A=1 TO NA: IF AD(A,4)<>ROOM OR AD(A,2) <2 OR AD(A,2) >3 THEN NEXT : RETURN
7430 PRINT MN$(OF);" PICKS UP ";AN$(A);".": PRINT :AD(A,4)=0:MD(OF,9)=A:MD(OF,10)=MD(OF,10) +AD(A,5):MD(OF,4)=MD(OF,4) *2: RETURN
7500 HIT=0: IF MD(OF,9)=-1 GOTO7400
7505 PRINT MN$(OF);" ATTACKS ";MN$(DF): PRINT " --";:RL=INT(100 *RND(0)+1):HIT=0: IF (RL <5 OR RL 0 THEN W=MD(OF,9): IF AD(W,2)=3 THEN PRINT : PRINT "SPARKS FLY FROM ";AN$(W);"!": RETURN
7535 IF FR >95 GOTO7550
7540 PRINT " WEAPON BROKEN!":AD(MD(OF,9),4)=0:MD(OF,10)=MD(OF,10) -AD(MD(OF,9),5):MD(OF,9)=-1:MD(OF,4)=MD(OF,4)/2: IFRND(0)>.5 THEN PRINT : RETURN
7545 PRINT " BROKEN WEAPON HURTS USER!"
7550 IF FR=100 GOTO7560
7555 D=MD(OF,11):S=MD(OF,12):DF=OF:A=1:GOTO7635
7560 D=MD(OF,11) *2:S=MD(OF,12):DF=OF:A=0:GOTO7635
7600 INC=( INT(100 *RND(0)+1) >MD(OF,10)):MD(OF,10)=MD(OF,10) +2 *INC
7605 D=MD(OF,11):S=MD(OF,12):A=1: IF RL >5 THEN PRINT "A HIT!":GOTO7635
7610 PRINT "A CRITICAL HIT!":R2=INT(100 *RND(0)+1): IF R2 <51 THEN A=0:GOTO7635
7615 IF R2 <86 THEN S=1.5 *S:GOTO7635
7620 IF R2 <96 THEN D=2 *D:GOTO7635
7625 IF R2 <100 THEN D=3 *D:GOTO7635
7630 GOTO7700
7635 D2=0: FOR D3=1 TO D:D2=D2 + INT(S *RND(0)+1): NEXT :D2=D2 -A *MD(DF,8): IF D2 <1 THEN PRINT " BLOW BOUNCES OFF ARMOUR": PRINT : RETURN
7640 MD(DF,13)=MD(DF,13) +D2: IF MD(DF,13) >=MD(DF,1) GOTO7700
7645 A=MD(DF,14):FD(A)=FD(A) +D2
7650 PRINT : PRINT MN$(DF);: ON INT(MD(DF,13) *5/MD(DF,1) +1) GOTO7655,7660,7665,7670,7675
7655 PRINT " IS STILL IN GOOD": PRINT " SHAPE.": RETURN
7660 PRINT " IS HURTING.": RETURN
7665 PRINT " IS IN PAIN.": RETURN
7670 PRINT " IS VERY BADLY INJURED.": RETURN
7675 PRINT " IS AT DEATH'S DOOR,": PRINT " KNOCKING LOUDLY.": RETURN
7700 REM*MONSTERS DYING EFFECTS
7705 PRINT MN$(DF);" IS DEAD!": PRINT :A=MD(DF,14):FD(A)=FD(A) +MD(DF,1) -MD(DF,13) +D2:MD(DF,5)=0
7710 FOR AJ=1 TO NA: IF AD(AJ,4)=-DF -1 THEN AD(AJ,4)=ROOM
7720 NEXT : IF MD(DF,9) >0 THEN AD(MD(DF,9),4)=ROOM:MD(DF,10)=MD(DF,10) -AD(MD(DF,9),5):MD(DF,9)=-1:MD(DF,4)=MD(DF,4)/2
7740 IF DF=0 THEN DIE=1:GOTO2000
7750 A2=DF +NZ -NM:AD(A2,4)=RO
7760 IF DF=10 THEN R=3: GOSUB 23800:AD(10,8)=6
7770 IF DF=7 THEN PRINT : PRINT "AS THE MIMIC DIES, IT ROLLS OVER AND": PRINT "YOU FIND A RING UNDERNEATH IT.":AD(6,4)=ROOM
7900 PRINT : RETURN
8000 REM*FLEE
8010 IF NOT NBTL THEN PRINT : PRINT "THERE'S NOTHING TO FLEE FROM!": PRINT :GOTO600
8015 IF MD(7,5)=ROOM THEN PRINT : PRINT "*HELD FAST BY THE MIMIC AND": PRINT "CANNOT FLEE!":GOTO800
8018 IF MD(15,5)=ROOM THEN PRINT : PRINT "*HELD TIGHTLY BY THE COILS OF": PRINT "THE SNAKE!":GOTO800
8020 FOR D=1 TO 6: IF S$=C$(D) THEN V$=S$:S$="FLEE":GOTO3000
8030 NEXT : IF NX=0 THEN PRINT : PRINT "THERE'S NO PLACE TO GO!":GOTO600
8040 GOSUB 8500:GOTO3500
8500 REM*MONSTER FLEES
8510 IF NX=0 THEN R2=ROOM: PRINT " ... BUT CAN'T FIND AN EXIT!": RETURN
8520 R2=RD(6*RND(0)+1):IFR2<1ORR2>NRTHEN8510
8530 RETURN
9000 REM*GIVE
9010 A2=1
9020 FOR M=1 TO NM: IF LEFT$(S$, LEN(MN$(M)))=MN$(M) AND MD(M,5)=ROOM GOTO9050
9030 NEXT : IF A2=1 THEN A2=2: PRINT : INPUT "WHO TO GIVE TO? ";S$:GOTO9020
9040 PRINT : PRINT "NOBODY HERE BY THAT NAME!": PRINT :GOTO600
9050 S$=MID$ (S$, LEN(MN$(M)) +1)
9060 IF LEFT$(S$,1)=" " THEN S$=MID$ (S$,2):GOTO9060
9065 IF VAL(S$) >0 GOTO9500
9068 IFS$=""THEN9085
9070 FOR A=1 TO NA: IF AN$(A)="" GOTO9080
9075 IF LEFT$(S$, LEN(AN$(A)))=AN$(A) AND AD(A,4)=-1 GOTO9095
9080 NEXT
9085 IF A2=2 THEN A2=3: PRINT : INPUT "WHAT TO GIVE? ";S$:GOTO9065
9090 PRINT : PRINT "YOU AREN'T CARRYING A ";S$;"!": PRINT :GOTO600
9095 IF A=MD(0,9) THEN MD(0,9)=-1
9100 PRINT : PRINT "OKAY.":AD(A,4)=-M -1:MD(M,14)=0:MD(M,3)=MD(M,3) *(1 +AD(A,1)/100)
9110 IF MD(M,10)<>0 AND MD(M,9)=-1 THEN MD(M,9)=A:MD(M,10)=MD(M,9) +AD(A,5):MD(M,4)=2 *MD(M,4)
9120 R3=ROOM: GOSUB 3600:GOTO5050
9500 IF VAL(S$) >GOLD THEN PRINT : PRINT "YOU AREN'T CARRYING THAT MUCH GOLD OF YOUR OWN!": PRINT :GOTO800
9510 GOLD=INT(GOLD - VAL(S$)):MD(M,0)=MD(M,0) + INT( VAL(S$)):MD(M,14)=0:MD(M,3)=MD(M,3) *(1 + VAL(S$)/100):GOTO9120
10000 REM*INVENTORY
10010 PRINT : PRINT "*CARRYING THE FOLLOWING--":A0=0: FOR A=1 TO NA: IF AD(A,4)=-1 THEN PRINT " ";AN$(A); LEFT$(" (READY WEAPON)",1 +20 *(A=MD(0,9))):A0=A0 +1: IF A0=15 THEN PRINT : PRINT "(HIT ANY KEY TO CONTINUE)";: GET A$: PRINT :A0=0
10020 NEXT :GOTO800
11000 REM*BLAST SPELL
11010 GOSUB 4900
11470 FOR M=1 TO NM: IF S$<>MN$(M) OR MD(M,5)<>ROOM THEN NEXT : PRINT : PRINT "YOU CAN'T BLAST ";S$;"!": PRINT :GOTO600
11480 S=1: GOSUB 11500: IF NOT SUC GOTO800
11490 PRINT : PRINT "DIRECT HIT!": PRINT :S=6:D=1:DF=M:A=0: GOSUB 7635: PRINT :GOTO800
11500 SUC=0: IF SA(S) THEN RL=INT(100 *RND(0)+1):SUC=(((RL S2(S) THEN S2(S)=S2(S) +2:SA(S)=SA(S) +2
11530 S2(S)=S2(S)/2
11540 RETURN
11600 PRINT : PRINT "THE STRAIN OF ATTEMPTING TO CAST THIS SPELL OVERLOADS YOUR BRAIN AND YOU FORGET IT COMPLETELY.": PRINT :SA(S)=0: RETURN
12000 REM*HEAL SPELL
12010 S=2: GOSUB 11500: IF NOT SUC GOTO800
12020 PRINT : IF MD(0,13) THEN PRINT "SOME OF YOUR WOUNDS SEEM TO CLEAR UP.": PRINT
12030 MD(0,13)=MD(0,13) - INT(10 *RND(0)+1): IF MD(0,13) <0 THEN MD(0,13)=0
12040 DF=0: GOSUB 7650:GOTO800
13000 REM*POWER SPELL
13010 S=4: GOSUB 11500: IF NOT SUC GOTO800
13020 RAISE=0: FOR M=1 TO NM:M2=NZ -NM +M: IF AD(M2,4)=ROOM OR AD(M2,4)=-1 THEN RAISE=1: GOSUB 13200
13030 NEXT M: IF RAISE THEN R3=ROOM: GOSUB 3600:GOTO800
13040 FOR A=1 TO NA: IF AD(A,4)=ROOM THEN RAISE=1: PRINT AN$(A);" VANISHES!":AD(A,4)=0
13050 NEXT A: IF RAISE THEN PRINT :GOTO800
13060 RR=INT(100 *RND(0)+1): IF RR <11 THEN PRINT : PRINT "THE SECTION OF TUNNEL YOU ARE IN ": PRINT " COLLAPSES AND YOU DIE.":DIE=1:GOTO2000
13080 IF RR <86 THEN PRINT : PRINT "YOU HEAR A VERY LOUD SONIC BOOM": PRINT " THAT ECHOES THROUGH THE TUNNELS.": PRINT :GOTO800
13090 IF RR >95 THEN PRINT : PRINT "ALL OF YOUR HITS ARE HEALED.": PRINT :MD(0,13)=0:GOTO800
13100 GOTO14020
13200 REM*RAISE DEAD
13210 PRINT MN$(M);" COMES ALIVE!":AD(M2,4)=0:MD(M,5)=ROOM:MD(M,13)=0: IF AD(M2,4)=-1 THEN WT=WT -AD(M2,3)
13290 RETURN
14000 REM*SPEED SPELL
14010 S=3: GOSUB 11500: IF NOT SUC GOTO800
14020 IF NOT SPD THEN MD(0,10)=MD(0,10) +2 *MD(0,2):MD(0,2)=2 *MD(0,2)
14030 SPD=SPD + INT(25 *RND(0)+10): PRINT : PRINT "YOU CAN FEEL THE NEW AGILITY FLOWING": PRINT " THROUGH YOU!": PRINT :GOTO800
15000 REM*SMILE COMMAND
15010 PRINT : FOR M=1 TO NM: IF MD(M,5)<>ROOM GOTO15100
15020 ON MD(M,14) GOTO15030,15040,15050
15030 PRINT MN$(M);" GROWLS AT YOU!":GOTO15100
15040 PRINT MN$(M);" IGNORES YOU.":GOTO15100
15050 PRINT MN$(M);" ";V$;"S BACK.":GOTO15100
15100 NEXT M: PRINT :GOTO800
16000 REM*SAY COMMAND
16010 GOSUB 4900
16030 IF S$="BLAST" THEN V$=S$:S$="":GOTO11000
16040 IF S$="HEAL" GOTO12000
16050 IF S$="POWER" GOTO13000
16060 IF S$="SPEED" GOTO14000
16070 IF S$="TROLLSFIRE" GOTO26000
16900 PRINT : PRINT "OKAY, '";S$;"'": PRINT :GOTO800
17000 REM ///READY A WEAPON.
17010 GOSUB 4900
17020 FOR A=1 TO NA: IF AN$(A)<>S$ OR AD(A,4)<>-1 THEN NEXT : PRINT : PRINT "YOU AREN'T CARRYING IT!": PRINT :GOTO600
17030 IF AD(A,2) <2 OR AD(A,2) >3 THEN PRINT : PRINT "THAT ISN'T A WEAPON!": PRINT :GOTO600
17980 MD(0,10)=(EA +AE) *( -EA >AE) +AD(A,5) +WA(AD(A,6)) +2 *MD(0,2):MD(0,9)=A:MD(0,11)=AD(A,7):MD(0,12)=AD(A,8)
17990 PRINT : PRINT "READIED.": PRINT :GOTO800
19000 REM*LIGHT
19010 GOSUB 4900: GOSUB 4800: IF NOT FO THEN PRINT : PRINT "I DON'T KNOW WHAT YOU MEAN.":GOTO600
19020 IF AD(A,2)<>5 THEN PRINT : PRINT "YOU BURN YOURSELF!":GOTO800
19030 IF AD(A,4)<>-1 THEN PRINT : PRINT "YOU HAVE TO PICK IT UP FIRST.":GOTO600
19040 LT=NL: IF AD(A,5) <=0 THEN PRINT : PRINT "IT WON'T LIGHT!":GOTO600
19050 LM=1:LT=1:LC=AD(A,5):LS=A: PRINT : PRINT "YOU'VE MANAGED TO LIGHT THE ";AN$(A);".":GOTO800
20000 REM*OPEN
20010 GOSUB 4900:WH=RO:HA=-1:EMB=RO +200: GOSUB 4810: IF NOT FO GOTO20200
20015 IF A=12 GOTO20500
20020 IF AD(A,2)=4 GOTO20100
20030 IF AD(A,2)=7 THEN PRINT : PRINT "TRY READING IT.":GOTO600
20040 IF AD(A,2)=1 THEN PRINT : PRINT "YOU'LL MAKE A MESS. WAIT TILL YOU LEAVE.":GOTO600
20050 IF AD(A,2)=8 GOTO20300
20060 PRINT : PRINT "THAT'S NOT WHAT YOU DO WITH IT.":GOTO600
20100 REM*OPEN CONTAINER
20110 IF AD(A,5) THEN IF AD(AD(A,5),4)<>-1 THEN PRINT : PRINT "IT'S LOCKED!":GOTO600
20120 LK=0: FOR X=1 TO NA: IF AD(X,4)=A +100 THEN AD(X,4)=ROOM:LK=1:
20130 NEXT : IF LK THEN PRINT : PRINT "YOU FOUND SOMETHING INSIDE!"
20140 GOTO800
20200 IF S$="DOOR" OR S$="GATE" THEN PRINT : PRINT "IT WILL OPEN WHEN YOU APPROACH.":GOTO600
20210 PRINT : PRINT "I DON'T KNOW HOW TO OPEN ";S$;".":GOTO600
20300 REM*OPEN DOOR/GATE
20310 IF AD(A,6) THEN IF AD(AD(A,6),4)<>-1 THEN PRINT : PRINT "IT'S LOCKED!":GOTO600
20330 AD(A,6)=0: PRINT : PRINT "YOU'VE OPENED THE ";AN$(A);".": FOR X=1 TO ND: IF RD(X)=A +100 THEN RD(X)=AD(A,5)
20340 NEXT :GOTO800
20500 PRINT :R=1: GOSUB 23800:AD(12,4)=0:MD(7,5)=ROOM:R3=ROOM: GOSUB 3600:GOTO600
21000 REM*PUT
21010 IF S$="" GOTO21040
21015 FOR X=1 TO LEN(S$): IF MID$ (S$,X,5)=" INTO" AND X >2 THEN A$=LEFT$(S$,X -1):B$=MID$ (S$,X +6):GOTO21100
21020 IF MID$ (S$,X,3)=" IN" AND X >2 THEN A$=LEFT$(S$,X -1):B$=MID$ (S$,X +3):GOTO21100
21030 NEXT : PRINT : INPUT "PUT WHAT?";A$: INPUT "PUT INTO WHAT?";B$:GOTO21100
21040 PRINT : INPUT "PUT WHAT?";A$: INPUT "PUT INTO WHAT?";B$:GOTO21100
21100 S$=A$: GOSUB 4800: IF NOT FO THEN PRINT "I DON'T KNOW WHAT YOU MEAN.":GOTO600
21110 X=A:S$=B$: GOSUB 4800: IF NOT FO OR A=X GOTO21150
21120 AD(X,4)=A +100: PRINT : PRINT "OKAY.":GOTO800
21150 PRINT : PRINT "DON'T BE ABSURD.":GOTO600
22000 REM*HEALING POTION
22010 GOSUB 4900: IF S$="POTION" THEN S$="BOTTLE"
22015 GOSUB 4800: IF NOT FO THEN PRINT : PRINT "I DON'T UNDERSTAND.":GOTO600
22020 IF AD(A,2)<>6 THEN PRINT : PRINT "YOU CAN'T DO THAT!":GOTO600
22030 IF AD(A,7) <=0 THEN PRINT : PRINT "THERE ISN'T ANY LEFT.":GOTO800
22040 IF AD(A,5) > INT(RND(0)*100) GOTO22100
22050 PRINT : PRINT "NOTHING SEEMS TO HAPPEN.":GOTO800
22100 REM*HEAL
22110 AD(A,7)=AD(A,7) -1:MD(0,13)=MD(0,13) -AD(A,6)
22120 PRINT : PRINT "YOUR WOUNDS SEEM TO "; MID$ ("OPENHEAL",(AD(A,6) >0) *4 +1,4);"!"
22130 GOTO800
23000 REM*READ
23010 GOSUB 4900:WH=RO:HAV=-1:EMB=RO +200: GOSUB 4810: IF NOT FO GOTO23100
23020 IF AD(A,2)=7 GOTO23200
23090 PRINT : PRINT "YOU CAN'T READ THAT!":GOTO800
23100 READ NON-ARTIF
23110 PRINT : PRINT "THERE IS NOTHING TO READ.":GOTO600
23200 REM*READ ARTIF
23210 IF A=9 GOTO23300
23250 PRINT : FOR X=1 TO AD(A,6):R=AD(A,5) -1 +X: GOSUB 23800: NEXT : PRINT : PRINT "PRESS A KEY TO CONTINUE";: GET A$: PRINT
23290 GOTO800
23300 REM*READ BOOK
23310 R=7: GOSUB 23800
23320 IF ROOM=26 THEN R=8: GOSUB 23800:DIE=1:GOTO2000
23330 R=9: GOSUB 23800:DIE=1:GOTO2000
23800 PRINT DK$;"READ EAMON.DESC,R";R +200: INPUT A$: PRINT DK$: PRINT A$: RETURN
24000 REM*FREE
24010 GOSUB 4900: FOR A=1 TO NA: IF S$<>AN$(A) AND S$<>RIGHT$(AN$(A), LEN(S$)) THEN NEXT : PRINT : PRINT "I DON'T UNDERSTAND.":GOTO600
24020 IF AD(A,2)<>10 THEN PRINT : PRINT "I DON'T UNDERSTAND.":GOTO600
24030 M=AD(A,5):K=AD(A,6):G=AD(A,7)
24110 IF AD(A,4)<>ROOM THEN PRINT : PRINT "I DON'T KNOW WHAT YOU ARE TALKING ABOUT.":GOTO600
24120 IF MD(G,5)=ROOM THEN PRINT : PRINT MN$(G);" WON'T LET YOU DO THAT!":GOTO800
24130 IF AD(K,4)<>-1 AND K<>0 THEN PRINT : PRINT "YOU DON'T HAVE THE KEY!":GOTO600
24150 PRINT : PRINT "YOU HAVE FREED ";MN$(M);".":MD(M,5)=ROOM:AD(A,4)=0:R3=ROOM: GOSUB 3600:GOTO800
25000 REM*ENTER
25010 IF (S$="WATER" OR S$="SEA") AND ROOM=26 THEN PRINT : PRINT "I'M AFRAID TO GO INTO THE WATER WITHOUT MY LIFE PRESERVER!":GOTO600
25020 IF S$="CAVE" AND ROOM=1 THEN V$="S":GOTO3000
25030 PRINT : PRINT "I'M NOT SURE WHAT YOU MEAN BY THAT. TRY GIVING A DIRECTION TO MOVE IN."
25900 GOTO600
26000 REM*TROLLSFIRE
26010 IF AD(10,4)<>-1 THEN PRINT : PRINT "NOTHING HAPPENS.":GOTO800
26020 IF NOT TR GOTO26500
26030 PRINT :R=6: GOSUB 23800:TR=0:AD(10,8)=6: IF MD(0,9)=10 THEN MD(0,12)=6
26040 GOTO800
26500 PRINT :R=4: GOSUB 23800: IF MD(0,9)<>10 THEN R=5: GOSUB 23800:D=1:S=5:DF=0: GOSUB 7635:GOTO800
26510 TR=1:AD(10,8)=10:MD(0,12)=10:GOTO800
26900 GOTO800
