0 GOSUB5500
5 CLS:PRINT@334,CHR$(23)"S T A R   T R E K":PRINT@398,"A D V E N T U R E":CLEAR500:DEFINTA-Z
10 DIMDS$(32),DI(32,5),OB$(26),OB(26),DI$(5),VB$(21),NN$(26),DD$(5)
20 ML$="THIS SAVES ROOM FOR PRINT SCRAMBLER!"
29 J=PEEK(VARPTR(ML$)+1)+256*PEEK(VARPTR(ML$)+2):J=J+65535*(J>32767):FORK=JTOJ+13:READX:POKEK,X:NEXTK:DELETE29:DATA121,254,128,48,6,254,64,56,2,61,13,195,115,4
30 S1=PEEK(16414):S2=PEEK(16415):POKE16414,PEEK(VARPTR(ML$)+1):POKE16415,PEEK(VARPTR(ML$)+2):FX=PEEK(16414)+256*PEEK(16415)+10:IFPEEK(16396)=201THENPOKE16396,23ELSEPOKE23886,0
35 ON ERRORGOTO1620
40 FORI=1TO32:PRINT@62+I*2,CHR$(188);:PRINT@638+I*2,CHR$(143);:FORJ=0TO5:READDI(I,J):NEXTJ,I:FORI=1TO26:READOB(I):NEXTI
50 DATA2,0,0,0,0,0,0,3,1,10,0,0,0,0,0,2,0,0,4,4,4,4,0,0,0,11,12,9,0,0,0,0,10,0,9,17,7,10,0,8,0,0,0,7,0,0,0,0,0,5,0,0,0,6,6,2,0,7,0,0,0,0,13,5,0,0,5,13,0,0,0,0,11,0,0,12,0,0
60 DATA14,16,18,0,0,0,17,18,0,15,0,0,0,16,0,14,0,0,0,0,15,0,6,24,14,19,18,15,0,0,0,0,0,18,0,0,24,27,0,23,0,0,0,22,0,0,0,0,22,22,23,21,0,0,22,20,23,23,0,0,0,0,20,0,17,29
70 DATA29,28,25,0,0,0,0,0,0,27,0,0,0,26,27,20,0,0,28,30,28,25,0,0,0,0,25,0,24,0,30,32,31,28,0,0,30,0,0,0,0,0,0,0,0,30,0,0
80 DATA32,12,13,11,5,10,15,20,25,26,7,14,27,4,8,4,16,19,21,21,21,27,31,32,1,5
100 DS$(1)="JO UIF DBQUBJO'T RVBSUFST PO CPBSE
UIF GFEFSBUJPO TUBSTIJQ FOUFSQSJTF.":DS$(2)="JO B DPSSJEPS PG UIF FOUFSQSJTF.
JOUFSTFDUJOH IBMMXBZT MFBE PGG JO BMM EJSFDUJPOT."
105 DS$(3)="JO UIF USBOTQPSUFS SPPN.  PO POF TJEF JT
B DPOUSPM QBOFM ... PO UIF PUIFS UIF USBOTQPSUFS DIBNCFS.":DS$(4)="PO UIF TVSGBDF PG QMBOFU UFJSBT 80 ...
B SPDLZ EFTPMBUF UFSSBJO VOEFS B TDPSDIJOH TVO."
110 DS$(5)="BU UIF FOUSBODF UP B UVSCPMJGU.":DS$(6)="JO UIF UVSCPMJGU."
115 DS$(7)=DS$(2):DS$(8)="JO POF PG UIF DSFX'T RVBSUFST.
MJLF BMM UIF PUIFST, JU IBT B CFE, ESFTTJOH SPPN, BOE DMPTFU.":DS$(9)=DS$(6):DS$(10)=DS$(5)
120 DS$(11)="BU UIF OBWJHBUJPO DPOUSPM DFOUFS...
B UXP NBO QPTU VTVBMMZ NBOOFE CZ TVMV BOE DIFLIPW.":DS$(12)="BU UIF DPNNVOJDBUJPOT TUBUJPO...
B DPNQMJDBUFE QBOFM PG JOTUSSVNFOUT VTVBMMZ NBOOFE CZ VIVSV."
125 DS$(13)="BU UIF TDJFODF PGGJDFS'T TUBUJPO...
UIF QSJNBSZ DPOUSPM QPTU GPS UIF TIJQ'T DPNQVUFS."
130 DS$(14)=DS$(2):DS$(15)=DS$(5):DS$(16)="JO UIF TIJQ'T MJCSBSZ...
B WBTU SPPN FRVJQQFE XJUI WJFXJOH TDSFFOT BOE UBQFT.":DS$(17)=DS$(6):DS$(18)=DS$(2):DS$(19)="JO UIF TJDL CBZ...
BSPVOE ZPV BSF WBSJPVT JUFNT PG NFEJDBM FRVJQNFOU.":DS$(20)=DS$(5)
140 DS$(21)="JO UIF TIJQ'T DFOUSBM TVQQMZ XBSFIPVTF.":DS$(22)=DS$(2):DS$(23)=DS$(2):DS$(24)=DS$(6):DS$(25)=DS$(5):DS$(26)="JO B TFDVSJUZ DFMM JO UIF CSJH.":DS$(27)=DS$(2)
150 DS$(28)=DS$(2):DS$(29)=DS$(6):DS$(30)="JO UIF FOHJOFFSJOH TFDUJPO --
B MBSHF SPPN XJUI UXP TNBMM BEKPJOJOH SPPNT. BU UIF GBS FOE PG
UIJT BSFB JT UIF NBUUFS / BOUJ-NBUUFS XBSQ FOHJOF ESJWF." 
155 DS$(31)="BU UIF EJMJUIJVN DSZTUBM QPXFS TUBUJPO.":DS$(32)="BU UIF BVYJMJBSZ DPOUSPM TUBUJPO."
160 OB$(1)="BO VOBSNFE LMJOHPO DPNNBOEFS":OB$(2)="B CVUUPO MBCFMMFE TFOTPST":OB$(3)="B CVUUPO MBCFMMFE TIJQ'T TUBUVT":OB$(4)="B CVUUPO MBCFMMFE GJSF JNQVMTF FOHJOFT"
170 OB$(5)="B TJHO PO UIF PQQPTJUF XBMM":FORI=6TO9:OB$(I)=OB$(5):NEXT:OB$(10)="NS. TQPDL MZJOH VODPOTDJPVT PO UIF GMPPS":OB$(11)="B LMJOHPO TPMEJFS":OB$(12)="B LMJOHPO HVBSE"
180 OB$(13)="B LMJOHPO TFOUSZ":OB$(14)="B LMJOHPO PGGJDFS":OB$(15)="B GVSSZ DSFBUVSF LOPXO BT B USJCCMF":OB$(16)="SBX EJMJUIJVN DSZTUBMT":OB$(17)="UIF UFDOJDBM NBOVBM GPS UIF TUBSTIJQ FOUFSQSJTF"
190 OB$(18)="B IZQP XJUI UIF MBCFM BOUJEPUF JOKFDUJPO":OB$(19)="B QIBTFS":OB$(20)="B DPNNVOJDBUPS":OB$(21)="BO FMFDUSPOJD TIVOU":OB$(22)="TQPDL'T USJDPSEFS":DI$(0)="OPSUI":DI$(1)="FBTU":DI$(2)="TPVUI":DI$(3)="XFTU":DI$(4)="VQ":DI$(5)="EPXO"
200 OB$(23)="UIF EJMJUIJVN DSZTUBM QPXFS TUBUJPO -- UIF DSZTUBMT BSF
GVTFE BOE POMZ QSPWJEJOH B GSBDUJPO PG OPSNBM FOFSHZ MFWFMT.":OB$(24)="UIF BVYJMJBSZ DPOUSPM QBOFM -- B LFZ DPNQPOFOU
IBT CFFO SFNPWFE JO UIF DFOUFS PG UIF DJSDVJU"
205 OB$(25)="B 3E DIFTT TFU":OB$(26)="TUBS DIBSUT"
210 VB$="!!!OPSFBTTPVXFTVQ!EPXIFMJOWTDPRVJMPPHP!HFUESPTBZUISGJSQSFSFBJOTJOK":FORI=1TO21:VB$=RIGHT$(VB$,LEN(VB$)-3):FORJ=1TO3:VB$(I)=VB$(I)+CHR$(ASC(MID$(VB$,J,1))-1):SET(0,I+5):SET(1,I+5):NEXTJ,I
215 FORI=0TO1:FORJ=27TO29:SET(I,J):NEXTJ,I
220 NN$="!!!!FOFSDPNNCVUUCVUUCVUUTJHOTJHOTJHOTJHOTJHOTQPDLMJOLMJOLMJOLMJOUSJCDSZTNBOVIZQPQIBTDPNNTIVOUSJD"
230 FORI=0TO22:NN$=RIGHT$(NN$,LEN(NN$)-4):FORJ=1TO4:NN$(I)=NN$(I)+CHR$(ASC(MID$(NN$,J,1))-1):SET(124,I+6):SET(125,I+6):NEXTJ,I:PL=1:SP=0:KE=-1:CR=0:SH=0:DE=-1:TT=0:SET(124,29):SET(125,29):TD!=1
240 DD$(1)="CSJEHF":DD$(2)="QFSTPOOFM TFDUJPO":DD$(3)="UFDIOJDBM EFQBSUNFOUT":DD$(4)="TFDVSJUZ TFDUJPO":DD$(5)="FOHJOFFSJOH EJVJTJPO":NN$(25)="CHES":NN$(26)="CHAR"
250 FORTI=1TO1000:NEXT
500 CLS:PRINT"ZPV ";:IFSPTHENPRINT"BOE TQPDL BSF ";ELSEPRINT"BSF ";;
510 PRINTDS$(PL):PRINT:PRINT"PCWJPVT FYJUT BSF:":FORJ=0TO5:IFDI(PL,J)<>0THENPRINTDI$(J);"   ";:NEXT:PRINTELSENEXT:PRINT
515 IFPL=21THENPRINT:PRINT"ZPV DBO TFF UIF GPMMPXJOH PCKFDUT:":PRINT"UIF FOUJSF TIJQ'T TUPSFIPVTF PG TVQQMJFT.":GOTO525
520 K=0:PRINT:PRINT"ZPV DBO TFF UIF GPMMPXJOH PCKFDUT:":FORJ=1TO26:IFOB(J)=PLTHENK=1:PRINTOB$(J):NEXTELSENEXTJ:IFK=0PRINT"OPUIJOH"
525 IFOB(11)=PLOROB(12)=PLOROB(13)=PLOROB(14)=PLTHEN3000
530 IFKEANDSPANDPL=28THENPRINT"
TQPDL TBZT -- DBQUBJO, NZ USJDPSEFS JOEJDBUFT B MBSHF OVNCFS
PG LMJOHPOT UP UIF FBTU.  UPP NBOZ GPS VT UP EFGFBU XJUI
KVTU IBOE QIBTFST."
540 IFKEANDPL=30THENPRINT"
ZPV BSF TVSSPVOEFE CZ B TRVBESPO PG LMJOHPO TPMEJFST.
ZPV IBWF UJNF GPS POMZ POF BDUJPO CFGPSF UIFZ GJSF!":GOTO3500
1000 GOSUB4000:PRINT:POKEFX,0:CM$="":PRINT"COMMAND ? ";:PP=PEEK(16416)+256*PEEK(16417)-15360:GOSUB5000:CM$=CM$+"    ":POKEFX,13
1005 VB$=LEFT$(CM$,3):NN$="":FORI=1TOLEN(CM$)-4:IFMID$(CM$,I,1)=" "THENNN$=MID$(CM$,I+1,4):I=255
1010 NEXTI:VB=0:FORJ=1TO21:IFVB$=VB$(J)THENVB=J
1020 NEXTJ:IFVB=0THENPRINT"DBO ZPV SFQFBU UIBU ";:GOTO1000
1030 NN=-1:FORJ=0TO26:IFNN$=NN$(J)THENNN=J
1040 NEXTJ:IF(NN=-1ANDVB>12)ANDVB<>15THENPRINT"DBO ZPV SFQFBU UIBU ";:GOTO1000
1050 ONVBGOTO1100,1100,1100,1100,1100,1100,1190,1400,1500,1600,500,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600
1100 IFDI(PL,VB-1)<>0THENPL=DI(PL,VB-1):GOTO500
1110 PRINT"ZPV DBOOPU HP JO UIBU EJSFDUJPO.":GOTO1000
1190 IFPL=4THEN1240
1200 IFNOTSPTHENPRINT"TPSSZ, DBQUBJO, ZPV BSF PO ZPVS PXO.":GOTO1000ELSEONPLGOSUB1210,1220,1230,1240,1220,1220,1250,1260,1220,1220,1270,1270,1270,1250,1220,1220,1220,1220,1220,1220,1280,1220,1220,1220,1220,1220,1250,1290,1220,1220,1300,1295:GOTO1000
1210 PRINT"QFSIBQT ZPV XPVME MJLF UP UBLF B OBQ?":RETURN
1220 PRINT"J TFF OPUIJOH PVU PG UIF PSEJOBSZ, DBQUBJO.":RETURN
1230 PRINT"ZPV VTVBMMZ TBZ <<FOFSHJ[F>> BU UIJT QPJOU, DBQUBJO.":RETURN
1240 PRINT"XJUIPVU B DPNNVOJDBUPS ZPV BSF USBQQFE PO UIJT QMBOFU GPSFWFS.":RETURN
1250 KH=0:FORJ=11TO14:IFOB(J)=PLTHENKH=1:NEXTELSENEXTJ
1255 IFKH=1THENPRINT"J TVHHFTU ZPV GJSF B QIBTFS.":RETURNELSE1220
1260 IFOB(15)=8THENPRINT"EP ZPV UIJOL UIJT DSFBUVSF DPVME CF VTFGVM?":RETURNELSE1220
1270 PRINT"EP ZPV XBOU NF UP QSFTT UIF CVUUPO?":RETURN
1280 PRINT"BMNPTU BOZ FRVJQNFOU ZPV SFRVJSF JT BWBJMBCMF.":RETURN
1290 IFKETHENPRINT"QFSIBQT JG XF IBE TPNFUIJOH UP GSJHIUFO UIFN BXBZ!":RETURNELSE1220
1295 IFOB(1)=32THENPRINT"J CFMJFWF UIF LMJOHPO-FTF QISBTF GPS <<EP ZPV TVSSFOEFS>>
JT <<USPYBFUJ>>.  QFSIBQT JG ZPV USJFE UIBU, DBQUBJO ?":RETURN
1300 PRINT"J TVHHFTU XF DPOTVMU UIF UFDIOJDBM NBOVBM.":RETURN
1400 PRINT:PRINT"ZPV BSF DBSSZJOH UIF GPMMPXJOH JUFNT:":K=0:FORJ=15TO26:IFOB(J)=0THENPRINTOB$(J):K=1
1410 NEXTJ:IFK=0THENPRINT"OPUIJOH"
1420 GOTO1000
1500 SC=(OB(16)=0ORCR)+(OB(19)=0)+CR+SH+(OB(1)=26)+(DE=0)+(KE=0)+SP:SC=SC*10:FORI=11TO14:IFOB(I)=-1THENSC=SC-5
1510 NEXTI:PRINT"ZPVS TDPSF UIVT GBS JT";-SC;"%":IFSC=-100THEN PRINT"DPOHSBUVMBUJPOT ... ZPV IBWF CFFO QSPNPUFE UP DPNNPEPSF!":GOTO1600ELSE1000
1600 PRINT"XPVME ZPV MJLF UP USZ BHBJO ?":GOSUB1650
1610 CM$=INKEY$:IFCM$="Y"THENRUN5ELSEIFCM$="N"THENENDELSE1610
1620 GOSUB1650:PRINT:PRINT"ERROR CODE";ERR/2+1;"IN LINE";ERL:END
1650 POKE16414,S1:POKE16415,S2:IFPEEK(16396)=23THENPOKE16396,201:RETURNELSEPOKE23886,1:RETURN
1700 VB$=LEFT$(NN$,3):VB=0:FORJ=1TO6:IFVB$=VB$(J)THENVB=J
1710 NEXTJ:IFVB=0THENFORJ=1TO1:GOTO1020ELSE1100
1800 IFNN<15THENPRINT"UIBU DBOOPU CF EPOF.":GOTO1000
1810 IFOB(NN)=PLANDTT<5THENPRINT"P.L.  BEE ";OB$(NN):PRINT"UP ZPVS JOWFOUPSZ.":OB(NN)=0:TT=TT+1:GOTO1000
1815 IFOB(NN)=PLTHENPRINT"ZPV BSF DBSSZJOH UPP NVDI.  ESPQ TPNFUIJOH.":GOTO1000
1820 IFOB(NN)=0THENPRINT"ZPV BMSFBEZ IBWF UIBU!":GOTO1000
1830 PRINT"XIFSF EP ZPV TFF UIBU?":GOTO1000
1900 IFOB(NN)<>0THENPRINT"ESPQ XIBU?":GOTO1000
1910 IFNN=16ANDOB(16)=0THENPRINT"P.L.  BT ZPV ESPQ UIFN, UIF DSZTUBMT TIBUUFS JOUP VTFMFTT EVTU.":OB(16)=4:TT=TT-1:GOTO1000
1920 PRINT"P.L.  ZPV IBWF ESPQQFE ";OB$(NN):OB(NN)=PL:TT=TT-1:GOTO1000
2000 IFPL=3IFSPIFNN=0THENPRINT"TQPDL TBZT -- BZF BZF DBQUBJO.":FORI=1TO50:PRINT"*";:FORJ=1TO50:NEXTJ,I:FORJ=1TO1000:NEXTJ:PL=4:SP=0:GOTO500
2010 IFPL=4IFOB(20)=0IFNN=0THENPRINT"TQPDL SFTQPOET -- CFBNJOH ZPV BCPBSE DBQUBJO.":FORI=1TO50:PRINT"*";:FORJ=1TO50:NEXTJ,I:FORJ=1TO1000:NEXTJ:PL=3:SP=-1:GOTO500
2020 IFPL=3IFNN=0THENPRINT"ZPV OFFE TPNFPOF UP XPSL UIF DPOUSPMT.":GOTO1000
2030 IFPL=32IFNN$="TROX"IFOB(1)=32THENPRINT"UIF DPNNBOEFS IBT TVSSFOEFSFE BOE XJMM BXBJU USJBM JO UIF
CSJH.  IF IBT BMTP DPOGFTTFE UIBU UIF DSFX JT VOIBSNFE PO UIF
QMBOFU'T TVSGBDF BOE XJMM TVQQMZ USBOTQPSUFS DP-PSEJOBUFT.":OB(1)=26:GOTO1000
2040 PRINT"P.L.  ZPV TBJE JU CVU"
2050 PRINT"OPUIJOH IBQQFOFE.":GOTO1000
2100 IFOB(NN)<>0THENPRINT"ZPV DBOOPU UISPX TPNFUIJOH ZPV EP OPUIBWF.":GOTO1000ELSETT=TT-1
2110 IFNN=16THENPRINT"P.L.  BT B SFTVMU UIF DSZTUBMT IBWF
TIBUUFSFE JOUP VTFMFTT EVTU.":OB(16)=4:GOTO1000
2120 IFNN>16THENPRINT"P.L.":IFSPTHENPRINT"TQPDL TBZT -- B NPTU JMMPHJDBM NPWF DBQUBJO."
2130 IFNN>16THENOB(NN)=PL:GOTO1000
2140 FORI=11TO14:IFOB(I)=PLTHENPRINT"UIF LMJOHPO XBT TP BGSBJE PG UIF USJCCMF UIBU IF
UVSOFE BOE SBO BXBZ UP IJEF.  EPO'S XPSSZ BCPVU IJN BOZNPSF!":OB(I)=-1:OB(15)=PL:I=15:NEXTI:GOTO1000ELSENEXTI
2150 IFOB(1)=PLTHENPRINT"UIF LMJJOHPO DPNNBOEFS JT FTQFDJBMMZ CSBWF
BOE TIBLJMZ IPMET IJT HSPVOE.":OB(15)=PL:GOTO1000
2160 IFPL=30ANDKETHENPRINT"PODF UIF LMJOHPOT SFBMJ[F UIFZ IBWF B USJCCMF JO UIJFS NJETU
UIFZ UVSO BOE SVO JO BMM EJSFDUJPOT.";
2165 IFPL=30IFKEIFSPTHENPRINT"  TQPDL TBZT -- FYDFMMFOU
DBQUBJO.  ZPV NVTU IBWF SFNFNCFSFE IPX JMMPHJDBMMZ GSJHIUFOFE
UIF LMJOHPOT BSF PG USJCCMFT.":ELSEPRINT
2170 IFPL=30ANDKETHENKE=0:OB(15)=30:GOTO1000
2180 PRINT"P.L.":OB(15)=PL:GOTO1000
2200 IFNN<>19THENPRINT"ZPV DBOOPU EP UIBU.":GOTO1000
2210 IFOB(19)<>0THENPRINT"ZPV DBOOPU EP UIBU ZFU.":GOTO1000
2220 FORI=11TO14:IFOB(I)=PLTHENPRINT"P.L.":PRINTSTRING$(64,131);:FORK=1TO10:NEXTK:PRINTCHR$(27);CHR$(30):PRINT"UIF LMJOHPO IBT CFFO SFNPWFE.":OB(I)=-1:I=15:NEXTI:GOTO1000
2230 NEXTI:IFOB(I)=PLTHENPRINT"P.L.":PRINTSTRING$(64,131);:FORK=1TO10:NEXTK:PRINTCHR$(27);CHR$(30):PRINT"UIF DPNNBOEFS IBT CFFO SFNPWFE.":IFSPTHENPRINT"TQPDL TBZT -- IJHIMZ JMMPHJDBM UP LJMM BO VOBSNFE NBO, DBQUBJO.":OB(1)=-1:GOTO1000ELSEOB(1)=-1:GOTO1000
2240 PRINT"P.L.":PRINTSTRING$(64,131);:FORK=1TO10:NEXTK:PRINTCHR$(27);CHR$(30):IFSPTHENPRINT"TQPDL TBZT -- XIZ XBTUF WBMVBCMF QIBTFS BIBSHF, DBQUBJO?":GOTO1000ELSE1000
2300 IFNN<2ORNN>4THENPRINT"EP XIBU, DBQUBJO?":GOTO1000
2310 IFPL<11ORPL>13THENPRINT"XIBU CVUUPO, DBQUBJO?":GOTO1000
2320 IFPL=12ANDKETHENPRINT"UIF DPNQVUFS SFTQPOET -- TFOTPST JOEJDBUF POF IVNBJOPJE MJGF
GPSN PO CPBSE, NBOZ LMJOHPO MJGF GPSNT, ... BOE POF WVMDBO.":GOTO1000
2330 IFPL=12THENPRINT"UIF DPNQVUFS SFTQPOET -- TFOTPST JOEJDBUF POF IVNBOPJE MJGF
GPSN BOE POF WVMDBO MJGF GPSN PO CPBSE.":GOTO1000
2340 IFPL=13THENPRINT"UIF DPNQVUFS SFTQPOET -- UIF FOUFSQSJTF JT JO PSCJU BSPVOE
QMBOFU UFJSBT 80 ... B DMBTT N QMBOFU ... PYZHFO - OJUSPHFO
BUNPTQIFSF ... SJDI JO DSZTUBMMJUF NJOFSBMT."
2350 IFPL=13IFDEPRINT"UIF FOUFSQSJTF XJMM CFHJO UP CVSO VQ JO UIF BUNPTQIFSF PG UIF
QMBOFU WFSZ TPPO VOMFTT JNQVMTF FOHJOFT BSF GJSFE."
2360 IFPL=13THEN1000
2370 IFPL=11IFSHIFCRTHENPRINT"UIF TIJQ TIBLFT WJPMFOUMZ ...
UIF DPNQVUFS SFTQPOET -- TUBCMF PSCJU BDIJFWFE !":DE=0:TD!=1:GOTO1000
2380 PRINT"OPUIJOH IBQQFOFE.":GOTO1000
2400 IFNN=9AND(INT(PL/5)*5=PLANDPL<26)THENPRINT"JU TBZT:
TUBSTIJQ FOUFSQSJTF -- ODD 1701":PRINT"EFDL";PL/5;" -- ";DD$(PL/5):GOTO1000
2410 IFNN=17ANDOB(17)=0THEN2420ELSEPRINT"SFBE XIBU, DBQUBJO?":GOTO1000
2420 IFPL=11THENPRINT"JU TBZT UP DIFDL CPUI UIF EJMJUIJVN DSZTUBMT BOE UIF DPOUSPMT
JO UIF FOHJOFFSJOH TFDUJPO.":GOTO1000
2430 IFPL=21ANDOB(21)=PLTHENPRINT"JU TBZT UIJT TIVOU JT JNQPSUBOU JO
UIF FOHJOFFSJOH DPOUSPM NFDBOJTN.":GOTO1000
2440 IFPL=31THENPRINT"JU TBZT JOTFSU UIF DSZTUBMT JOUP UIF QPXFS TUBUJPO.":GOTO1000
2450 IFPL=32THENPRINT"JU TBZT JOTUBMM UIF TIVOU JO UIF DPOUSPM QBOFM.":GOTO1000
2460 PRINT"JU EPFT OPU NFOUJPO BOZUIJOH PG WBMVF JO UIJT TJUVBUJPO.":GOTO1000
2500 IFPL<31THENPRINT"IFSF, DBQUBJO?":GOTO1000
2510 IFPL=31IFOB(16)=0IFNN=16IFCRPRINT"UIBU JT OPU OFDFTTBSZ OPX, DBQUBJO.":GOTO1000
2520 IFPL=31IFOB(16)=0IFNN=16IFCR=0THENPRINT"B MPX WJCSBUJPO CFHJOT ...
QPXFS MFWFMT OPX BU.";90+RND(9)+RND(0);"%":CR=-1:TT=TT-1:OB(16)=4:OB(23)=-1:GOTO2560
2530 IFPL=32IFOB(21)=0IFNN=21IFSHPRINT"UIBU JT OPU OFDFTTBSZ OPX, DBQUBJO.":GOTO1000
2540 IFPL=32IFOB(21)=0IFNN=21IFSH=0THENPRINT"B HSFFO QBOFM MJHIU HMPXT
BVYJMJBSZ DPOUSPM OPX PQFSBUJPOBM.":OB(24)=-1:TT=TT-1:SH=-1:OB(21)=21:GOTO2560
2550 PRINT"ZPV DBOOPU EP UIBU, DBQUBJO.":GOTO1000
2560 IFCRANDSHTHENTD!=-17-RND(3)-RND(0):GOTO1000ELSE1000
2600 IF(NN=18ORNN=10)IFOB(10)=26IFOB(18)=0THENPRINT"P.L.  TQPDL BXBLFOT BOE TBZT -- J BN JOEFCUFE UP CPUI ZPV BOE
ES. NDDPZ. J BN XFMM FOPVHI UP BTTJTU ZPV OPX.":SP=-1:OB(10)=-1:GOTO1000
2610 PRINT"OPU OPX, DBQUBJO.":GOTO1000
3000 IFOB(19)<>0ANDOB(15)<>0THENPRINT:PRINT"XJUIPVU B QIBTFS, ZPV NVTU TVSSFOEFS.":GOTO1600
3010 PRINT:POKEFX,0:CM$="":PRINT"COMMAND ? ";:PP=PEEK(16416)+256*PEEK(16417)-15360:GOSUB5000:CM$=CM$+STRING$(10,32):POKEFX,13:C2$=LEFT$(CM$,10)
3020 C3$=VB$(16)+"OW "+NN$(15):IFC2$=C3$THENIFOB(15)=0THENTT=TT-1:GOTO2140ELSEPRINT"XIBU USJCCMF?  ZPV IBWF CFFO UBLFO DBQUJWF":GOTO1600
3030 C3$=VB$(17)+"E "+NN$(19)+"E":IFC2$=C3$THEN2220ELSEPRINT"UPP TMPX, DBQUBJO.  ZPV IBWF CFFO UBLFO DBQUJWF":GOTO1600
3500 PRINT:POKEFX,0:CM$="":PRINT"COMMAND ? ";:PP=PEEK(16416)+256*PEEK(16417)-15360:GOSUB5000:CM$=CM$+STRING$(10,32):POKEFX,13:C2$=LEFT$(CM$,10):IFOB(15)<>0THEN3520
3510 IFC2$=VB$(16)+"OW "+NN$(15)THENTT=TT-1:GOTO2160
3520 PRINT"UPP TMPX, DBQUBJO. ZPV IBWF CFFO DBQUVSFE!
UIF FOUFSQSJTF IBT CFFO MPTU!":GOTO1600
4000 IFTD!>0THENRETURNELSETD!=TD!+1+RND(0)
4010 IFTD!>0THENPRINT"UPP MBUF, DBQUBJO!  UIF FOUFSQSJTF XJMM TPPO CVSO
VQ JO UIF QMBOFU'T BUNPTQIFSF.  HPPECZF, DBQUBJO!":GOTO1600
4020 IFSPTHENPRINT"TQPDL TBZT -- POMZ";TD!;" NJOVUFT VOUJM PSCJU EFDBZT"
4030 RETURN
5000 PRINT@PP+LEN(CM$),CHR$(143);:FORXE=1TO30:WY$=INKEY$:IFWY$=""THENNEXT:PRINT@PP+LEN(CM$)," ";:FORXE=1TO30:WY$=INKEY$:IFWY$=""THENNEXT:GOTO5000
5010 IFWY$=CHR$(13)THENPRINT@PP+LEN(CM$)," ":RETURN
5020 IFASC(WY$)=8ANDLEN(CM$)>0THENCM$=LEFT$(CM$,LEN(CM$)-1):PRINT@PP,STRING$(LEN(CM$)+2,32);:PRINT@PP,CM$;:GOTO5000ELSEIFASC(WY$)=8THEN5000
5030 CM$=CM$+WY$:PRINT@PP,CM$;:GOTO5000
5500 CLS:PRINT@128,"CAPTAINS LOG -- STARDATE 4295.2  -- WHERE AM I ? WHAT HAS
HAPPENED TO MY CREW ?  I AWOKE MOMENTS AGO TO FIND THAT I HAD
BEEN DEPOSITED UNCONSCIOUS IN MY QUARTERS BY AN UNKNOWN ENEMY."
5510 PRINT"I HAVE TRIED REPEATEDLY TO CONTACT MY CREW BUT NONE RESPONDS --
SPOCK, SCOTTY, MCCOY, SULU, CHECKOV ... THE ENTERPRISE IS
EERILY QUIET, THE SILENCE BROKEN ONLY BY A SNATCH OF CONVERSA-
TION IN A STRANGE LANGUAGE SPOKEN IN THE CORRIDOR OUTSIDE MY"
5520 PRINT"CABIN.  COULD THIS BE THE KLINGON'S FINAL VICTORY ?":PRINT:PRINT"YOU ARE THE CAPTAIN OF THE STARSHIP ENTERPRISE.  PRESS ENTER":PRINTTAB(20)"AND WELCOME TO ... ":PP=807:CM$="":GOSUB5000:RETURN

