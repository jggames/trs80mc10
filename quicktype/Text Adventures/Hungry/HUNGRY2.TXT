0 CLEAR500:DIMCC,ZZ,M$,I$:GOTO10
1 ZZ=1:CC=32:FORCC=CCTOZZSTEP-1:I$=MID$(M$,CC,1):IFI$<"!"THEN?MID$(M$,ZZ,CC-ZZ):ZZ=CC+1:CC=ZZ+32:IFI$=""THENCC=.
2 CC=CC+(CC>255)*(CC-255):NEXT:M$="":RETURN
10 CLS:PRINT"nellen is thirsty":PRINT:PRINT"WRITTEN BY DR FURMAN H SMITH"
11 PRINT"PUBLISHED IN RECREATIONAL":PRINT"COMPUTING MAGAZINE IN 1980"
20 PRINT"PORTED TO THE COMMODORE 64"
21 PRINT"BY STEVEN DARNOLD":PRINT"PORTED TO BBC"
22 PRINT"BY LURKIO IN 2020"
100 L=39:A$="                              "
105 GOSUB705:GOSUB745
110 INPUT"ARE YOU THE ONLY PERSON PLAYING? "A$
115 P=1:A$=LEFT$(A$,1):IFA$="Y"THENP9=1:GOTO140
120 IFA$<>"N"THENPRINT"PLEASE TYPE YES OR NO":GOTO110
130 INPUT"HOW MANY OF YOU WILL BE PLAYING? "A$:P9=VAL(A$)
135 IFP9<1THENPRINT"OH, COME ON.":GOTO130
140 IFP9>5THENPRINT"SORRY, THAT IS TOO MANY.":GOTO130
145 DIM P$(P9):I=1:INPUT"WHAT IS YOUR NAME? "P$(P):M$=P$(P):GOSUB9100:P$(P)=M$:GOTO150
150 IFI=P9THEN165
151 I=I+1
155 M$="PLEASE GIVE ME THE NAME OF THE NEXT PLAYER.":GOSUB1
160 INPUTP$(I):GOTO150
165 IFP9=1 THENT2=T9:GOTO205
166 T2=4
205 CLS:PRINT
210 W4(R)=1:I=1+INT((R-1)/R8):J=R-R8*(I-1)
215 ONI GOSUB220,225,230:GOTO235
220 ONJ GOTO2010,2020,2030
225 ONJ GOTO2040,2050,2060
230 ONJ GOTO2070,2080,2090
235 FORM=1TOM9
240 IFL(M)=R THENGOSUB265
245 NEXTM
250 IFRND(0)>T*(2-W4(1)-W4(3))/(7*T9)THEN260
256 M$="A VOICE SAYS, <>":GOSUB1
260 GOTO305
265 I=1+INT((M-1)/8):J=M-8*(I-1)
270 ONI GOTO275,280,285,290
275 ONJ GOTO2410,2420,2430,2440,2450,2460,2470,2480
280 ONJ GOTO2490,2500,2510,2520,2530,2540,2550,2560
285 ONJ GOTO2570,2580,2590,2600,2610,2620,2630,2640
290 ONJ GOTO2650
305 PRINT"* ";:Q$=Q$(1+Q9*RND(0))
310 IFRND(0)>.5THENQ$=Q$+", "+P$(P)
315 Q$=Q$+"?":M$=Q$:GOSUB1:INPUT"* "A$:M$=A$:GOSUB9100:A$=M$:I9=LEN(A$):PRINT
320 IF I9=0 THEN305
325 FORI=1TOI9:IFMID$(A$,I,1)<>" "THENNEXT
330 V$=LEFT$(A$,I-1):IFI=I9+1THENN$=V$:GOTO345
331 IX=I:I=I9:NEXT:I=IX
335 FORJ=I9TOISTEP-1:IFMID$(A$,J,1)<>" "THENNEXT
340 N$=RIGHT$(A$,I9-J):JX=J:J=I:NEXT:J=JX
345 V=0:N=0
350 FORI=1TOV9:IFV$(I)=V$THENV=I:I=V9
351 NEXT
355 FORI=1TON9:IFN$(I)=N$THENN=I:I=N9:NEXT:I=N
356 NEXT
357 IFV+N>0ANDV$=N$THEN380
358 GOTO3505
365 M$="I DON'T UNDERSTAND "+A$+".":GOSUB1
370 M$="TYPE LIST WORDS TO SEE A LIST OF SOME OF THE WORDS THAT I UNDERSTAND.":GOSUB1:GOTO 305
380 IFN<29THEN405
381 IFN=29THENN=11:GOTO405
382 N=N-7
405 IFN>4ANDN<9THENN=N-4
410 IF N>4 OR N=0 THEN435
411 ON N GOTO412,416,420,424
412 W1(R)=ABS(W1(R)):IFW1(R)=1THEN430
414 IFW1(R)=2THENR=R-R8:GOTO605
415 GOTO505
416 W1(R+R8)=ABS(W1(R+R8)):IFW1(R+R8)=1THEN430
418 IFW1(R+R8)=2THENR=R+R8:GOTO605
419 GOTO505
420 W2(R+1)=ABS(W2(R+1)):IFW2(R+1)=1THEN430
422 IFW2(R+1)=2THENR=R+1:GOTO605
423 GOTO505
424 W2(R)=ABS(W2(R)):IFW2(R)=1THEN430
426 IFW2(R)=2THENR=R-1:GOTO605
427 GOTO505
430 PRINT"YOU CAN'T WALK THROUGH WALLS.":GOTO305
435 IFN<>12ANDN<>22THENGOSUB4015:GOTO440
436 GOSUB4030
440 IF(V<=4ORV=13)ANDN=22THEN5410
442 IFN=28ANDV<9 GOTO480
445 IFM<>0ORV=0ORV>8THEN455
450 M$="THAT'S NOT POSSIBLE NOW, "+P$(P)+".":GOSUB1:GOTO305
455 IFM=0ORV=15ORN=9THEN505
460 IF 4-1ANDL(M)<>R THEN470
461 GOTO475
470 M$="IT SEEMS THAT THE "+N$+" ISN'T HERE.":GOSUB1:GOTO305
475 IFV>8THEN505
476 IFV<5THENV=1:GOTO480
477 V=5
480 IFN=28THENPRINT"THE WATCH STAYS ON YOUR WRIST.":GOTO305
485 IFN=10ORN=23ORN=24THEN5980
490 ON(V+3)/4GOSUB4045,4100
495 GOTO235
505 IFN<=8ANDN>0THEN5015
510 IFN=26ORN=27THENON(N-25)GOSUB5105,5155:GOTO305
512 IFV=0THEN365
515 IFV<=14THENJ=V-8:GOTO520
516 J=V-14:GOTO525
520 ONJ GOTO5205,5255,5355,5355,5405,5605
525 ONJ GOTO5705,5755,5780,5805,5980,210
605 T=T+1:T1=T1+1
610 IFT>T9THENGOSUB5155:GOTO615
611 GOTO625
615 M$="TIME IS UP _ THE "+STR$T9+" SCOOTS HAVE PASSED.":GOSUB1:VDU7
620 PRINT"IF YOU WANT TO PLAY AGAIN, PUSH RETURN.":INPUTM$:RUN
625 IFW1(R)=-1THENW1(R)=1
630 IFW1(R+R8)=-1THENW1(R+R8)=1
635 IFW2(R)=-1THENW2(R)=1
640 IFW2(R+1)=-1THENW2(R+1)=1
645 IF T1<=T2 THEN205
646 T1=0:IF P>.")

2073 M$="A SCREEN SAYS THAT YOUR VISIT WILL LAST FOR "+STR$T9+" SCOOTS. "+STR$T+" SCOOTS HAVE PASSED.":GOSUB1
2075 PRINT"TO LEAVE THIS ROOM, TYPE GO NORTH.":RETURN
2080 M$="YOU ARE STANDING IN A ROOM WITH GREEN WALLS. A GREEN CHAIR IS IN THE CORNER.":GOSUB1
2083 IFW1(4)<0THENRETURN
2084 PRINT"A SIGN HERE SAYS:"
2084 PRINT"+-----------------+"
2085 PRINT"!  MAGIC WORKS    !"
2086 PRINT"!    IN THE       !"
2087 PRINT"! ENCHANTED HOUSE !"
2088 PRINT"+-----------------+":RETURN
2090 M$="YOU ARE IN THE ROOM WHERE "+N$(31)+" LIVES; THIS ROOM IS CALLED THE CAT ROOM.":GOSUB1
2091 RETURN
2410 M$="THERE IS A COLLEGE CATALOG FROM THE UNIVERSITY OF HOUSTON VICTORIA CAMPUS HERE.":GOSUB1
2411 RETURN
2420 M$="ON THE FLOOR IS A COUPON. ACCORDING TO WHAT IS WRITTEN ON THE COUPON, IF IT IS DROPPED IN THE STORE WHILE THE MACHINE IS WORKING, "
2421 M$=M$+"YOU WILL RECEIVE ONE BLUE BOWL.":GOSUB1
2423 RETURN
2430 PRINT"THERE IS A CLEAN EMPTY BLUE BOWL HERE.":RETURN
2440 PRINT"THE BOWL OF COLD MILK IS HERE.":RETURN
2450 PRINT"THERE IS A BLUE BOWL WITH WARM MILK.":RETURN
2460 RETURN
2470 M$="IN A CORNER OF THE ROOM IS A MACHINE WHICH ANNOUNCES THAT IF YOU DEPOSIT (OR DROP) A COUPON AND THE MACHINE IS WORKING, "
2471 M$=M$+"YOU WILL RECEIVE WHATEVER THE COUPON IS GOOD FOR.":GOSUB1:GOSUB9000
2473 M$=" IF THE MACHINE DOESN'T WORK, YOU ARE INVITED TO CALL THE REPAIRPERSON.":GOSUB1
2476 RETURN
2480 PRINT"THE MACHINE IN THE CORNER HAS A"
2481 PRINT"FLASHING DISPLAY ANNOUNCING:"
2482 PRINT"<>.":RETURN
2490 M$="THE BANKER, MR."+N$(30)+", LOOKS "+B$(1+B9*RND(0))+".":GOSUB1
2492 IFL(23)=R0 THENPRINT"TYPE SCORE TO CHECK YOUR SCORE."
2494 RETURN
2500 PRINT"THERE IS AN OLD BRASS KEY HERE.":RETURN
2510 M$=N$(31)+" THE CAT IS HERE. SHE PRETTY MUCH FILLS UP THE ROOM; SHE'S AS LARGE AS AN ELEPHANT-- "
2511 M$=M$+"NO KIDDING.":GOSUB1:M$=" IN A SOFT POLITE VOICE SHE SAYS, ":GOSUB1:GOSUB9000
2512 M$=" <>":GOSUB1
2517 RETURN
2520 M$=N$(31)+" PURRS AND SAYS, <>":GOSUB1
2523 M$=" SHE DOESN'T MENTION THAT IT WAS WARM.":GOSUB1
2525 L(5)=0:L(3)=9:L(12)=0:L(11)=9:RETURN
2530 M$="WOW! "+N$(31)+" CAN SURE BE LOUD WHEN SHE PURRS.":GOSUB1
2531 M$=" SHE LOOKS AT YOU AND SAYS, '"+P$(P)+", YOU'VE MADE ME SO HAPPY. I KNOW THAT IT WASN'T EASY TO GET THIS BOWL OF COLD MILK TO ME. YOU DID IT!":GOSUB1
2534 L(4)=0:L(3)=9:L(13)=0:L(14)=9:IFL(25)<>0THEN2537
2535 GOSUB9000:M$=" PLEASE ACCEPT THIS SMALL PRESENT.' SHE OFFERS YOU A SMALL "+N$(21)+".":GOSUB1
2536 L(25)=9
2537 RETURN
2540 M$=N$(31)+" IS NAPPING. SHE'S QUITE HAPPY.":GOSUB1:RETURN
2550 M$=N$(29)+" THE WHITE RABBIT IS HERE AND SHE SAYS, <>":GOSUB1
2552 RETURN
2560 M$=N$(29)+" HOPS OUT OF YOUR ARMS AND SCURRIES OFF. SHE RETURNS AND SAYS, <>":GOSUB1
2563 L(23)=5:L(15)=5:L(16)=0:C=C-1:RETURN
2570 M$=N$(29)+" HOPS DOWN AND GOBBLES A GROWTH OF CARROTS THAT WAS BLOCKING THE EAST DOORWAY. SHE SMILES AND SAYS, <>":GOSUB1
2574 L(17)=0:L(15)=2:L(6)=0:C=C-1:RETURN
2580 M$="A WHITE RABBIT IS HERE. SHE HOPS TO YOU AND SAYS, <>":GOSUB1
2583 M$=" SHE HUGS YOU AND SAYS, <>":GOSUB1
2587 L(18)=0:L(15)=4:RETURN
2590 M$="THERE IS A MAGIC MAP HERE. IF YOU GET THE MAP, YOU MAY CONSULT THE MAP.":GOSUB1
2591 RETURN
2600 PRINT"AN OLD GUM WRAPPER IS ON THE FLOOR.":RETURN
2610 M$="A VOICE SAYS, <>":GOSUB1
2612 RETURN
2620 PRINT"A HEAVY COIN IS HERE.":RETURN
2630 PRINT"A GOLDEN EGG IS ON THE FLOOR.":RETURN
2640 PRINT"ON THE FLOOR IS A JEWEL.":RETURN
2650 PRINT"A MAGNIFICENT VASE IS HERE.":RETURN
3505 IFA$="EXTEND TIME"THENT9=T9+24:N=28:GOTO5315
3995 GOTO365
4015 IFV=0ORN=0THENM=0:RETURN
4020 IFN<>24THEN4025
4021 IFL(11)=9 THENM=11:RETURN
4022 M=14:RETURN
4025 FORI=1TOM9:IFN1(I)=N THENM=I:I=M9:NEXT:I=M:RETURN
4026 NEXT
4030 M=0:IFN<>22ANDN<>12THENRETURN
4035 FORJ=3TO5:IFL(J)<>0THENM=J
4036 NEXT
4040 RETURN
4045 IFL(M)=R ANDC=C9 THEN4055
4050 M$="YOU'VE STILL GOT THE "+N$+".":GOSUB1:GOTO4140
4055 M$="YOU CAN ONLY CARRY "+STR$C9+" OBJECTS (NOT COUNTING THE WATCH) AND YOU ARE ALREADY CARRYING THAT MUCH. IF YOU REALLY WANT TO GET SOMETHING ELSE, THEN YOU WILL HAVE TO DROP SOMETHING FIRST.":GOSUB1
4071 GOTO4140
4075 IFW(M)=0THEN4090
4076 M$="CONGRATULATIONS, "+P$(P)+"!":GOSUB1
4080 M$="YOU'LL EARN POINTS WHEN THE "+N$+" IS DEPOSITED (OR DROPPED) IN THE BANK.":GOSUB1
4085 C=C+1:L(M)=-1:RETURN
4090 M$="OK, YOU ARE CARRYING THE "+N$+".":GOSUB1
4095 L(M)=-1:C=C+1:RETURN
4100 IFL(M)=-1THEN PRINT"OK.":L(M)=R:C=C-1:GOTO4105
4101 GOTO4135
4105 IFR=R0 THEN GOSUB5175
4110 IFR<>3ANDR<>9THEN RETURN
4115 IFL(2)=3THENL(2)=0:L(3)=3:L(7)=0:L(8)=3
4120 IFL(4)=9THENL(4)=0:L(3)=9:L(11)=0:L(13)=9
4125 IFL(5)=9THENL(5)=0:L(3)=9:L(11)=0:L(12)=9
4130 RETURN
4135 M$="YOU DON'T HAVE THE "+N$+".":GOSUB1
4140 M$="TO SEE AN INVENTORY OF WHAT YOU'RE CARRYING, TYPE INVENTORY.":GOSUB1
4145 RETURN
4505 M$=W4$(R):GOSUB9100:M$="YOU ARE IN THE "+M$+" ROOM NOW.":GOSUB1
4510 PRINT" N";:PRINT"W+E";:PRINT" S"
4515 WC=145+6
4520 I2=R7*R8:FORI1=1TOR6
4525 IF(I1-1)*I21ANDJK0 ANDKK0 ANDK1ANDJK0 ANDK1ANDJR8 THEN4595
4585 IFW1(K+J)>0THENPRINTW1$(W1(K+J));:GOTO4590
4586 PRINTW1$(0);
4590 J=J+1:GOTO4535
4595 IFK=K9 THENVDU23,1,1;0;0;0;:RETURN
4596 J=1:VDUWC
4600 IFW2(K+J)>0THENPRINTW2$(W2(K+J));:GOTO4605
4601 PRINTW2$(0);
4605 IFJ>R8 THENPRINT:GOTO4620
4610 IFW4(K+J)>0THENPRINTCHR$(129+VAL(MID$("264620515",K=J,1)))W4$(K+J)CHR$(145+6);:GOTO4615
4611 PRINTCHR$(129+5)W4$(0)CHR$(145+6);
4615 J=J+1:GOTO4600
4620 K=K+R8:J=1:GOTO4535
5015 IFR<>1THEN5040
5016 IFL(10)=-1THEN5030
5020 M$="THE DOOR IS LOCKED AND YOU'RE NOT CARRYING THE KEY.":GOSUB1
5025 W1(4)=3.5:GOTO305
5030 W1(4)=2.5:R=4:GOTO605
5040 IFR<>2THEN5070
5041 IFL(6)<>2THEN5060
5045 M$="YOU CANNOT ENTER _ THE DOORWAY IS BLOCKED BY A THICK GROWTH OF CARROTS.":GOSUB1
5055 W2(3)=3.5:GOTO305
5060 R=3:W2(3)=2.5:GOTO605
5070 IFR=4ANDL(10)<>-1THEN5020
5071 IFR=4THEN5080
5073 IFR>4THEN365
5075 R=2:GOTO605
5080 W1(4)=2.5:R=1:GOTO605
5105 M$="YOUR WATCH STAYS ON YOUR WRIST FOR THE WHOLE VISIT.":GOSUB1
5106 IFC=0THENM$=" YOU AREN'T CARRYING ANYTHING ELSE.":GOSUB1:RETURN
5115 M$=" HERE IS AN INVENTORY OF WHAT YOU'RE CARRYING:":GOSUB1
5120 FORJ=1TOM9
5125 IFL(J)=-1THENPRINTTAB(2)N$(N1(J))
5126 NEXT
5130 RETURN
5155 GOSUB5175:PRINT"YOU HAVE ";I;" POINTS OUT OF 100."
5160 M$="YOU EARN POINTS BY DEPOSITING VALUABLE THINGS IN THE BANK.":GOSUB1
5165 RETURN
5175 I=0:FORJ=1TOM9:IFL(J)=R0 THENI=I+W(J)
5180 IFP9>1THENA$="ALL ":GOTO5185
5181 A$=""
5185 NEXTJ:IFI<100THENRETURN
5190 M$="MR "+N$(30)+" SHOUTS, <>":GOSUB1:VDU7:GOTO620
5205 M$="KICKING "+N$+" WILL NOT HELP ANYTHING.":GOSUB1:GOTO305
5255 IFNOT(N=11ORN=23ORN=24)THEN5305
5260 IFL(6)=0THEN5275
5265 M$="THE "+N$(N1(M))+" LAUGHS AND SAYS, <>":GOSUB1
5270 GOTO305
5275 ON 2-W4(1) GOTO5280,5290
5280 M$="THE "+N$(N1(M))+" SAYS, '"+P$(P)+", I THINK THAT YOU'RE DOING GREAT.'":GOSUB1:GOTO305
5290 M$="THE "+N$(N1(M))+" SMILES MYSTERIOUSLY AND SAYS, <>":GOSUB1
5300 GOTO305
5305 IFN=15THENSTOP:GOSUB4505:GOTO305
5310 IFN=20THENPRINT"IT DOESN'T HELP HERE.":GOTO305
5315 IFN=28THENPRINT;T;" SCOOTS HAVE PASSED":GOSUB9000
5320 IFN=28THENM$=" AND "+STR$(T9-T)+" SCOOTS REMAIN.":GOSUB1:GOTO305
5325 GOTO5980
5355 IFN=9THEN5015
5356 GOTO5980
5405 IFN<>12ANDN<>24THEN5980
5406 IFN=24THENV=5:N=12:GOTO435
5410 IFR<>2ORL(3)<>-1THEN5425
5411 L(3)=0:L(4)=-1
5415 M$="GLURG; GLURG; PLINK. YOUR BOWL HAS COLD MILK NOW.":GOSUB1
5420 GOTO305
5425 IFN=22ANDM=3THENPRINT"THE BOWL IS EMPTY.":N$="BOWL"
5430 IFV<>13ANDL(M)=R THENGOSUB4045:GOTO305
5435 IFM=4ORM=5THENPRINT"THE BOWL IS STILL FULL OF MILK."
5440 IFR<>2THENPRINT"THE MILK ROOM HAS LOTS OF MILK."
5445 IFL(M)>-1ORM<3ORM>5THENPRINT"YOU NEED A BOWL."
5450 GOTO305
5605 IFN<>25THEN5980
5606 PRINT"I KNOW THESE VERBS: ";
5610 FORI=1TOV9:A$=V$(I):GOSUB5655:NEXT
5615 PRINT"I KNOW THESE NOUNS: ";
5620 FORI=1TON9:A$=N$(I):GOSUB5655:NEXT
5625 M$="I KNOW SOME ONE-WORD MESSAGES (FOR EXAMPLE HELP) AND I KNOW SOME TWO-WORD MESSAGES "
5626 M$=M$+"(FOR EXAMPLES FILL BOWL, OFFER MILK).":GOSUB1:GOSUB9000 
5630 M$=" WHATEVER YOU SAY, I'LL LOOK AT THE FIRST AND LAST WORDS; YOU COULD SAY SIT IN THE CHAIR OR "
5631 M$=M$+"CONSULT THE SLEEPY MR "+N$(30)+"."
5650 GOSUB1:GOTO 305
5655 IFPOS=1VDU8
5656 IFL-POS0THEN305
5710 M$="THE "+N$+" MIGHT BE USEFUL AS A TOOL.":GOSUB1
5720 IFN=11ORN=23ORN=24THENPRINT"FRIENDS ARE VALUABLE."
5725 IFN=20THENM$="A COLLEGE EDUCATION IS A WORTHWHILE AND STIMULATING EXPERIENCE.":GOSUB1
05735 GOTO305
5755 IFN<>10THEN5980
5756 IFR=1ORR=8THENR=9-R:GOTO605
5760 PRINT"THERE'S NO CHAIR IN HERE.":GOTO305
5780 IFN<>22THEN5980
5781 IFL(4)=-1ORL(5)=-1THEN5790
5785 PRINT"YOU'RE NOT CARRYING ANY MILK.":GOTO305
5790 PRINT"GLUG; GLUG.":L(4)=0:L(5)=0:L(3)=-1:GOTO305
5805 PRINT"LOST? ........... CONSULT MAP"
5810 PRINT"WHAT CARRYING? .... INVENTORY"
5815 PRINT"SCOOTS LEFT? ...CONSULT WATCH"
5820 PRINT"REDESCRIBE ROM? .......RELOOK"
5825 PRINT"WORTH OF SOMETHING?.........."
5830 PRINT"EXAMPLES: COIN, CATALOG, CAT "
5835 PRINT"WANT A HINT?   CONSULT FRIEND"
5840 PRINT"EXAMPLES: CONSULT BANKER, OR "
5841 PRINT"CONSULT "N$(29)
5845 PRINT"NOT SURE HOW TO SAY SOMETHING?"
5846 PRINT"LIST WORDS"
5850 PRINT"NOT SURE WHAT THE CLUES MEAN"
5855 PRINT"THINK AND EXPERIMENT.":GOTO305
5980 IFN$=V$THENPRINT"YOU'LL NEED TO USE TWO WORDS.":GOTO305
5982 M$="THE "+N$+" IS HARD TO "+V$+".":GOSUB1:GOTO305
9000 M$=INKEY$:IFM$=""THEN9000
9001 CLS:RETURN
9100 IFLEFT$(M$,1)=" "THEN9105
9101 GOTO9110
9105 M$=RIGHT$(M$,LEN(M$)-1):IFLEFT$(M$,1)<>" "THEN9110
9106 GOTO9105
9110 IFRIGHT$(M$,1)=" "THEN9115
9111 GOTO9120
9115 M$=LEFT$(M$,LENM$-1):IFRIGHT$(M$,1)<>" "THENRETURN
9120 GOTO9115
