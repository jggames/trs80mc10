10 CLS:CU.0:F.Z=0TO10:P.ATR.(703),"*";:N.Z
15 P.AT704,"TREK III, VERSION 3.4 - BY LANCE MICKLUS
25 P."BURLINGTON, VT., 05401 - ALL RIGHTS RESERVED
30 P."COPYRIGHT NOVEMBER 1979 - LANCE MICKLUS, INC.
40 U=25:V=14:I=5:GOS.1935:U=100:V=25:I=1:GOS.1935:U=80:V=12:I=4:GOS.1935
50 F.X=0TO279:A(X)=0:N.X:REST.
55 READB$,J:IFJ<>999T.55
60 P=R.(191)-1:IFA(P)<>0T.60
65 READJ:IFJ>0T.A(P)=-J:G.60
70 P=R.(150):M=P:IFA(P)<>0T.70
75 GOS.1640:GOS.1700
80 F.B=A(256)-1TOA(256)+1:F.C=A(257)-1TOA(257)+1
85 F.D=A(258)-1TOA(258)+1
90 GOS.1625
95 IFP=-1T.100
96 IFA(P)>=0T.A(P)=10*I.(A(P)/10)-5:G.100
97 A(P)=10*(-I.(-A(P)/10))-5
100 N.D:N.C:N.B:A(M)=-4
105 P=R.(191)-1:IFA(P)<>0T.105
110 READA(P):IFA(P)<>0T.A(P)=-A(P):G.105
115 F.N=0TO190:IFA(N)=0T.A(N)=-1
120 N.N:A(256)=7:A(257)=7:A(258)=2:A(276)=3
125 E=3999:T=2200:H=2470:Q=0:A(191)=1006:S=0
130 A(259)=3:A(260)=3:A(261)=1:GOS.955
135 CLS:REST.:W.32
140 P."CREW AWAITING YOUR ORDERS
145 READB$,J:P.TAB(5);J;:P.TAB(9);B$:IFJ<>11T.145
150 O=99:I."ORDERS";O
155 IFO<0T.2500
160 IF(O>11)+(I.(O)<>O)T.135
165 IFO>4T.175
170 ONO+1GOS.1570,455,385,1240,1390:G.180
175 ONO-4GOS.2050,1410,880,1160,1125,320,520
180 GOS.1705:GOS.1625:IFA.(A(P))<10000T.210
185 GOS.1040
190 IFA(261)=2T.A(261)=3:GOS.345
195 IF(A(268)=0)*(A(271)=0)T.O=3:GOS.400
200 IFA(271)=0GOS.2050
205 G.220
210 B$="  SPACE STORM"
215 IFR.(100)=1GOS.355:GOS.555
220 IFA(261)>1GOS.1570
225 T=T+.2:E=E-A(261)*A(261)*10
230 IFE<0T.2185
235 J=1:GOS.520
240 IFT<HT.135
245 CLS:W.32
247 P.AT384,"FLEET COMMAND REQUESTS
250 P."YOU RETURN TO
255 P."FLEET HQ BASE 7,7,2":H=H+10:GOS.1675:G.135
260 G.135
265 CLS:REST.:N=2500-T:IFN<0T.S=S+N*10
270 F.P=0TO191:IFA(P)<0T.280
271 S=S+1:F=I.(A(P)/10)*10:IFA(P)<0T.F=-I.(-A(P)/10)*10
275 IFA(P)-F=9LETS=S+20
280 N.P
285 READB$,Z:IFZ<>425T.285
290 IFS<ZREADB$,Z:G.290
295 P.AT256,"RATING:";I.(S/4.91)
300 P.:P."ADMIRAL FITZPATRICK HERE...":P.
305 P."     CAPTAIN, AFTER REVIEWING YOUR LOG AND DATA TAPES,
310 P."I AM GOING TO RECOMMEND TO COMMAND THAT YOU BE ";B$;".
315 P.:P.:END
320 CLS:W.32
325 P.AT320,"1 - GREEN":P."2 - YELLOW":P."3 - RED
330 I."ENTER CONDITION CODE";N
335 IF(N<1)+(N>3)+(I.(N)<>N)T.330
340 A(261)=N:IFN=1RET.
345 REST.
350 READB$,J:IFJ-20<>A(261)T.350
355 CLS:W.32:GOS.2600
365 F.K=0TO4:P.AT530,B$:PA.400
370 P.AT530,"                ":W.32:PA.400
375 IFINK.=13T.K=4
380 N.K:RET.
385 CLS:IFA(268)<>0T.I=2:G.505
390 IFA(271)<>0T.I=5:G.505
395 O=0
400 F.P=192TO255:IF(A(P)=1)+(A(P)=0)T.445
405 IF(O=3)*(A(P)<25)T.445
410 CLS:U=62:V=14
415 F.Z=0TOR.(5)+2:P.ATR.(512)+63,"*";:N.Z
420 GOS.2095:GOS.1930:GOS.1640
425 P.:P."OBJECT AT";B;:P.AT651,C;"IS A ";B$;".
430 IFA(P)<25T.440
435 P."READING";A(P)-25;"UNITS OF ENERGY.
440 GOS.2105
445 N.P
450 RET.
455 CLS:REST.:READB$,Z
460 IFA(267)<>0T.I=1:G.505
465 P."TACTICAL HERE..."
470 P."DAMAGE CONTROL REPORTS THE FOLLOWING:":P.
475 F.Z=267TO275:READB$,J:P.TAB(14);B$,
480 IF(Z=275)*(A(276)=0)P."** INOPERATIVE **":G.500
485 IFA(Z)=0P."OPERATIONAL":G.500
490 IFA(Z)<10P."NEARLY OPERATIONAL
495 IFA(Z)>9P."** INOPERATIVE **
500 N.Z:G.1675
505 CLS:REST.:W.32
510 READB$,J:IFI<>JT.510
515 P.AT320,B$;" INOPERATIVE":G.2105
520 F.N=1TOJ:F.Z=267TO275
525 IFA(Z)=0T.550
530 A(Z)=A(Z)-R.(5):IFA(Z)>0T.550
535 A(Z)=0:REST.:IFA(267)<>0T.550
540 READB$,J:IFJ<>Z-266T.540
545 CLS:W.32
546 P.AT320,B$;" OPERATIONAL":GOS.2105
550 N.Z:N.N:RET.
555 F.J=1TO4-A(261)
560 Z=266+R.(9):IFA(Z)<>0T.585
565 A(Z)=R.(25)*J:IFA(267)<>0T.585
570 CLS:REST.:W.32
575 READB$,J:IFJ<>Z-266T.575
580 P.AT320,"DAMAGE TO ";B$:GOS.2105
585 N.J:RET.
590 CLS:P=X*8+Y+192:U=30:V=14
595 GOS.1930:GOS.2095:Z=338:M=I
600 P.:P.TAB(25);"SECTOR:";X;Y
605 B$=" *":IF(Q=1)*(I=5)GOS.830:G.625
610 B$="-":IFI=5T.GOS.830:G.620
615 Z=336:B$=")":GOS.830
620 B$=" ":GOS.830
625 L=L*4
630 IFQ=1T.650
635 IFR.(2)=1T.A(282)=A(282)-X:A(283)=A(283)-Y:G.650
640 Z=1
641 L=L*.6:Z=Z+1:IFZ*Z<=(X-A(282))*(X-A(282))+(Y-A(283))*(Y-A(283))T.641
645 X=A(282):Y=A(283):G.670
650 GOS.2130
655 X=X+A(282):Y=Y+A(283)
660 IF(X<0)+(X>7)+(Y<0)+(Y>7)T.P=-1:CLS:G.705
665 L=L*.6
670 P=I.(X)*8+I.(Y)+192
675 IFA(P)=0T.655
680 IFQ=2RET.
685 CLS:V=15:IFA(P)=18LETU=28
690 IF(Q<>1)*(I=5)*(A(P)<25)T.P=-1:G.710
695 IF(Q<>1)*(I=1)*(A(P)<>18)T.P=-1:G.710
700 GOS.1930
705 IFQ=2RET.
710 GOS.2095:P.:P.TAB(25);"SECTOR:";I.(X);I.(Y)
715 B$="* ":IF(M=5)*(Q=1)GOS.850:G.735
720 B$="-":IFM=5GOS.850:G.730
725 B$="(":GOS.850
730 B$=" ":GOS.850
735 Q=0:L=I.(L):IF(P=-1)+(I=0)RET.
740 GOS.1890
745 IF(M=5)*(I<>1)T.GOS.795:GOS.2105:G.2195
750 IFI<>5T.775
755 GOS.870:E=E-L
760 IFL-A(261)*75>0GOS.555:L=L-A(261)*75:G.760
765 IFE>0RET.
770 G.2190
775 IFI<>1T.795
780 A(P)=A(P)-L:IFA(P)>25RET.
785 G.795
790 IFL<100RET.
795 P.TAB(20);B$;" DESTROYED"
800 F.N=0TO30
805 R.(21+R.(17),12+R.(5)):S.(21+R.(17),12+R.(5))
810 N.N
815 A(P)=0:GOS.1705:GOS.1625
820 A(P)=A.(A(P))-10000:S=S+10
825 RET.
830 F.N=ZTO380
835 P.ATN,B$;:PA.25
840 N.N:IFQ=1P.AT380,"  "
845 RET.
850 F.N=380TO338S.-1
855 P.ATN,B$;:PA.25
860 N.N:IFQ=1P.AT338," ";
865 P.AT640,"";:RET.
870 F.W=1TOI.(L/50):W.32:PA.25:W.64:PA.25:N.W:G.865
880 CLS:IFA(273)<>0T.I=7:G.505
885 GOS.1705
890 W.32
891 P.AT320,"HELM HERE..."
895 I."COURSE (X,Y,Z)";B,C,D:GOS.1625
900 IFP=-1T.895
905 I."WARP FACTOR (0-8)";K:IFK=0T.RET.
910 IF(K<0)+(K>8)+(I.(K)<>K)T.905
915 F=(A(256)-B)*(A(256)-B)+(A(257)-C)*(A(257)-C)+(A(258)-D)*(A(258)-D)
916 L=F/2:N=F/4
917 IFL*L>FT.L=L-N:G.919
918 L=L+N
919 N=N/2:IFA.(L*L-F)>.01T.917
920 IFE-100>L*K*K*KT.945
925 CLS:W.32
926 P.AT320,"ENGINEERING HERE...":P.
930 P."SORRY CAPTAIN,":P."BUT WE JUST DON'T HAVE"
935 P."ENOUGH ENERGY."
940 G.2105
945 E=E-L*K*K*K:T=T+2*L*L/K:GOS.1700
950 J=INT(L*L/K):IFJ>0GOS.520
955 GOS.1705:GOS.1625:GOS.1655
960 IFA(266)=0T.A(266)=8:A(P)=I.(A.(A(P))/10)*10+8
965 IF(A(265)>0)*(A(266)=1)T.A(266)=7:GOS.1645
970 B=X:C=Y:D=3:GOS.1630
975 IF(A(266)>1)*(A(266)<5)T.2150
980 IFA(266)>7T.A(265)=A(265)-1
985 F.N=192TO255:A(N)=0:N.N:A(P)=18
990 F.N=262TO265
995 IFA(N)=0T.1025
1000 IFN=262T.M=R.(1500)+250
1005 IFN=263T.M=20
1010 IFN=264T.M=19
1015 IFN=265T.M=3
1020 GOS.2020:A(N)=A(N)-1:G.995
1025 N.N
1030 IFA(266)>7T.M=2:GOS.2020
1035 R=0:G.2050
1040 F.R=192TO255
1045 IFA(R)<25T.1120
1050 X=I.((R-192)/8):Y=R-192-(X*8):A(280)=X:A(281)=Y
1055 IFR.(2)>1T.1085
1060 A(282)=(A(259)>X)-(A(259)<X):A(283)=(A(260)>Y)-(A(260)<Y)
1065 IFGT.A(282)=2-R.(3):A(283)=2-R.(3):G.1070
1066 A(282)=A(282)*(R.(2)-1):A(283)=A(283)*(R.(2)-1)
1070 IF(X+A(282)>=0)*(X+A(282)<=7)T.A(280)=X+A(282)
1075 IF(Y+A(283)>=0)*(Y+A(283)<=7)T.A(281)=Y+A(283)
1080 IFA(A(280)*8+A(281)+192)=0T.Z=A(X*8+Y+192):A(X*8+Y+192)=0:X=A(280):Y=A(281):A(X*8+Y+192)=Z
1085 IFGT.1120
1090 A(282)=A(259)-X:A(283)=A(260)-Y
1095 A(280)=X:A(281)=Y:A(284)=A(282):A(285)=A(283):Q=2:GOS.650
1100 IFP=-1T.1110
1105 IFA(P)<>18T.1120
1110 X=A(280):Y=A(281):A(282)=A(259):A(283)=A(260):Q=0:L=R.(A(R)*.7)
1115 IFL>100T.A(R)=A(R)-L:GOS.590
1120 N.R:G=0:RET.
1125 CLS:IF(A(275)<>0)+(A(276)=0)T.I=9:G.505
1130 Q=1:GOS.2050
1135 I."TORPEDO DIRECTION (0-8)";I:P.TAB(18);" ";
1140 IF(I<0)+(I>8)T.1135
1145 G=-1:GOS.1040
1150 GOS.2400:GOS.1705
1155 A(276)=A(276)-1:Q=1:L=8000:G.590
1160 CLS:IFA(274)<>0T.I=8:G.505
1165 W.32
1166 P.AT320,"WEAPONS OFFICER HERE..."
1170 I."ENERGY";O:IFO<=0RET.
1175 P."BEAM WEAPON LOCKED ON TARGET."
1180 PA.500
1185 F.A=192TO255
1190 IFA(A)<25T.1235
1195 G=-1:GOS.1040
1200 X=I.((A-192)/8):Y=A-192-X*8
1205 A(284)=X:A(285)=Y
1210 A(282)=X-A(259):A(283)=Y-A(260):GOS.1705
1215 Q=2:GOS.650:Q=0:A(282)=A(284):A(283)=A(285):L=O:GOS.1705
1220 IFP=-1T.1230
1225 IFA(P)<25T.1235
1230 IFE-100-O>0T.E=E-O:GOS.590
1235 N.A:RET.
1240 CLS:REST.:IFA(269)<>0T.I=3:G.505
1245 READB$,J:IFJ<>50T.1245
1250 P."SHIP'S COMPUTER COMMAND FUNCTIONS:":P.
1255 P."    ";J-50;" DATA BASE SCAN TO LOCATE ";B$
1260 IFJ<>54READB$,J:G.1255
1265 P."     5  LONG RANGE SENSOR SCAN FROM DATA BASE"
1270 P."     6  QUADRANT DETAILED DISPLAY"
1275 PRINT:I."ENTER FUNCTION";O
1280 IF(O<0)+(O>6)+(I.(O)<>O)T.1240
1285 IFO<5T.1295
1290 ONO-4G.1375,1350
1295 CLS:REST.
1300 READB$,J:IFJ-50<>OT.1300
1305 P."WE ARE CURRENTLY LOCATED AT:";A(256);A(257);A(258)
1310 P."DATA BASE SCAN FOR ";B$;":":P.
1315 F.P=0TO191
1320 IF(O=4)*(A(P)<0)T.1340
1325 IF(A(P)<0)+(O=4)T.1345
1330 GOS.1655
1335 IFA(262+O)=0T.1345
1340 GOS.1640:P.B;C;D,
1345 N.P:P.:G.1675
1350 I."ENTER QUADRANT (X,Y,Z)";B,C,D:GOS.1625
1355 IFP=-1T.1350
1360 GOS.1655
1365 IFA(P)<0P."NO DATA AVAILABLE.":G.2105
1370 G.1710
1375 I."ENTER QUADRANT (X,Y,Z)";U,V,W:CLS
1380 P.AT904,"LONG RANGE COMPUTER QUADRANT SCAN OF";U;V;W;
1385 R=1:G.1760
1390 CLS:IFA(270)<>0T.I=4:G.505
1395 U=A(256):V=A(257):W=A(258):R=0
1400 P.AT899,"LONG RANGE SENSOR SCAN";:P.AT938,"QUADRANT";U;V;W;
1405 G.1760
1410 CLS:IFA(272)<>0T.I=6:G.505
1415 Q=1:GOS.2050
1420 I."HEADING (0-8)";I:IFA(271)=0P.TAB(18);" ";
1425 IF(I<0)+(I>8)T.1420
1430 GOS.2400:GOS.2130
1435 INPUT"SPEED (0-9)";J:IFA(271)=0P.TAB(18);" ";
1440 IF(J<0)+(J>9)T.1435
1445 IFJ=0RET.
1450 GOS.1705:A(X*8+Y+192)=0
1455 F.I=1TOJ:X=X+A(282):Y=Y+A(283)
1460 GOS.2120:GOS.1630
1465 B$="ENERGY BARRIER"
1470 IFP=-1T.E=R.(E):G.1510
1475 IF(B<>A(256))+(C<>A(257))T.1525
1480 W=A(I.(X)*8+I.(Y)+192):B$="   COLLISION"
1485 IFW<>20T.1505
1490 IFJ-I>1T.S=S-100:G.1510
1495 IFA(A(256)*8+A(257)+A(258)*64)=1006T.265
1500 A(276)=3:E=4000:G.1520
1505 IFW=0T.1525
1510 IFJ-I>1GOS.355:GOS.555:W=0:G.1520
1515 IF(W<>2)*(W<>3)*(W<>19)GOS.355:GOS.555
1520 X=X-A(282):Y=Y-A(283):GOS.2120:G.1530
1525 N.I
1530 X=I.(X):Y=I.(Y):A(X*8+Y+192)=18
1535 IF(B<>A(256))+(C<>A(257))GOS.1700:G.955
1540 GOS.1700:Q=1:GOS.2050
1545 IF(W=2)+(W=3)+(W=19)T.1560
1550 IFE=4000P."DOCKED":P.TAB(18);" ";:GOS.1680:T=T+1:J=2:G.520
1555 G.1680
1560 IFW=2GOS.1705:GOS.1625:A(P)=I.(A.(A(P))/10)*10+9
1565 P.TAB(16);"ORBIT":P.TAB(18);" ";:G.1680
1570 CLS:W.32
1575 P.AT266,"STATUS REPORT:":PRINT"     --------------"
1580 P."     DATE:";T
1585 P."     ENERGY:";E
1590 B$="GREEN":IFA(261)=2LETB$="YELLOW"
1595 IFA(261)=3LETB$="RED"
1600 P."     CONDITION: ";B$
1605 P."     QUADRANT:";A(256);A(257);A(258)
1610 P."     SECTOR:";A(259);A(260)
1615 P."     TORPEDOES:";A(276)
1620 G.1675
1625 IF(D<0)+(D>2)T.P=-1:RET.
1630 IF(B<0)+(B>7)+(C<0)+(C>7)T.P=-1:RET.
1635 P=8*B+C+64*D:RET.
1640 D=I.(P/64):B=I.((P-D*64)/8):C=P-D*64-B*8:RET.
1645 A(P)=A(262)*1E4+A(263)*1E3+A(264)*1E2+A(265)*10+A(266)
1650 RET.
1655 A(266)=A.(A(P)):K=1E4
1660 F.N=0TO3
1665 A(262+N)=I.(A(266)/K):A(266)=A(266)-A(262+N)*K:K=K/10
1670 N.N:RET.
1675 P.
1680 IFQ=1T.Q=0:RET.
1685 P."HIT (ENTER) TO CONTINUE.";:GOS.2600
1690 IFINK.<>13T.1690
1695 CLS:RET.
1700 A(256)=B:A(257)=C:A(258)=D:A(259)=X:A(260)=Y:RET.
1705 B=A(256):C=A(257):D=A(258):X=A(259):Y=A(260):RET.
1710 CLS:P.AT384," ","COORDINATES:";B;C;D
1715 P." ","WARSHIPS:";A(262),"BASES:";A(263)
1720 P." ","STARS:";A(264),"PLANETS:";A(265)
1725 REST.:IF(A(266)>6)+(A(266)<2)T.B$="NONE":G.1735
1730 READB$,J:IFJ-30<>A(266)T.1730
1735 P." ","ASTRONOMICAL FEATURE: ";B$:REST.
1740 IFA(266)<7T.B$="NONE":G.1750
1745 READB$,J:IFJ-30<>A(266)T.1745
1750 P." ","SCIENTIFIC INTEREST: ";B$:P.:P.
1755 G.1680
1760 P.AT64,""
1765 F.C=V-1TOV+1:F.D=W-1TOW+1:F.B=U-1TOU+1
1770 GOS.1625
1775 IFP=-1P."  UNKNOWN QUADRANT ";:G.1835
1780 IF(R=0)*(A.(A(P))-(INT(ABS(A(P))/10)*10)<>5)T.A(P)=A.(A(P))
1785 IF(R=1)*(A(P))<0P."      NO DATA      ";:G.1835
1790 IF(R=1)*(A(P)=5)T.1800
1795 IFA.(A(P))<>1GOS.1655:G.1805
1800 P."        VOID       ";:G.1835
1805 IFA(266)=2P."  LARGE BLACK HOLE ";:G.1835
1810 IFA(266)=3P."    CLASS O STAR   ";:G.1835
1815 IFA(266)=4P."       PULSAR      ";:G.1835
1820 IF(R=0)*(A(266)=5)P."    SPACE NOISE    ";:G.1835
1825 IFA(266)=6P."      FLEET HQ     ";:G.1835
1830 P."  W";A(262);"B";A(263);"S";A(264);"P";A(265);" ";
1835 N.B:P." ";D:N.D:P.:N.C
1840 P.AT8,U-1;:P.AT28,U;:P.AT47,U+1;
1845 P.AT253,V-1;:P.AT509,V;:P.AT765,V+1;
1850 P.AT979,"";:I=191
1855 F.Z=0TO40
1865 S.(0,Z):S.(1,Z):S.(38,Z):S.(39,Z):S.(76,Z):S.(77,Z):S.(114,Z):S.(115,Z)
1870 NEXTZ
1875 F.Z=2TO127
1880 S.(Z,4):S.(Z,16):S.(Z,28):S.(Z,40)
1885 N.Z:G.1680
1890 I=0:B$="MR. FIBBLE"
1895 IFA(P)=2T.I=4:B$="CLASS M PLANET"
1900 IFA(P)=3T.I=4:B$="CLASS G PLANET"
1905 IFA(P)=18T.I=5:B$="STAR SHIP"
1910 IFA(P)=19T.I=3:B$="CLASS F STAR"
1915 IFA(P)=20T.I=2:B$="FLEET BASE"
1920 IFA(P)>24T.I=1:B$="WARSHIP"
1925 RET.
1930 GOS.1890
1935 ONI+1G.1940,2005,1995,1975,1960,1945
1940 RET.
1945 F.Z=U-7TOU-1:S.(Z,V-1):N.Z
1950 F.Z=U-4TOU+5:S.(Z,V+1):N.Z
1955 F.Z=U+1TOU+7:S.(Z,V):N.Z:S.(U-3,V):RET.
1960 F.Z=U-3TOU+3:S.(Z,V-1):S.(Z,V):S.(Z,V+1):N.Z
1965 R.(U-3,V-1):R.(U+3,V-1):R.(U-3,V+1):R.(U+3,V+1)
1970 RET.
1975 F.Z=U-2TOU+1:S.(Z,V):N.Z
1980 F.Z=V-1TOV+1S.2
1985 S.(U-2,Z):S.(U+1,Z):S.(U-3,Z):S.(U+2,Z)
1990 N.Z:RET.
1995 F.Z=U-5TOU+5:SET(Z,V+1):N.Z
2000 S.(U,V):S.(U-2,V-1):S.(U-1,V-1):S.(U,V-1):RET.
2005 F.Z=U-5TOU+5:S.(Z,V):N.Z
2010 S.(U-5,V-1):S.(U-4,V-1):S.(U+4,V-1):S.(U+5,V-1)
2015 S.(U-1,V+1):S.(U,V+1):S.(U+1,V+1):RET.
2020 B=R.(8)-1:C=R.(8)-1:D=3
2025 F.U=B-1TOB+1:F.V=C-1TOC+1
2030 IF(U<0)+(U>7)+(V<0)+(V>7)T.2040
2035 P=8*U+V+192:IFA(P)<>0T.2020
2040 N.V:N.U
2045 GOS.1630:A(P)=M:RET.
2050 CLS:GOS.2600:IFA(271)<>0T.I=5:G.505
2055 GOSUB1705:GOSUB1625:A(P)=ABS(A(P))
2060 PRINT:FORC=0TO7:FORB=0TO7
2065 P=B*8+C+192:PRINT"   -    ";
2070 IFA(P)<>0LETU=B*16+7:V=3*C+4:GOSUB1930
2075 N.B:IFINK.=13T.2090
2076 N.C:GOS.2095
2080 P.AT650,"SHORT RANGE SENSOR SCAN OF QUADRANT";
2085 P.A(256);A(257);A(258):PRINTTAB(18);" ";:G.1680
2090 CLS:P.TAB(18);"";:PA.25:RET.
2095 P.AT0,"";:GOS.2101
2096 P.AT576,"";:GOS.2101
2100 RET.
2101 F.F=1TO63:P."=";:N.F:RET.
2105 GOS.2600:F.N=0TO80:PA.100
2110 IFINK.=13T.2115
2111 N.N:RET.
2115 CLS:F.N=0TO0:N.N:RET.
2120 X=B*8+X:B=I.(X/8):X=X-B*8:Y=C*8+Y:C=I.(Y/8):Y=Y-C*8
2125 RET.
2130 IFA.(A(282))>A.(A(283))T.A(283)=A(283)/A.(A(282)):A(282)=A(282)/A.(A(282)):G.2140
2135 A(282)=A(282)/A.(A(283)):A(283)=A(283)/A.(A(283))
2140 A(282)=A(282)*1000+.5*((A(282)>0)-(A(282)<0)):IFA(282)<0T.2142
2141 A(282)=I.(A(282))/1000:G.2145
2142 A(282)=-I.(-A(282))/1000
2145 A(283)=A(283)*1000+.5*((A(283)>0)-(A(283)<0)):IFA(283)<0T.2147
2146 A(283)=I.(A(283))/1000:G.2148
2147 A(283)=-I.(-A(283))/1000
2148 RET.
2150 B$="LARGE BLACK HOLE":IFA(266)=3LETB$="CLASS O STAR"
2160 IFA(266)=4B$="PULSAR"
2165 GOS.2193:P."AFTER FLYING INTO A ";B$;",
2170 P."THE SHIP & CREW WERE LOST TO SPACE.
2180 P.:P.:E.
2185 GOS.2193:P."AFTER DEPLETING ITS ENERGY SUPPLY":G.2170
2190 GOS.2193:P."WHILE DOING BATTLE AGAINST THE ENEMY":G.2170
2193 CLS:P.AT320,"ON DATE";T;" ";:RET.
2195 CLS
2200 P.AT448,"DESTRUCTION OF A ";B$;" IS GROUNDS FOR COURT-MARTIAL.
2205 P.:P."YOU ARE RELIEVED OF YOUR COMMAND.
2210 P.:P.:E.
2215 D."STATUS",0,"DAMAGE CONTROL",1,"SCIENCE COMPUTER",2
2220 D."SHIP'S COMPUTER",3,"LR SENSORS",4,"SR SENSORS",5
2225 D."IMPULSE",6,"WARP",7,"BEAM WEAPON",8
2230 D."TORPEDOES",9,"ALERT",10,"REPAIR",11
2235 D."WARSHIPS",50,"FLEET BASES",51
2240 D."CLASS F STARS",52,"PLANETS",53
2245 D."UNEXPLORED AREAS",54
2250 D."     GREEN",21," YELLOW ALERT",22,"   RED ALERT",23
2255 D."BLACK HOLE",32,"O STAR",33,"PULSAR",34
2260 D."SPACE NOISE",35,"FLEET HQ",36,"G PLANET",37
2265 D."UNEXPLORED M",38,"EXPLORED M",39
2270 D."PROMOTED",425,"DECORATED",350,"REASSIGNED",290
2275 D."DEMOTED",190,"RESIGNED",-1,"EXECUTED",-32000
2280 D."E",999,30111,31111,30101,20121,20201,20001
2285 D.10001,10111,10211,10321,10221,-99
2290 D.1110,110,110,110,110
2295 D.1111,1111,1211,1121,1121
2300 D.3,3,2,2
2305 D.121,121,211,211,311,311,321,321,221,221
2310 D.121,121,211,211,311,311,321,321,221,221,0
2400 F=I:GOS.2410:A(283)=A(282):F=I+6:IFF>8T.F=F-8
2410 A=F:IFF>4T.F=F-4
2420 IFF>2T.F=4-F
2430 F=F*0.785398:A(282)=F-F*F*F/6+F*F*F*F*F/120+F*F*F*F*F*F*F/5040
2440 IFA<4T.A(282)=-A(282)
2450 RET.
2500 CLS:I."0 TO SAVE, 1 TO LOAD";N:P.:REW.
2510 ONN+1G.2520,2540:G.135
2520 A$=",":P.#E;A$;H;A$;T;A$;S:F.N=0TO279
2525 P.#A(N):N.N:P."COPY DATA FROM CASSETTE WINDOW TO A SAFE PLACE":GOS.1685:G.135
2540 P."PASTE SAVED DATA INTO THE <F3> CASSETTE WINDOW":GOS.1685
2550 I.#E,H,T,S:F.N=0TO279:I.#A(N):N.N:G.135
2600 IFINK.<>0T.2600
2610 RET.
