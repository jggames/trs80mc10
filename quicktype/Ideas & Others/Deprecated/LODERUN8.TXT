0 DIMK(255),M(88),P(31,15),X(5),Y(5),D(5,7),A(7),B(7),N(7),F(7),C,O,P,T,Z,M,MC,G,H,I,J
1 CLS0:GOSUB800:GOTO900
2 RETURN
3 M=2:GOSUB8:NEXT:NEXT:NEXT:GOTO40
4 M=3:GOSUB8:NEXT:NEXT:NEXT:GOTO40
5 M=4:GOSUB8:NEXT:NEXT:NEXT:GOTO40
6 M=5:GOSUB8:NEXT:NEXT:NEXT:GOTO40
7 PRINT" DEAD":END
8 O=N(T):P=PEEK(P(A(T)+X(M),B(T)+Y(M))):ONK(P)GOTO9,2,15,7,2
9 N(T)=P:POKEP(A(T),B(T)),O:A(T)=A(T)+X(M):B(T)=B(T)+Y(M):POKEP(A(T),B(T)),D(M,T)
10 F(T)=POINT(A(T)*2,B(T)*2+2):ONK(P)GOSUB11:ONF(T)GOSUB2,2,2,2,12:RETURN
11 F(T)=1:RETURN
12 M=5:GOSUB8:RETURN
13 M=5:GOSUB8:GOTO21
14 M=5:GOSUB8:NEXT:NEXT:NEXT:GOTO40
15 P=G:G(T)=G(T)+1:SOUND100,1:GOTO9
16 ON1-(N(T)=H)GOTO22,4
17 ON1-(PEEK(P(A(T),B(T)+1))<>I)GOTO22,6
18 ON1-(PEEK(P(A(T)+1,B(T)))<>I)GOTO19,5
19 ON1-(PEEK(P(A(T)-1,B(T)))<>I)GOTO18,3
20 FORZ=1TO64000:FORC=2TO4STEP2:T=1:ONF(T)+1GOTO13:M=K(PEEK(K)ANDPEEK(2)):ONMGOSUB50,8,8,8,8
21 FORT=CTOC+1:ONF(T)+1GOTO14:ON1-(B(T)-B(1)>-1)GOTO17,16
22 ON1-(A(T)-A(1)>0)GOTO18,19:NEXT:NEXT:NEXT
40 PRINT" GAME OVER":END
50 RETURN
55 STOP
800 K(32)=1:K(65)=2:K(87)=3:K(83)=4:K(90)=5:MC=16384:K=17023:G=128:H=220:I=175
810 M(88)=175:M(72)=220:M(45)=204:M(42)=146
815 K(220)=0:K(204)=1:K(175)=2:K(146)=3:K(128)=0:K(142)=4:K(141)=4:K(189)=5:K(190)=5
820 FORX=0TO31:FORY=0TO15:P(X,Y)=(32*Y)+X+MC:NEXT:NEXT
830 X(2)=-1:Y(2)=0:D(2,1)=141:FORT=2TO7:D(2,T)=189:NEXT
831 X(3)=0:Y(3)=-1:D(3,1)=141:FORT=2TO7:D(3,T)=189:NEXT
832 X(4)=1:Y(4)=0:D(4,1)=142:FORT=2TO7:D(4,T)=190:NEXT
833 X(5)=0:Y(5)=1:D(5,1)=142:FORT=2TO7:D(5,T)=190:NEXT
850 RETURN
900 FORT=0TO31:PRINT@T,CHR$(175);:NEXT
910 FORJ=1TO14:READA$:FORC=1TO32:PRINT@T,CHR$(M(ASC(MID$(A$,C,1))));:T=T+1:NEXT:NEXT
920 FORC=1TO31:PRINT@T,CHR$(175);:T=T+1:NEXT:POKE16895,175
930 A(1)=14:B(1)=14:N(1)=128:POKEP(A(1),B(1)),141:F(1)=POINT(A(1)*2,B(1)*2+2)
940 A(2)=2:B(2)=1:N(2)=128:POKEP(A(2),B(2)),142+48:F(2)=POINT(A(2)*2,B(2)*2+2):M(2)=2
945 A(3)=5:B(3)=6:N(3)=128:POKEP(A(3),B(3)),142+48:F(3)=POINT(A(3)*2,B(3)*2+2):M(3)=2
950 A(4)=21:B(4)=6:N(4)=128:POKEP(A(4),B(4)),142+48:F(4)=POINT(A(4)*2,B(4)*2+2):M(4)=2
955 A(5)=15:B(5)=9:N(5)=128:POKEP(A(5),B(5)),142+48:F(5)=POINT(A(5)*2,B(5)*2+2):M(5)=2
990 GOTO20
1001 DATA"X    *                         X"
1002 DATA"XXXXXXXXHXXXXXXXX              X"
1003 DATA"X       H-------------     *   X"
1004 DATA"X       H     XXH     XXXXXXXHXX"
1005 DATA"X       H     XXH            H X"
1006 DATA"X       H     XXH         *  H X"
1007 DATA"XXXHXXXXX     XXXXXXXXXHXXXXXXXX"
1008 DATA"X  H                   H       X"
1009 DATA"X  H                   H       X"
1010 DATA"XXXXXXXXXXHXXXXXXXXXXXXHXXXXXXXX"
1011 DATA"X         H            H       X"
1012 DATA"X       * H------------H   *   X"
1013 DATA"X    HXXXXXX           XXXXXXXHX"
1014 DATA"X    H              *         HX"
