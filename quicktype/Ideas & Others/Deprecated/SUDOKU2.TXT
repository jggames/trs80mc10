1 DIM CAN$,TMP$,N1$
2 DIM SU(80),A,B,K,IND,BOX,INX,TR,FA,Z,O
3 DIM ROW:REM AS INTEGER, COL AS INTEGER
4 DIM ARR(9):REM BOOLEAN
5 DIM I,J,LST,LES,SYC,CAC,R1:REM INTEGER
10 Z=0:O=1:TR=-1:FA=0:GOTO1000
100 CAN$="":IND=I
110 REM CONVERT ARRAY INDEX INTO A TABLE INDEX
120 ROW=INT(IND/9)
130 COL=IND-(ROW*9)
140 FOR B=1 TO 9:REM LOOP SYMBOLS 1 TO 9
150 ARR(B)=FA:REM DEFAULT
160 REM CHECK PUZZLE ROW FOR AVAILABLE CANDIDATES
170 FORA=(ROW*9)TO((ROW*9)+8):ON(SU(A)=B)+OGOTO190
180 ARR(B)=TR
190 NEXT
200 REM CHECK PUZZLE COLUMN FOR AVAILABLE CANDIDATES
210 FORA=COLTO(72+COL)STEP9:ON(SU(A)=B)+OGOTO230
220 ARR(B)=TR
230 NEXT
240 NEXT
250 REM CHECK BOX (3*3 GRID) FOR AVAILABLE CANDIDATES
260 BOX=(INT(IND/27)*27)+(INT(COL/3)*3)
270 FORA=0TO2:REM ROW COUNTER
280 FORB=0TO2:REM COLUMN COUNTER
290 INX=BOX+(A*9)+B
300 FORK=OTO9:ON(SU(INX)=K)+1GOTO320
310 ARR(K)=TR
320 NEXT
330 NEXT
340 NEXT
350 REM RETURN CANDIDATES IN A STRING
360 FORA=1TO9:ONARR(A)+OGOTO370,370,370,370,370,370,370,370,370
361 NEXT:GOTO390
370 CAN$=CAN$+RIGHT$(STR$(A),O)
380 NEXT
390 PRINTJ;I,CAN$:RETURN
1000 FORC=0TO80:SU(C)=0:NEXT:SYC=0
1010 FOR J=1 TO 81:
1020 LES=10
1030 FOR I=0 TO 80
1040 ONSU(I)GOTO1095,1095,1095,1095,1095,1095,1095,1095,1095
1050 GOSUB100
1060 TMP$=CAN$
1070 CAC=LEN(TMP$)
1080 IF CAC=0 THEN RUN
1090 IF CAC<LES THEN LES=CAC:CAN$=TMP$:LST=I
1095 NEXT
1100 IF LEN(CAN$)=1 THEN SU(LST)=VAL(CAN$):GOTO2000
1110 R1=RND(LES):N1$=MID$(CAN$,R1,1):SU(LST)=VAL(N1$)
2000 NEXT
2010 REM CHECK THE NUMBER OF SYMBOLS FOUND SO FAR ...
2020 FOR I=0 TO 80
2030 IF SU(I)>0 THEN SYC=SYC+1
2040 NEXT:PRINT"SYMBOL COUNT=";SYC
3000 IF SYC<>81 THEN 1000
3010 REM FINISHED
3020 C=0:FORY=1TO9:FORX=1TO9:PRINTSU(C);:C=C+1:NEXT:PRINT:NEXT
3030 END
4000 REM -----------------------------------------
4010 REM NOW WE SHOULD HAVE A SOLVED SUDOKU STORED
4020 REM IN AN ARRAY. REPLACE THE FOLLOWING
4030 REM CODE DEPENDING ON HOW YOU WILL IMPLEMENT
4040 REM YOUR GAME GUI. IN THIS DEMO WE WILL
4050 REM FILL THE SUDOKU GRID (TEXTBOX CONTROL ARRAY)
4060 REM WITH SYMBOLS ON FORM1
4070 REM FOR I = 0 TO 80
4080 REM    FORM1.TXTSYMBOL(I) = SU(I)
4090 REM NEXT
5000 REM ------------------------------------------
