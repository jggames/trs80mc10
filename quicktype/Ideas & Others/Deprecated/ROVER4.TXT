0 GOSUB5000:CLEAR1000:DIMS$(6),E$(2),F$(2),A$(2),X$(6),A$,B$,C$,E$,F$,G$,H$,I$,J$,K$,L$,U$,D$,T$
1 DIMK(255),P(255),A(300),A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,MN,N1:GOTO1000
2 ONRND(2)GOTO3,4:RETURN
3 X$(M)=U$:M=M-1:RETURN
4 X$(M)=D$:M=M+1:RETURN
5 X$(M)=T$:M=M+1:RETURN
6 X$(M)=B$:M=M-1:RETURN
7 A=A+1:C=C+1:B=B+1:RETURN
8 A=A-1:C=C-1:B=B-1:RETURN
9 J=1:RETURN
10 FORD=1TO250:ONMGOSUB5,2,2,2,2,6:ONXGOSUB23,19,19,19,19,19,19,19,21:PRINT@A(D),A$(S);
11 V=V+G:U=U+Q:ONPOINT(U,V)GOSUB29,28,25,28,28,28,28,28:SET(U,V,R)
12 FORT=1TO6:S$(T)=RIGHT$(S$(T),31)+X$(T):X$(T)=L$:NEXT:PRINT@64,S$(1)S$(2)S$(3)S$(4)S$(5)S$(6);
13 E$=RIGHT$(E$,28)+E$(P(D)):F$=RIGHT$(F$,O)+F$(P(D)):PRINT@416,E$F$;
14 PRINT@MS,G$;:ONJGOTO16,16,17,18:PRINT@A,A$;:PRINT@C,C$;:ONK(PEEK(W)ANDPEEK(P))GOSUB7,8,9,26
15 ONABS(PEEK(B)=255)+1GOTO30:NEXT:GOTO50
16 A=A-Z:C=C-Z:B=B-Z:J=J+1:PRINT@A,A$;:PRINT@C,C$;:NEXT:GOTO50
17 A=A+Z:C=C+Z:B=B+Z:J=J+1:PRINT@A,A$;:PRINT@C,C$;:NEXT:GOTO50
18 A=A+Z:C=C+Z:B=B+Z:J=0:PRINT@A,A$;:PRINT@C,C$;:GOTO15
19 X=X-1:I=(X*8)+4:ONPOINT(I,Y)GOSUB24,24,25:ONPOINT(I-1,Y-1)GOSUB24,24,25
20 SET(I,Y,4):SET(I-1,Y,4):SET(I+1,Y,4):SET(I,Y-1,4):RETURN
21 ONP(D)GOSUB22:RETURN
22 X=8:Y=25:RETURN
23 GOSUB19
24 X=9:RETURN
25 PRINT@A,K$;:PRINT@C,K$;:SOUND1,2:A(250)=A(D):D=251:RETURN
26 PRINTH$;:E=(A-N1)*W:FORF=22TO1STEP-3:ONPOINT(E,F)GOSUB29,29,29,29,29,29,27,29:SET(E,F,1):NEXT:RESET(E,F+3):RETURN
27 PRINT@A(D),A$(2);:SOUND5,1:PRINT@A(D),A$(0);:N=A(D+50):H=(O-N)/50:N=O:FORT=DTOD+49:A(T)=N:N=N-H:NEXT:RETURN
28 U=A(D)*2:V=5
29 RETURN
30 A(250)=A(D):D=252:NEXT:PRINT@A,CHR$(128)CHR$(128)CHR$(128);:PRINT@C,A$;:PRINT@C+Z,C$;:SOUND100,1:SOUND1,1
50 PRINT@A(250),A$(0);:IFD=251THEN1500
55 MN=MN-1:GOSUB160:IFMN=0THEN100
56 FORT=1TO2000:NEXT:GOTO2000 
60 R=1+RND(17):FORT=1TO250:A(T)=R:ONRND(W)GOSUB65,75:NEXT:RETURN
65 ONABS(A(T)-W>1)GOTO70:R=A(T)+W:RETURN
70 R=A(T)-W:RETURN
75 ONABS(A(T)+W<18)GOTO80:R=A(T)-W:RETURN
80 R=A(T)+W:RETURN
85 PRINT@260,"GET READY FOR LEVEL";ABS(11-L);:FORT=1TO250:ONRND(L)GOTO92:P(T)=0:NEXT:GOSUB60:RETURN
92 P(T)=RND(2):FORX=1TO3+RND(2):P(T+X)=0:NEXT:T=T+(X-1):ONRND(2)GOTO93:NEXT:GOSUB60:RETURN
93 P(T-X)=RND(2):NEXT:GOSUB60:RETURN
100 PRINT@0,"  GAME OVER. PLAY AGAIN (Y/N)?  ";
110 I$=INKEY$:R=RND(1000):IFI$=""THEN110
120 IFI$="Y"THENL=11:MN=3:GOTO1500
130 IFI$="N"THENEND
140 GOTO110
160 POKE16895,48+MN:RETURN
1000 L$=CHR$(128):U$=CHR$(134):D$=CHR$(137):T$=CHR$(131):B$=CHR$(140):N1=352
1010 FORT=1TO5:FORX=1TO32:S$(T)=S$(T)+L$:NEXT:X$(T)=L$:NEXT
1020 FORX=1TO32:S$(T)=S$(T)+B$:NEXT:M=6
1030 E$(2)=CHR$(139+112)+CHR$(128+112)+CHR$(128+112)+CHR$(135+112)
1040 F$(2)=CHR$(143+112)+CHR$(139+112)+CHR$(135+112)+CHR$(143+112)
1050 E$(0)=CHR$(143+112)+CHR$(143+112)+CHR$(143+112)+CHR$(143+112):F$(0)=E$(0):E$(1)=E$(0):F$(1)=E$(0)
1070 A$=CHR$(128+32)+CHR$(131+32)+CHR$(130+32):J$=CHR$(137+32)+CHR$(137+32)+CHR$(137+32)
1080 C$=CHR$(142+32)+CHR$(142+32)+CHR$(134+32):K$=CHR$(137+48)+CHR$(137+48)+CHR$(137+48)
1090 FORT=1TO160:G$=G$+L$:NEXT:MN=3
1110 K(83)=1:K(65)=2:K(87)=3:K(32)=4:W=2:MS=256:O=28:Z=32:P=17023:B=16384:L=11:FORT=1TO8:H$=H$+CHR$(140):NEXT
1120 FORT=251TO300:A(T)=1:NEXT
1200 A$(0)=CHR$(128)+CHR$(128)+CHR$(128)+CHR$(128)+CHR$(128)+CHR$(128)
1210 A$(1)=CHR$(128)+CHR$(128+96)+CHR$(135+96)+CHR$(139+96)+CHR$(128+96)+CHR$(128)
1220 A$(2)=CHR$(128)+CHR$(128)+CHR$(134+96)+CHR$(134+96)+CHR$(128+96)+CHR$(128+96)
1500 L=L-1:IFL=0THENL=1
1510 GOSUB85
2000 E$="":F$="":FORT=1TO8:E$=E$+E$(0):F$=F$+F$(0):NEXT
2010 CLS0:PRINT@416,E$F$;:A=352:C=384:B=16384+C+33:X=9:Y=0:J=0:S=1:R=1:V=5:G=2:U=A(1)*2:Q=-.3
2999 GOSUB160:GOTO10
5000 CLS:PRINT@264,"MOON ROVER PATROL";:RETURN
