0 CLS0:DIMX(16),Y(16),A(16),B(16),C(16),K(255),A,I,K,N,S,T,U,W
1 GOSUB1000:GOSUB2000
2 CLSO:FORT=OTOS:SET(X(T),Y(T),C(T)):X(T)=X(T)+A(T):ONABS(X(T)<O)GOSUB7:ONABS(X(T)>A)GOSUB6:Y(T)=Y(T)+B(T):ONABS(Y(T)<O)GOSUB9
3 ONABS(Y(T)>U)GOSUB8:NEXT:ONPOINT(X(O),Y(O))GOSUB10,10,11,10,10,10,10,10:CLS0:FORT=STOOSTEPN:SET(X(T),Y(T),C(T))
4 X(T)=X(T)+A(T):ONABS(X(T)<O)GOSUB7:ONABS(X(T)>A)GOSUB6:Y(T)=Y(T)+B(T):ONABS(Y(T)<O)GOSUB9:ONABS(Y(T)>U)GOSUB8
5 NEXT:ONPOINT(X(O),Y(O))GOSUB10,10,11,10,10,10,10,10:ONK(PEEK(W)ANDPEEK(K))GOSUB15,16,17,18,19,20,21,22,23:GOTO2
6 X(T)=O:RETURN
7 X(T)=A:RETURN
8 Y(T)=O:RETURN
9 Y(T)=U:RETURN
10 STOP
11 RETURN
15 STOP 
16 B(O)=-W:A(O)=O:RETURN
17 A(O)=W:B(O)=O:RETURN
18 B(O)=W:A(O)=O:RETURN
19 A(O)=-W:B(O)=O:RETURN
20 A(O)=-W:B(O)=-W:RETURN
21 A(O)=W:B(O)=-W:RETURN
22 A(O)=-W:B(O)=W:RETURN
23 A(O)=W:B(O)=W:RETURN
1000 T=1:A=0:B=0:GOSUB1010:T=5:A=60:B=0:GOSUB1010:T=9:A=0:B=30:GOSUB1010:T=13:A=60:B=30:GOSUB1010
1005 RETURN
1010 X(T)=A:Y(T)=B:X(T+1)=A+1:Y(T+1)=B:X(T+2)=A:Y(T+2)=B+1:X(T+3)=A+1:Y(T+3)=B+1
1020 R1=((RND(0)+RND(0))*(2-RND(3)))+.5:R2=((RND(0)+RND(0))*(2-RND(3)))+.5:FORG=TTOT+3:A(G)=R1:B(G)=R2:C(G)=5:NEXT:RETURN
2000 X(0)=32:Y(0)=16:C(0)=3:A(0)=0:B(0)=0
2010 A=63:O=0:S=16:I=1:N=-1:U=31:W=2:K=17023
2020 K(13)=1:K(87)=2:K(68)=3:K(88)=4:K(65)=5:K(81)=6:K(69)=7:K(90)=8:K(67)=9:RETURN
