1 CLS:DIM CA$,CN$,TM$,N1$,SU(80),A,B,K,BX,IX,TR,Z,O,RW,AR(9)
5 DIM I,J,LA,LS,SC,CC,R1,CL,PP
10 Z=0:O=1:TR=-1
20 CLS1
30 FORA=1TO9
40 FORB=1TO9
50 GR$(A,B)=" ":NEXT:NEXT
60 C=1:FORA=1TO35:RESET(A,1):RESET(A,20)
63 C=C+1:IFC=13THENRESET(A,0):RESET(A,21):C=1
67 NEXT
70 C=1:FORB=1TO20:RESET(1,B):RESET(36,B)
73 C=C+1:IFC=8THENRESET(0,B):RESET(37,B):C=1
77 NEXT
89 GOTO4000
3100 CN$="":RW=INT(I/9):CL=I-(RW*9)
3140 FORB=1TO9:AR(B)=Z:FORA=(RW*9)TO((RW*9)+8):IFSU(A)=BTHENAR(B)=TR
3190 NEXT:FORA=CLTO(72+CL)STEP9:IFSU(A)=BTHENAR(B)=TR
3230 NEXT:NEXT
3260 BX=(INT(I/27)*27)+(INT(CL/3)*3)
3270 FORA=0TO2:FORB=0TO2:IX=BX+(A*9)+B:FORK=1TO9:IFSU(IX)=KTHENAR(K)=TR
3320 NEXT:NEXT:NEXT:FORA=1TO9:IFAR(A)THEN3380
3370 CN$=CN$+CHR$(A+48)
3380 NEXT:RETURN
4000 PRINT@480-96," * SUDOKU MAKER * ":FORC=0TO80:SU(C)=0:NEXT:SC=0
4010 FORJ=1TO81:LS=10:FORI=0TO80:IFSU(I)THEN4095
4050 GOSUB3100:TM$=CN$:CC=LEN(TM$):IFCC=0THENI=80:NEXT:J=81:NEXT:GOTO4000
4090 IFCC<LSTHENLS=CC:CA$=TM$:LA=I
4095 NEXT
4100 IFLEN(CA$)=1THENSU(LA)=VAL(CA$):GOTO4200
4110 R1=RND(LS):N1$=MID$(CA$,R1,1):SU(LA)=VAL(N1$)
4200 GOSUB4500:PRINT@480,CA$;"        ";:NEXT
4210 REM CHECK THE NUMBER OF SYMBOLS FOUND SO FAR ...
4220 FORI=0TO80:IFSU(I)>0THENSC=SC+1
4240 NEXT:IFSC<>81THEN4000
4310 REM FINISHED
4330 PRINT@480,"PRESS ANY KEY TO CONTINUE";
4340 I$=INKEY$:IFI$=""THEN4340
4350 GOSUB5000
4360 FORY=1TO9:FORX=1TO9:PP=PEEK(16384+(32*Y)+((X*2)-1))
4370 IFPP<50THEN:GR$(X,Y)=CHR$(PP):GOTO4390
4380 GR$(X,Y)=" "
4390 NEXT:NEXT
4400 REM RETURN TO MAIN PROGRAM
4500 C=0:FORY=1TO9:FORX=1TO9:PRINT@(32*Y)+((X*2)-1),CHR$(SU(C)+48);:C=C+1:NEXT:NEXT
4510 RETURN
5000 FORCL=1TO5
5010 A=RND(4)-1:B=RND(4)-1
5030 GOTO5050
5040 NEXT
5045 I$=INKEY$:IFI$=""THEN5045
5046 RUN
5050 X=4-A:Y=4+B:IFPEEK(16384+(32*Y)+((X*2)-1))<58THEN5010
5051 X=6-A:Y=4-B:IFPEEK(16384+(32*Y)+((X*2)-1))<58THEN5010
5052 X=4+A:Y=6+B:IFPEEK(16384+(32*Y)+((X*2)-1))<58THEN5010
5053 X=6+A:Y=6-B:IFPEEK(16384+(32*Y)+((X*2)-1))<58THEN5010
5055 X=4-A:Y=4+B:POKE16384+(32*Y)+((X*2)-1),(PEEK(16384+(32*Y)+((X*2)-1)))-64
5060 X=6-A:Y=4-B:POKE16384+(32*Y)+((X*2)-1),(PEEK(16384+(32*Y)+((X*2)-1)))-64
5070 X=4+A:Y=6+B:POKE16384+(32*Y)+((X*2)-1),(PEEK(16384+(32*Y)+((X*2)-1)))-64
5080 X=6+A:Y=6-B:POKE16384+(32*Y)+((X*2)-1),(PEEK(16384+(32*Y)+((X*2)-1)))-64
5090 GOTO5040
