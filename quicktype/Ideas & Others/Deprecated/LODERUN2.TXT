0 DIM K(255),M(88),P(31,15),X(5),Y(5),A(7),B(7),O(7),N(7),F(7),C(7),T,Z,M,MC,D$(5,7)
1 CLS0:GOSUB800:GOTO900
2 RETURN
8 O(T)=N(T):C(T)=PEEK(P(A(T)+X(M),B(T)+Y(M))+MC):ONK(C(T))GOTO9,2,15
9 N(T)=C(T):PRINT@P(A(T),B(T)),CHR$(O(T));:A(T)=A(T)+X(M):B(T)=B(T)+Y(M):PRINT@P(A(T),B(T)),D$(M,T);
10 F(T)=POINT(A(T)*2,B(T)*2+2):ONK(C(T))GOSUB11:ONF(T)GOSUB2,2,2,2,12:RETURN
11 F(T)=1:RETURN
12 M=5:GOSUB8:RETURN
13 M=5:GOSUB8:GOTO21
15 C(T)=128:G(T)=G(T)+1:GOTO9
20 FORZ=1TO64000:T=1:ONF(T)+1GOTO13:M=K(PEEK(K)ANDPEEK(2)):ONMGOSUB16,8,8,8,8
21 NEXT
40 PRINT"GAME OVER":END
50 RETURN
800 K(32)=1:K(65)=2:K(87)=3:K(83)=4:K(90)=5:MC=16384:K=17023:L$=CHR$(142):R$=CHR$(141)
810 M(88)=175:M(72)=220:M(45)=204:M(42)=146
815 K(175)=2:K(220)=0:K(204)=1:K(146)=3:K(128)=0
820 FORX=0TO31:FORY=0TO15:P(X,Y)=(32*Y)+X:NEXT:NEXT
830 X(2)=-1:Y(2)=0:D$(2,1)=CHR$(141):FORT=2TO7:D$(2,T)=CHR$(141+48):NEXT
831 X(3)=0:Y(3)=-1:D$(3,1)=CHR$(141):FORT=2TO7:D$(3,T)=CHR$(141+48):NEXT
832 X(4)=1:Y(4)=0:D$(4,1)=CHR$(142):FORT=2TO7:D$(4,T)=CHR$(142+48):NEXT
833 X(5)=0:Y(5)=1:D$(5,1)=CHR$(142):FORT=2TO7:D$(5,T)=CHR$(142+48):NEXT
850 A(1)=2:B(1)=1:N(1)=128:RETURN
900 FORT=0TO31:PRINT@T,CHR$(175);:NEXT
910 FORJ=1TO14:READA$:FORC=1TO32:PRINT@T,CHR$(M(ASC(MID$(A$,C,1))));:T=T+1:NEXT:NEXT
920 FORC=1TO31:PRINT@T,CHR$(175);:T=T+1:NEXT:POKE16895,175
930 PRINT@P(A(1),B(1)),CHR$(141);:F(1)=POINT(A(1)*2,B(1)*2+2):GOTO20
1001 DATA"X    *                         X"
1002 DATA"XXXXXXXXHXXXXXXXX              X"
1003 DATA"X       H-------------     *   X"
1004 DATA"X       H     XXH     XXXXXXXHXX"
1005 DATA"X       H     XXH            H X"
1006 DATA"X       H     XXH         *  H X"
1007 DATA"XXXHXXXXX     XXXXXXXXXHXXXXXXXX"
1008 DATA"X  H                   H       X"
1009 DATA"X  H                   H       X"
1010 DATA"XXXXXXXXXXHXXXXXXXXXXXXHXXXXXXXX"
1011 DATA"X         H            H       X"
1012 DATA"X       * H------------H   *   X"
1013 DATA"X    HXXXXXX           XXXXXXXHX"
1014 DATA"X    H              *         HX"
