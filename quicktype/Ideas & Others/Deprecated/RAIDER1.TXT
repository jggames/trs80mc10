0 CLS1:CLEAR1200:DIMS$(13),LN$
1 DIMY(500),B(500),K(255),EC(32),A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,ML,PK,ZZ,EZ,B$,ES:GOSUB1000
2 FORML=1TO64000:GOSUB3000
5 FORG=ITO500STEPW:ONK(PEEK(PK)ANDPEEK(W))GOSUB20,30,40,50,60:RESET(X,Y(G)):RESET(X+I,Y(G+I)):RESET(A,B(G)):RESET(A+I,B(G+I))
6 FORC=ITOQ:S$(C)=RIGHT$(S$(C),U)+CHR$(PEEK(V+(S*C))):NEXT:PRINT@S,RIGHT$(S$(I),U);B$;
7 PRINTRIGHT$(S$(W),U);B$;RIGHT$(S$(E),U);B$;RIGHT$(S$(F),U);B$;RIGHT$(S$(D),U);B$;RIGHT$(S$(H),U);B$;RIGHT$(S$(J),U);B$;
8 PRINTRIGHT$(S$(K),U);B$;RIGHT$(S$(M),U);B$;RIGHT$(S$(N),U);B$;RIGHT$(S$(P),U);B$;RIGHT$(S$(T),U);B$;RIGHT$(S$(Q),U);B$;
9 ONK(PEEK(Z))GOSUB200,70:POKEZ,SH:GOSUB62:ONRND(E)GOSUB64,66,69:ONK(PEEK(EZ+ZZ))GOSUB68,300:EZ=EZ+ZZ:POKEEZ,ES:NEXT:NEXT
10 PRINT@480,"GAME OVER. PRESS c TO CONTINUE.";:GOTO99
20 PRINT@Z-16383,"------";:RETURN
30 Z=Z-I:RETURN
40 Z=Z+I:RETURN
50 Z=Z-S:RETURN
60 Z=Z+S:RETURN
62 EZ=EZ-I:EC=EC+I:ONEC(EC)GOSUB275:RETURN
64 ZZ=-S:RETURN
66 ZZ=S:RETURN
68 ONRND(E)GOSUB64,66:ONK(PEEK(EZ+ZZ))GOTO68:RETURN
69 RETURN
70 SOUND1,1:SC=SC+100:PRINT@448,SC;:RETURN
99 I$=INKEY$:IFI$=""THEN99
100 IFI$<>"C"THEN99
110 CLS1:GOTO2
200 PRINT@480-32,"YOU'RE DEAD!  SCORE=";SC;:ML=64000:G=500
210 RETURN
275 EC=I:EZ=V+((Y(G)/2)*S)+63:SOUND200,1:RETURN
300 PRINT@448,"IT GOT YOU!";
310 GOTO310
1000 U=31:V=16415:S=32:N=10:L=27:B$=CHR$(143):EC(28)=1
1005 O=0:I=1:W=2:E=3:F=4:D=5:H=6:J=7:K=8:M=9:N=10:P=11:T=12:Q=13:PK=17023:SH=126:ES=95
1010 FORC=ITOS:S$(0)=S$(0)+B$:LN$=LN$+CHR$(131):NEXT
2000 FORC=128TO142:K(C)=1:NEXT:K(30)=1:K(95)=1:K(13)=2:K(126)=2
2020 K(32)=1:K(65)=2:K(83)=3:K(87)=4:K(90)=5
2090 RETURN
3000 PRINT@O,"PREPARE FOR THE NEXT CAVERN...";:X=62:Y=8:A=62:B=22:Z=16384+256+15:EZ=16384+256+30
3005 FORG=ITO500STEPW:R=W-RND(E):IFY+R<WORY+R>B-NTHENR=O
3010 Y=Y+R:Y(G)=Y:Y=Y+R:Y(G+I)=Y:R=W-RND(E):IFB+R+R>LORB+R<Y+NTHENR=0
3020 B=B+R:B(G)=B:B=B+R:B(G+I)=B:NEXT
3040 FORC=ITOQ:S$(C)=S$(0):NEXT:S$(4)=LN$:S$(11)=LN$
3090 PRINT@O,"CAVERN RAIDER BY JIM GERRIE   ";:RETURN
