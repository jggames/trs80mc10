20 DIM B,B1,B2,I,J,K,M,N,P,X,Y,Q,XX,YY,P(200),Y(200)
70 CLS0
80 FORX=0TO62:SET(X,2,1):SET(X,3,1):SET(X,31,1):SET(X,30,1):NEXT
90 FORY=2TO31:SET(0,Y,1):SET(62,Y,1):NEXT
200 P=32:Y=10:SET(P,Y,1):SET(P,Y+1,1):P(0)=P:Y(0)=Y:K=1
210 IFPOINT(P+2,Y)=0THEN260
220 IFPOINT(P-2,Y)=0THEN260
230 IFPOINT(P,Y+4)=0THEN260
240 IFPOINT(P,Y-4)=0THEN260
250 GOTO350
260 ONRND(4)GOTO270,280,290,300
270 XX=0:YY=-1:IFPOINT(P+(XX*2),Y+(YY*4))=0THENSET(P,Y+(YY*4),1):SET(P,Y+(YY*3),1):SET(P,Y+(YY*2),1):SET(P,Y+(YY*1),1):GOTO330
275 GOTO260
280 XX=0:YY=1:IFPOINT(P+(XX*2),Y+(YY*4))=0THENSET(P,Y+(YY*5),1):SET(P,Y+(YY*4),1):SET(P,Y+(YY*3),1):SET(P,Y+(YY*2),1):GOTO330
285 GOTO260
290 XX=1:YY=0:IFPOINT(P+(XX*2),Y+(YY*4))=0THENSET(P+(XX*2),Y,1):SET(P+(XX*2),Y+1,1):SET(P+XX,Y,1):SET(P+XX,Y+1,1):GOTO330
295 GOTO260
300 XX=-1:YY=0:IFPOINT(P+(XX*2),Y+(YY*4))=0THENSET(P+(XX*2),Y,1):SET(P+(XX*2),Y+1,1):SET(P+XX,Y,1):SET(P+XX,Y+1,1):GOTO330
305 GOTO260
330 P=P+(XX*2):Y=Y+(YY*4):P(K)=P:Y(K)=Y:K=K+1:GOTO210
350 K=K-1:P=P(K):Y=Y(K):RESET(P,Y):SET(P,Y,1)
360 IFK=0THEN400
370 GOTO210
400 GOTO400
