0 CLS1:CLEAR1200:DIMS$(13),LN$,SH$,B$,L$,Y(500),B(500),K(255),EC(32),A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z
1 DIMG(13),ML,PK,ZZ,EZ,SH,ST,ES,HS,MC,TC,F3,S4:GOSUB1000
2 FORML=1TO64000:GOSUB3000
3 FORG=ITO500STEPW:RESET(X,Y(G)):RESET(X+I,Y(G+I)):RESET(A,B(G)):RESET(A+I,B(G+I))
4 S$(I)=RIGHT$(S$(I),U)+CHR$(PEEK(G(I))):S$(W)=RIGHT$(S$(W),U)+CHR$(PEEK(G(W))):S$(E)=RIGHT$(S$(E),U)+CHR$(PEEK(G(E)))
5 S$(F)=RIGHT$(S$(F),U)+CHR$(PEEK(G(F))):S$(D)=RIGHT$(S$(D),U)+CHR$(PEEK(G(D))):S$(H)=RIGHT$(S$(H),U)+CHR$(PEEK(G(H)))
6 S$(J)=RIGHT$(S$(J),U)+CHR$(PEEK(G(J))):S$(K)=RIGHT$(S$(K),U)+CHR$(PEEK(G(K))):S$(M)=RIGHT$(S$(M),U)+CHR$(PEEK(G(M)))
7 S$(N)=RIGHT$(S$(N),U)+CHR$(PEEK(G(N))):S$(P)=RIGHT$(S$(P),U)+CHR$(PEEK(G(P))):S$(T)=RIGHT$(S$(T),U)+CHR$(PEEK(G(T)))
8 S$(Q)=RIGHT$(S$(Q),U)+CHR$(PEEK(G(Q))):PRINT@S,RIGHT$(S$(I),U);B$;
10 PRINTRIGHT$(S$(W),U);B$;RIGHT$(S$(E),U);B$;RIGHT$(S$(F),U);B$;RIGHT$(S$(D),U);B$;RIGHT$(S$(H),U);B$;RIGHT$(S$(J),U);B$;
11 PRINTRIGHT$(S$(K),U);B$;RIGHT$(S$(M),U);B$;RIGHT$(S$(N),U);B$;RIGHT$(S$(P),U);B$;RIGHT$(S$(T),U);B$;RIGHT$(S$(Q),U);B$;
12 ONK(PEEK(PK)ANDPEEK(W))GOSUB20,30,40,50,60:ONK(PEEK(Z))GOSUB85,70:POKEZ,SH:ONRND(N)GOSUB95,95
13 GOSUB62:ONRND(F)GOSUB63,64,66,69:ONK(PEEK(EZ+ZZ))GOSUB68,69,75,80:EZ=EZ+ZZ:POKEEZ,ES:NEXT:NEXT
14 PRINT@480,"GAME OVER. PRESS c TO CONTINUE.";:GOTO99
20 PRINT@Z-ST,SH$;:RETURN
30 Z=Z-I:RETURN
40 Z=Z+I:RETURN
50 Z=Z-S:RETURN
60 Z=Z+S:RETURN
62 EZ=EZ-I:EC=EC+I:ONEC(EC)GOSUB90:RETURN
63 ZZ=-I:EC=EC+I:ONEC(EC)GOSUB90:RETURN
64 ZZ=-S:RETURN
66 ZZ=S:RETURN
67 ZZ=O:RETURN
68 ONRND(H)GOSUB63,64,64,66,66,67:ONK(PEEK(EZ+ZZ))GOTO68:RETURN
69 RETURN
70 SOUNDI,I:SC=SC+100:SL=INT((Z-MC)/S):LO=S*(((Z-MC)/S)-SL):L$=S$(SL)
71 VP=VARPTR(L$):POKE(PEEK(VP+W)*T6)+PEEK(VP+E)+LO+I,F3:S$(SL)=L$
72 PRINT@448,"SCORE:";SC;"            ";:RETURN
75 PRINT@448,"IT GOT YOU!";:POKEZ,191:SOUND1,9:GOSUB85:RETURN
80 PRINT@448,"YOU GOT IT!";:POKEEZ+ZZ,191:SOUND1,5:SC=SC+1000:GOSUB72:GOSUB90:RETURN
85 GOSUB72:IFSC>HSTHENHS=SC
86 PRINT@448+16,"HIGH:";HS;:ML=64000:G=500
87 RETURN
90 EC=O:EZ=V+(INT(Y(G)/W)*S)+ES:ZZ=O:RETURN
95 POKEV+(INT(Y(G)/W)*S)+ES+I,42:RETURN
99 I$=INKEY$:IFI$=""THEN99
100 IFI$<>"C"THEN99
110 CLS1:GOTO2
1000 U=31:V=16415:S=32:N=10:L=27:B$=CHR$(143):FORC=27TO32:EC(C)=1:NEXT:SH$="------":ST=16383
1005 O=0:I=1:W=2:E=3:F=4:D=5:H=6:J=7:K=8:M=9:N=10:P=11:T=12:Q=13:PK=17023:SH=126:ES=95
1010 FORC=ITOS:S$(0)=S$(0)+B$:LN$=LN$+CHR$(131):NEXT
1020 FORC=ITOQ:G(C)=V+(S*C):NEXT
2000 FORC=128TO142:K(C)=1:NEXT:K(30)=1:K(95)=1:K(13)=1:K(126)=3:K(109)=4:K(106)=2
2020 K(32)=1:K(65)=2:K(83)=3:K(87)=4:K(90)=5
2030 HS=0:MC=16384:T6=256:F3=143:S4=64
2090 RETURN
3000 PRINT@O,"PREPARE FOR THE NEXT CAVERN... ";:X=62:Y=8:A=62:B=22:Z=16384+256+15:EZ=16384+256+30:EC=0
3005 FORG=ITO500STEPW:R=W-RND(E):IFY+R<WORY+R>B-NTHENR=O
3010 Y=Y+R:Y(G)=Y:Y=Y+R:Y(G+I)=Y:R=W-RND(E):IFB+R+R>LORB+R<Y+NTHENR=0
3020 B=B+R:B(G)=B:B=B+R:B(G+I)=B:NEXT
3040 FORC=ITOQ:S$(C)=S$(0):NEXT:S$(4)=LN$:S$(11)=LN$:SC=0:GOSUB72
3090 PRINT@O,"* CAVERN RAIDER BY JIM GERRIE *";:RETURN
