0 WIDTH 32:CLS
5 PRINT@168,"PLEASE,STAND BY":PRINT@230,"GENERATING GRAPHICS"
6 PRINT:PRINT" PRESS <M> FOR MENU DURING GAME"
7 PRINT:PRINT" PRESS <C> TO DROP THE CHARGES"
10 GOSUB 1500:REM VARIABLES
20 GOSUB 1000:REM GRAFICOS
22 REM BUCLE DE PUNTERIA
25 TIMER=0
30 X=JOYSTK(0):Y=JOYSTK(1)
40 X=INT(X/6.4)+1:Y=INT(Y/6.4)+1
50 H=X*15+10:V=Y*15+10
55 REM PRINT@4,X:PRINT@9,Y:GOTO 30
60 GET (H,V)-(H+9,V+9),F
70 PUT (H,V)-(H+9,V+9),M,PSET
80 REM CIRCLE (SH*15+10,SV*15+10),3,1
90 FOR Z=1 TO 30
100 A$=INKEY$
110 IF A$="C" OR A$="c" THEN GOSUB 3000
111 IF A$="M" OR A$="m" THEN GOSUB 5000
119 NEXT Z
120 PUT (H,V)-(H+9,V+9),F
130 IF TIMER<250 THEN 30
500 PLAY"O1T34;3;4;3;4;5;3;4;5"
510 IF RND(4)=1 THEN GOSUB 2000
515 DT=DT+1
520 ON SD GOSUB 1680,1720,1600,1640,1620,1740,1660,1700
530 GOTO 25
1000 PMODE 3,1:PCLS 1
1010 COLOR 2
1020 LINE (195,95)-(204,104),PSET,BF
1030 CIRCLE(198,100),5,4,1,.13,.38
1040 CIRCLE (198,100),5,4,1,.63,.88
1050 PSET (198,100,4)
1060 GET (195,95)-(204,104),M,G
1070 LINE(195,95)-(204,104),PRESET,BF
1080 DRAW"C4BM200,30;U14R6F2D4G2L4F6"
1090 DRAW"C4BM200,135;U14D7R8NU7D7"
1100 DRAW"C4BM200,90;U14R4F3D8G3L4"
1110 FOR A=1 TO 50 STEP 5:PSET (200+A,35,4):NEXT A
1120 COLOR 4
1130 LINE(10,10)-(180,180),PSET,BF
1140 COLOR 2
1150 LINE(15,15)-(175,175),PSET,BF
1160 SCREEN 1,1
1170 RETURN
1500 DIM M(10,10),F(10,10)
1510 SH=RND(10):SV=RND(10)
1520 SD=RND(8) 'DIRECCION SUBMARINO
1530 DT=0:CD=0
1540 RETURN
1600 SH=SH+1:IF SH>10 THEN SH=10
1610 RETURN
1620 SV=SV+1:IF SV>10 THEN SV=10
1630 RETURN
1640 GOSUB 1600:GOSUB 1620
1650 RETURN
1660 SH=SH-1:IF SH<1 THENSH=1
1670 RETURN
1680 SV=SV-1:IF SV<1 THEN SV=1
1690 RETURN
1700 GOSUB 1660:GOSUB 1680
1710 RETURN
1720 GOSUB 1600:GOSUB 1680
1730 RETURN
1740 GOSUB 1660:GOSUB 1620
1750 RETURN
2000 ' CAMBIO CURSO DE SUBMARINO
2010 IF RND(2)=1 THENSD=SD+1 ELSE SD=SD-1
2020 IF SD>8 THEN SD=1
2030 IF SD<1 THENSD=8
2040 RETURN
3000 ' CALCULO DISTANCIA
3010 DH=ABS(SH-X):DV=ABS(SV-Y)
3020 DD=INT(SQR(DH^2+DV^2))
3030 IF DD=0 THEN GOTO 4000
3040 DD=10-DD:IF DD<1 THEN DD=1
3050 COLOR 2
3060 LINE (H-5,V-5)-(H+14,V+14),PSET,BF
3070 FOR Z=1 TO DD*1.5
3080 CIRCLE(H+4,V+4),Z,1
3090 NEXT Z
3100 GET (H,V)-(H+9,V+9),F
3110 CD=CD+1:IF CD/3=INT(CD/3) THEN TIMER=500
3120 ' STATUS DISPLAY
3130 IF NOT RF THEN 3160
3140 LINE(200,36)-(255,44),PRESET,BF
3150 CIRCLE(200+(10-DD)*5,40),3,4
3160 IF NOT HI THEN 3220
3170 DRAW"C1"+D$
3180 IF SD/2=INT(SD/2)THEN H$="E12NL4ND4" ELSE H$="U12NF4NG4"
3190 A$=RIGHT$(STR$(INT(SD/2-.5)),1)
3200 D$="BM230,135;A"+A$+H$
3210 DRAW "C4"+D$
3220 IF NOT DI THEN RETURN
3230 DRAW"C1"+DA$
3240 IF X>=SH THEN 3280
3250 IF Y>SV THEN DA=2:GOTO 3330
3260 IF Y<SV THEN DA=4:GOTO 3330
3270 DA=3:GOTO 3330
3280 IF X=SH THEN 3320
3290 IF Y>SV THEN DA=8:GOTO 3330
3300 IF Y<SV THEN DA=6:GOTO 3330
3310 DA=7:GOTO 3330
3320 IF Y<SV THEN DA=5 ELSE DA=1
3330 IF DA/2=INT(DA/2) THEN H$="E12NL4ND4" ELSE H$="U12NF4NG4"
3340 A$=RIGHT$(STR$(INT(DA/2-.5)),1)
3350 DA$="BM230,90;A"+A$+H$
3360 DRAW"C4"+DA$
3370 RETURN
4000 CLS:SCREEN 0,1
4010 PRINT@45,"YOU GOT IT!!"
4020 PRINTSTRING$(31,"#")
4030 PRINT"THE ENEMY SUBMARINE WAS ABLE TO MOVE FREELY FOR"DT"MILES"
4040 PRINT"AND YOU USED"CD"DEPTH CHARGES"
4050 PRINT:PRINTSTRING$(31,"#")
4060 PRINT:PRINT"DO YOU WANT TO PLAY AGAIN? (Y/N)";
4070 R$=INKEY$
4080 IF R$="N" OR R$="n" THEN CLS:PRINT"BYE":END
4090 IF R$="Y" OR R$="y" THEN GOSUB 1510:GOSUB 1120: GOTO 25
4100 GOTO 4070
5000 REM MENU
5010 TM=TIMER
5020 CLS
5030 PRINT@34,"rANGE FINDER:";
5040 IF RF THEN PRINT"ON" ELSE PRINT"OFF"
5050 PRINT@98,"dIRECTION INDICATOR:";
5060 IF DI THEN PRINT"ON" ELSE PRINT"OFF"
5070 PRINT@162,"hEADING INDICATOR:";
5080 IF HI THEN PRINT"ON" ELSE PRINT"OFF"
5090 PRINT@260,"RETURN TO cONSOLE"
5100 SCREEN 0,1
5110 O$=INKEY$
5120 IF O$="C"OR O$="c" THEN SCREEN 1,1:RETURN
5130 IF O$="R" OR O$="r" THEN RF=NOT(RF):GOTO 5030
5140 IF O$="D" OR O$="d" THEN DI=NOT(DI):GOTO 5050
5150 IF O$="H" OR O$="h" THEN HI=NOT(HI):GOTO 5070
5160 GOTO 5110