10 'SCEPTER OF KZIRGLA20 'WRITTEN BY PAUL PENROSE30 '(C) 1982,RAINBOW CONNECTION     SOFTWARE40 GOSUB108050 CLEAR:DIMDT$(20),AT$(10),IT(9),F(3),D(3):S=1024:IT(9)=1:IT(4)=1:IT(5)=1:TP$="WARRIOR":P$="V15O4T4L8F#":P1$="V15O3L8CBC":P2$="V15O4T3L8AB"60 CLS:PRINT@40,"WELCOME MORTAL","  TO THE WORLD OF KZIRGLA !!":PRINT:PRINT"BE THEE (W)ARRIOR OR (M)AGICIAN?":SOUND200,1:GOSUB830:IFA=77THENTP=1:TP$="MAGICIAN"70 HP=RND(29):ST=30-HP:CLS:PRINT:PRINT"PLAY WITH THESE QUANTITIES(Y/N)? HIT POWER ...";HP," STRENGTH ....";ST:GOSUB830:IFA$="N"THEN7080 PRINT:PRINT"SKILL LEVEL 1-9 (1=EASY 9=HARD)?";:GOSUB830:SL=11-(A-47):IFSL<1ORSL>9THENPRINT"TRY AGAIN.":PLAY"XP1$;P2":CLS:GOTO8090 ST=ST-INT((SL*.75)+.5):HP=HP-10100 FORX=0TO20:READDT$(X):NEXT110 DATA ZUBU,ILDOR,GREMLIN,DWARF,CRAWLER,LIZARD-MAN,BERSERKER,SKELETON,ZOMBIE,KCAHS-OIDAR,2CLUB,2DAGGER,2MACE,0AXE,0SWORD,1PENDANT,WALL,GOLD,SILVER,JEWEL,CARPET120 E$="":FORX=1TO60:E$=E$+" ":NEXT:FORX=0TO10:AT$(X)="":NEXT:FORX=0TO3:READD(X):NEXT:E1$=LEFT$(E$,25)130 DATA 1,32,-1,-32140 CLS(0):GOSUB760:TIMER=0:X=RND(4)-1:IT(X)=IT(X)+1150 GOSUB620:PRINT@0,"HIT POWER:";HP,"STRENGTH:";ST:TR=IT(6)+IT(7)*5+IT(8)*10:PRINT@32,"SUB LEVEL:";DL,"TREASURE:";TR:PRINT@64,E$:PRINT@66,"COMMAND: ";:GOSUB850:IFA=255THENAK=1:GOTO150ELSEAK=0160 IFA=9THENNL=PL+1:ED=0:PRINT"GO EAST":GOTO180ELSEIFA=8THENNL=PL-1:ED=2:PRINT"GO WEST":GOTO180ELSEIFA=10THENNL=PL+32:ED=1:PRINT"GO SOUTH":GOTO180ELSEIFA=94THENNL=PL-32:ED=3:PRINT"GO NORTH":GOTO180ELSEIFA=73THEN610170 IFA=65THENPRINT"ATTACK":GOTO320ELSEIFA=88THEN730ELSEIFA=66THENPRINT"BRIBE":GOTO950ELSEIFA=70THENPRINT"FLY":GOTO1000ELSE150180 X=PEEK(S+NL):IFX<>252 THEN190 ELSEPRINT"GOING DOWN TO LEVEL";DL+1:POKES+PL,128:PLAY"O2V15T3L230":FORX=1TO7:PLAY"CP8CP4V-V-":NEXTX:GOSUB760:TC=TIMER+598+60*SL:GOTO150190 IFX=128ORX=239THENPLAY"V15L255T255O3CT1O1":POKES+PL,128:OL=PL:PL=NL:PLAY"P8C":POKES+PL,174 ELSE300200 IFX<>239THEN270ELSEPRINT@96,"YOU HAVE FOUND ";:X=RND(3):PLAY"T4P4":ONX GOTO210,220,240210 PRINT"A trap door";:POKEPL+S,128:PLAY"V17L4O3T4":FORX=1TO4:PLAY"ECP8V-V-V-V-":NEXTX:HP=HP-(20+RND(10)):IFHP<=0THEN730ELSET=PL:GOSUB760:POKES+PL,128:PL=T:POKES+PL,174:GOTO150220 PRINT"POISONOUS GAS!":ST=ST-(5+RND(5)):PLAY"V19T255L255O1":FORX=0TO50:PLAY"N"+STR$(RND(12))+"P"+STR$(RND(200)+2):IFINT(X/5)=X/5THENPLAY"V-"230 NEXTX:IFST<=0THEN730ELSE150240 PRINT"A TREASURE CHEST!":PLAY"L4T4P2":PRINT@96,E$;:PRINT@96,"IN THE CHEST YOU FIND:":FORX=1TORND(5)250 X1=RND(11)-1:IFX1=6THEN250ELSEPRINT@128,E1$;:PRINT@128,"A ";:IFX1<6THENPRINTMID$(DT$(X1+10),2);:IT(X1)=IT(X1)+1ELSEPRINTDT$(X1+10);:IT(X1-1)=IT(X1-1)+1260 PLAY"XP$;P4":NEXTX:PRINT@128,E1$;:GOTO150270 FORX=0TO3:EV=PEEK(S+OL+D(X)):IFEV<182OREV>238 THEN290 ELSENL=OL+D(X)+D(ED):IFPEEK(S+NL)=128 THENPOKES+OL+D(X),128:PLAY"V15T4O1L40BAGFEDC":POKES+NL,EV ELSE290280 FORX1=1TO10:IFVAL(AT$(X1))=OL+D(X)THENAT$(X1)=STR$(NL)+MID$(AT$(X1),INSTR(AT$(X1),"@")) ELSENEXTX1290 NEXTX:GOTO150300 PRINT"UGG, I RAN INTO A ";:IFX=159ORX=143ORX<128THENX=198310 PRINTDT$(X-182);:PRINT"!!":PLAY"V15T3L4O1FL2C":PRINT"WANT TO ATTACK IT (Y/N)?":A$=INKEY$:GOSUB830:PRINT@96,E$:IFA=89 THENPRINT@96,"";:AL=NL:GOSUB350:GOTO370 ELSE150320 ER=0:GOSUB330:IFER=1THENGOTO150ELSE360330 PRINT"WHICH DIRECTION ?";:GOSUB830:IFA=9THENAL=PL+1:ED=0:PRINT"EAST":GOTO350ELSEIFA=8THENAL=PL-1:ED=2:PRINT"WEST":GOTO350ELSEIFA=10THENAL=PL+32:ED=1:PRINT"SOUTH":GOTO350340 IFA=94THENAL=PL-32:ED=3:PRINT"NORTH" ELSE PRINT:PRINT"WHAT?":PLAY"V15O2L8T4BAGFEDC":PRINT@96,E$;:ER=1:RETURN350 EV=PEEK(S+AL):RETURN360 IFEV=128OR EV=239THENPRINT@128,"NOTHING TO ATTACK!";:PLAY"XP$;P2":PRINT@96,E$;:GOTO150370 PRINT"WITH WHAT? ";:GOSUB830:IFA=72THEN M=1:PRINT"HANDS":GOTO410380 FORX=10TO15:IFA$=MID$(DT$(X),2,1) THEN IFIT(X-10)=0 THENPRINT@128,"YOU DON'T HAVE ONE!":PLAY"V15O1L2C":FORX=0TO250:NEXTX:PRINT@96,E$;:PRINT@96,"";:GOTO370 ELSE ELSE400390 X1=VAL(LEFT$(DT$(X),1)):IFX1=TP ORX1=2THENM=1+(.25*(X-9)):PRINTMID$(DT$(X),2);:GOTO410 ELSEPRINT@128,"YOU CANT'T USE THAT!";:FORX=0TO5:PLAY"O4L8T3P8":NEXT:FORX=0TO250:NEXT:PRINT@96,E$;:GOTO150400 NEXTX:M=1:PRINT"HANDS";410 W=X:FORX=0TO250:NEXT:IFW<15ORM=1THEN465ELSEPRINT@128,"WHICH SPELL, 1 OR 2?":GOSUB830:IFA=49 THEN450420 FORX=AL TO900*SGN(D(ED)) STEPD(ED):IFPEEK(S+X)<128ORPEEK(S+X)=143ORPEEK(S+X)>239 THEN430 ELSEPOKES+X,239:PLAY"L50T4O4V15B":NEXT430 IFX<>AL THENX1=X-D(ED):FORX=AL TOX1 STEPD(ED):POKES+X,128:NEXT440 IFRND(100)<50+SL THEN580 ELSEPRINT@128,"THE PENDANT BURNED OUT!":PLAY"V15L255O3":FORX=1TO15:PLAY"CCDEFCBV-":NEXT:IT(5)=IT(5)-1:GOTO580450 FORX2=0TO3:EV=PEEK(S+PL+D(X2)):IFEV<129OREV=252OREV=143OREV=239 THEN ELSEAL=PL+D(X2):GOSUB520:FORX1=0TO250:NEXT460 NEXT:GOTO440465 IFM=2.25THENM=3470 PRINT@128,"I ATTACK AND I ";:PLAY"O4V15L255":FORX1=1TO15:PLAY"CV-":NEXT:PLAY"V15":ES=INT(((EV-181)*DL+DL^2)/2)+RND(10):EP=SL*(4-39/9)+39/9:IFEV=159OREV=143OREV<128THENEP=150:ES=50480 FORX=0TO10:IFVAL(AT$(X))=AL THENEP=VAL(MID$(AT$(X),INSTR(AT$(X),"@")+1)) ELSENEXTX490 IFRND(100)<100*(ST/ES) THENPRINT"HIT!":GOSUB930:EP=EP-ST*M:IFM=1THEN510 ELSE ELSE PRINT"MISS!":GOSUB940:GOTO580500 IFRND(10+SL)=1 THENPRINT@128,"OOPS, MY ";MID$(DT$(W),2);" JUST BROKE!":PLAY"V15O3L255":FORX=1TO15:PLAY"EDCV-":NEXT:IT(W-10)=IT(W-10)-1:FORX=0TO500:NEXT510 IFEP>0OREV=143OREV<129THEN590ELSEGOSUB520:GOTO580520 PRINT@96,E$;:PRINT@96,"ANOTHER ";:IFEV=159 THENPRINT"WALL"; ELSE PRINTDT$(EV-182);530 PRINT" BITES THE","DUST!!":PLAY"V30O3T255L255":FORX=1TO15:POKES+AL,128+16*(RND(8)-1)+6:X$="N"+STR$(RND(12))+"V-":PLAYX$:POKES+AL,128+16*(RND(8)-1)+9:X$="N"+STR$(RND(12))+"V-":PLAYX$:NEXT:POKES+AL,128:GOSUB1030540 IFEV=159 THENRETURNELSEHP=HP+RND((EV-181)*2)+EV-181+SL:PRINT@96,"ON THE BODY I FOUND:":IFRND(EV-181)-1=0 THENPRINT"NOTHING.":PLAY"V15O1T3L4C":RETURN ELSE PRINT"A ";:TG=RND(EV-181):IFTG>6 THENTG=7-RND(3)550 PRINTMID$(DT$(TG+9),2):IT(TG-1)=IT(TG-1)+1:PLAYP$:FORX=1TO3:IFRND(EV-181)<X*2 THENRETURN ELSE AM=RND(EV-(181+X)):FORX1=0TO500:NEXT:PRINT@128,AM;DT$(X+16);560 PRINT"  ";CHR$(8);CHR$(8);:IFAM>1 THENPRINT"S"570 PLAYP$:IT(X+5)=IT(X+5)+AM:NEXT:RETURN580 FORX=0TO250:NEXT:PRINT@96,E$;:GOTO150590 IFEV=143OREV<128THEN580 ELSEFORX=0TO10:IFVAL(AT$(X))=AL THEN600ELSENEXTX:FORX=0TO10:IFAT$(X)="" THEN ELSENEXTX:X=0600 AT$(X)=STR$(AL)+"@"+STR$(EP):GOTO580610 PRINT@0,E$;E$;:PRINT@0,"";:FORX=10TO15:A$=MID$(DT$(X),2):PRINTA$;":";STRING$(7-LEN(A$),32);IT(X-10),:NEXT:FORX=17TO20:PRINTDT$(X);":";STRING$(7-LEN(DT$(X)),32);IT(X-11),:NEXT:GOSUB830:PRINT@0,E$;E$;E$;:GOTO150620 NM=300+SL*30630 IFRND(NM)>DL*3THENIFAK=1THEN680 ELSERETURN ELSEFORX=0TO3:F(X)=0:NEXT640 DR=RND(4)-1:IFF(0)+F(1)+F(2)+F(3)=4 THEN680650 IFPEEK(S+PL+D(DR))<>128THENF(DR)=1:GOTO640ELSEEL=PL+D(DR)660 EV=RND(INT(DL/1.2+1.8)):IFEV>10 THENEV=EV-3670 POKES+EL,EV+181:AK=1:NM=INT(NM*.666):GOTO 630680 AF=0:FORX=0TO3:EV=PEEK(S+PL+D(X)):IFEV<182THEN720690 IFEV=252OREV=239THEN720ELSEAF=AF+1700 PRINT@96,"A ";DT$(EV-182);" IS ATTACKING!":PLAY"V15O3L255T1":FORX1=1TO15:PLAY"CV-":NEXT:PLAY"T3P2":PRINT@96,"AND IT ";:ES=INT(((EV-181)*DL+RND(DL*2))/3)+1:IFRND(100)<100*(ES/ST)+10THEN ELSEPRINT"MISSED!":GOSUB940:GOTO720710 PRINT"HITS!":GOSUB930:HP=HP-ES:IF HP<1 THEN730 ELSEFORX1=0TO250:NEXT720 NEXT:PRINT@96,E$;:AK=0:TC=TIMER+598+60*SL:RETURN730 CLS:PRINT:PRINT"WE MOURN THE PASSING OF YET ONE","MORE BRAVE ";:IF TP=0THEN PRINT"WARRIOR." ELSE PRINT"MAGICIAN."740 PLAY "V15O2T3L4GL8.GL16GL4GL8.B-L16AL8.AL16GL8.GL16F#L2G":GOSUB900750 PRINT:PRINT"DO YOU DARE TRY AGAIN (Y/N)? ";:GOSUB830:IFA$="Y"THENRUN50 ELSEEND760 FORX3=0TO10:A$(X)="":NEXT:DL=DL+1:IFDL=13THEN860ELSEHP=HP+10:ST=ST+INT((SL*.75)+.5)770 CLS0:FORX=480TO511:POKES+X,143:NEXT:FORX=192TO448STEP32:POKES+X,143:POKEX+S+31,143:NEXT:FORX=0TO191:POKES+X,143:NEXT780 FORX=1TO50+DL*5790 X1=RND(325)+193:IFPEEK(S+X1)=128THENPOKES+X1,159:NEXTELSE790800 FORX=1TO5+RND(5):X1=RND(325)+193:IFPEEK(S+X1)=128THENPOKES+X1,239810 NEXT:X=RND(9)*32+191:POKES+X,252:POKES+X-1,128:POKES+X-2,128:PRINT@484,TP$;"    SKILL LEVEL";10-SL;820 PL=RND(9)*32+160:IFPL=X+1THEN820ELSEPOKES+PL,174:POKES+PL+1,128:POKES+PL+2,128:RETURN830 A$=INKEY$:R=RND(99):IFA$=""THEN830ELSEA=ASC(A$):PLAYP$:RETURN840 A$=INKEY$:IFA$<>""THENA=ASC(A$):RETURNELSEA=PEEK(339):IFA=253THENA=73:RETURNELSEIFA=254THENA=65:RETURNELSEIFPEEK(341)=247THENA=94:RETURNELSEIFPEEK(342)=247THENA=10:RETURNELSEIFPEEK(343)=247THENA=8:RETURNELSEIFPEEK(344)=247THENA=9:RETURN850 IFTIMER>TC THENTC=TIMER+598+60*SL:A=255:RETURN ELSEIFTIMER>60000 THENTM=TM+TIMER:TIMER=0:GOTO840 ELSE840860 CLS:PRINT"   **  Y O U   D I D   I T  **":PMODE2:COLOR0,5:PCLS5:PLAY"V15O3L16T4":FORX1=1TO8:SCREEN0,0:PCLS5:A$="BM128,96S"+STR$(X1)+"BM+0,+"+STR$(INT((X1/4)*45)):PCLS5:DRAWA$:B$="N"+STR$(X1)870 DRAW"L2H2U2R8D2G2L2BR2BU4NU60L4U60BF2H14E14F14G14U8H6NL8E6NU8F6NR8G6BU4U2NU2NL2NR2BD16BL2":FORX=1TO7:DRAW"F4G4":NEXT:FORL=0TO150:NEXTL:SCREEN1,1:PLAYB$:FORL=0TO200:NEXTL:NEXTX1880 PLAY"O5L50":FORX=1TO10:SCREEN1,1:PLAY"C":FORL=0TO50:NEXTL:SCREEN1,0:PLAY"F":FORL=0TO50:NEXTL,X890 PRINT:PRINT"YOU HAVE RECOVERED THE POWERFUL SCEPTER AND TAKEN THE KINGDOM","BACK FROM THE EVIL MAGICIAN!!":PRINT:PRINT" all HAIL THE KING!":GOSUB900:GOTO750900 PRINT:PRINT:PRINT"PRESS ANY KEY TO CONTINUE":GOSUB830:CLS910 PRINT@71,"FINAL INVENTORY":FORX=10TO15:A$=MID$(DT$(X),2):PRINTA$;":";STRING$(7-LEN(A$),32);IT(X-10),:NEXT:FORX=17TO20:PRINTDT$(X);":";STRING$(7-LEN(DT$(X)),32);IT(X-11),:NEXT:PRINT:PRINT"HIT POWER:"HP,"STRENGTH:"ST:PRINT920 TM=TM+TIMER:PRINT"YOUR GAME LASTED:":A=INT(TM/5168168):TM=TM-5168168*A:PRINTA;"DAYS,";:A=INT(TM/215340):TM=TM-A*215340:PRINTA;"HOURS,":A=INT(TM/3589):TM=TM-A*3589:PRINTA;"MINUTES,";:A=INT(TM/59.8):PRINTA"SECONDS":RETURN930 FORX1=1TO5:PLAY"V15L16O3T4CF":NEXT:RETURN940 PLAY"V15T4L16O4":FORX1=1TO3:PLAY"O-EDCP8":NEXT:RETURN950 ER=0:GOSUB330:IFER=1THEN150ELSEIFEV=128OREV=159OREV=143OREV>200THENPRINT"NOTHING TO BRIBE!":PLAY"XP2$;P2":PRINT@96,E$;:GOTO150ELSEEV=EV-181:IFRND(120)<EV*10THENPRINT"NO WAY, SUCKER!":GOSUB940:PRINT@96,E$;:GOTO150960 FORX1=0TO250:NEXT:PRINT@96,E$;:PRINT@96,"";:INPUT"HOW MUCH DO YOU OFFER";OF:PRINT@96,E$;:PRINT@96,"THE ";DT$(EV-1);" SAYS:":IFOF<RND(EV*10)+5THENPRINT"FORGET IT!":PLAY"XP1$;P2":GOTO150ELSEPRINT"I'LL TAKE IT!":PLAYP$970 IFIT(8)*10+IT(7)*5+IT(6)<OF THENPRINT@96,E$;:PRINT@96,"BUT I DON'T HAVE THAT MUCH!":PLAY"XP1$;P2":GOTO960ELSEFORX1=2TO1STEP-1:X2=INT(OF/X1*5):IFIT(X1+6)<X2 THENX2=IT(X1+6)980 IT(X1+6)=IT(X1+6)-X2:OF=OF-X2*X1*5:NEXT:IT(6)=IT(6)-OF990 FORX1=0TO250:NEXT:PRINT@96,E$;:POKEAL+S,128:GOSUB1030:GOTO1501000 OV=128:IFIT(9)=0THENPRINT@96,"HOW? I DON'T HAVE WINGS!":PLAY"XP1$;P2":PRINT@96,E$;:GOTO1501010 IFTP=1THENER=0:PRINT@96,E$;:PRINT@96,"";:GOSUB330:IFER=1THENIT(9)=IT(9)-1:GOTO150ELSE ELSEIFRND(99)<50THENED=0ELSEED=RND(3)1020 A$=INKEY$:IFA$<>""THENPOKEPL+S,174:IFTP=1THEN1010ELSEPRINT@96,E$;:IT(9)=IT(9)-1:GOTO150ELSEPOKEPL+S,175:NL=PL+D(ED):X=PEEK(NL+S):IFX=159ORX=143ORX>239ORX<128THENPOKEPL+S,174:GOTO1010ELSEPLAY"O1T16L255EC":POKEPL+S,OV:OV=X:PL=NL:GOTO10201030 FORX3=0TO10:IFVAL(AT$(X3))=AL THENAT$(X3)="":RETURN ELSENEXT:RETURN1040 IFINKEY$<>""THENRETURNELSEA1$="T1O1V12L4BBF#BB":A$="T8L8O2EF#GB-GB-F#B-"1050 B$="EB-EB-GAB-O3C#O2B-O3C#O2AO3C#O2GO3C#O2GO3C#O2A#BV+O3CECV+EO2BO3EO2A#V+O3EO2A#O3EO2A#V+O3EO2"1060 C$="BO3EO2BV+O3EO2BO3EO2BO3D#O2V+BO3D#O2BO3D#":D$="O1V+L4T1EECEE"1070 PLAYA1$:FORX=1TO3:PLAY"XA$;XB$;XC$;":NEXTX:PLAYD$:RETURN1080 PMODE2:COLOR0,5:PCLS5:SCREEN1,1:B$="BR6BU7":FORX=1TO2:A$="BM"+STR$(X*2+8)+","+STR$(X+9)+"S8":A1$="BD1D1F1R3F1D2G1L3H1BU5E1R3F1BD6":A2$="BD1D5F1R3E1U1BU3U1H1L3G1BD6BR5":DRAW"XA$;XA1$;XB$;XA2$;XB$;"1090 DRAW"NR5D3NR4D4R5XB$;ND7R4F1D2G1L4BD3BR5XB$;R4L2D7BR3XB$;":A3$="BD1D5F1R3E1U5H1L3G1BD6BR5":A4$="ND7R4F1D1G1NL4F1D3":DRAW"NR5D3NR4D4R5XB$;XA4$;XB$;":NEXT:DRAW"S5BM90,34XA3$;XB$;NR5D3NR3D4BR5"1100 FORX=1TO2:A$="S8BM"+STR$(58+X*2)+","+STR$(49+X):DRAW"XA$;D7U4R3E2NU1G2F2D2XB$;R5D1G5D1R5XB$;R4L2D7L2R4BR1XB$;XA4$;XB$;BD1D5F1R3E1U2NL2BU2U1H1L3G1BD6BR5XB$;D7R5XB$;BD1D6U4NR5U2E1R3F1D6":NEXT1110 B$="BR4BU7":DRAW"S4BM0,180NR3D7R3BR2XB$;XA2$;XB$;BR2R3D7NL3BR5XB$;BR6R2D7NL2R2BR1XB$;BD3BR1H1U1E1R3D3NL3D2G2L1BR4XB$;R5D3L5NU3D4R5NU4BR1XB$;BD1U1R5D3L5D4R5XB$;BR6BD3R3BR11BU3XA4$;XB$;XA2$;XB$;XA1$;"1120 FORX=6TO1STEP-1:CIRCLE(128,170),38+X*12,,.8,.5,0:NEXT:LINE(18,170)-(80,170),PSET:LINE(178,170)-(238,170),PSET:PAINT(128,84),0,0:PAINT(128,105),0,0:PAINT(128,126),0,0:GOTO1040