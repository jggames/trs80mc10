10 CLEAR32:DIMD$(9),O$(17),D(28,4),O(17,6):CLS:M1=15360
11 GOSUB 13000
15 IFINKEY$=""THENX=RND(100):GOTO15
20 CLS:C=991:O(17,1)=RND(155)+100:SP=RND(6):ST=RND(10):CH=RND(6):M=10:MC=6:PL=480:L=32:BQ=223:S1=BQ
30 D$="WANT TO":W$="WHICH ITEM?":E$="DON'T HAVE ANY!":H$="HOW MANY?":M$="DON'T HAVE THAT MANY!"
31 Y$="YOU'RE WASTING MY TIME!":R$="THEY ATTACKED ANYWAY!
40 DATA212CASTLE,214RUIN,99 CAVE,94 TOWER,107CITY,80 PILGRIMS,87 WIZARDS,79 OGRES,83 SOLDIERS
50 DATASIEGE TOWERS,SMALL BOAT,GRAPPLING HOOKS,OIL LAMPS,AXES,SHOVELS,ROPE,LEATHER JERKINS,CHAIN MAIL,PLATE ARMOR,SHIELDS
51 DATABROAD SWORDS,LONG BOWS,CROSSBOWS,RATIONS,LARGE KEY,GOLD COINS
60 DATA1500,2500,,150,255,,15,30,,5,20,,10,30,,10,20,,15,25,,15,40,2,25,60,4,50,100,8,3,20,2,10,50,5,11,50,5,18,40,4,4
61 DATA15,,1,5,,.25,1,
70 FORI=1TO9:READD$(I):NEXT:FORI=1TO17:READO$(I):NEXT:FORI=1TO17:FORJ=2TO4:READO(I,J):NEXTJ,I
80 DATA212,94,99,214,212,94,99,214,212,94,99,214,212,94,99,214,212,94,99,214,80,80,87,79,83,83
83 CLS:PRINT @234,"PLEASE WAIT"
85 D(1,1)=107:D(2,1)=107:D(1,2)=RND(6):D(2,2)=RND(6)+8:D(1,3)=RND(30)+1:D(2,3)=RND(30)+1:FORI=3TO28:D(I,4)=1:READD(I,1)
90 D(I,2)=RND(14):D(I,3)=RND(30)+1:IFD(I,2)=8THEN90
95 FORJ=1TO I:IFD(I,2)=D(J,2) THENIF D(I,3)=D(J,3) THENIF J<>I THEN90
100 NEXTJ,I:FORI=8TO14:IFRND(10)>5 THENO(I,1)=RND(8)
110 NEXT:O(15,1)=RND(25)+15:A=RND(7):B=RND(32):SL=RND(384)+1024:GOSUB9000:N=C+B+A*L
120 F1=1:GOSUB3030:GOSUB6100
1000 GOSUB5900:EG=EG+1:IFDF THEN1008
1004 Q=1:F1=1:GOSUB3030:GOSUB6100:IFTW<=M*100THEN1008
1005 GOSUB10010:PRINT@PL,"CARRYING TOO MUCH!";:GOSUB10000:GOSUB3000:GOSUB9000:GOTO1000
1008 GOSUB10010:PRINT@PL,"WHAT NOW SIRE?";:A$="IUNSEW"
1009 GOSUB2000:IFQ=0THEN1009
1020 ONQ GOSUB3000,5000:IFQ=1 ORQ=2THENGOSUB9000
1030 IFQ=5 AND B<32 THENB=B+1
1040 IFQ=4 AND A<15 THENA=A+1
1050 IFQ=6 AND B>1 THENB=B-1
1060 IFQ=3 AND A>1 THENA=A-1
1065 IFA<>8 OR O(2,1)>0 THEN1070
1066 GOSUB10010:PRINT@PL,"YOUR MEN CAN'T SWIM!";:GOSUB10000:A=A-1:IFQ=3THENA=A+2
1067 GOTO1000
1070 F=F+1:P=O(15,1)-M/2:IFF<10THEN1084
1071 F=0
1076 O(15,1)=P:IFP<M THENGOSUB10010:PRINT@PL,"FOOD LOW!";:GOSUB10000:IFO(15,1)<0THENO(15,1)=0
1080 IFP<M/2THENP=RND(M/3):GOSUB10010:PRINT@PL,P"MEN DIED!";:M=M-P:GOSUB10000
1084 MC=MC+1:FORI=1TO28:IFA=D(I,2) THENIFB=D(I,3) THENPOKEM1+N,S1:GOTO7000
1090 NEXT:POKEM1+N,S1:N=C+A*L+B:IFPEEK(N)<>207 THENS1=PEEK(N)
1100 DF=0:SWF=0:MF=0:GOSUB10010:PRINT@PL,"YOU ARE IN THE ";:B$="WILDERNESS":IFA=8THENB$="RIVER"
1120 IFB>18THENIFA<8THENB$="MOUNTAINS":MF=1:F=F+.5
1130 IFS1=125THENB$="SWAMP":SWF=1
1140 IFS1=220THENPRINT"SHADOW OF";:GOSUB10006:PRINT@PL,"THE DREADED MORLOCK'S TOWER!";:GOSUB10006:GOTO6000
1150 SOUND10,1:FORJ=0TO95:SOUND10,1:FORJ=0TO140:SOUND7,2
1170 PRINTB$;:POKEM1+N,207:GOSUB9100
1200 BT=0:FORX=1TO28:IFABS(A-D(X,2))>2THEN1290
1210 IFABS(B-D(X,3))>2THEN1290
1220 IFD(X,4)=1THEND(X,4)=0
1230 FORY=1TO9:IFVAL(D$(Y))<>D(X,1) THEN1280
1260 IFY>5THENBT=Y
1270 GOSUB10010:PRINT@PL,MID$(D$(Y),4);" NEAR";:GOSUB10000:GOTO1290
1280 NEXTY
1290 NEXTX
1291 IFA>12THENIFB>22THENGOSUB10010:PRINT@PL,"CITADEL NEAR";:GOSUB10000
1300 IFSWF THENIFRND(100)<50THENGOSUB10010:PRINT@PL,"2 MEN ARE STUCK IN QUICKSAND!";:M=M-2:DF=1:GOSUB10000:GOTO1319
1305 IFMF THENIFRND(100)<50THENGOSUB10010:PRINT@PL,"2 MEN FELL INTO A DEEP RAVINE!";:M=M-2:DF=1:GOSUB10000
1319 IFBT THEN1000
1320 BC=BC+1:IFBC<3THEN1000
1330 BC=0:FORJ=23TO28:IFD(J,4)=0THEND(J,4)=1:POKEM1+C+D(J,3)+D(J,2)*L,BQ
1340 X=RND(15):Y=RND(32):IFX=8THEN1340
1350 FORZZ=1TO28:IFX=D(ZZ,2) THENIFY=D(ZZ,3)THENIFJ<>ZZ THEN1340
1360 NEXTZZ:D(J,2)=X:D(J,3)=Y:NEXTJ:IFEX>0THENIFRND(100)>80THENJ=RND(6)+22:D(J,2)=A:D(J,3)=B:GOTO1084
1370 N=C+B+A*L:POKEM1+N,207:GOTO1000
2000 B$=INKEY$:Q=0:IFB$=""THEN2000
2001 FORI=1TOLEN(A$):IFB$=MID$(A$,I,1) THENQ=I:RETURN
2010 NEXT:RETURN
2100 A$="":Q=0:GOSUB10010:
2110 B$=INKEY$:IFB$<>""THENIFASC(B$)=13THENQ=VAL(A$):RETURN
2120 IFB$<>""THENIFASC(B$)=8THEN2100
2130 IFB$<>""THENA$=A$+B$:PRINT@PL,A$;
2140 GOTO2110
3000 CLS(0):PRINTTAB(11)"INVENTORY":PRINT
3010 PRINT"ITEM         QUANTITY  WT. TOTAL":F1=0:ZL=0
3030 WV=0:TW=0:FORI=1TO17:IFO(I,1)=0THEN3058
3040 J=O(I,1):K=O(I,2):TW=TW+J*K:IFF1=0THENGOSUB3180:ZL=ZL+1:IFZL=7THENGOSUB8904:ZL=0
3050 X=O(I,4):IFJ>M THENJ=M
3055 WV=WV+J*X
3058 NEXT:IFF1 THENRETURN
3060 PRINT:PRINT
3070 IFQ=3 THEN RETURN
3080 PRINT"TOTAL WEIGHT"TW" LBS.":PRINT"YOUR"M" MEN CAN CARRY"M*100
3085 IFZ=5THEN8700
3090 PRINT@PL,D$" DROP ANYTHING?";
3095 A$=INKEY$:IFA$=""THEN3095
3100 IFA$<>"Y"THENQ=1:RETURN
3110 GOSUB10010:PRINT@PL,W$;:GOSUB10005:GOSUB2100:IFQ>17THEN3110
3111 I=Q:QT=O(I,1):IFQT=0THENGOSUB10010:PRINT@PL,E$;:GOSUB10005:GOTO3090
3140 GOSUB10010:PRINT@PL,H$;:GOSUB10005:GOSUB2100:IFQ>QT THENPRINT@PL,M$;:GOSUB10005:GOTO3090
3160 O(I,1)=QT-Q:Q=1:GOTO3000
3180 PRINTMID$(STR$(I),2)" ";:IFI<10THENPRINT" ";
3185 PRINTO$(I);TAB(18)J;TAB(23)MID$(STR$(K),2);TAB(27)MID$(STR$(J*K),2):RETURN
3500 Z=0:BC=3:BT=0:B=B-1:IFRND(10)>5THENB=B+2
3510 N=C+B+A*L:RETURN
5000 CLS(0):Q=3:GOSUB3010:GOSUB10010:PRINT@PL,W$;:GOSUB10005:GOSUB2100:IFQ>17THEN5000
5001 I=Q:P=O(I,1):IFP=0THENGOSUB10010:PRINT@PL,E$;:GOSUB10005:GOTO5041
5020 IF(I=16 ANDZ=1)OR(I=6 ANDZ=2)OR(I=4 ANDZ=3)OR(I=3 ANDZ=4) THEN5100
5030 IFI=7 AND DF=1 THEN5600
5040 GOSUB10010:PRINT@PL,O$(I);" - NO EFFECT";:GOSUB10005
5041 GOSUB10010:PRINT@PL,"SOMETHING ELSE?";:GOSUB10000
5045 A$=INKEY$:IFA$=""THEN5045
5050 IFA$="Y"THEN5000
5060 GOSUB9000:RETURN
5100 GOSUB9000:GOSUB10010:PRINT@PL,"YOU'RE IN A ";MID$(D$(Z),4);:GOSUB10000:J=0
5110 GOSUB10010:PRINT@PL,"SEARCH OR LEAVE?";
5115 A$=INKEY$:IFA$=""THEN5115
5120 IFA$="S"THENJ=J+10:GOTO5210
5130 GOSUB3500:RETURN
5210 SF=0:IFRND(100)>90THENSF=Z:SU=1:Z=9:GOTO7300
5220 IFRND(100)>J THENPRINT@PL,"THERE'S NOTHING HERE!";:GOSUB10000:GOTO5110
5250 GOSUB10010:PRINT@PL,"THERE'S A CHEST HERE!";:GOSUB10000:IFRND(100)>90THEN5390
5255 IFD(AL,4)=-1THENGOSUB10010:PRINT@PL,"IT'S EMPTY!";:GOSUB10000:GOTO5350
5260 D(AL,4)=-1:GOSUB10010:PRINT@PL,"CONTAINING";:IFO(16,1) OR RND(100)>20 THEN5300
5261 PRINT" A ";O$(16);:O(16,1)=1:GOTO5350
5300 J=RND(500)+50:PRINTJ;O$(17);:O(17,1)=O(17,1)+J
5350 GOSUB10005:GOSUB10010:PRINT@PL,"BETTER LEAVE NOW!";:GOSUB10005:Q=0:GOTO5130
5390 J=RND(2):IFM>20THENJ=RND(5)
5400 GOSUB10010:PRINT@PL,"IT'S A TRAP!"J"MEN ARE KILLED";:M=M-J:GOTO5350
5600 GOSUB 10010:IFRND(100)<80THEN PRINT@PL,"THE ROPE BROKE-IT'S USELESS NOW";:GOSUB10005:O(7,1)=O(7,1)-1:DF=0:GOTO5610
5601 PRINT@PL,"YOU SAVED THEM":GOSUB10005:DF=0:M=M+2
5610 GOSUB9000:RETURN
5900 IFM>0THENRETURN
5901 PRINT@PL,"ALL YOUR MEN ARE DEAD!":END
6000 IFTW<2400THENGOSUB20030
6010 IFO(1,1)=0THENGOSU20050
6020 GOSUB10010:PRINT@PL,D$;:GOSUB10000:PRINT@PL,"ATTACK OR LEAVE?";
6030 A$="LA":GOSUB2000:IFQ=0THEN6030
6031 IF2THEN6050
6040 IFRND(100)>70THENGOSUB20010
6045 A=A-1:GOTO1084
6050 FA=1:BM=RND(40)+160:IW=20:BW=2000:SU=0:GOTO7470
6100 I=TW/M:FORSP=1TO9:IF10*SP>=I THEN6120
6101 NEXT
6120 SP=10-SP:RETURN
7000 AL=I:P=D(I,1):FORZ=1TO9:IFP<>VAL(D$(Z)) THENNEXT:GOTO1000
7010 SU=0:IFZ>5THEN7300
7020 GOSUB10010:PRINT@PL,"YOU'VE COME TO A ";MID$(D$(Z),4);:GOSUB10000:ONZ GOTO7040,7060,7080,7090,7100
7040 PRINT@PL,"THE WAY IS BARRED BY A STOUT,";:GOSUB10005:PRINT@PL,"DOOR WITH AN IRON LOCK!      ";:GOSUB10005:GOTO1000
7060 PRINT@PL,"THE ENTRANCE IS FILLED WITH";:GOSUB10005:GOSUB10010:PRINT@PL,"DRIFTED SAND!";:GOSUB10005:GOTO1000
7080 PRINT@PL,"IT'S TOO DARK TO SEE!";:GOSUB10005:GOTO1000
7090 PRINT@PL,"THERE'S NO VISIBLE ENTRANCE!";:GOSUB10005:GOTO1000
7100 IFMC<6THEN7200
7110 MC=0:FORI=1TO15:O(I,5)=0:IFRND(100)>50OR (I=1 AND A>8) THENIF I<15THEN7190
7120 O(I,5)=RND(20):V=O(I,3):GOSUB8990:O(I,6)=V:IFI=1THEN O(I,5)=1
7130 IFI=15THEN O(I,5)=RND(100)+M
7190 NEXTI
7200 GOSUB10010:PRINT@PL,"LEAVE,BUY AT MARKET,INVENTORY?";:A$="LBMI":GOSUB2000:IFQ=0THEN7200
7220 IFQ=1THENGOSUB3500:GOSUB9000:GOTO1000
7221 IFQ=4THENGOSUB3000:GOTO7200
7222 GOTO8000
7300 SOUND110,3:GOSUB20000:SOUND10,4:GOSUB10010:PRINT@PL,"YOU'VE ENCOUNTERED A BAND OF";:GOSUB10000:GOSUB10010
7301 PRINT@PL,MID$(D$(Z),4);:GOSUB10000
7310 BM=RND(M+M/4)+INT(EG/10):BS=RND(10):BX=RND(INT(EG/10)):SB=RND(10):BI=BM:BX=INT(BX)
7320 IFZ<8THENGOSUB10010:PRINT@PL,"THEY HAVE AN ESCORT!";:GOSUB10000
7330 IW=RND(8)-10*(EX>2):BW=BM*IW:GOSUB10010:PRINT@PL,"THERE ARE"BM",";:IFIW<6THENPRINT" LIGHTLY";:GOTO7335
7331 IFIW>5ANDIW<15THENPRINT" WELL";:GOTO7335
7332 PRINT" HEAVILY";
7335 PRINT" ARMED";:GOSUB10000
7340 IFSU THEN7450
7400 GOSUB10010:PRINT@PL,D$;:GOSUB10000:PRINT@PL,"ATTACK, RUN OR BE FRIENDLY?";:GOSUB10000:A$="ARF":GOSUB2000
7401 ONQ GOTO7440,7800,7900:GOTO7400
7440 SU=-1:IFRND(100)>50THENSU=0:GOTO7470
7450 GOSUB10010:B$="THEY":IFSU=1THENB$="YOU":PRINT@PL,B$;" WERE SURPRISED!";:GOSUB10000
7470 F1=1:GOSUB3030:BW=BM*IW:CLS:PRINTTAB(12)"YOU";TAB(22)"THEM":PRINT"MEN"TAB(12)M;TAB(22)BM
7471 PRINT"WEAPONS"TAB(12)WV;TAB(22)BW:PRINT"EXPERIENCE"TAB(12)EX;TAB(22)BX
7475 PRINT@128,"LUCK";
7480 SOUND250,1:I=RND(100):J=RND(100):PRINT@140,I"        "J;:A$=INKEY$:IFA$=""THEN7480
7490 I=I-SU*10:J=J+SU*10:TW=WV+I+ST*5+EX*5:IFFA THENIFO(1,1)=0THENTW=TW/5
7500 WT=BW+J+SB*2+BX*2:M=M+INT((WT>TW)*RND(M/10)+(TW>WT)*(RND(M/20)-1))
7501 BM=BM+INT((TW>WT)*RND(BM/10)+(WT>TW)*(RND(BM/20)-1)):IFBM<0THENBM=0
7505 GOSUB5900:PRINT:PRINT"SURVIVORS"TAB(12)M;TAB(22)BM:IFBM=0THEN7950
7506 IF BM<BI/4 ANDRND(100)>50 ANDFA=0THEN7901
7510 PRINT:PRINT"FIGHT, RUN OR TERMS?":A$="FRT":GOSUB2000:IFQ=0THEN7510
7511 IFQ=2THEN7800
7512 IFQ=3 THEN7820
7513 GOTO7470
7800 IFSP>B OR RND(100)>90ORFA=1THENGOSUB10010:PRINT@PL,"YOU GOT AWAY!";:GOSUB10000:FA=0:GOTO7930
7810 GOSUB10010:PRINT@PL,"THEY CAUGHT YOU!";:GOSUB10000:SU=1:GOTO7450
7820 I=WT*RND(100):J=TW*RND(10)*CH:GOSUB10000:IFJ>I ANDFA=0THEN7830
7821 PRINT@PL,R$;:GOSUB10000:SU=1:GOTO7450
7830 BM=RND(BM):GOTO7901
7900 GOSUB10010:IFRND(10)>CH THENPRINT@PL,R$;:GOSUB10005:SU=1:GOTO7450
7901 BM=RND(BM)
7901 PRINT@PL,BM"WILL JOIN YOU!";:GOSUB10000:M=M+BM:PRINT:PRINT"THEY HAVE:":PRINT
7910 FORI=8TO15:IFRND(100)>50THENQT=RND(BM):O(I,1)=O(I,1)+QT:PRINTQT;O$(I)
7920 NEXT:IFRND(100)>90THENPRINT"TOO BAD THEY HAD NO GOLD!":GOTO7930
7921 QT=INT(RND(5)*((EG/10)+1)*BM):O(17,1)=O(17,1)+QT:PRINTQT;O$(17)
7930 EX=EX+1:PRINT@PL,"READY TO GO ON?";:A$="A":GOSUB2000:IFSF THENZ=SF:GOTO5100
7931 GOSUB9000:GOTO1330
7950 IFFA THEN9500
7951 FORJ=1TO2:SOUND32,3:GOSUB20000:SOUND147,5:GOSUB20000:NEXT:PRINT"YOU WON!
7960 BM=2:PRINT"YOU MANAGED TO SALVAGE:":GOTO7910
8000 HC=0:OC=0:ZL=0:CLS(0):VF=1:PRINT"ITEM      PRICE   WT. QUANTITY":PRINT:FORI=1TO15:IFO(I,5)=0THEN8090
8005 PRINTMID$(STR$(I),2)" ";:IFI<10THENPRINT" ";
8010 PRINTO$(I);TAB(18)O(I,6);TAB(23)O(I,2);TAB(27)O(I,5)
8020 ZL=ZL+1:IFZL=7THENGOSUB8900:IFZL=99THEN8100
8090 NEXTI
8100 HB=0:F1=1:GOSUB3030:PRINT"YOU HAVE"O(17,1)"GOLD COINS":PRINT"YOUR"M"MEN ARE CARRYING"TW"LBS"
8280 GOSUB10010:PRINT@PL,W$;:GOSUB10005:GOSUB2100:IFQ>17THEN8280
8281 V=O(Q,6):OL=3+RND(4)-(5*(V>150)):GOSUB8990:X=Q:GOSUB10010:IFO(X,5)=0THENPRINT@PL,E$;:GOSUB10005:GOTO7200
8300 GOSUB10010:PRINT@PL,"YOUR OFFER?";:GOSUB10005:GOSUB2100:Q=INT(Q):GOSUB10010:IFQ>=V THENV=Q:GOTO8400
8305 IFRND(30)=15THENV=Q:GOTO8400
8306 IFRND(20)=12THENOL=OL+10
8307 IFRND(100)=74THENV=V*2
8310 IFQ<V/3THENPRINT@PL,"NOT INTERESTED!";:GOTO8610
8315 IFQ=HB THENHC=HC+1
8320 IFQ<HB OR (Q=HB ANDHC=2) THEN8600
8330 HB=Q:PRINT@PL,"TELL YOU WHAT I'M GOING TO DO--";:GOSUB10000:ZZ=INT(V*((RND(15)+5)*.01)):IFZZ<1THENZZ=1
8340 V=V-ZZ:IFV<HB THENV=HB 
8345 IFQ>=V THENV=Q:GOTO8400
8350 GOSUB10010:IFRND(100)>50THENPRINT@PL,"FOR YOU I'LL MAKE IT";V;"OK?";:GOTO8355
8351 PRINT@PL,"WHAT DO YOU SAY TO"V"?";
8355 A$=INKEY$:IFA$=""THEN8355
8360 IF A$<>"Y" THEN OC=OC+1:IF OC< OL THEN 8300
8361 GOTO8600
8400 GOSUB10010:PRINT@PL,H$;:GOSUB10005:GOSUB2100:IFQ>O(X,5) THENPRINT@PL,M$;:GOSUB10005:GOTO8400
8420 IFQ*V>O(17,1)THENGOSUB10010:PRINT@PL,"NOT ENOUGH GOLD!";:GOSUB10005:GOTO8400
8430 O(X,1)=O(X,1)+Q:O(17,1)=O(17,1)-Q*V:O(X,5)=O(X,5)-Q:GOTO7200
8600 GOSUB10010:PRINT@PL,Y$;
8610 GOSUB10005:O(X,6)=INT(O(X,6)/4)+O(X,6):GOTO7200
8700 PRINT@PL,D$" SELL ANYTHING?";:A$=INKEY$:IFA$=""THEN8700
8701 IFA$<>"Y"THENRETURN
8710 GOSUB10010:PRINT@PL,W$;:GOSUB10005:GOSUB2100:IFQ>17THEN8710
8711 I=Q:IFO(I,1)=0THENPRINT@PL,E$:GOSUB10005:GOTO8700
8712 V=INT(O(I,3)/(RND(3)+2)):OL=5+RND(5)-10*(V>80):HB=O(I,3)+1:HC=0
8720 IFRND(100)>50THENPRINT@PL,"I'LL GIVE YOU";V;"OK?";:GOTO8725
8721 PRINT@PL,"WILL YOU TAKE";V;"?";
8725 A$=INKEY$:IFA$=""THEN8725
8726 IFA$="Y"THEN8800
8730 GOSUB10010:PRINT@PL,"HOW MUCH DO YOU WANT?";:GOSUB10005:GOSUB2100:J=Q:IFJ=HB THENHC=HC+1:GOTO8735
8731 HC=0
8735 IFJ<=V THEN8800
8740 IFJ>HB OR (J=HB AND HC=2) OR OL=0 THENPRINT@PL,Y$;:GOSUB10005:RETURN
8750 HB=J:ZZ=INT(V*(RND(20)+10)*.01):IFZZ<1THENZZ=1
8760 V=V+ZZ:IFV<J THEN8720
8800 GOSUB10010:PRINT@PL,H$;:GOSUB10005:GOSUB2100:IFQ>O(I,1)THENPRINT@PL,M$;:GOSUB10005:GOTO8800
8810 O(17,1)=O(17,1)+V*Q:O(I,1)=O(I,1)-Q:RETURN
8900 J=0:PRINT"PRESS ENTER TO CONTINUE, OR":PRINT"SPACE BAR TO BUY":PRINT:GOTO8910
8904 PRINT"PRESS ENTER TO CONTINUE"
8910 A$=INKEY$:IFA$=""THEN8910
8920 IFASC(A$)=32THENZL=99
8930 RETURN
8990 V=V-RND(V/4):RETURN
9000 CLS(6):FORI=0TO10:FORJ=0TO3:IFRND(10)>5THENPOKEM1+SL+I+J*L,125
9010 NEXTJ,I:FORI=0TO31:POKEM1+1248+I,175:NEXT
9011 FORI=1TO14STEP2:FORJ=0TO6:IFRND(10)>6THENPOKEM1+1041+I+J*L,111:POKEM1+1041+I+1+J*L,92
9020 NEXTJ,I
9030 POKEM1+1497,216:POKEM1+1498,220:POKEM1+1499,212
9100 POKEM1+C+B+A*L,207
9110 FORX=1TO28:IFD(X,4)<1THENPOKEM1+C+D(X,2)*L+D(X,3),D(X,1)
9120 NEXT:RETURN
9500 FORI=1TO5:SOUND89,4:GOSUB20000:SOUND176,4:GOSUB20000:NEXT:PRINT@PL,"YOU'VE CONQUERED THE FORCES OF";
9501 GOSUB10006:GOSUB10010:PRINT@PL,"EVIL!    ALL HAIL THE VICTOR!!!!":END
10000 FORWT=1TO1000:NEXT:RETURN
10005 FORWT=0TO1000:NEXT:RETURN
10006 FORWT=1TO1000:NEXT:RETURN
10010 POKEM1+1535,143:PRINT@PL,"                               ";:RETURN
12000 FORWT=0TO10:NEXT:RETURN
13000 PRINT@32,"********************************";
13100 PRINT@480,"********************************";
13200 FOR X=32 TO 448 STEP 32
13300 PRINT@X,"*";:PRINT@X+31,"*";
13350 NEXTX
13400 PRINT@224,"********************************";
13500 PRINT@77,"QUEST";
13600 PRINT@108,"*******";
13700 PRINT@134,"A DIFFERENT KIND OF";
13800 PRINT@171,"ADVENTURE";
13900 PRINT@290,"COPYRIGHT 1981 R.J.RETELLE/";
14000 PRINT@322,"AARDVARK TECHNICAL SERVICES";
14100 PRINT@354,"LICENSED TO DRAGON DATA";
14150 PRINT@425,"-PRESS ENTER-";
14200 RETURN
20000 FORWT=1TO25:NEXT:RETURN
20010 I=RND(M/10):M=M-I:PRINT@PL,"A VOLLEY OF ARROWS";:GOSUB10006:PRINT@PL,"FROM THE TOWER HAS KILLED";:GOSUB10006
20020 GOSUB10010:PRINT@PL,I"OF YOUR MEN!";:GOSUB10006:RETURN
20030 GOSUB10010:PRINT@PL,"YOUR ARMY IS NOT STRONG ENOUGH";:GOSUB10006:GOSUB10010:PRINT@PL,"TO MAKE SUCCESS LIKELY!";
20040 GOSUB10006:RETURN
20050 B10010:PRINT@PL,"THE WALLS ARE TOO HIGH";:GOSUB10006:PRINT@PL,"FOR YOU TO BESIEGE THE TOWER!";:GOSUB10006
20060 RETURN
