0 CLS1:CLEAR630:DIMA$(15),B$(15),C$(15),D$(24),E$(24),I$(27),D(20,20,2),V(1,1,1,1,1),X(3),Y(3),N(4),BX(2),BY(2),I(27,3):GOTO999
1 O=0:GOSUB100:O=5:GOSUB100:O=9:GOSUB100:O=14:GOSUB100:RETURN
2 GOSUB170:GOSUB150:O=14:GOSUB100:RETURN
3 GOSUB110:O=6:GOSUB100:O=7:GOSUB100:O=14:GOSUB100:RETURN
4 GOSUB110:GOSUB150:O=14:GOSUB100:RETURN
5 O=0:GOSUB100:GOSUB160:GOSUB180:RETURN
6 GOSUB170:GOSUB130:GOSUB180:RETURN
7 GOSUB110:GOSUB160:GOSUB180:RETURN
8 GOSUB110:GOSUB130:GOSUB180:RETURN
9 O=0:GOSUB100:O=6:GOSUB100:O=7:GOSUB100:GOSUB120:RETURN
10 GOSUB170:GOSUB150:GOSUB120:RETURN
11 GOSUB110:O=6:GOSUB100:O=7:GOSUB100:GOSUB120:RETURN
12 GOSUB110:GOSUB150:GOSUB120:RETURN
13 O=0:GOSUB100:GOSUB160:GOSUB120:RETURN
14 GOSUB170:GOSUB130:GOSUB120:RETURN
15 GOSUB110:GOSUB160:GOSUB120:RETURN
16 GOSUB110:GOSUB130:GOSUB120:RETURN
17 O=0:GOSUB100:GOSUB140:O=14:GOSUB100:RETURN
18 GOSUB170:GOSUB140:O=14:GOSUB100:RETURN
20 GOSUB110:GOSUB140:O=14:GOSUB100:RETURN
21 O=0:GOSUB100:GOSUB140:GOSUB180:RETURN
22 GOSUB170:GOSUB140:GOSUB180:RETURN
24 GOSUB110:GOSUB140:GOSUB180:RETURN
25 O=0:GOSUB100:GOSUB140:GOSUB120:RETURN
26 GOSUB170:GOSUB140:GOSUB120:RETURN
28 GOSUB110:GOSUB140:GOSUB120:RETURN
29 O=0:GOSUB100:GOSUB140:GOSUB120:RETURN
30 GOSUB170:GOSUB140:GOSUB120
31 RETURN
100 PRINT@32*0+O,"";:PRINT@32*1+O,"";:PRINT@32*2+O,"";:PRINT@32*3+O,"";:PRINT@32*4+O,"";
105 PRINT@32*5+O,"";:PRINT@32*6+O,"";:PRINT@32*7+O,"";:PRINT@32*8+O,"";:PRINT@32*9+O,"";
106 RETURN
110 PRINT@32*0,"";:PRINT@32*1,"";:PRINT@32*2,"";:PRINT@32*3,"";:PRINT@32*4,"";
115 PRINT@32*5,"";:PRINT@32*6,"";:PRINT@32*7,"";:PRINT@32*8,"";:PRINT@32*9,"";:RETURN
120 PRINT@32*0+14,"";:PRINT@32*1+14,"";:PRINT@32*2+14,"";:PRINT@32*3+14,"";
125 PRINT@32*4+14,"";:PRINT@32*5+14,"";:PRINT@32*6+14,"";:PRINT@32*7+14,"";
126 PRINT@32*8+14,"";:PRINT@32*9+14,"";:RETURN
130 PRINT@32*0+6,"";:PRINT@32*1+6,"";:PRINT@32*2+6,"";:PRINT@32*3+6,"";
134 PRINT@32*4+6,"";:PRINT@32*5+6,"";:PRINT@32*6+6,"";:PRINT@32*7+6,"";
138 PRINT@32*8+6,"";:PRINT@32*9+6,"";:RETURN
140 PRINT@32*0+6,"";:PRINT@32*1+6,"";:PRINT@32*2+6,"";:PRINT@32*3+6,"";
144 PRINT@32*4+6,"";:PRINT@32*5+6,"";:PRINT@32*6+6,"";:PRINT@32*7+6,"";
148 PRINT@32*8+6,"";:PRINT@32*9+6,"";:RETURN
150 PRINT@32*0+6,"";:PRINT@32*1+6,"";:PRINT@32*2+6,"";:PRINT@32*3+6,"";
154 PRINT@32*4+6,"";:PRINT@32*5+6,"";:PRINT@32*6+6,"";:PRINT@32*7+6,"";
158 PRINT@32*8+6,"";:PRINT@32*9+6,"";:RETURN
160 PRINT@32*0+6,"";:PRINT@32*1+6,"";:PRINT@32*2+6,"";:PRINT@32*3+6,"";
164 PRINT@32*4+6,"";:PRINT@32*5+6,"";:PRINT@32*6+6,"";:PRINT@32*7+6,"";
168 PRINT@32*8+6,"";:PRINT@32*9+6,"";:RETURN
170 PRINT@32*0,"";:PRINT@32*1,"";:PRINT@32*2,"";:PRINT@32*3,"";:PRINT@32*4,"";
175 PRINT@32*5,"";:PRINT@32*6,"";:PRINT@32*7,"";:PRINT@32*8,"";:PRINT@32*9,"";:RETURN
180 PRINT@32*0+14,"";:PRINT@32*1+14,"";:PRINT@32*2+14,"";:PRINT@32*3+14,"";
184 PRINT@32*4+14,"";:PRINT@32*5+14,"";:PRINT@32*6+14,"";:PRINT@32*7+14,"";
188 PRINT@32*8+14,"";:PRINT@32*9+14,"";:RETURN
200 FORX=1TO20:FORY=1TO20:OND(X,Y,L)GOTO210:NEXT:NEXT:RETURN
210 RESET(42+X,Y):NEXT:NEXT:RETURN
300 PRINT@416,BL$"YOU SEE SOMETHING";:PRINT@448,BL$;
302 PRINT@202,CHR$(140+(I(S,3)-1)*16);:RETURN
310 PRINT@416,BL$"YOU SEE A SHADOWY";:PRINT@448,BL$"FIGURE";:PRINT@137,CHR$(135+(I(S,3)-1)*16)+CHR$(130+(I(S,3)-1)*16);
312 PRINT@169,CHR$(134+(I(S,3)-1)*16)+CHR$(130+(I(S,3)-1)*16);:RETURN 
330 PRINT@32*4+7,A$(M-3);:PRINT@32*5+7,B$(M-3);:PRINT@32*6+7,C$(M-3);:PRINT@32*7+7,D$(M-3);:PRINT@32*8+7,E$(M-3);
335 PRINT@480,BL$"uSE WEAPON OR mAGIC";:RETURN
340 GOSUB345:PRINT@232,D$(M-3);:PRINT@264,E$(M-3);:RETURN
345 PRINT@416,BL$"YOU FOUND A ";:PRINT@448,BL$;I$(M);:RETURN
350 GOSUB345:FORT=8TO9:PRINT@32*T+9,CHR$(206)CHR$(205);:NEXT:RETURN
360 GOSUB345:FORT=0TO8:PRINT@32*T+9,CHR$(206)CHR$(205);:NEXT:RETURN
999 DIMX,Y,T,F,A,B,R,R2:T=RND(-(PEEK(9)*256+PEEK(10)))
1000 FORT=1TO15:READA$(T),B$(T),C$(T),D$(T),E$(T):PRINTA$(T),,B$(T),,C$(T),,D$(T),,E$(T):GOSUB2500:CLS1:NEXT
1010 FORT=16TO24:READD$(T),E$(T):PRINTD$(T),,E$(T):GOSUB2500:CLS1:NEXT
1020 FORT=1TO32:READN(0),N(1),N(2),N(3),N(4):V(N(0),N(1),N(2),N(3),N(4))=T:NEXT
1030 FORT=1TO27:READI$(T),I(T,0),I(T,1),I(T,2),I(T,3):NEXT:FORT=1TO20:BL$=BL$+"*":NEXT:FORT=1TO20:BL$=BL$+CHR$(8):NEXT
1040 X(0)=1:X(1)=0:X(2)=-1:X(3)=0:Y(0)=0:Y(1)=1:Y(2)=0:Y(3)=-1:BX(0)=10:BY(0)=10
1050 D(0,0,0)=100:D(0,1,0)=10:D(0,2,0)=-2:D(0,3,0)=3:D(0,4,0)=100:D(0,5,0)=99000
2000 FORL=0TO2
2006 CLS1:PRINT@448,"MAKING LEVEL";L+1;:FORX=2TO19:FORY=2TO18:D(X,Y,L)=0:NEXT:NEXT
2007 FORX=1TO20:D(X,1,L)=1:D(X,19,L)=1:NEXT:FORY=1TO19:D(1,Y,L)=1:D(20,Y,L)=1:NEXT
2008 FORT=1TO4:A=1+RND(13):B=1+RND(12):R=2+RND(3):FORX=ATOX+R:D(X,B,L)=1:D(X,B+R,L)=1:NEXT:FORY=BTOY+R:D(A,Y,L)=1:D(A+R,Y,L)=1
2009 NEXT:R2=INT(R/2):D(A+R2,B,L)=0:D(A+R2,B+R,L)=0:D(A,B+R2,L)=0:D(A+R,B+R2,L)=0:NEXT:D(BX(L),BY(L),L)=0
2010 FORT=1TO50:D(RND(20),RND(19),L)=1:NEXT:GOSUB200
2020 X=BX(L):Y=BY(L):A=X:B=Y:F=1:FORT=1TO300
2030 F=F+1:ON1-(F>400)GOTO2040:T=300:NEXT:CLS:GOTO2006
2040 D=RND(4)-1:ON1-(D(X+X(D),Y+Y(D),L)=0)GOTO2030:X=X+X(D):Y=Y+Y(D):SET(X+42,Y,2):SET(X+42,Y,1)
2045 ON1-(ABS(A-X)+ABS(B-Y)<13)GOTO2050:NEXT:GOTO2006
2050 D(X,Y,L)=2:T=300:NEXT:SET(X+42,Y,2):ONL+1GOTO2060,2060,2070
2060 D(X,Y,L+1)=3:BX(L+1)=X:BY(L+1)=Y:GOTO2080
2070 D(X,Y,L)=18
2080 FORT=1TO10
2082 X=RND(20):Y=RND(19):ON1-(D(X,Y,L)=0)GOTO2082:D(X,Y,L)=3+RND(6+(L*2)):NEXT:FORT=1TO10
2086 X=RND(20):Y=RND(19):ON1-(D(X,Y,L)=0)GOTO2086:D(X,Y,L)=15+RND(2):NEXT:FORT=1TO10
2090 X=RND(20):Y=RND(19):ON1-(D(X,Y,L)=0)GOTO2090:D(X,Y,L)=19+RND(8):NEXT:NEXT:L=0:CLS1:GOSUB200
2100 X=BX(L):Y=BY(L):D=0:GOSUB2200:PRINT@480,BL$;"USE bOW OR mAGIC";
2110 I$=INKEY$:RESET(X+42,Y):SET(X+42,Y,1):IFI$=""THEN2110
2120 IFI$="W"THENIF(X+X(D)>1ANDX+X(D)<20)AND(Y+Y(D)>1ANDY+Y(D)<20)ANDD(X+X(D),Y+Y(D),L)<>1THENX=X+X(D):Y=Y+Y(D)
2130 IFI$="A"THEND=D-1:IFD=-1THEND=3
2140 IFI$="S"THEND=D+1:IFD=4THEND=0
2150 IFM>0THEN REM ATTACKROUTINE
2160 GOSUB2200:GOSUB2300:GOTO2110
2200 S=0:M=0:OND+1GOTO2210,2220,2230,2240
2210 N(0)=D(X,Y-1,L):N(1)=D(X+1,Y-1,L):N(2)=D(X+1,Y,L):N(3)=D(X+1,Y+1,L):N(4)=D(X,Y+1,L):GOSUB2290:GOTO2250
2220 N(0)=D(X+1,Y,L):N(1)=D(X+1,Y+1,L):N(2)=D(X,Y+1,L):N(3)=D(X-1,Y+1,L):N(4)=D(X-1,Y,L):GOSUB2290:GOTO2250
2230 N(0)=D(X,Y+1,L):N(1)=D(X-1,Y+1,L):N(2)=D(X-1,Y,L):N(3)=D(X-1,Y-1,L):N(4)=D(X,Y-1,L):GOSUB2290:GOTO2250
2240 N(0)=D(X-1,Y,L):N(1)=D(X-1,Y-1,L):N(2)=D(X,Y-1,L):N(3)=D(X+1,Y-1,L):N(4)=D(X+1,Y,L):GOSUB2290:GOTO2250
2250 ONV(N(0),N(1),N(2),N(3),N(4))GOSUB1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,20,21,22,24,24,25,26,28,28,29,30,28,28
2260 ONSGOSUB31,300,300,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,300,300,300,300,300,300,300,300,300
2270 M=ABS(D(X,Y,L))
2280 ONMGOSUB31,350,360,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,340,340,340,340,340,340,340,340,340
2290 RETURN
2290 FORT=0TO4:ONABS(N(T))+1GOTO2292,2293:ON1-(T=2)GOTO2292:S=ABS(N(T))
2292 N(T)=0
2293 NEXT:RETURN
2300 PRINT@341,"HEALTH:";D(0,0,0);:PRINT@373,"WEAPON:";D(0,1,0);:PRINT@405,"ARMOUR:";D(0,2,0);
2330 PRINT@437,"ARROWS:";D(0,3,0);:PRINT@469,"MAGIC:";D(0,4,0);:PRINT@501,"GP:";D(0,5,0);:RETURN
2500 I$=INKEY$:IFI$=""THEN2500
2510 RETURN
8000 DATA"","","","߀","Հ","","","","",""
8020 DATA"","","","","","","","","",""
8040 DATA"̀","΀","","","ʀ","","","","",""
8050 DATA"ˀ","π","","","","","","","",""
8060 DATA"","ʀ","ʀ","ʀ","ʀ","","","","",""
8070 DATA"","","","","","Ҁ","","","ڀ",""
8080 DATA"","","","","","","","","",""
8090 DATA"","","","",""
8100 DATA"","","","","","","","","","","","","","","","","",""
9000 DATA0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,1,0,1,0,1,0,0,1,0,1,1,0,1,0,0,0,0,0,1
9010 DATA0,1,0,0,1,1,0,0,0,1,1,1,0,0,1,0,0,0,1,1,0,1,0,1,1,1,0,0,1,1,1,1,0,1,1,0,0,1,0,0,0,1,1,0,0
9020 DATA1,0,1,0,0,1,1,1,0,0,0,0,1,1,0,0,1,1,1,0,1,0,1,1,0,1,1,1,1,0,0,0,1,0,1,0,1,1,0,1,1,0,1,0,1
9030 DATA1,1,1,0,1,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1
9100 DATA"WALL",100,0,0,6,"LADDER DOWN",0,0,0,6,"LADDER UP",0,0,0,6,"FIGHTER",6,8,4,3,"MAGIC USER",8,4,2,4,"RANGER",10,6,5,1
9146 DATA"ORC",11,8,5,3,"SKELETON",15,10,2,5,"BEHOLDER",16,11,2,7,"OGRE",17,12,3,1,"UMBER HULK",19,20,5,7,"GHOST",19,20,2,5
9200 DATA"SPIDER",20,20,5,8,"GRIFFON",25,21,5,8,"PHANTOM",25,25,5,6,"DEER",1,1,0,8,"BAT",1,3,9,1,"PIT FIEND",25,30,9,1
9300 DATA"HEALING POTION",10,20,0,6,"SWORD",8,9,1,6,"DAGGER",4,3,1,6,"SHIELD",-2,-5,0,6,"WAR HAMMER",8,10,1,6
9310 DATA"BUNCH OF ARROWS",6,5,1,6,"JEWELED GOBLET",50,50,0,6,"PILE OF GOLD",20,25,0,6,"MAGIC ITEM",20,30,0,6
