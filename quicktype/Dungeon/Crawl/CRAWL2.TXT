0 CLS1:CLEAR1000:DIMA$(15),B$(15),C$(15),D$(15),E$(15),D(20,20,2),V(1,1,1,1,1),X(3),Y(3),N(4),BX(2),BY(2):GOTO2000
1 O=0:GOSUB100:O=5:GOSUB100:O=9:GOSUB100:O=14:GOSUB100:RETURN
2 GOSUB170:GOSUB150:O=14:GOSUB100:RETURN
3 GOSUB110:O=6:GOSUB100:O=7:GOSUB100:O=14:GOSUB100:RETURN
4 GOSUB110:GOSUB150:O=14:GOSUB100:RETURN
5 O=0:GOSUB100:GOSUB160:GOSUB180:RETURN
6 GOSUB170:GOSUB130:GOSUB180:RETURN
7 GOSUB110:GOSUB160:GOSUB180:RETURN
8 GOSUB110:GOSUB130:GOSUB180:RETURN
9 O=0:GOSUB100:O=6:GOSUB100:O=7:GOSUB100:GOSUB120:RETURN
10 GOSUB170:GOSUB150:GOSUB120:RETURN
11 GOSUB110:O=6:GOSUB100:O=7:GOSUB100:GOSUB120:RETURN
12 GOSUB110:GOSUB150:GOSUB120:RETURN
13 O=0:GOSUB100:GOSUB160:GOSUB120:RETURN
14 GOSUB170:GOSUB130:GOSUB120:RETURN
15 GOSUB110:GOSUB160:GOSUB120:RETURN
16 GOSUB110:GOSUB130:GOSUB120:RETURN
17 O=0:GOSUB100:GOSUB140:O=14:GOSUB100:RETURN
18 GOSUB170:GOSUB140:O=14:GOSUB100:RETURN
20 GOSUB110:GOSUB140:O=14:GOSUB100:RETURN
21 O=0:GOSUB100:GOSUB140:GOSUB180:RETURN
22 GOSUB170:GOSUB140:GOSUB180:RETURN
24 GOSUB110:GOSUB140:GOSUB180:RETURN
25 O=0:GOSUB100:GOSUB140:GOSUB120:RETURN
26 GOSUB180:GOSUB140:GOSUB120:RETURN
28 GOSUB110:GOSUB140:GOSUB120:RETURN
29 O=0:GOSUB100:GOSUB140:GOSUB120:RETURN
30 GOSUB170:GOSUB140:GOSUB120:RETURN
100 PRINT@32*0+O,"€€€€€€€";
101 PRINT@32*1+O,"€€€€€€€";
102 PRINT@32*2+O,"€€€€€€€";
103 PRINT@32*3+O,"€€€€€€€";
104 PRINT@32*4+O,"€€€€€€€";
105 PRINT@32*5+O,"€€€€€€€";
106 PRINT@32*6+O,"€€€€€€€";
107 PRINT@32*7+O,"€€€€€€€";
108 PRINT@32*8+O,"€€€€€€€";
109 PRINT@32*9+O,"€€€€€€€";:RETURN
110 PRINT@32*0,"€Ÿ“€€€";
111 PRINT@32*1,"€ŸŸŸ“€";
112 PRINT@32*2,"€ŸŸŸŸŸ";
113 PRINT@32*3,"€ŸŸŸŸŸ";
114 PRINT@32*4,"€ŸŸŸŸŸ";
115 PRINT@32*5,"€ŸŸŸŸŸ";
116 PRINT@32*6,"€ŸŸŸŸŸ";
117 PRINT@32*7,"€ŸŸŸŸœ";
118 PRINT@32*8,"€ŸŸœ€€";
119 PRINT@32*9,"€œ€€€€";:RETURN
120 PRINT@32*0+14,"€€€‘—š€";
121 PRINT@32*1+14,"€‘—ŸŸš€";
122 PRINT@32*2+14,"•ŸŸŸŸš€";
123 PRINT@32*3+14,"•ŸŸŸŸš€";
124 PRINT@32*4+14,"•ŸŸŸŸš€";
125 PRINT@32*5+14,"•ŸŸŸŸš€";
126 PRINT@32*6+14,"•ŸŸŸŸš€";
127 PRINT@32*7+14,"”ŸŸŸš€";
128 PRINT@32*8+14,"€€”Ÿš€";
129 PRINT@32*9+14,"€€€€”˜€";:RETURN
130 PRINT@32*0+6,"€€€€€€€€";
131 PRINT@32*1+6,"€€€€€€€€";
132 PRINT@32*2+6,"‘‘";
133 PRINT@32*3+6,"•Ÿ“€‘—Ÿ";
134 PRINT@32*4+6,"•ŸŸŸ•ŸŸŸ";
135 PRINT@32*5+6,"•ŸŸœ”ŸŸ";
136 PRINT@32*6+6,"•œ”";
137 PRINT@32*7+6,"€€€€€€€€";
138 PRINT@32*8+6,"€€€€€€€€";
139 PRINT@32*9+6,"€€€€€€€€";:RETURN
140 PRINT@32*0+6,"€€€€€€€€";
141 PRINT@32*1+6,"€€€€€€€€";
142 PRINT@32*2+6,"•ŸŸŸŸŸŸŸ";
143 PRINT@32*3+6,"•ŸŸŸŸŸŸŸ";
144 PRINT@32*4+6,"•ŸŸŸŸŸŸŸ";
145 PRINT@32*5+6,"•ŸŸŸŸŸŸŸ";
146 PRINT@32*6+6,"•ŸŸŸŸŸŸŸ";
147 PRINT@32*7+6,"”œœœœœœœ";
148 PRINT@32*8+6,"€€€€€€€€";
149 PRINT@32*9+6,"€€€€€€€€";:RETURN
150 PRINT@32*0+6,"€€€€€€€€";
151 PRINT@32*1+6,"€€€€€€€€";
152 PRINT@32*2+6,"‘€€€€";
153 PRINT@32*3+6,"•Ÿ“€€€€€";
154 PRINT@32*4+6,"•ŸŸŸ€€€€";
155 PRINT@32*5+6,"•ŸŸœ€€€€";
156 PRINT@32*6+6,"•œ€€€€";
157 PRINT@32*7+6,"€€€€€€€€";
158 PRINT@32*8+6,"€€€€€€€€";
159 PRINT@32*9+6,"€€€€€€€€";:RETURN
160 PRINT@32*0+6,"€€€€€€€€";
161 PRINT@32*1+6,"€€€€€€€€";
162 PRINT@32*2+6,"€€€€‘";
163 PRINT@32*3+6,"€€€€‘—Ÿ";
164 PRINT@32*4+6,"€€€€•ŸŸŸ";
165 PRINT@32*5+6,"€€€€”ŸŸ";
166 PRINT@32*6+6,"€€€€”";
167 PRINT@32*7+6,"€€€€€€€€";
168 PRINT@32*8+6,"€€€€€€€€";
169 PRINT@32*9+6,"€€€€€€€€";:RETURN
170 PRINT@32*0,"€€€€€€";
171 PRINT@32*1,"€€€€€€";
172 PRINT@32*2,"€ŸŸŸŸŸ";
173 PRINT@32*3,"€ŸŸŸŸŸ";
174 PRINT@32*4,"€ŸŸŸŸŸ";
175 PRINT@32*5,"€ŸŸŸŸŸ";
176 PRINT@32*6,"€ŸŸŸŸŸ";
177 PRINT@32*7,"€œœœœœ";
178 PRINT@32*8,"€€€€€€";
179 PRINT@32*9,"€€€€€€";:RETURN
180 PRINT@32*0+14,"€€€€€€€";
181 PRINT@32*1+14,"€€€€€€€";
182 PRINT@32*2+14,"•ŸŸŸŸš€";
183 PRINT@32*3+14,"•ŸŸŸŸš€";
184 PRINT@32*4+14,"•ŸŸŸŸš€";
185 PRINT@32*5+14,"•ŸŸŸŸš€";
186 PRINT@32*6+14,"•ŸŸŸŸš€";
187 PRINT@32*7+14,"”œœœœ˜€";
188 PRINT@32*8+14,"€€€€€€€";
189 PRINT@32*9+14,"€€€€€€€";:RETURN
200 FORT=1TO50:D(RND(20),RND(19),L)=1:NEXT:FORX=1TO20:FORY=1TO20:OND(X,Y,L)GOTO220:NEXT:NEXT:GOTO230
220 RESET(42+X,Y):NEXT:NEXT
230 RETURN
1000 A$(1)="€ÅÏÏÀÊ":A$(2)="³·¿¿³²":A$(3)="€‹¡ ":A$(4)="€ÁÇÏÏÃú":A$(5)="€ÅÍÍ€"
1002 B$(1)="€ÅÂÇÁË":B$(2)="°•——°Â":B$(3)="€››š€ª":B$(4)="€ÄÅÂÇÄú":B$(5)="€ÄÎÎ€"
1003 C$(1)="¥¯ßßÜÈ":C$(2)="€·¿¿³Ê":C$(3)="…ŽŒ®":C$(4)="€—ŸŸŸŸþ":C$(5)="ÁÊÃÂË"
1004 D$(1)="¥¯ßß€€":D$(2)="€¿¿¿°Ê":D$(3)="„Š¡¨":D$(4)=" œ¥¯¯ ø":D$(5)="ÅÂÇÂÇ"
1005 E$(1)="€ÕàÕ€€":E$(2)="€µ¿¿°Ê":E$(3)="€Š€Š €":E$(4)=" €¥€¥€€":E$(5)="€ÀÊÊ€"
1006 A$(6)="ÁåãçÁ€":A$(7)="€…ŒË€":A$(8)="€åíîë€":A$(9)="€ÁÏËÀ€":A$(10)="óò°°ñó€"
1007 B$(6)="€ïÎÍê€":B$(7)="€‡Ï€":B$(8)="åïçëïë":B$(9)="€ÎÍÌÊ€":B$(10)="úûÿÿ÷õð"
1008 C$(6)="ÄïËÇîÈ":C$(7)="…ÏÏÏ":C$(8)="ïïáâïï":C$(9)="€ÏÎÏÊ€":C$(10)="óÿýþÿòð"
1009 D$(6)="Áíïïéà":D$(7)="…Ÿ€":D$(8)="îíïïîä":D$(9)="€ÏËÏÊ€":D$(10)="úþþþúú€"
1010 E$(6)="€ä€ä€È":E$(7)="€ŠŠ€":E$(8)="°µºµº€":E$(9)="€ÎÎÎÊ€":E$(10)="øúúúúø€"
1011 A$(11)="€€€€÷ø":A$(12)="€ÑÞÝÒ€":A$(13)="€€õ€€õ":A$(14)="€€€…ˆ":A$(15)="Žƒƒƒ‚"
1012 B$(11)="€‘“’ÿø":B$(12)="ÕßÓÓßÚ":B$(13)="€€ôûóþ":B$(14)="ƒƒ…ˆ":B$(15)="‹‡Š…€‹‡"
1013 C$(11)="‘Ÿ—ÿüø":C$(12)="ÔÞÝÞÝØ":C$(13)="€óó÷ÿ€":C$(14)="„‡‡Ž€":C$(15)="€„ŒŒŒˆ€"
1014 D$(11)="õÿÿÿò":D$(12)="€ÕßßÚ€":D$(13)="€÷ÿýþ€":D$(14)="€†ˆŒ‚€":D$(15)="€‡‹‹‹‹€"
1015 E$(11)="€—“›÷ú":E$(12)="ÑßßßßÒ":E$(13)="€ú€ðú€":E$(14)="€€€€":E$(15)="€…ŽŽŽŠ€"
1020 RETURN
2000 GOSUB1000:FORT=1TO32:READN(0),N(1),N(2),N(3),N(4):V(N(0),N(1),N(2),N(3),N(4))=T:NEXT
2001 X(0)=1:X(1)=0:X(2)=-1:X(3)=0:Y(0)=0:Y(1)=1:Y(2)=0:Y(3)=-1:BX(0)=10:BY(0)=10
2005 FORL=0TO2
2006 CLS1:PRINT@448,"MAKING LEVEL";L+1;:FORX=2TO19:FORY=2TO18:D(X,Y,L)=0:NEXT:NEXT
2007 FORX=1TO20:D(X,1,L)=1:D(X,19,L)=1:NEXT:FORY=1TO19:D(1,Y,L)=1:D(20,Y,L)=1:NEXT
2008 FORT=1TO4:A=1+RND(13):B=1+RND(12):R=2+RND(3):FORX=ATOX+R:D(X,B,L)=1:D(X,B+R,L)=1:NEXT:FORY=BTOY+R:D(A,Y,L)=1:D(A+R,Y,L)=1
2009 NEXT:R2=INT(R/2):D(A+R2,B,L)=0:D(A+R2,B+R,L)=0:D(A,B+R2,L)=0:D(A+R,B+R2,L)=0:NEXT:D(BX(L),BY(L),L)=0
2010 GOSUB200
2020 X=BX(L):Y=BY(L):A=X:B=Y:F=1:FORT=1TO300
2030 F=F+1:ON1-(F>400)GOTO2040:T=300:NEXT:CLS:GOTO2006
2040 D=RND(4)-1:ON1-(D(X+X(D),Y+Y(D),L)=0)GOTO2030:X=X+X(D):Y=Y+Y(D):SET(X+42,Y,2):SET(X+42,Y,1)
2045 ON1-(ABS(A-X)+ABS(B-Y)<13)GOTO2050:NEXT:GOTO2006
2050 D(X,Y,L)=3:T=300:NEXT:SET(X+42,Y,2):ONL+1GOTO2060,2060,2070
2060 D(X,Y,L+1)=4:BX(L+1)=X:BY(L+1)=Y:NEXT:GOTO2100
2070 D(X,Y,L)=4+15:NEXT:L=2
2100 X=BX(L):Y=BY(L):D=0:GOSUB2200:PRINT@480,"EXPLORE THE DUNGEON";
2110 I$=INKEY$:RESET(X+42,Y):SET(X+42,Y,1):IFI$=""THEN2110
2120 IFI$="W"THENIF(X+X(D)>1ANDX+X(D)<20)AND(Y+Y(D)>1ANDY+Y(D)<20)ANDD(X+X(D),Y+Y(D),L)<>1THENX=X+X(D):Y=Y+Y(D)
2130 IFI$="A"THEND=D-1:IFD=-1THEND=3
2140 IFI$="S"THEND=D+1:IFD=4THEND=0
2150 GOSUB2200:GOTO2110
2200 OND+1GOTO2210,2220,2230,2240
2210 N(0)=D(X,Y-1,L):N(1)=D(X+1,Y-1,L):N(2)=D(X+1,Y,L):N(3)=D(X+1,Y+1,L):N(4)=D(X,Y+1,L):GOSUB2290:GOTO2250
2220 N(0)=D(X+1,Y,L):N(1)=D(X+1,Y+1,L):N(2)=D(X,Y+1,L):N(3)=D(X-1,Y+1,L):N(4)=D(X-1,Y,L):GOSUB2290:GOTO2250
2230 N(0)=D(X,Y+1,L):N(1)=D(X-1,Y+1,L):N(2)=D(X-1,Y,L):N(3)=D(X-1,Y-1,L):N(4)=D(X,Y-1,L):GOSUB2290:GOTO2250
2240 N(0)=D(X-1,Y,L):N(1)=D(X-1,Y-1,L):N(2)=D(X,Y-1,L):N(3)=D(X+1,Y-1,L):N(4)=D(X+1,Y,L):GOSUB2290:GOTO2250
2250 ONV(N(0),N(1),N(2),N(3),N(4))GOSUB1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,20,21,22,24,24,25,26,28,28,29,30,28,28
2260 RETURN
2290 FORT=0TO4:IFN(T)>1THENN(T)=0
2295 NEXT:RETURN
2499 END
2500 PRINT@480,"HIT A KEY";
2510 I$=INKEY$:IFI$=""THEN2510
2520 RETURN
9000 DATA0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,1,0,1,0,1,0,0,1,0,1,1,0,1,0,0,0,0,0,1
9010 DATA0,1,0,0,1,1,0,0,0,1,1,1,0,0,1,0,0,0,1,1,0,1,0,1,1,1,0,0,1,1,1,1,0,1,1,0,0,1,0,0,0,1,1,0,0
9020 DATA1,0,1,0,0,1,1,1,0,0,0,0,1,1,0,0,1,1,1,0,1,0,1,1,0,1,1,1,1,0,0,0,1,0,1,0,1,1,0,1,1,0,1,0,1
9030 DATA1,1,1,0,1,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1
