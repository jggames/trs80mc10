0 CLEAR100:PRINT@.5*930/2,"CHARGEMENT EN COURS";
1 GOTO40000
2 HG$=INKEY$:IFHG$=""THEN2
3 GOSUB41000:PRINT@.5*930,"  INITIALISATION   ":GOSUB9:GOSUB500:SOUND135,1:PRINT@.5*928,"APPUIE SUR UNE TOUCHE,GAEL";
4 SOUND135,1:PRINT@.5*928,"APPUIE SUR UNE TOUCHE,GAEL";:CLS:R$=INKEY$:A=RND(400):IFR$=""THEN4
5 DIMTS(6),RE(2):GOSUB4007:P=33350:CA=5:GOSUB 20000
6 T$="":A=0  
7 GOSUB1000
8 GOTO120
9 RETURN
10 IFXK=1ANDCW=0THENGOSUB10000
11 IFXK=2ANDCW=0THENGOSUB10000
12 A=SA:CW=CW-1:IFCW=-1THENCW=50
13 IF MA<>0 THEN 3000
14 R$=INKEY$:IFR$=""THEN10
15 PRINT@.5*880,"    ",,,;:PRINT@.5*880,"";
20 IF R$=CHR$(13)ANDT$=""THEN10
30 IF R$=CHR$(13)THEN200
40 IFR$=CHR$(8)ANDLEN(T$)<1THEN10
50 IFR$=CHR$(8)THENT$=MID$(T$,1,LEN(T$)-1):GOTO120
70 T$=T$+R$
71 IFLEN(T$)>5THENT$=""
120 PRINT@.5*40*23,T$;"¥"
130 GOTO10
200 IFT$=""THEN10
205 PRINT@.5*40*23,"";"¥"
210 FORX1=LEN(T$)TO1STEP-1
220 A$=MID$(T$,X1,1)
225 IFA<>0THEN245
240 IFASC(A$)>48ANDASC(A$)<55THENA=ASC(A$)-48
245 IFA$=" "ORASC(A$)>48ANDASC(A$)<58THENT$=MID$(T$,1,X1-1)+MID$(T$,X1+1,LEN(T$))
260 NEXT
270 RESTORE:X1=1
271 READA$:IFA$=T$THEN2000
272 X1=X1+1:IFX1<11THEN271
300 PRINT@.5*880,"PARLE CLAIREMENT!";
380 GOTO 6
500 PT=33716:PA=PT
502 O=INT(RND(12)):M=INT(RND(40)):NO=INT(RND(4)-1):NM=INT(RND(3)-1)
503 IFNO=0THEN509
504 FORX1=1TONO
505 O=INT(RND(12)):IFO=11THEN505
506 REM IF PEEK THEN POKE
507 PT=PT+1:NEXTX1
509 PT=PA+6
510 IFNM=0THEN517
511 FORX1=1TONM
512 M=INT(RND(40)):IFM=37ORM=38THEN512
513 IFPEEK(PT)=0THENREM
515 PT=PT+1:NEXTX1
517 PT=PA+8
518 IFPA=34068THENRETURN
520 PA=PT:GOTO 502
900 DATA"N","S","E","O","AT","PR","PO","AV","LI","CO"
1000 PRINT@.5*40*24,"FORCE";FM;:PRINT@.5*40*24+12,"INTEL.";IM;:PRINT@.5*40*24+26,"CONST.";CM;:RETURN
2000 CA=CA-1:IFCA<>0THEN2005
2001 CA=5:CM=CM-IN-1:IF CM<=0THENMA=2:GOTO3000
2005 ONX1GOSUB6000,7000,8000,9000,10000,11000,12000,13000,14000,15000
2010 GOTO6
3000 X1=1:IFMA=1THEN3100
3010 IFMA=2THEN3200
3020 IFMA=3THEN3300
3021 IFMA=5THEN3400
3100 PRINT@.5*414,"CE COMBAT ";:PRINT@.5*482,"  A ETE FATAL.......";:GOTO3301
3200 PRINT@.5*414,"TU ES MORT";:PRINT@.5*482,"PAR NEGLIGEANCE!";:GOTO3301
3300 PRINT@.5*414,"IL ETAIT ";:PRINT@.5*482,"   EMPOISONNE...........";:GOTO3301
3301 FORI=1TO2000:NEXTI:FORI=36608TO36700:NEXT:NEW
3302 IFHG$<>"O"THENEND
3303 RUN40000
3400 PRINT@.5*414,"GAEL LE PREUX ,";:PRINT@.5*494,"TU AS VAINCU.";:PRINT@.5*694,"ALICEA REVIT,";:PRINT@.5*772,"ET T'EN REMERCIE."
3405 FORKT=1TO200:SOUND230,1:NEXT
3410 FORKT=1TO8:NEXT
3420 HG$=INKEY$:IFHG$=""THEN3420
3500 GOTO3301:END
4007 P=335:PRINT@.5*40*8,"CONSTITUTION":PRINT@.5*40*10,"FORCE":PRINT@.5*40*12,"INTELLIGENCE"
5000 L=150:V=250:GOSUB5004:C1=A:L=20:V=40:GOSUB5004:F1=A:L=6:V=25:GOSUB5004:I1=A:GOSUB5015:GOSUB5007
5001 P=40*8+21:L=150:V=250:GOSUB5004:C2=A:L=20:V=40:GOSUB5004:F2=A:L=6:V=25:GOSUB5004:I2=A:GOSUB5020:GOSUB5007
5002 P=40*8+27:L=150:V=250:GOSUB5004:C3=A:L=20:V=40:GOSUB5004:F3=A:L=6:V=25:GOSUB5004:I3=A:GOSUB 5030:GOSUB5007:GOSUB5060
5003 ?@.5*728,"TON CHOIX ? 1,2,3,4":?@.5*256,"1":?@.5*262,"2":?@.5*268,"3":?@.5*273,"4":A$="":SOUND240,4:GOTO5040
5004 A=INT(RND(V))
5005 IFA<LTHEN5004
5006 RETURN
5007 A=RND(300):PRINT@.5*728,"APPUIE SUR UNE TOUCHE":SOUND255,1
5008 A=RND(200):PRINT@.5*728,"appuie sur une touche":SOUND255,1
5009 A$=INKEY$:IFA$=""THEN5007
5010 RETURN
5015 PRINT@.5*P,C1:PRINT@.5*P+40*2,F1:PRINT@.5*P+40*4,I1:RETURN
5020 PRINT@.5*P,C2:PRINT@.5*P+40*2,F2:PRINT@.5*P+40*4,I2:RETURN
5030 PRINT@.5*P,C3:PRINT@.5*P+40*2,F3:PRINT@.5*P+40*4,I3:RETURN
5035 PRINT@.5*P,C4:PRINT@.5*P+40*2,F4:PRINT@.5*P+40*4,I4:RETURN
5040 A$=INKEY$:IFA$=""THEN5040
5042 IFASC(A$)>48ANDASC(A$)<53THEN5046
5044 GOTO5040
5046 ONASC(A$)-48GOTO5048,5050,5052,5054
5048 CM=C1:FM=F1:IM=I1:RETURN
5050 CM=C2:FM=F2:IM=I2:RETURN
5052 CM=C3:FM=F3:IM=I3:RETURN
5054 CM=C4:FM=F4:IM=I4:RETURN
5060 P=40*8+32:L=150:V=250:GOSUB5004:C4=A:L=20:V=40:GOSUB5004:F4=A:L=6:V=25:GOSUB5004:I4=A:GOSUB 5035:RETURN
6000 IFP-12<33280THEN6006
6001 IFPEEK(P-12)=0THEN6006
6002 P=P-12:IFPEEK(P)=26THEN6010
6003 IFPEEK(P)=41 THEN 6020
6004 GOSUB36000:GOSUB20000:RETURN
6006 PRINT@.5*22*40,"NORD,IMPOSSIBLE";:RETURN
6010 IFRY(1)=11ORRY(2)=11ORRY(3)=11THENMA=5
6011 GOSUB20000:RETURN
6020 IFPEEK(34177)<>0THEN6080
6050 GOSUB36000:GOSUB 20000:RETURN
6080 P=P+12:PRINT@.5*880,"TU NE PASSERAS PAS,MOI VIVANT !";:SOUND1,1:SOUND2,1:RETURN
7000 IFP+12>33363THEN7006
7001 IFPEEK(P+12)=0THEN7006
7002 P=P+12:IFPEEK(P)=44THEN7011
7004 GOSUB36000:GOSUB20000:RETURN
7006 PRINT@.5*22*40,"SUD,IMPOSSIBLE";:RETURN
7011 IFPEEK(34180)<>0THEN7080
7012 GOSUB36000:GOSUB 20000:RETURN
7080 P=P-12:PRINT@.5*880,"TU NE PASSERAS PAS,MOI VIVANT !";:SOUND1,1:SOUND2,1:RETURN
8000 IFP+1>33363THEN8006
8001 IFPEEK(P+1)=0THEN8006
8002 GOSUB36000:P=P+1:GOSUB20000:RETURN
8006 PRINT@.5*22*40,"EST,IMPOSSIBLE";:RETURN
9000 IFP-1<33280THEN9006
9001 IFPEEK(P-1)=0THEN9006
9002 GOSUB36000:P=P-1:GOSUB20000:RETURN
9006 PRINT@.5*22*40,"OUEST,IMPOSSIBLE";:RETURN
10000 PRINT@.5*880,"     ",,;:IFXK=0THEN10004
10003 SA=A:A=XK:IFCM<0THENRETURN
10004 IFA=0THEN16065
10005 IFA>2THEN16060
10010 IFRE(A)=0THEN16060
10011 IFCM<250 THEN10013
10012 X1=INT(CM/200)+1:SOUNDX1,1:SOUNDX1+1,1:GOTO10020
10013 SOUNDCM,1
10020 PM=34068:KL=PM+RE(A)*3-3
10021 IFA=2 THEN10025
10022 IFPEEK(35250)=13THEN10030
10023 GOSUB20000:GOTO10029
10025 IF PEEK(35250)=14THEN10030
10026 GOSUB 20000
10029 REM
10030 PM=KL:BM=FM+IM:BE=PEEK(PM):CY=INT(PEEK(PM+1)*1.5)
10035 DL=BM-BE:IFDL<0THEN10080
10042 GOSUB50000:IFRC<0THEN10046
10043 IFRC<>0THEN10045
10044 PRINT@.5*880,"RATE !";:GOTO10104
10045 GOTO10101
10046 GOTO10103
10080 DL=ABS(DL):GOSUB50000:RC=-RC:IFRC<0THEN10103
10090 IFRC<>0THEN10101
10095 PRINT@.5*880,"BIEN ESQUIVE !";:GOTO10104
10101 CY=CY-RC:PRINT@.5*880,"LE MONSTRE EST BLESSE";:GOTO10110
10103 CM=CM+RC:PRINT@.5*880,"TU ES BLESSE!";:IFCM<=0THEN 10200
10104 GOSUB1000:RETURN
10110 IFINT(CY/1.5)>0THEN 10120
10112 GOTO10130
10120 GOSUB1000:RETURN
10130 RA=(FM/IM)+1:BE=(BE/15):FM=INT(FM+BE-(BE*.6/RA)):IM=INT(IM+(BE*.6/RA)):CM=CM+INT(BE*.4)
10135 PRINT@.5*880,"LE MONSTRE EST MORT     ";:XK=0:SOUND210,1:SOUND211,1:SOUND212,1:SOUND213,1
10140 PT=33716:GOSUB20000:GOSUB1000:RETURN
10200 MA=1:PRINT@.5*880,"TU ES MORT !   ";:GOSUB1000:RETURN
11000 IFA=0THENGOTO16000
11010 IFIN=3THENGOTO16010
11015 IFTS(A)=0THENGOTO16060
11020 GOSUB16020:IN=IN+1:OB=TS(A):TS(A)=0:X1=1
11021 IFRY(X1)=0THEN11024
11022 X1=X1+1:IFX1<4THEN11021
11023 GOTO16010
11024 RY(X1)=OB
11025 IFCC<>0THEN11060
11030 IFSI=1THEN11050
11035 PRINT@.5*880,"TU ES SAGE";:SOUND245,1
11040 CM=CM+CO:FM=FM+INT(FO/2):IM=IM+INT(IO/2):GOTO11060
11050 CM=CM-CO:FM=FM-INT(FO/2):IM=IM-INT(IO/2)
11055 PRINT@.5*880,"QUELLE ERREUR!";:SOUND1,1
11060 PT=33716:PT=PT+PEEK(P)*8-8
11080 GOTO12080
12000 IFIN=0THENGOTO17000
12010 IFA=0THENGOTO16000
12011 IFRY(A)=0THEN16040
12015 IFA>3THEN16050
12020 PT=33716:PT=PT+PEEK(P)*8-8:X1=PT
12030 IFPEEK(X1)=0THEN12042
12040 X1=X1+1:IFX1<PT+7THEN12030
12041 GOTO16030
12042 TS(A)=RY(A):GOSUB16020:IFCC<>0THEN12060
12043 IFSI=0THEN12045
12044 CM=CM+CO:FM=FM+INT(FO/2):IM=IM+INT(IO/1.5):GOTO12060
12045 CM=CM-INT(CO/2):FM=FM-INT(FO/2):IM=IM-IO
12060 REM POKEX1,RY(A)
12070 RY(A)=0:IN=IN-1
12080 GOSUB18000:GOSUB20000:RETURN
13000 IFA=0THENGOTO16005
13010 IFTS(A)=0THEN16060
13020 GOSUB16020:IFCC<>1THEN16006
13030 IFSI=1THEN13080
13040 FM=FM+INT(FO/1.5):IM=IM+INT(IO/1.5):CM=CM+INT(CO*1.5):PRINT@.5*880,"TU ES SAGE";:SOUND245,1:GOTO13090
13080 FM=FM-INT(FO/1.2):IM=IM-INT(IO/1.5):CM=CM-CO:PRINT@.5*880,"QUELLE ERREUR!";:SOUND1,1
13081 IFCM<=0THENMA=3
13090 PT=33716:GOSUB20000:RETURN
14000 IFA=0THEN16000
14010 IFTS(A)=0THEN16060
14020 GOSUB16020:IFCC<>2THEN16080
14030 GOTO13040
15000 IFA=0THEN16000
15010 IFTS(A)=0THEN16060
15020 MS=34640:S$="":MS=MS+TS(A)*16-16:FORX1=MSTOMS+15:S$=S$+CHR$(PEEK(X1)):NEXTX1:IM=IM-2:PRINT@.5*880,S$;:RETURN
16000 PRINT@.5*880,"QUEL OBJET?";:RETURN
16005 PRINT@.5*880,"QUEL MET?";:RETURN
16006 PRINT@.5*880,"IL N'EST PAS COMESTIBLE!";:RETURN
16010 PRINT@.5*880,"TU ES TROP CHARGE!";:RETURN
16020 NB=34188:NB=NB+TS(A)*5-5:SI=PEEK(NB+4):FO=PEEK(NB):IO=PEEK(NB+1):CO=PEEK(NB+2):CC=PEEK(NB+3):RETURN
16030 PRINT@.5*880,"LA SALLE EST PLEINE!";:RETURN
16040 PRINT@.5*880,"TU NE POSSEDES PAS CET OBJET!";:RETURN
16050 PRINT@.5*880,"TU AS 3 OBJETS!";:RETURN
16060 PRINT@.5*880,"IL N'EXISTE PAS!";:RETURN
16065 PRINT@.5*880,"QUEL MONSTRE?";:RETURN
16080 PRINT@.5*880,"IL N'Y A RIEN D'ECRIT";:RETURN
17000 PRINT@.5*880,"TU NE POSSEDES RIEN";:RETURN
18000 PRINT@.5*80,"TES OBJETS :":PRINT@.5*93,"            ";:PRINT@.5*133,"          ";:PRINT@.5*173,"           ";
18001 IFRY(1)=0THEN18100
18002 NB=34568:NB=NB+RY(1)*6-6
18010 S$="":FORX1=NBTONB+5:S$=S$+CHR$(PEEK(X1)):NEXTX1
18020 PRINT@.5*93,"1: ";S$;
18100 IFRY(2)=0THEN18200
18102 NB=34568:NB=NB+RY(2)*6-6
18110 S$="":FORX1=NBTONB+5:S$=S$+CHR$(PEEK(X1)):NEXTX1
18130 PRINT@.5*133,"2: ";S$;
18200 IFRY(3)=0THEN18300
18202 NB=34568:NB=NB+RY(3)*6-6
18210 S$="":FORX1=NBTONB+5:S$=S$+CHR$(PEEK(X1)):NEXTX1
18220 PRINT@.5*173,"3: ";S$;
18300 RETURN
20000 CW=0:XK=0:NS=33364:PT=33716:PM=34068:PO=34188:NM=34248:NB=34568:NS=NS+PEEK(P)*8-8
20001 PT=PT+PEEK(P)*8-8:X1=1:FORS=PTTOPT+5:OB=PEEK(S):TS(X1)=OB:X1=X1+1:NEXT
20002 PT=S:X1=1:FORS=PTTOPT+1:MO=PEEK(S):RE(X1)=MO:X1=X1+1:NEXT
20003 TG=PEEK(33024+PEEK(P)-1)
20004 QQ=36848
20006 REM BUNCH OF POKES
20007 GOSUB 18000
20009 PRINT@.5*800,"    ",,,,,,;
20010 NS$="":FORS=NSTONS+7:NS$=NS$+CHR$(PEEK(S)):NEXTS
20020 PRINT@.5*0,"SALLE      :";NS$;
20030 PT=33716:PT=PT+PEEK(P)*8-8:W=1
20040 FORS=PTTOPT+5:NB=34568:OB=PEEK(S):GOSUB30000:W=W+1:NEXT
20045 W1=1
20050 PT=S:FORS=PTTOPT+1:MO=PEEK(S):GOSUB35000:W1=W1+1:NM=34248:NEXT
21000 IFRE(1)=0THEN 22000
21010 PM=PM+RE(1)*3-1:IFPEEK(PM)=1THENXK=1:GOTO24030
22000 IFRE(2)=0THEN 24030
22010 PM=34068:PM=PM+RE(2)*3-1:IFPEEK(PM)=1THENXK=2
24030 REM
24031 REM
24032 REM
24034 REM
24036 RETURN
30000 IFOB=0THENRETURN
30001 NB=NB+OB*6-6:NS$="":FOR X1=NBTONB+5:NS$=NS$+CHR$(PEEK(X1)):NEXT X1
30002 ONWGOTO30010,30020,30030,30040,30050,30060
30010 PRINT@.5*800,"1 ";NS$;:RETURN
30020 PRINT@.5*840,"2 ";NS$;:RETURN
30030 PRINT@.5*809,"3 ";NS$;:RETURN
30040 PRINT@.5*849,"4 ";NS$;:RETURN
30050 PRINT@.5*818,"5 ";NS$;:RETURN
30060 PRINT@.5*858,"6 ";NS$;:RETURN
35000 IFMO=0THENRETURN
35001 NM=NM+MO*8-8:NS$=""
35002 FORX1=NMTONM+7:IFPEEK(X1)=32THEN35004
35003 NS$=NS$+CHR$(PEEK(X1)+32)
35004 NEXTX1
35005 ONW1GOTO35020,35030
35020 PRINT@.5*829,"1 ";NS$:RETURN
35030 PRINT@.5*869,"2 ";NS$:RETURN
36000 RETURN
40000 FORKT=0TO8:NEXT:SOUND230,1
40001 GOTO2
41000 PRINT@.5*50,"DETAIL DE L'ECRAN":PRINT@.5*162,"EN HAUT A GAUCHE : NOM DE LA SALLE"
41010 PRINT@.5*261,"INVENTAIRE":PRINT@.5*362,"A GAUCHE : LES OBJETS DANS LA SALLE":PRINT@.5*482,"A DROITE : LES MONSTRES DANS LA SALLE"
41020 PRINT@.5*602,"AU BAS DE L'ECRAN : DETAIL DE VOS":PRINT@.5*725,"POINTS DE CONSTITUTION, DE":PRINT@.5*845,"FORCE ET D'INTELLIGENCE."
41030 PRINT@.5*970,"APPUYEZ SUR UNE TOUCHE";
41040 A$=INKEY$:IFA$=""THEN41040
41050 RETURN
50000 RC=DL-(RND(DL+2)-1)-(RND(INT(.5*DL/1.5)+2)-1)+1:RETURN
