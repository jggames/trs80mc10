10REM LABYRINTH P,J.GOSS 2-9-B1
20DIM AE24,243,811213/CE1213
30PRINT "********** LABYRINTH **********"
40PRINT
50PRINT "FOUR SIZES OF LABYRINTH ARE AVAILABLE"
60PRINT "AFTER SELECTING THE REQUIRED SIZE A"
70PRINT "LABYRINTH WILL BE DISPLAYED AND THEN"
8OPRINT "DISAPPEAR FROM THE SCREEN."
90PRINT "TO MOVE AROUND THE LABYRINTH YOU ARE"
100PRINT "ASKED TO TYPE DIRECTIONS IN THE FORM"
110PRINT "OF N,S,E OR W."
120PRINT "TO FINISH TYPE F"
130PRINT
140PRINT "SIZE";
150INPUT L
160IF L<1OR L>4GOTO 130
170LET M=74-<INT<L)*4)
180GOTO 200
190REM******INITIATE ALL ARRAYS******
200FOR 1=2TO M+/STEP
210FOR J=2T0 M+1STEP 2
220LET ALI,J]=0
230LET ACI-1,J-11=I
240LET ACI,J-13=2
250LET ACI-1,J)=3
260NEXT J
270NEXT I
280LET AUM+1)/2,<M4.1)/23=4
290GOT0 300
300FOR 1=ITO 121
310LET 13[1]=C113=0
320NEXT
330REM******SELECT RANDOM PATH FROM CENTRE******
340LET D=1
350LET S=T=04+1)/2
360LET BriJ=C11)=S


0037 370LET 2=0 0128 1280REM******DISPLAY LABYRINTH******
0038 380G010 INT<RND<1)*4)+10F 400,500,600,700,370 0129 1290LET AEBEDLCID33=7
0039 390REm******NORTHERN PATH SELECT****** 0130 1300LET AC<M+1,/2,(m+1J/21=6
0040 400IF T-2=OGOTO 460 0131 1310pRINT
0041 410IF 141.'3,T -2)=40R 2=1GOTO 380 0132 1320PRINT
0042 42OLET 2=1 0133 1330GOSUB 2040
0043 430LET ArS,T-11=0 0134 1340REM******CLEAR SCREEN******
0044 440LET T=T-2 0135 1350F0R 1=1T0 23
0045 450GOT0 750 0136 1360PRINT
0046 460IF D<M-<INT<M/2»GOTO 380 0137 1370NEXT I 0047 470LET ACS,T-11=0 0138 1380REm******MOVE PLAYER TEST FOR COLLISION
0048 490GOT0 830 AND EXIT
0049 490REM******EASTERN PATH SELECT****** 0139 1390LET S=8[0]
0050 500IF S+2=M+1GOTO 560 0140 1400LET T=CID]
0051 510IF AES+2,T3=40R 2=2G0TO 380 0141 1410LET P=D -I 0052 520LET 2=2 0142 1420LET N=D
0053 530LET ACS+1,T)=5 0143 1430LET w=R=Y=0
0054 540LET S=S+2 0144 1440PRINT
0055 550GOT0 750 0145 1450PRINT "N,S,E OR W"
0056 5601F D<M-<INTW2)JGOTO 380 0146 1460INPUT AS
0057 570LET ArS+1,T1=5 0147 1470IF AS="N"GOTO 1530
0058 590G0T0 830 0148 1480IF AS="S'GOTO 1570
0059 590REM******SOUTHERN PATH SELECT****** 0149 1490IF AS="E"GOTO 1610
0060 600IF T+2=M+1GOTO 660 0150 1500IF AS="W"GOTO 1650
0061 610IF ACS,T+21=40R 2=3GOTO 380 0151 1510IF As="F"GOTO 1960
0062 620LET 2=3 0152 15205010 1440
0063 630LET AES,T+11=0 0153 1530IF AIS,T-11=2GOT0 1850
0064 640LET T=T+2 0154 1540IF T-2=050TO 1890
0065 650G0T0 750 0155 1550LET T=T-2
0066 660IF D<M-(INTM/2»COTO 380 0156 15608010 1690
0067 670LET ACS,T+l3=0 0157 1570IF AES,T+11=2G0TO 1850
0068 6805010 830 0158 1580IF T+2=M+1GOTO 1890
0069 690REm******WESTERN PATH SELECT****** 0159 1590LET T=T+2
0070 7001F S-2=0GOT0 800 0160 1600GOTO 1690
0071 710IF MS -2,71=40R 2=45070 380 0161 1610IF ACS+1,T1=3GOTO 1850
0072 720LET 2=4 0162 1620IF 8+2=11+15070 1890
0073 730LET ACS -1,77=5 0163 1630LET S=S+2
0074 740LET S=S -2 0164 1640G0T0 1690
0075 750LET D=0+1 0165 1650IF AES-1,T]=3G0T0 1850
0076 760LET ACS,T]=4 0166 1660IF S-2=000TO 1890
0077 770LET B[D]=S 0167 1670LET S=8-2
0078 780LET CID3=T 0169 1680REM***.**cALCULATE STEPS TO CENTRE**.***0079 790GOT0 380 0169 1690F0R I=1TO «M-1)/2)-2
0080 800IF D4M-(INT<M/2)JGOTO 380 01170 1700IF S=13111AND T=C(I1GOTO 1720
0081 810LET ACS -1,T]=5 0171 17100070 1750
0032 820REM******CREATE REMAINDER OF LABYRINTH****** 0172 1720IF I<NLET P=P -1
0083 830LET E=F=G=D 0173 1730IF I>HLET P=P+1
0084 840F0R K=D+1TO <<M -1)/2Y2 0174 1740LET N=I
0035 850REM******TEST FOR NORTH WALL BREAK****** 0175 1750NEXT I 0086 860IF CEE1-2=0G0TO 940 0176 1760LET R=R+1
0087 870IF AEBEELCEE1-23=4GOT0 940 0177 1770IF P=OGOTO 1930
0088 880LET AL8CELCIEJ-11=0 0178 1780IF R=7-L5OT0 1800
0089 890LET AtEICE),CrE1-21=4 0179 1790GOT0 1440
0090 900LET BIKJ=BEE3 0180 1800LET V=V+12
0091 910LET CIK)=CCE3-2 0181 I8IOLET R-0
0092 920GOTO 1160 0182 1820PRINT
0093 930REm******TEST FOR SOUTH WALL OREAK****** 0183 1930PRINT "NUMBER OF STEPS TO CENTRE ARE "P
0094 940IF BIE1+2=M+1GOTO 1020 0184 18408010 1440
0095 950IF ACBEE1+2,C(E31=450T0 1020 0185 1850PRINT
0096 960LET AEBEE1+1,CIE11=5 0186 1860PRINT 'OUCH! - YOU WALKED INTO A WALL"
009? 970LET ACBCE3+2,C[E33=4 0187 187OLET W=W+1
0098 980LET BLX]=81E3+2 0188 1880GOT0 1440
0099 990LET CIK]=CEE1 0189 1990PkINT
0100 10005070 1160 0190 1900PRINT "YOU HAVE JUST TRIED TO WALK OUT"
0101 1010REM******TEST FOR EAST WALL BREAK****** 0191 1910PRINT "OF THE LABYRINTH'
0102 1020IF CEE1+2=M+1COTO 1100 0192 1920GOT0 1440
0103 1030IF ACBEELCIE3+21=4G0T0 1100 0193 1930PRINT
0104 1040LET ArBEE1,CIE3+13-6 0194 1940PRINT 'YOU HAVE FOUNC THE CENTRE IN "V+R+W0105 1050LET AESIE-3,ccE)+23=4 0195 1950ARINT "NUMBER OF BRUISES "8
0106 1060LET 8[X]=8iE) 0196 1960F0R 1=2T0 D
010? 1070LET CCK1-C[E]+2 0197 197DLET AL8113,C1113=8
0108 10805010 1160 0198 1980NEXT I 0109 1090REm******TEsT FOR WEST WALL BREAK****** 0199 1990LET AE(M+1)/2,<M+1):21=6
0110 1100IF 81E1 -2=050T0 1190 0200 2000LET AIS,T]=7
0111 1110IF AEBEE1-2,CrE11=4GOTO 1190 0201 201000808 2040
0112 1120LET ALBEE)-1,CEE11=5 0202 20205010 2190
0113 II3OLET AME1-2,C[E11-4 0203 2030REm******LABYRINTH DISPLAY ROUTINE******0114 1140LET BEK]=81E1-2 0204 2040F0R J=110 M
0115 1150LET cil<1=c1E1 0205 2050FOR 1=1TO M
0116 1160LET E=K 0206 2060IP AII,J3=0PRINT "
Olt? 11700010 1270 0207 20701F AiI,J)=1PRINT "+";
0118 1180REN******TEST FOR PATHS OFF MAIN 0208 2080IF ACI,J1=2PRINT
ROUTE****** 0209 20901F All,J3=3PRINT "1";
0119 1190IF F=250TO 1240 0210 2100IF A[I,J1=4PRINT
0120 1200LET F=F-1 0211 2110IF ACI,J1=5PRINT
0121 1210LET E=F 0212 21201F A11,J3=6PRINT " X "; 0122 12205010 860 0213 2130IF All,J1=7PRINT " ? "; 0123 1230REM******TEST FOR PATHS OFF PREVIOUS 0214 21401F AII,J3=8PRINT " * "; PATHS****** 0215 2150NEXT I
0124 1240LET G=G+1 0216 2160PRINT " " 0125 1250LET E=G 0217 2170NEXT J
0126 126050T0 860 0218 2180RETURN
0127 1270NEXT K 0219 2190END