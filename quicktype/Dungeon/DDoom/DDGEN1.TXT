10 GOSUB610
20 CLS
30 BG=2:FG=1:T=0:L=3:LW=W-3:GOSUB280
40 CLS0
50 PRINT@32*1+18,"LEVEL GEN"
60 PRINT@32*2+18,"LEVEL:";LE
70 PRINT@32*3+18,"? FOR HELP"
80 BG=3:FG=2:T=0:L=15:LW=15:GOSUB280
90 X=1:Y=1
100 I$=INKEY$
110 IFI$="?"THENGOSUB360
120 IFI$="W"ANDY>1THENY=Y-1
130 IFI$="Z"ANDY<15THENY=Y+1
140 IFI$="A"ANDX>1THENX=X-1
150 IFI$="S"ANDX<15THENX=X+1
155 IFI$="E"THENGOSUB700:GOTO20
160 IFI$>"/"ANDI$<":"THENGOSUB230
170 REM
180 PRINT@X+32*(Y),CHR$(OS);
190 PRINT@X+32*(Y),CHR$(R(X,Y));
200 IF(I$="X"ORI$="N")ANDIX>0THENGOSUB450
205 IFI$="N"THEN20
210 IFI$<>"X"THEN100
220 END
230 I=VAL(I$)
240 IFI=9THENI=8+RND(3)
250 IFI=5THENIX=X:IY=Y
260 R(X,Y)=C0+I
270 RETURN
280 PRINT@32*T,;
310 FORI=1TOL:REM PRINT
330 NEXTI:PRINT@32*T,;:RETURN
360 REM
370 FORH=1TO11
380 PRINT@32*5+18,H$(H);:GOSUB430
390 PRINT@32*5+18,""
400 NEXTH
420 RETURN
410 REM
430 G$=INKEY$:IFG$=""THEN430
440 RETURN
450 PRINT@1+32*5,"ONE MOMENT PLEASE.";
460 S$=""
470 FORJ=1TO15
480 FORK=1TO15
490 S$=S$+CHR$(R(K,J))
500 NEXTK
510 NEXTJ
520 S$=S$+CHR$(IX+OS):S$=S$+CHR$(IY+OS)
530 S$=S$+CHR$(LE+OS)
540 PRINT@1+32*5),"ANY KEY TO SAVE  ";:GOSUB430
545 F$="LEVEL"+STR$(LE)
550 REM S=OPENOUT F$
560 REM PRINT#S,S$
570 REN LOSE#S
580 PRINT@1+32*5,""
590 LE=LE+1:GOSUB700
600 RETURN
610 DIMR(15,15),H$(11),S$(15)
620 GOSUB790
630 DATA"PRESS ANY KEY","MOVE W A S Z","1 WALL 2 VASE"
640 DATA"3 CHEST 4 IDOL","5 ENTRY 6 EXIT","7 TRAP","8 SAFE PLACE"
650 DATA"9 GUARD","0 ERASE","N NEXT LEVEL","X SAVE & EXIT"
660 LE=1
670 FORI=1TO11
680 READH$(I)
690 NEXTI
700 FORJ=1TO15
710 FORK=1TO15
720 R(J,K)=C0
730 NEXTK
740 NEXTJ
750 IX=0:IY=0
760 RETURN
790 OS=143:C0=128:W=32
795 REM
800 RETURN
