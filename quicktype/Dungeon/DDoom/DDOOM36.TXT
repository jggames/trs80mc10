0 X=RND(-(PEEK(9)*256+PEEK(10))):GOSUB9300:GOTO9000
1 Z=R(R,S):IFZTHENSET(W+R,S,6):IFZ>C1THENIFZ<C6ORZ=C7THENRESET(W+R,S):RETURN
2 IFZ<C2THENRETURN
3 SET(W+R,S,4):IFDX<C0ORZ=C6THENSET(W+R,S,6):RESET(W+R,S):RETURN
4 MT=Z:M=MT-C2:MV=M/16:MS=M*6:DX=3:LX=R:LY=S:MX=R:MY=S:SET(W+R,S,6):RESET(W+R,S):RETURN
5 PRINT@X+32*(Y),MID$("vciexts123",R(X,Y)+1,1);:RETURN
7 O=(PEEK(17024)AND1)*256+PEEK(17025)-1+MC:FORU=1TOLEN(M$):POKEO+U,ASC(MID$(M$,U))AND63:NEXT:RETURN
20 A=15:B=15:C=15:D=15:E=15:F=15:G=15:H=15:I=15:IFN(X+V(1,.,V),Y+V(1,1,V))THENC=13
22 IFN(X+V(5,.,V),Y+V(5,1,V))THENG=13
23 IFN(X+V(2,.,V),Y+V(2,1,V))THEND=13
24 IFN(X+V(4,.,V),Y+V(4,1,V))THENF=13
25 IFN(X+V(3,.,V),Y+V(3,1,V))THENE=13
26 IFN(X+V(6,.,V),Y+V(6,1,V))THENA=12:B=16:C=4
27 IFN(X+V(10,.,V),Y+V(10,1,V))THENG=6:H=16:I=12
28 IFN(X+V(7,.,V),Y+V(7,1,V))THENB=12:C=12:D=4
29 IFN(X+V(9,.,V),Y+V(9,1,V))THENF=6:G=12:H=12
30 IFN(X+V(8,.,V),Y+V(8,1,V))THEND=12:E=12:F=12
31 IFN(X+V(11,.,V),Y+V(11,1,V))THENA=2
32 IFN(X+V(15,.,V),Y+V(15,1,V))THENI=8
33 IFN(X+V(12,.,V),Y+V(12,1,V))THENA=11:B=11:C=3
34 IFN(X+V(14,.,V),Y+V(14,1,V))THENG=7:H=11:I=11
35 IFN(X+V(13,.,V),Y+V(13,1,V))THENC=11:D=11:E=11:F=11:G=11
36 IFN(X+V(16,.,V),Y+V(16,1,V))THENA=10:B=2
37 IFN(X+V(18,.,V),Y+V(18,1,V))THENH=8:I=10
38 IFN(X+V(17,.,V),Y+V(17,1,V))THENB=10:C=10:D=10:E=10:F=10:G=10:H=10
39 IFN(X+V(19,.,V),Y+V(19,1,V))THENA=1
42 IFN(X+V(20,.,V),Y+V(20,1,V))THENI=9
45 PRINT@33,MID$(A$,A,1)MID$(A$,B,1)MID$(A$,C,1)MID$(A$,D,1)MID$(A$,E,1)MID$(A$,F,1)MID$(A$,G,1)MID$(A$,H,1)MID$(A$,I,1);
46 PRINT@65,MID$(B$,A,1)MID$(B$,B,1)MID$(B$,C,1)MID$(B$,D,1)MID$(B$,E,1)MID$(B$,F,1)MID$(B$,G,1)MID$(B$,H,1)MID$(B$,I,1);
47 PRINT@97,MID$(C$,A,1)MID$(C$,B,1)MID$(C$,C,1)MID$(C$,D,1)MID$(C$,E,1)MID$(C$,F,1)MID$(C$,G,1)MID$(C$,H,1)MID$(C$,I,1);
48 ?@129,MID$(D$,A,1)MID$(D$,B,1)MID$(D$,C,1)MID$(D$,D,1)MID$(D$,E,1)MID$(D$,F,1)MID$(D$,G,1)MID$(D$,H,1)MID$(D$,I,1);:RETURN
50 IFN(X+V(17,.,V),Y+V(17,1,V))=.THENX=X+V(17,.,V):Y=Y+V(17,1,V):NX=NX+D(NF,1):NY=NY+D(NF,2):SOUND200,1:GOSUB20
60 FORS=NY-1TONY+1:FORR=NX-1TONX+1:GOSUB1:NEXT:NEXT:RETURN
70 U=(O-2)*20+1:IFO>6THEN76
72 M$=MID$("π΀󀀀ˀȀŀŀ",U,20):GOTO83
76 M$=MID$("ȀĀȀȀ 倀倀ˀǀˀȀ",U-100,20)
83 FORO=1TO4:PRINT@32*O+3,MID$(M$,O*5-4,5);:NEXT:RETURN
100 I$=INKEY$:IFI$="F"THENIFDX<2ANDDY<2THENGOSUB870
101 IFI$="C"THENIFO(31)>0ANDO(15)+O(16)>0THENGOSUB990
102 IFI$="G"THENGOSUB1410
103 IFI$="P"THENGOSUB1660
104 IFI$="R"THENGOSUB1690
105 IFI$="?"THENGOSUB940
110 IFI$="A"THENV=V-1:V=V-(V<1)*4+(V>4)*4:NF=V:GOSUB20
120 IFI$="S"THENV=V+1:V=V-(V<1)*4+(V>4)*4:NF=V:GOSUB20
150 IFI$="W"THENGOSUB50
210 Q=R(NX,NY):IFQ=C2ORQ=C3ORQ=C4ORQ>C7THENGOSUB1780:O=Q:GOSUB70:IFQ>C7THENGOSUB350
220 IFQ=C6THENTX=NX:TY=NY:TF=1:O=Q:GOSUB70
230 IFTF=1THENNX=TX:NY=TY:X=TX+3:Y=TY+3:GOSUB20
240 IFO(25)<S1*.8THENIFRND(8)<O(30)THENTF=.
250 IFI$<>""THENO(25)=O(25)*0.99
260 IFO(25)<S1THENO(25)=O(25)+(O(26)/1100)
265 IFQ=C5THEN1750
270 GOSUB480:SET(W+NX,NY,0):OX=NX:OY=NY:RESET(W+NX,NY):IFDX<C0THENGOSUB620
280 IFQ=5ORQ=8THENO=Q:GOSUB70
310 IFO(25)>.THENIFFI=.THEN100
330 IFFITHENRETURN
340 O(25)=0:GOSUB480:PRINT@332,"THOU HAST EXPIRED!":FORJ=150TO1STEP-4:SOUNDJ,1:NEXT:BG=1:RETURN
350 IFI$="W"THENMS=0:DX=C0:GOTO60
360 RETURN
370 PRINT@332,M$;:GOSUB4195
410 PRINT@332,"":RETURN
430 GOSUB410:PRINT@332,M$;:FORU=1TO1000:NEXTU:GOTO410
480 PRINT@161,"DIR: "MID$("NESW.",NF,1);:PRINT@193,"STR:"INT(O(25));:PRINT@225,"VIT:"INT(O(26));:PRINT@257,"AUR:"O(31);
550 PRINT@321,"ATT:"INT(O(25)+O(1)+O(2)+O(3)+O(4)+O(5)+O(7)+O(8));:PRINT@353,"SPL:"O(17)+O(18)+O(19)+O(20)+O(21)+O(22);
552 PRINT@289,"EXP:"INT(O(29));:PRINT@385,"TOR:"O(14);:PRINT@417,"POT:"O(23)+O(24);:RETURN
620 DX=LX-NX:SX=SGN(DX):DY=LY-NY:SY=SGN(DY):IFRND(0)>MVTHEN670
630 MX=LX-SX:Z=R(MX,MY):IF(Z>.ANDZ<>MT)ORABS(DX)=.THENMX=LX
640 MY=LY-SY:Z=R(MX,MY):IF(Z>.ANDZ<>MT)ORABS(DY)=.THENMY=LY
650 R(LX,LY)=.:RESET(W+LX,LY):R(MX,MY)=MT:SET(W+MX,MY,.)
670 LX=MX:LY=MY:L=0:RESET(W+MX,MY):IFABS(DX)<=1ANDABS(DY)<=1ANDQ<>C7THENL=M*.5:O=MT:GOSUB70:SOUNDL,1
690 IFL*12<O(30)+O(27)THENRETURN
700 M$=T$(5):GOSUB430:SOUND110,2
710 L=L/(3+O(9)+O(10)+O(11)+O(12)+O(13)):O(25)=O(25)-L:O(26)=O(26)-(L/101)
730 K=1:O=-(RND(0)<((MT-8)/20)):J=MT*10:SOUNDJ,1:SOUND110,2
750 IFO=1ANDO(K)>0THENO(K)=0:M$=T$(8)+W$(K):GOSUB430:O=0:SOUND110,2:J=K*15:SOUNDJ,1:RETURN
760 IFK<11THENK=K+1:GOTO750
770 RETURN
870 M$=T$(RND(3)):SOUND110,2:L=O(25)+O(1)+O(2)+O(3)+O(4)+O(5)+O(7)+O(8)+RND(O(30)):IFO(27)+O(30)<RND(M)+2THENM$=T$(4):L=0
900 MS=MS-L:GOSUB430:O(25)=O(25)-(L/100):O(29)=O(29)+.04:IFMS<1THENGOSUB970
930 RETURN
940 GOSUB950:PRINT@364,"rEVEAL cONJURE gET":PRINT@396,"pOTION ":PRINT@332,"a w s MOVEMENT fIGHT";
946 PRINT@460,T$(10):GOSUB4195
950 FORO=1TO5:PRINT@32*(9+O)+12,"":NEXT:PRINT@473,"?=HELP":RETURN
970 DX=C0:MS=0:R(MX,MY)=0:O(29)=O(29)+.1:M$=T$(6):GOSUB430:FORJ=200TO150STEP-8:SOUNDJ,1:NEXT
980 R=MX:S=MY:GOSUB60:GOSUB20:RETURN
990 GOSUB480:PRINT@364,"YOU MAY USE MAGICKS":IFO(15)>0THENPRINT@396,"FROM NECRONOMICON"
1020 PRINT@460,"CONSULT THE LORE":IFO(16)>0THENPRINT@428,"FROM THE SCROLLS"
1040 M$="USE SPELL NUMBER?":GOSUB370:SL=VAL(I$):IFSL=0OR(O(15)=0ANDSL<5)OR(O(16)=0ANDSL>3)ORSL>6THENSOUND1,5:GOTO1040
1070 GOSUB950:O(P+SL)=O(P+SL)-1:R=NX:S=NY:GOSUB1:H$=STR$(SL):IFO(P+SL)<0THENH$=H$+T$(9):GOTO1100
1090 ONSLGOSUB1140,1190,1220,1280,1300,1390:O(29)=O(29)+.08
1100 GOSUB950:M$="SPELL"+H$
1130 GOSUB430:GOSUB480:RETURN
1140 FORJ=1TO32STEP3:SOUNDJ,1:SOUND110,1:NEXT:IFDX<3ANDDY<3ANDRND(O(31))>1THENGOSUB970
1180 RETURN
1190 IFQ=0THENR(NX,NY)=C7:O=C7:GOSUB70
1200 SOUND100,1:SOUND200,1:RETURN
1220 NX=1+RND(13):NY=1+RND(13):FORJ=8TO255STEP8:SOUNDJ,1:NEXT:X=NX+3:Y=NY+3:GOSUB20:R=NX:S=NY:GOSUB60:RETURN
1280 O(26)=O(26)+RND(O(P+SL)):O(25)=O(25)+RND(O(P+SL)):O(31)=O(31)-1:RETURN
1300 EX=NX+D(NF,1):EY=NY+D(NF,2):IF(EX<1OREX>15)OR(EY<1OREY>15)THENRETURN
1310 N(EX+3,EY+3)=0:GOSUB20:FORJ=1TO30:Q=VAL(MID$("235789",RND(6),1)):O=Q:GOSUB70:SOUNDJ,1:NEXT
1320 R(EX,EY)=Q:DX=C0:MS=0:R=EX:S=EY:GOSUB1:FORJ=1TO20STEP4:SOUNDJ,1:NEXT:RETURN
1390 O(26)=S2:O(25)=S1:O(31)=O(31)-1:RETURN
1410 GX=NX+D(NF,1):GY=NY+D(NF,2):GT=R(GX,GY):IFGT=C2THENO(23)=O(23)+1:O(24)=O(24)+1:GOTO1525
1480 IFGT=C3THENGOSUB1530:GOTO1525
1490 IFGT=C4THENGOSUB1550
1520 GOSUB20:RETURN
1525 R(GX,GY)=0:SOUNDGT*10,1:SOUNDGT*5,1:GOTO1520
1530 O(0)=O(0)+1:IFRND(3)=1THENO=RND(11):GOSUB3351:IFUTHENM$=W$(O):GOSUB430:O(O)=Q(O)
1535 IFPC<C4ANDRND(6)=1THENSP=RND(6):O(P+SP)=O(P+SP)+1:M$=STR$(SL):GOSUB1100
1536 IFRND(9)=1THENM$="TORCHES":O(14)=O(14)+2:GOTO1130
1540 RETURN
1550 PRINT@332,"THY QUEST IS OVER!";:FORO=1TO18:J=T(O):SOUNDJ,1:R=NX:S=NY:FORNF=1TO4:GOSUB480:NEXT:NEXT:MS=0
1630 PRINT@396,"THY SCORE=";INT((O(0)*10)+(O(0)*O(29))+O(25)+O(26)+O(29)):FI=1:GOTO946
1660 IFO(24)>0ANDO(25)<S1THENO(25)=S1:O(24)=O(24)-1
1670 IFO(23)>0ANDO(26)<S2THENO(26)=S2:O(23)=O(23)-1
1680 RETURN
1690 IFO(14)=0THENM$=T$(7):GOSUB430:RETURN
1700 T=50:FORS=NY-3TONY+3:FORR=NX-3TONX+3:IFR>.ANDR<16THENIFS>.ANDS<16THENGOSUB1
1710 NEXT:NEXT:T=.:O(14)=O(14)-1:RETURN
1750 O=Q:GOSUB70:M$=T$(12):GOSUB430:IFO(29)<S3THENM$=T$(11):GOSUB430:GOTO1775
1760 PRINT@364,"(Y/N)?":M$=T$(12):GOSUB370:IFI$="N"THEN1775
1765 LC=1:M$="SAVE CHARACTER?":GOSUB370:IFI$="Y"THENO=364:GOSUB3230
1766 O=364:PRINT@332,"DUNGEON"
1770 GOSUB4140:CLOAD*R,M$:LE=R(0,0):IX=R(0,1):IY=R(0,2):FI=0:BG=0:RETURN
1775 GOSUB950:GOSUB1780:GOTO100
1780 NX=OX:NY=OY:X=OX+3:Y=OY+3:GOSUB20:RETURN
2160 S1=O(28):S2=O(32):S3=INT(O(29))+1:PC=O(33):RETURN
2460 DATA2H SWORD,BR SWORD,SWORD,AXE,MACE,FLAIL,DAGGER,GAUNTLET,H ARMOUR,C ARMOUR,L ARMOUR
2500 FORO=1TO11:READW$(O):NEXT:FORO=1TO12:READT$(O):NEXT:C1=1:C2=2:C3=3:C4=4:C5=6:C6=7:C7=8:C0=255
2610 DATAA GOOD BLOW,WELL HIT SIR,THY AIM IS TRUE,"MISSED!","HIT THEE!!",IT IS SLAIN,NO LIGHT
2620 DATA"BROKEN THY "," EXHAUSTED",PRESS ANY KEY,NEED EXPERIENCE,EXIT FROM THIS LEVEL,,-1,1,,,1,-1,
2680 FORO=1TO4:READD(O,1),D(O,2):NEXT:FORO=1TO18:READT(O):NEXT:RETURN
2760 DATA69,117,73,121,81,129,69,117,73,121,81,129,89,137,97,145,101,149
3000 CLS:PRINT"LOAD CHARACTER FROM TAPE (Y/N)?";:GOSUB4195:IFI$="Y"THENO=32:GOSUB4140:N$=M$:CLOAD*O,M$:GOTO2160
3005 CLS:PRINT@384,"   w UP        space NEXT PAGE":PRINT"   z DOWN":PRINT@431,"s +   a -"
3010 M$="":J=1:L=3+RND(5):H$="POINTS":FORI=1TO8:I(1,I)=RND(5)+2:NEXT:I(1,5)=1
3015 FORO=0TO33:O(O)=0:NEXT:GOSUB3400:BG=2:GOSUB3440:K=1:P=T:PRINT@32*P+1,">";
3035 GOSUB3355:IFK=5THEN3035
3045 IFI$="S"ORI$="+"THENIFL>0THENI(J,K)=I(J,K)+1:L=L-1:GOSUB3450
3050 IFI$="A"ORI$="-"THENIFI(J,K)>1THENI(J,K)=I(J,K)-1:L=L+1:GOSUB3450
3055 PC=1:IFI(1,4)>6ANDI(1,8)>7THENPC=2
3065 IFI(1,4)>8ANDI(1,7)>7THENPC=3
3070 IFI(1,1)>7ANDI(1,8)>5ANDI(1,1)+I(1,2)>10THENPC=4
3075 IFI(1,1)>8ANDI(1,2)+I(1,3)>12ANDI(1,8)<6THENPC=5
3080 PRINT@50,C$(PC):GOSUB3420:IFI$<>" "THEN3035
3090 PRINT@448,"":PRINT@431,"bUY   oFFER":H$="GOLD COINS":O(0)=120+RND(60):L=O(0)
3095 FORJ=2TO4:BG=J+2:K=1:P=T:M$="CHOOSE WELL SIR!":GOSUB3400:GOSUB3440:PRINT@32*P+1,">";
3130 GOSUB3355:N=8*(J-2)+K:M$="YOUR CHOICE?":GOSUB3335:BR=0:OF=0:IFI$="B"THENOF=I(J,K):GOSUB3300
3160 IFI$="O"THENBR=RND(3):GOSUB3280
3165 L=O(0):GOSUB3420:ON-(I$<>" ")GOTO3130:NEXT:FORJ=1TO8:O(24+J)=I(1,J):NEXT:BG=0:O(16)=O(16)*20
3180 PRINT@448,"NAME THY CHARACTER";:INPUTN$:IFLEN(N$)>8THEN3180
3181 FORO=13TO16:O(O)=O(O+2):NEXT:FORO=1TO2:FORJ=1TO3:O(16+(O-1)*3+J)=O(14+O)*O(31):NEXT:NEXT:O(28)=O(25):O(32)=O(26):O(33)=PC
3190 PRINT@448,"SAVE CHARACTER (Y/N)?":GOSUB4195:IFI$="Y"THENO=448:GOSUB3230
3220 GOTO2160
3230 PRINT@O,T$(10):GOSUB4195:PRINT@O,"SAVING":CSAVE*O,N$:PRINT@O,"":RETURN
3280 M$="":GOSUB3420:PRINT@448,"YOUR OFFER";:INPUTOF:PRINT@448,"":GOSUB3335
3300 IFO(N)>0ANDN<23THENM$="YOU HAVE IT SIR":RETURN
3305 PR=I(J,K)-BR:IFO(0)<PRTHENM$="YOU CANNOT AFFORD":RETURN
3315 IFOF>=PRANDY=1THENO(N)=O(N)+Q(N):O(0)=O(0)-OF:M$="TIS YOURS!"
3320 IFOF<PRANDY=1THENM$="OFFER REJECTED"
3325 IFO(0)<0THENO(0)=0
3330 RETURN
3335 Y=0:O=N:GOSUB3351:Y=U:IFY=0THENM$="NOT FOR "+C$(PC)
3350 RETURN
3351 U=0:IFMID$(O$(O),PC,1)="1"THENU=1
3352 RETURN
3355 GOSUB4195:PRINT@1+32*P," ";:IFI$="W"ANDK>1THENK=K-1
3380 IFI$="Z"ANDK<8THENK=K+1
3385 P=K+T-1:PRINT@1+32*P,">";:RETURN
3400 PRINT@0,F$(J,9)
3420 PRINT@448,M$:PRINT@32,H$;:PRINT@42,L;:RETURN
3440 T=2:GOSUB3480:T=T+1
3450 FORI=1TO8:Y=T+I-1:PRINT@2+32*Y,F$(J,I);:PRINT@16+32*Y,I(J,I);:NEXT:RETURN
3480 PRINT@32*T,;:FORS=TTO11:PRINT@32*S,"":NEXT
3500 FORO=1TO62:SET(O,T*2,BG):SET(O,23,BG):NEXT:FORO=T*2TO23:SET(0,O,BG):SET(63,O,BG):NEXT:RETURN
3525 DATA00001,00011,10011,10011,11011,00011,10111,11011,00011,00011,10011,11111
3530 DATA00011,11011,11011,11111,11100,00100,11100,10100,11100,11100,11111,11111
3540 FORO=1TO24:READO$(O):NEXT:FORJ=2TO4:FORI=1TO8:READI(J,I):NEXT:NEXT:FORO=1TO24:READQ(O):NEXT
3550 DATA20,16,12,15,8,10,8,6,18,15,9,9,14,8,6,6,20,15,14,12,10,8,6,6,5,4,3,3,2,2,1,1,5,4,3,1,2,1,3,1,4,3,2,2,3,1,1,1
3620 DATASTRENGTH,VITALITY,AGILITY,INTELLIGENCE,EXPERIENCE,LUCK,AURA,MORALITY,character creation
3630 DATA2 HAND SWORD,BROADSWORD,SHORT SWORD,AXE,MACE,FLAIL,DAGGER,GAUNTLET,armoury,HEAVY ARMOUR
3640 DATACHAIN ARMOUR,LEATHER ARMOUR,HEAVY ROBE,GOLD HELMET,HEADPIECE,SHIELD,TORCH,accoutrements,NECRONOMICON,SCROLLS
3650 DATARING,MYSTIC AMULET,SASH,CLOAK,HEALING SALVE,POTIONS,emporium,WANDERER,CLERIC,MAGICIAN,WARRIOR,BARBARIAN
3660 FORJ=1TO4:FORI=1TO9:READF$(J,I):NEXT:NEXT:FORO=1TO5:READC$(O):NEXT:FORO=0TO9:READH$(O):NEXT:RETURN
4000 CLS:LE=1:IX=1:IY=1:GOSUB4370:PRINT@50,"MAP GENERATOR"
4020 X=1:Y=1:PRINT@82,"LEVEL:"LE:PRINT@114,"? FOR HELP"
4040 I$=INKEY$:IFI$="?"THENPRINT@178,T$(10):FORO=0TO9:PRINT@178,H$(O);:GOSUB4195:PRINT@178,"":NEXT
4055 IFI$="W"ANDY>1THENY=Y-1
4060 IFI$="Z"ANDY<15THENY=Y+1
4065 IFI$="A"ANDX>1THENX=X-1
4070 IFI$="S"ANDX<15THENX=X+1
4075 IFI$="L"THENO=0:GOSUB1770:GOSUB4380:GOTO4020
4080 IFI$>"/"ANDI$<":"THENGOSUB4120
4090 PRINT@X+32*(Y)," ";:GOSUB5:IFI$="N"THEN4210
4110 IFI$<>"X"THEN4040
4115 BG=0:FI=0:PRINT@178,"SAVE TO TAPE?":GOSUB4195:IFI$<>"Y"THENRETURN
4116 O=0:GOSUB4140:R(0,0)=LE:R(0,1)=IX:R(0,2)=IY:CSAVE*R,M$:RETURN
4120 I=VAL(I$):IFI=9THENI=8+RND(3)
4130 IFI=5THENIX=X:IY=Y
4135 R(X,Y)=I:RETURN
4140 PRINT@O,;:INPUT"FILENAME";M$:IFLEN(M$)>8THEN4140
4145 RETURN
4195 I$=INKEY$:IFI$=""THEN4195
4200 RETURN
4210 PRINT@0,;:INPUT"LEVEL";LE:IFLE<1ORLE>9THEN4210
4220 GOSUB4370:GOTO4020
4290 DATAMOVE W A S Z,1 WALL 2 VASE,3 CHEST 4 IDOL,5 ENTRY 6 EXIT,7 TRAP,8 SAFE PLACE
4310 DATA9 GUARD,0 ERASE,N NEW LEVEL,L LOAD X EXIT
4370 FORY=1TO15:FORX=1TO15:R(X,Y)=.:NEXT:NEXT
4380 PRINT@0,"WAIT":FORY=1TO15:FORX=1TO15:GOSUB5:NEXT:NEXT:PRINT@0,"":RETURN
5000 FORV=1TO4:FORX=1TO20:FORY=0TO1:READV(X,Y,V):NEXT:NEXT:NEXT:FORY=0TO23:FORX=0TO23:N(X,Y)=1:NEXT:NEXT
5030 A$="Ӏ":B$="Ӏ":C$="܀":D$="܀":RETURN
5100 DATA-2,-4,-1,-4,,-4,1,-4,2,-4,-2,-3,-1,-3,,-3,1,-3,2,-3,-2,-2,-1,-2,,-2,1,-2,2,-2,-1,-1,,-1,1,-1,-1,,1,
5110 DATA4,-2,4,-1,4,,4,1,4,2,3,-2,3,-1,3,,3,1,3,2,2,-2,2,-1,2,,2,1,2,2,1,-1,1,,1,1,,-1,,1
5120 DATA2,4,1,4,,4,-1,4,-2,4,2,3,1,3,,3,-1,3,-2,3,2,2,1,2,,2,-1,2,-2,2,1,1,,1,-1,1,1,,-1,
5130 DATA-4,2,-4,1,-4,,-4,-1,-4,-2,-3,2,-3,1,-3,,-3,-1,-3,-2,-2,2,-2,1,-2,,-2,-1,-2,-2,-1,1,-1,,-1,-1,,1,,-1
9000 DIMY,V(20,1,4),V,A,B,C,D,E,F,G,H,I,N(23,23),O,U,M$,M,N,R,S,MC,R(16,16),C1,C2,C6,C7,C0,O(33),C3,C4,C5,W$(11),T$(12)
9010 DIMD(4,2),T(18),I(4,8),F$(4,9),C$(5),O$(24),Q(24),H$(9):W=24:MC=16384:GOSUB2500:GOSUB3540:GOSUB5000
9200 PRINT@104,"1. MAKE CHARACTER":PRINT@168,"2. MAKE DUNGEON":PRINT@232,"3. PLAY GAME"
9240 PRINT@300,"CHOICE?":GOSUB4195:O=VAL(I$):IFO>3THEN9200
9241 LC=0:ONOGOSUB3000,4000,9800,9810:IFLC=1THENO=4:GOTO9241
9250 GOSUB9300:GOTO9200
9300 CLS:PRINT@40,"DUNGEON OF DOOM":RETURN
9800 PRINT@416,"LOAD A DUNGEON FROM TAPE (Y/N)?";:GOSUB4195:IFI$="Y"THENO=448:GOSUB1770
9810 IFLE>O(29)ORFI>0ORO(25)<1ORBGTHENO=0:RETURN
9900 CLS0:R(0,0)=0:R(0,1)=0:R(0,2)=0:FORY=1TO15:FORX=1TO15:N(X+3,Y+3)=-(R(X,Y)=1):NEXT:NEXT:FI=0:DX=255:TX=0:TY=0
9920 TF=0:MX=0:MY=0:DY=12:NX=1:NY=1:X=IX+3:Y=IY+3:NX=IX:NY=IY:OX=IX:OY=IY:IFN(X,Y)THENRETURN
9940 H$="         ":M$=LEFT$(N$+H$,9):V=2:NF=V:PRINT@1,;:GOSUB7:GOSUB20
9945 FORR=0TO16:SET(W+R,0,6):SET(W+R,16,6):R(R,16)=1:R(R,0)=1:NEXT:FORS=0TO16:SET(W,S,6):SET(W+16,S,6)
9950 R(0,S)=1:R(16,S)=1:NEXT:FORO=161TO417STEP32:PRINT@O,H$;:NEXT:GOSUB950
9980 BG=1:PRINT@87,;:M$="DUNGEON":GOSUB7:PRINT@153,;:M$="OF":GOSUB7:PRINT@216,;:M$="DOOM":GOSUB7
9990 T=0:PRINT@449,;:M$=LEFT$(C$(O(33))+H$,9):GOSUB7:P=16:GOSUB2160:GOTO100
