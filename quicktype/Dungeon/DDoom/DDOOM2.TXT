0 CLS:GOTO9000
7 CC=(PEEK(17024)AND1)*256+PEEK(17025)-1+MC:FORZZ=1TOLEN(M$):VV=ASC(MID$(M$,ZZ)):POKECC+ZZ,VV-(VVAND64):NEXT:?@CC-MC+ZZ,:RETURN

20 A=15:B=15:C=15:D=15:E=15:F=15:G=15:H=15:I=15:IFN(X+V(1,.,V),Y+V(1,1,V))THENC=13
22 IFN(X+V(5,.,V),Y+V(5,1,V))THENG=13
23 IFN(X+V(2,.,V),Y+V(2,1,V))THEND=13
24 IFN(X+V(4,.,V),Y+V(4,1,V))THENF=13
25 IFN(X+V(3,.,V),Y+V(3,1,V))THENE=13

26 IFN(X+V(6,.,V),Y+V(6,1,V))THENA=12:B=16:C=4
27 IFN(X+V(10,.,V),Y+V(10,1,V))THENG=6:H=16:I=12
28 IFN(X+V(7,.,V),Y+V(7,1,V))THENB=12:C=12:D=4
29 IFN(X+V(9,.,V),Y+V(9,1,V))THENF=6:G=12:H=12
30 IFN(X+V(8,.,V),Y+V(8,1,V))THEND=12:E=12:F=12

31 IFN(X+V(11,.,V),Y+V(11,1,V))THENA=2
32 IFN(X+V(15,.,V),Y+V(15,1,V))THENI=8
33 IFN(X+V(12,.,V),Y+V(12,1,V))THENA=11:B=11:C=3
34 IFN(X+V(14,.,V),Y+V(14,1,V))THENG=7:H=11:I=11
35 IFN(X+V(13,.,V),Y+V(13,1,V))THENC=11:D=11:E=11:F=11:G=11

36 IFN(X+V(16,.,V),Y+V(16,1,V))THENA=10:B=2
37 IFN(X+V(18,.,V),Y+V(18,1,V))THENH=8:I=10
38 IFN(X+V(17,.,V),Y+V(17,1,V))THENB=10:C=10:D=10:E=10:F=10:G=10:H=10

39 IFN(X+V(19,.,V),Y+V(19,1,V))THENA=1
42 IFN(X+V(20,.,V),Y+V(20,1,V))THENI=9

45 ?@P,MID$(A$,A,1)MID$(A$,B,1)MID$(A$,C,1)MID$(A$,D,1)MID$(A$,E,1)MID$(A$,F,1)MID$(A$,G,1)MID$(A$,H,1)MID$(A$,I,1);
46 ?@P+32,MID$(B$,A,1)MID$(B$,B,1)MID$(B$,C,1)MID$(B$,D,1)MID$(B$,E,1)MID$(B$,F,1)MID$(B$,G,1)MID$(B$,H,1)MID$(B$,I,1);
47 ?@P+64,MID$(C$,A,1)MID$(C$,B,1)MID$(C$,C,1)MID$(C$,D,1)MID$(C$,E,1)MID$(C$,F,1)MID$(C$,G,1)MID$(C$,H,1)MID$(C$,I,1);
48 ?@P+96,MID$(D$,A,1)MID$(D$,B,1)MID$(D$,C,1)MID$(D$,D,1)MID$(D$,E,1)MID$(D$,F,1)MID$(D$,G,1)MID$(D$,H,1)MID$(D$,I,1);:RETURN

50 K=PEEK(2)ANDPEEK(17023):IFK=.THEN50
51 V=V+(K=65)-(K=83):V=V-(V<1)*4+(V>4)*4:IFK=87THENIFN(X+V(17,.,V),Y+V(17,1,V))=.THENX=X+V(17,.,V):Y=Y+V(17,1,V)
52 IFK>48ANDK<55THENGOSUB90:GOTO50
60 GOSUB20:GOTO50

90 P(N,0)=X:P(N,1)=Y:P(N,2)=V:P(N,5)=L:N=K-48
91 PRINT@P-33,"€";:P=32*P(N,4)+P(N,3)+33:PRINT@P-33,"€";:X=P(N,0):Y=P(N,1):V=P(N,2):L=P(N,5):GOSUB20:RETURN

100 I$=INKEY$:IFI$="A"ANDDX<255THENGOSUB870
101 IFI$="C"ANDF(7)>0ANDO(17)+O(18)>0THENGOSUB990
102 IFI$="G"THENGOSUB1410
103 IFI$="P"THENGOSUB1660
104 IFI$="R"THENGOSUB1690
105 IFI$="S"THENGOSUB2260
110 IFI$="B"THENNF=NF-1
120 IFI$="N"THENNF=NF+1
130 IFNF>4THENNF=1
140 IFNF<1THENNF=4
150 IFI$="M"THENNX=NX+D(NF,1):NY=NY+D(NF,2)
160 IFNY>15THENNY=15
170 IFNY<1THENNY=1
180 IFNX<1THENNX=1
190 IFNX>15THENNX=15
200 RH=R(NX,NY)
201 FORY=NY-1TONY+1
202 FORX=NX-1TONX+1
203 IF(X>0ANDX<16)AND(Y>0ANDY<16)AND(X<>OXORY<>OY)THENGOSUB570
204 NEXT X:NEXT Y
210 IF RH=C1 OR RH=C2 OR RH=C3 OR RH=C4 OR RH>C7 THEN X=NX:Y=NY:GOSUB 570:NX=OX:NY=OY:F(1)=F(1)-.03
220 IF RH=C6 THEN TX=NX:TY=NY:TF=1
230 IF TF=1 THEN NX=TX:NY=TY
240 IF F(1) < S1*.8 AND RND(8)<F(6) THEN TF=0
250 IF I$>""THEN F(1)=F(1)*0.99
260 IF F(1) <S1 THEN F(1)=F(1)+(F(2)/1100)
270 GOSUB 480
280 IF OX<>NX OR OY<>NY THEN X=OX:Y=OY:GOSUB 570
290 OX=NX:OY=NY
300 IF DX<255 THEN GOSUB 620
310 IFF(1)>0ANDFI<1ANDRH<>C5THEN100
320 IFRH=C5THENM$=T$(12):GOSUB430:GOSUB1760:GOTO100
330 IF F(1)<1 THEN GOSUB 810
340 PRINT TAB(0,10);:END
350 SOUND 1,-15,J,2:RETURN
360 SOUND 0,-15,7,3:RETURN
370 PRINT@0+32*5,M$;
390 I$=INKEY$:IFI$=""THEN390
410 PRINT@0+32*5,;:M$=""
420 RETURN
430 COLOUR 2+128:COLOUR 0
440 PRINT@32*6+18,M$;
450 FORD=1TO200:NEXTD
460 PRINT TAB(0,5);LEFT$(B$,W);:M$=""
470 RETURN
480 COLOUR 1+128:COLOUR 3
490 PRINT TAB(NX,NY+5);MID$(F$,NF,1);
500 COLOUR 2+128:COLOUR 0
510 PRINT TAB(16,8);INT(F(1));
520 PRINT TAB(16,11);INT(F(2));
530 PRINT TAB(16,14);INT(F(7));
540 PRINT TAB(16,17);MID$("NESW.",NF,1);
550 PRINT TAB(16,20);INT(F(5));
551 PRINT TAB(1,22);INT(F(1)+O(1)+O(2)+O(3)+O(4)+O(5)+O(7)+O(8))
552 PRINT TAB(5,22);INT(M(1)+M(2)+M(3)+M(4)+M(5)+M(6))
553 PRINT TAB(12,22);INT(LT)
554 PRINT TAB(16,22);INT(O(23)+O(24))
560 RETURN
570 COLOUR 1+128:COLOUR	2
580 RM=R(X,Y):PRINT TAB(X,Y+5);CHR$(RM);
590 IF ABS(DX)<4 OR RM<=C7 THEN RETURN
600 MT=RM:M=MT-C2:MV=M/16:MS=M*6:DX=3:LX=X:LY=Y
610 RETURN
620 DX=LX-NX:SX=SGN(DX):DY=LY-NY:SY=SGN(DY)
630 MX=LX-(MV*SX):MY=LY-(MV*SY):RM=R(MX,MY)
640 IF (RM>C0 AND RM<>MT) OR (ABS(DX)<=1 AND ABS(DY)<=1) THEN MY=LY:MX=LX
650 R(LX,LY)=C0:X=LX:Y=LY:GOSUB 570
660 R(MX,MY)=MT:X=MX:Y=MY:GOSUB 570
670 LX=MX:LY=MY:H=0
680 IF ABS(DX)<=1 AND ABS(DY)<=1 AND RH<>C7 THEN H=M*.5:J=H:GOSUB 350
690 IF H*12<F(6)+F(3) THEN RETURN
700 M$=T$(5):GOSUB 430:GOSUB 360
710 H=H/(3+O(9)+O(10)+O(11)+O(12)+O(13)+O(14))
720 F(1)=F(1)-H:F(2)=F(2)-(H/101)
730 I=1:WB=0:MB=RND(M)
740 J=MT:GOSUB 350:GOSUB 360
750 IF MB=1 AND O(I)>0 THEN GOSUB 780
760 IF I<11 THEN I=I+1:GOTO 750
770 RETURN
780 O(I)=0:M$=T$(8)+" "+W$(I):GOSUB 430
790 MB=0:GOSUB 360:J=I:GOSUB 350
800 RETURN
810 NF=5:F(1)=0:GOSUB 440
820 PRINT TAB(1,5);"THOU HAST EXPIRED!"
830 FOR J=150 TO 1 STEP-4
840 GOSUB 350:GOSUB 360:GOSUB 570:GOSUB 480
850 NEXT J
860 RETURN
870 M$=T$(RND(3)):GOSUB 360
880 H=F(1)+O(1)+O(2)+O(3)+O(4)+O(5)+O(7)+O(8)+RND(F(6))
890 IF F(3)+F(6)< RND(M)+2 THEN M$=T$(4):HT=0
900 MS=MS-H:GOSUB 430
910 F(1)=F(1)-(H/100):F(5)=F(5)+.05
920 IFMS<1THENGOSUB940
930 RETURN
940 DX=255:MS=0:R(MX,MY)=C0
950 F(5)=F(5)+.5
960 M$=T$(6):GOSUB 430
970 FORJ=200TO150STEP-8:GOSUB350:GOSUB360:NEXTJ
980 GOSUB 570:RETURN
990 GOSUB 480:COLOUR 2+128:COLOUR 0
1000 PRINT TAB(0,1);"YOU MAY USE MAGICS";
1010 IF O(17)>0 THEN PRINT TAB(0,2);"FROM NECRONOMICON";
1020 IF O(18)>0 THEN PRINT TAB(0,3);"FROM THE SCROLLS";
1030 PRINT TAB(0,4);"CONSULT THE LORE"
1040 M$="USE SPELL NUMBER?":GOSUB 370
1050 SL=VAL(I$)
1060 IF SL=0 OR (O(17)=0 AND SL<5) OR (O(18)=0 AND SL>3) OR SL>6 THEN GOTO 1040
1070 M(SL)=M(SL)-1:X=NX:Y=NY
1080 IF M(SL)<0 THEN M$=T$(9):SL=7
1090 FOR J=1 TO 5:PRINT TAB(0,J);LEFT$(B$,W);:NEXT J:GOSUB 570
1100 ON SL GOSUB 1140,1190,1220,1280,1300,1390,1130
1110 F(5)=F(5)+.2
1120 GOSUB 430
1130 RETURN
1140 FOR J=1 TO 12
1150 GOSUB 350:GOSUB 360
1160 NEXT J
1170 IF DX<255 THEN X=MX:Y=MY:GOSUB 940
1180 RETURN
1190 IF RH=C0 THEN R(NX,NY)=C7
1200 J=100:GOSUB 350:J=200:GOSUB 350
1210 RETURN
1220 NX=RND(13):NY=RND(13)
1230 FOR J=0 TO 255 STEP 8
1240 GOSUB 360:GOSUB 350
1250 NEXT J
1260 GOSUB 480
1270 RETURN
1280 F(2)=F(2)+RND(M(SL)):F(1)=F(1)+RND(M(SL)):F(7)=F(7)-1
1290 RETURN
1300 EX=NX+D(NF,1):EY=NY+D(NF,2)
1301 IF (EX<1 OR EX>15) OR (EY<1 OR EY>15) THEN RETURN
1302 X=EX:Y=EY
1303 FOR J=1 TO 30
1310 R(EX,EY)=RND(8)+1+C0
1320 GOSUB350:GOSUB570
1330 NEXTJ
1340 IFRH<=C7THENDX=255:MS=0
1350 FORJ=1TO20STEP4
1360 GOSUB 350
1370 NEXT J
1380 RETURN
1390 F(2)=S2:F(1)=S1:F(7)=F(7)-1
1400 RETURN
1410 GX=NX+D(NF,1):GY=NY+D(NF,2)
1420 IF GX<0 THEN GX=0
1430 IF GY<0 THEN GY=0
1440 IF GX>15 THEN GX=15
1450 IF GY>15 THEN GY=15
1460 GT=R(GX,GY):IF GT>C1 AND GT<C4 THEN R(GX,GY)=C0
1470 IF GT=C2 THEN O(23)=O(23)+1:O(24)=O(24)+1
1480 IF GT=C3 THEN TR=TR+1
1490 IF GT=C4 THEN GOSUB 1550
1500 X=GX:Y=GY:GOSUB 570
1510 IF GT>C1 AND GT<C4 THEN J=GT:GOSUB 350:J=GT+5:GOSUB 350
1520 RETURN
1530 J=O(24)+O(23)*10:GOSUB 350
1540 RETURN
1550 COLOUR 2+128:COLOUR 1
1560 PRINT TAB(0,1);" THY QUEST IS OVER! "
1570 FOR I = 1 TO 18
1580 J=T(I):GOSUB 350
1590 X=NX:Y=NY
1600 FOR N=1 TO 4:NF=N:GOSUB 480:NEXT N
1610 NEXT I
1620 MS=0
1630 PRINT TAB(1,2);"THY SCORE=";INT((TR*10)+(GC*F(5))+F(1)+F(2)+F(3))
1640 FI=1
1650 RETURN
1660 IF O(24)>0 AND F(1)<S1 THEN F(1)=S1:O(24)=O(24)-1
1670 IF O(23)>0 AND F(2)<S2 THEN F(2)=S2:O(23)=O(23)-1
1680 RETURN
1690 IF LT=0 THEN M$=T$(7):GOSUB 430:RETURN
1700 FOR Y=NY-3 TO NY+3
1710 FOR X=NX-3 TO NX+3
1720 IF (X>0 AND X<16) AND (Y>0 AND Y<16) THEN GOSUB 570
1730 NEXT X:NEXT Y
1740 LT=LT-1
1750 RETURN
1760 REM IF F(5)<S3+1 THEN M$=T$(11):NX=OX:NY=OY:GOSUB 430:RETURN
1770 CLS
1950 RETURN
1960 PRINT:PRINT "LEVEL TOO DEEP"
1970 PRINT "REWIND TAPE"
1980 PRINT "TO POSITION"
1990 PRINT "FOR LEVEL #";F(5)
2000 RETURN
2010 CLS
2020 M$=T$(10):GOSUB370
2250 RETURN
2260 M$="ONE MOMENT PLEASE":GOSUB430
2490 RETURN
2500 W=32
2560 DATA"GR SWORD","SWORD","AXE","MACE","FLAIL","DAGGER","ARMOUR","ARMOUR"
2570 DATA"ARMOUR","HELMET","HEADPC."
2580 FORI=1TO11:READW$(I):NEXTI
2610 DATA"A GOOD BLOW","WELL HIT SIR","THY AIM IS TRUE","MISSED!","HIT THEE!!"
2620 DATA"THE MONSTER IS SLAIN","NO LIGHT","BROKEN THY ","SPELL EXAUSTED"
2630 DATA"PRESS ANY KEY","YOU NEED EXPERIENCE","EXIT FROM THIS LEVEL"
2640 FORI=1TO12:READT$(I):NEXTI
2670 DATA0,-1,1,0,0,1,-1,0
2680 FORI=1TO4:READD(I,1),D(I,2):NEXTI
2690 FI=0:DX=255:NF=0
2700 TX=0:TY=0:TF=0:TR=0
2710 MX=0:MY=0:DY=12:F$=""
2720 NX=1:NY=1:RE=0:LT=0:LE=0
2730 FORI=1TO5:F$=F$+CHR$(OS+I):NEXTI
2760 DATA69,117,73,121,81,129,69,117,73,121,81,129,89,137,97,145,101,149
2770 FORI=1TO18:READT(I):NEXTI:RETURN
2790 COLOUR 1+128:CLS
2800 COLOUR 3+128:COLOUR 0
2810 PRINT M$;LEFT$(B$,W-LEN(M$));
2820 COLOUR 2+128:COLOUR 3
2830 FOR I=1 TO 5:PRINT LEFT$(B$,W);:NEXT I
2840 COLOUR 0+128:COLOUR 1
2850 FOR I=1 TO 15:PRINT TAB(1,5+I);LEFT$(B$,15);:NEXT I
2860 RETURN

2870 PRINT@P+32*4,"STR:";:PRINT@P+32*5,"VIT:";:PRINT@P+32*6,"AUR:";:PRINT@P+32*7,"DIR:";
2910 PRINT@P+32*8,"EXP:";:PRINT@P+32*9,"ATT:";:PRINT@P+32*10,"SPL:";:PRINT@P+32*11,"CAN:";:PRINT@P+32*12,"POT:";:RETURN

3000 CLS:PRINT@384,"   w UP        space NEXT PAGE":PRINT"   z DOWN":PRINT"   s INCREMENT  a DECREMENT":J=1:H=MP:H$="POINTS"
3020 GOSUB3400:GOSUB3440:K=1:P=T+2:PRINT@1+32*INT(P/2),">";
3035 GOSUB3355:IFK=5THEN3035
3045 IFI$="S"ANDH>0THENI(J,K)=I(J,K)+1:H=H-1:GOSUB3450
3050 IFI$="A"ANDI(J,K)>1THENI(J,K)=I(J,K)-1:H=H+1:GOSUB3450
3055 C=1:IFI(1,4)>6ANDI(1,8)>7THENC=2
3065 IFI(1,4)>8ANDI(1,7)>7THENC=3
3070 IFI(1,1)>7ANDI(1,8)>5ANDI(1,1)+I(1,2)>10THENC=4
3075 IFI(1,1)>8ANDI(1,2)+I(1,3)>12ANDI(1,8)<6THENC=5
3080 M$=C$(C):GOSUB3420:IFI$<>" "THEN3035
3090 PRINT@448,"":PRINT@431,"bUY     oFFER"
3095 H=GC:H$="GOLD COINS:":FORJ=2TO4:K=1:P=T+2:M$="CHOOSE WELL SIR!":GOSUB3400:GOSUB3440:PRINT@1+32*INT(P/2),">";
3130 GOSUB3355:N=8*(J-2)+K:M$="YOUR CHOICE?":GOSUB3335:BR=0:OF=0:IFI$="B"ORI$=CHR$(13)THENOF=I(J,K):GOSUB3300
3160 IFI$="O"THENBR=RND(3):GOSUB3280
3165 GOSUB3420:IFI$<>" "THEN3130
3175 NEXTJ
3180 PRINT@33,"NAME THY CHARACTER";:INPUTN$:IFLEN(N$)>9THEN3180
3275 RETURN
3280 M$="":GOSUB3420
3285 PRINT@448,"YOUR OFFER";:INPUTOF:PRINT@448,"":GOSUB3335
3300 IFO(N)>0ANDN<23THENM$="YOU HAVE IT SIR":RETURN
3305 PR=I(J,K)-BR:IFH<PRTHENM$="YOU CANNOT AFFORD":RETURN
3315 IFOF>=PRANDY=1THENO(N)=O(N)+Q(N):H=H-PR:M$="TIS YOURS!"
3320 IFOF<PRANDY=1THENM$="OFFER REJECTED"
3325 IFH<0THENH=0
3330 RETURN
3335 Y=0:IFMID$(O$(N),C,1)="1"THENY=1
3345 IFY=0THENM$="NOT FOR "+C$(C)
3350 RETURN
3355 I$=INKEY$:IFI$=""THEN3355
3370 PRINT@1+32*INT(P/2)," ";
3375 IFI$="W"ANDK>1THENK=K-1
3380 IFI$="Z"ANDK<8THENK=K+1
3385 P=K*2+T-1
3390 PRINT@1+32*INT(P/2),">";:RETURN
3400 PRINT@0,F$(J,9)
3420 PRINT@480,"                     ";:PRINT@480,M$;:PRINT@2+32*INT(3/2),H$;:PRINT@15+32*INT(3/2),H;
3435 RETURN
3440 BG=2:T=2.5:L=11:GOSUB3480:T=INT(T+.5)+2
3450 FORI=1TO8:Y=T+(I-1)*2+1:PRINT@2+32*INT(Y/2),F$(J,I);:PRINT@16+32*INT(Y/2),I(J,I);:NEXTI:RETURN
3480 PRINT@32*INT(T/2),;:FORYY=INT(T)TOINT(L):PRINT@32*YY,"":NEXT
3500 FORXX=1TO62:SET(XX,T*2,BG):SET(XX,L*2,BG):NEXT:FORYY=T*2TOL*2:SET(1,YY,BG):SET(62,YY,BG):NEXT:RETURN
3525 DATA"00001","00011","10011","10011","10011","00011","11111","10011"
3530 DATA"00011","00011","10011","11111","00011","11011","11011","11111"
3535 DATA"11100","00100","11100","10100","11100","11100","11111","11111"
3540 W=32:B=0:FORI=1TO24:READO$(I):NEXTI:FORI=1TO8:I(1,I)=RND(5)+2:NEXTI
3545 I(1,5)=1
3550 DATA20,16,12,15,8,10,8,6,18,15,9,9,14,8,6,6,20,15,14,12,10,8,6,6
3565 FORJ=2TO4:FORI=1TO8:READI(J,I):NEXTI:NEXTJ
3590 DATA5,4,3,3,2,2,1,1,5,4,3,1,2,1,3,1,4,3,2,2,3,1,1,1
3605 FORI=1TO24:READQ(I):NEXTI
3620 DATA"STRENGTH","VITALITY","AGILITY","INTELLIGENCE"
3625 DATA"EXPERIENCE","LUCK","AURA","MORALITY","character creation"
3630 DATA"2 HAND SWORD","BROARDSWORD","SHORT SWORD"
3635 DATA"AXE","MACE","FLAIL","DAGGER","GAUNTLET","armoury"
3640 DATA"HEAVY ARMOUR","CHAIN ARMOUR","LEATHER ARMOUR","HEAVY ROBE"
3645 DATA"GOLD HELMET","HEADPIECE","SHIELD","TORCH","accoutrements"
3650 DATA"NECRONOMICON","SCROLLS","RING","MYSTIC AMULET","SASH","CLOAK"
3655 DATA"HEALING SALVE","POTIONS","emporium"
3660 FORJ=1TO4:FORI=1TO9:READF$(J,I):NEXTI:NEXTJ
3685 DATA"WANDERER","CLERIC","MAGICIAN","WARRIOR","BARBARIAN"
3690 FORI=1TO5:READC$(I):NEXTI:MP=3+RND(5):GC=120+RND(60):M$="":AS=65:RETURN

4000 CLS0:T=0:L=3:PRINT@50,"MAP GENERATOR":PRINT@82,"LEVEL:";LE:PRINT@114,"? FOR HELP":X=1:Y=1
4040 I$=INKEY$:IFI$="?"THENGOSUB4160
4055 IFI$="W"ANDY>1THENY=Y-1
4060 IFI$="Z"ANDY<15THENY=Y+1
4065 IFI$="A"ANDX>1THENX=X-1
4070 IFI$="S"ANDX<15THENX=X+1
4075 IFI$="E"THENGOSUB4335:GOTO4005
4080 IFI$>"/"ANDI$<":"THENGOSUB4120
4090 PRINT@X+32*(Y)," ";
4095 PRINT@X+32*(Y),MID$("€ßvciextsg",R(X,Y)+1,1);
4100 IF(I$="X"ORI$="N")ANDIX>0THENGOSUB4115
4105 IFI$="N"THEN
4110 IFI$<>"X"THEN4040
4115 RETURN
4120 I=VAL(I$):IFI=9THENI=8+RND(3)
4130 IFI=5THENIX=X:IY=Y
4135 R(X,Y)=C0+I:RETURN
4140 LE=LE+1:IFLE>5THENLE=5
4150 GOSUB4335:GOTO4000
4160 FORH=1TO11:PRINT@178,H$(H);:GOSUB4195
4175 PRINT@178,"€€€€€€€€€€€€€€€";
4180 NEXTH:RETURN
4195 M$=INKEY$:IFM$=""THEN4195
4200 RETURN
4290 DATA"PRESS ANY KEY","MOVE W A S Z","1 WALL 2 VASE","3 CHEST 4 IDOL","5 ENTRY 6 EXIT","7 TRAP","8 SAFE PLACE"
4310 DATA"9 GUARD","0 ERASE","N NEXT LEVEL","X EXIT"
4320 LE=1:FORI=1TO11:READH$(I):NEXTI
4335 FORJ=1TO15:FORK=1TO15:R(J,K)=C0:NEXT:NEXT
4360 IX=0:IY=0:RETURN

5000 FORV=1TO4:FORX=1TO20:FORY=0TO1:READV(X,Y,V):NEXT:NEXT:NEXT
5010 FORY=0TO23:FORX=0TO23:N(X,Y)=1:NEXT:NEXT
5030 A$="¯¯«¢€¡§¯¯ßßÓ€€€£":B$="¯¯¯¯€¯¯¯¯ßßßßÓ€¯":C$="¯¯®¨€¤­¯¯ßßÜ€€€¬":D$="®¨€€€€€¤­Ü€€€€€€":RETURN

5100 DATA-2,-4,-1,-4,0,-4,1,-4,2,-4,-2,-3,-1,-3,0,-3,1,-3,2,-3,-2,-2,-1,-2,0,-2,1,-2,2,-2,-1,-1,0,-1,1,-1,-1,0,1,0
5110 DATA4,-2,4,-1,4,0,4,1,4,2,3,-2,3,-1,3,0,3,1,3,2,2,-2,2,-1,2,0,2,1,2,2,1,-1,1,0,1,1,0,-1,0,1
5120 DATA2,4,1,4,0,4,-1,4,-2,4,2,3,1,3,0,3,-1,3,-2,3,2,2,1,2,0,2,-1,2,-2,2,1,1,0,1,-1,1,1,0,-1,0
5130 DATA-4,2,-4,1,-4,0,-4,-1,-4,-2,-3,2,-3,1,-3,0,-3,-1,-3,-2,-2,2,-2,1,-2,0,-2,-1,-2,-2,-1,1,-1,0,-1,-1,0,1,0,-1

9000 DIMX,Y,V(20,1,4),V,A,B,C,D,E,F,G,H,I,N(23,23),P,P(6,5),L,ZZ,CC,VV,M$,M,N:MC=16384
9010 DIMR(15,15),F(8),O(24),W$(11),T$(12),M(6),D(4,2),T(18)
9020 DIMI(4,9),F$(4,9),C$(5),O$(24),Q(24)
9030 DIMH$(11)

9100 GOSUB2500:GOSUB2010:GOSUB1770:GOSUB3540:GOSUB4320:GOSUB5000

9200 CLS:PRINT"MENU"
9210 PRINT"1. MAKE CHARACTER"
9220 PRINT"2. MAKE DUNGEON"
9230 PRINT"3. PLAY GAME":PRINT:INPUT"CHOICE";T
9240 ONTGOSUB3000,4000,9900:GOTO9200

9900 CLS0:N=1:X=0:Y=0:P(N,2)=2:P(N,3)=X:P(N,4)=Y:FORY=1TO15:FORX=1TO15:IFR(X,Y)<>1THENN(X+3,Y+3)=.
9910 NEXT:NEXT
9920 FORN=1TO1
9930 X=3+RND(16):Y=3+RND(16):IFN(X,Y)THEN9930
9940 M$=LEFT$(N$+"         ",9):P(N,0)=X:P(N,1)=Y:P=32*P(N,4)+P(N,3)+33:PRINT@P-32,;:GOSUB7
9950 GOSUB2870:X=P(N,0):Y=P(N,1):V=P(N,2):L=P(N,5)
9951 GOSUB20:P(N,5)=1:NEXT
9960 N=1:GOSUB91:GOTO50
