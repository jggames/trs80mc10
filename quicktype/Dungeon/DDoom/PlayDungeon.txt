10 GOSUB 2500
20 GOSUB 2010
30 GOSUB 1770
40 I$=INKEY$(0)
50 IF I$="A" AND DX<255 THEN GOSUB 870
60 IF I$="C" AND F(7)>0 AND O(17)+O(18)>0 THEN GOSUB 990
70 IF I$="G" THEN GOSUB 1410
80 IF I$="P" THEN GOSUB 1660
90 IF I$="R" THEN GOSUB 1690
100 IF I$="S" THEN GOSUB 2260
110 IF I$="B" THEN NF=NF-1
120 IF I$="N" THEN NF=NF+1
130 IF NF>4 THEN NF=1
140 IF NF<1 THEN NF=4
150 IF I$="M" THEN NX=NX+D(NF,1):NY=NY+D(NF,2)
160 IF NY>15 THEN NY=15
170 IF NY<1 THEN NY=1
180 IF NX<1 THEN NX=1
190 IF NX>15 THEN NX=15
200 RH=R(NX,NY)
201 FOR Y=NY-1 TO NY+1
202 FOR X=NX-1 TO NX+1
203 IF (X>0 AND X<16) AND (Y>0 AND Y<16) AND (X<>OX OR Y<>OY) THEN GOSUB 570
204 NEXT X:NEXT Y
210 IF RH=C1 OR RH=C2 OR RH=C3 OR RH=C4 OR RH>C7 THEN X=NX:Y=NY:GOSUB 570:NX=OX:NY=OY:F(1)=F(1)-.03
220 IF RH=C6 THEN TX=NX:TY=NY:TF=1
230 IF TF=1 THEN NX=TX:NY=TY
240 IF F(1) < S1*.8 AND RND(8)<F(6) THEN TF=0
250 IF I$>""THEN F(1)=F(1)*0.99
260 IF F(1) <S1 THEN F(1)=F(1)+(F(2)/1100)
270 GOSUB 480
280 IF OX<>NX OR OY<>NY THEN X=OX:Y=OY:GOSUB 570
290 OX=NX:OY=NY
300 IF DX<255 THEN GOSUB 620
310 IF F(1)>0 AND FI<1 AND RH<>C5 THEN GOTO 40
320 IF RH=C5 THEN M$=T$(12):GOSUB 430:GOSUB 1760:GOTO 40
330 IF F(1)<1 THEN GOSUB 810
340 PRINT TAB(0,10);:END
350 SOUND 1,-15,J,2:RETURN
360 SOUND 0,-15,7,3:RETURN
370 COLOUR 2+128:COLOUR 0
380 PRINT TAB(0,5);M$;
390 I$=INKEY$(0)
400 IF I$="" THEN GOTO 390
410 PRINT TAB(0,5);LEFT$(B$,W);:M$=""
420 RETURN
430 COLOUR 2+128:COLOUR 0
440 PRINT TAB(0,5);M$;
450 FOR D=1 TO 200:NEXT D
460 PRINT TAB(0,5);LEFT$(B$,W);:M$=""
470 RETURN
480 COLOUR 1+128:COLOUR 3
490 PRINT TAB(NX,NY+5);MID$(F$,NF,1);
500 COLOUR 2+128:COLOUR 0
510 PRINT TAB(16,8);INT(F(1));" ";
520 PRINT TAB(16,11);INT(F(2));" ";
530 PRINT TAB(16,14);INT(F(7));" ";
540 PRINT TAB(16,17);MID$("NESW.",NF,1);
550 PRINT TAB(16,20);INT(F(5));
551 PRINT TAB(1,22);INT(F(1)+O(1)+O(2)+O(3)+O(4)+O(5)+O(7)+O(8));" ";
552 PRINT TAB(5,22);INT(M(1)+M(2)+M(3)+M(4)+M(5)+M(6));" "
553 PRINT TAB(12,22);INT(LT);" ";
554 PRINT TAB(16,22);INT(O(23)+O(24));" "
560 RETURN
570 COLOUR 1+128:COLOUR	2
580 RM=R(X,Y):PRINT TAB(X,Y+5);CHR$(RM);
590 IF ABS(DX)<4 OR RM<=C7 THEN RETURN
600 MT=RM:M=MT-C2:MV=M/16:MS=M*6:DX=3:LX=X:LY=Y
610 RETURN
620 DX=LX-NX:SX=SGN(DX):DY=LY-NY:SY=SGN(DY)
630 MX=LX-(MV*SX):MY=LY-(MV*SY):RM=R(MX,MY)
640 IF (RM>C0 AND RM<>MT) OR (ABS(DX)<=1 AND ABS(DY)<=1) THEN MY=LY:MX=LX
650 R(LX,LY)=C0:X=LX:Y=LY:GOSUB 570
660 R(MX,MY)=MT:X=MX:Y=MY:GOSUB 570
670 LX=MX:LY=MY:H=0
680 IF ABS(DX)<=1 AND ABS(DY)<=1 AND RH<>C7 THEN H=M*.5:J=H:GOSUB 350
690 IF H*12<F(6)+F(3) THEN RETURN
700 M$=T$(5):GOSUB 430:GOSUB 360
710 H=H/(3+O(9) + O(10) + O(11) + O(12) + O(13) + O(14))
720 F(1)=F(1)-H:F(2)=F(2)-(H/101)
730 I=1:WB=0:MB=RND(M)
740 J=MT:GOSUB 350:GOSUB 360
750 IF MB=1 AND O(I)>0 THEN GOSUB 780
760 IF I<11 THEN I=I+1:GOTO 750
770 RETURN
780 O(I)=0:M$=T$(8)+" "+W$(I):GOSUB 430
790 MB=0:GOSUB 360:J=I:GOSUB 350
800 RETURN
810 NF=5:F(1)=0:GOSUB 440
820 PRINT TAB(1,5);"THOU HAST EXPIRED!"
830 FOR J=150 TO 1 STEP-4
840 GOSUB 350:GOSUB 360:GOSUB 570:GOSUB 480
850 NEXT J
860 RETURN
870 M$=T$(RND(3)):GOSUB 360
880 H=F(1)+O(1) + O(2) + O(3) + O(4) + O(5) + O(7) + O(8)+RND(F(6))
890 IF F(3)+F(6)< RND(M)+2 THEN M$=T$(4):HT=0
900 MS=MS-H:GOSUB 430
910 F(1)=F(1)-(H/100):F(5)=F(5)+.05
920 IF MS<1 THEN GOSUB 940
930 RETURN
940 DX=255:MS=0:R(MX,MY)=C0
950 F(5)=F(5)+.5
960 M$=T$(6):GOSUB 430
970 FOR J=200 TO 150 STEP-8:GOSUB 350:GOSUB 360:NEXT J
980 GOSUB 570:RETURN
990 GOSUB 480:COLOUR 2+128:COLOUR 0
1000 PRINT TAB(0,1);"YOU MAY USE MAGICS";
1010 IF O(17)>0 THEN PRINT TAB(0,2);"FROM NECRONOMICON";
1020 IF O(18)>0 THEN PRINT TAB(0,3);"FROM THE SCROLLS";
1030 PRINT TAB(0,4);"CONSULT THE LORE"
1040 M$="USE SPELL NUMBER?":GOSUB 370
1050 SL=VAL(I$)
1060 IF SL=0 OR (O(17)=0 AND SL<5) OR (O(18)=0 AND SL>3) OR SL>6 THEN GOTO 1040
1070 M(SL)=M(SL)-1:X=NX:Y=NY
1080 IF M(SL)<0 THEN M$=T$(9):SL=7
1090 FOR J=1 TO 5:PRINT TAB(0,J);LEFT$(B$,W);:NEXT J:GOSUB 570
1100 ON SL GOSUB 1140,1190,1220,1280,1300,1390,1130
1110 F(5)=F(5)+.2
1120 GOSUB 430
1130 RETURN
1140 FOR J=1 TO 12
1150 GOSUB 350:GOSUB 360
1160 NEXT J
1170 IF DX<255 THEN X=MX:Y=MY:GOSUB 940
1180 RETURN
1190 IF RH=C0 THEN R(NX,NY)=C7
1200 J=100:GOSUB 350:J=200:GOSUB 350
1210 RETURN
1220 NX=RND(13):NY=RND(13)
1230 FOR J=0 TO 255 STEP 8
1240 GOSUB 360:GOSUB 350
1250 NEXT J
1260 GOSUB 480
1270 RETURN
1280 F(2)=F(2)+RND(M(SL)):F(1)=F(1)+RND(M(SL)):F(7)=F(7)-1
1290 RETURN
1300 EX=NX+D(NF,1):EY=NY+D(NF,2)
1301 IF (EX<1 OR EX>15) OR (EY<1 OR EY>15) THEN RETURN
1302 X=EX:Y=EY
1303 FOR J=1 TO 30
1310 R(EX,EY)=RND(8)+1+C0
1320 GOSUB 350:GOSUB 570
1330 NEXT J
1340 IF RH<=C7 THEN DX=255:MS=0
1350 FOR J = 1 TO 20 STEP 4
1360 GOSUB 350
1370 NEXT J
1380 RETURN
1390 F(2)=S2:F(1)=S1:F(7)=F(7)-1
1400 RETURN
1410 GX=NX+D(NF,1):GY=NY+D(NF,2)
1420 IF GX<0 THEN GX=0
1430 IF GY<0 THEN GY=0
1440 IF GX>15 THEN GX=15
1450 IF GY>15 THEN GY=15
1460 GT=R(GX,GY):IF GT>C1 AND GT<C4 THEN R(GX,GY)=C0
1470 IF GT=C2 THEN O(23)=O(23)+1:O(24)=O(24)+1
1480 IF GT=C3 THEN TR=TR+1
1490 IF GT=C4 THEN GOSUB 1550
1500 X=GX:Y=GY:GOSUB 570
1510 IF GT>C1 AND GT<C4 THEN J=GT:GOSUB 350:J=GT+5:GOSUB 350
1520 RETURN
1530 J=O(24)+O(23)*10:GOSUB 350
1540 RETURN
1550 COLOUR 2+128:COLOUR 1
1560 PRINT TAB(0,1);" THY QUEST IS OVER! "
1570 FOR I = 1 TO 18
1580 J=T(I):GOSUB 350
1590 X=NX:Y=NY
1600 FOR N=1 TO 4:NF=N:GOSUB 480:NEXT N
1610 NEXT I
1620 MS=0
1630 PRINT TAB(1,2);"THY SCORE=";INT((TR*10)+(GC*F(5))+F(1)+F(2)+F(3))
1640 FI=1
1650 RETURN
1660 IF O(24)>0 AND F(1)<S1 THEN F(1)=S1:O(24)=O(24)-1
1670 IF O(23)>0 AND F(2)<S2 THEN F(2)=S2:O(23)=O(23)-1
1680 RETURN
1690 IF LT=0 THEN M$=T$(7):GOSUB 430:RETURN
1700 FOR Y=NY-3 TO NY+3
1710 FOR X=NX-3 TO NX+3
1720 IF (X>0 AND X<16) AND (Y>0 AND Y<16) THEN GOSUB 570
1730 NEXT X:NEXT Y
1740 LT=LT-1
1750 RETURN
1760 REM IF F(5)<S3+1 THEN M$=T$(11):NX=OX:NY=OY:GOSUB 430:RETURN
1770 CLS:PRINT TAB(0,3);"PREPARE DUNGEON TAPE"
1780 M$=T$(10):GOSUB 370
1785 A$="LEVEL"+STR$(LE+1)
1790 S=OPENIN A$
1800 INPUT#S,S$
1810 CLOSE#S
1820 I=1
1830 FOR Y=1 TO 15
1840 FOR X=1 TO 15
1850 R(X,Y)=ASC(MID$(S$,I,1))
1860 I=I+1
1870 NEXT X
1880 NEXT Y
1890 IX=ASC(MID$(S$,I,1))-OS
1900 IY=ASC(MID$(S$,I+1,1))-OS
1910 LE=ASC(MID$(S$,I+2,1))-OS
1920 REM IF LE>F(5) THEN GOSUB 1960:GOTO 1760
1930 GOSUB 2790
1940 NX=IX:NY=IY:OX=NX:OY=NY:DX=255
1950 RETURN
1960 PRINT:PRINT "LEVEL TOO DEEP"
1970 PRINT "REWIND TAPE"
1980 PRINT "TO POSITION"
1990 PRINT "FOR LEVEL #";F(5)
2000 RETURN
2010 CLS:PRINT TAB(0,3);"PREPARE HERO TAPE"
2020 M$=T$(10):GOSUB 370
2030 S=OPENIN "HERO"
2040 INPUT#S,S$
2050 CLOSE#S
2060 P=2
2070 OT=ASC(MID$(S$,1,1))-AS
2080 FOR I= 1 TO 8
2090 F(I)=ASC(MID$(S$,P,1))-AS
2100 P=P+1
2110 NEXT I
2120 FOR I=1 TO OT
2130 O(I)=ASC(MID$(S$,P,1))-AS
2140 P=P+1
2150 NEXT I
2160 GC=ASC(MID$(S$,P,1))-AS
2170 TR=ASC(MID$(S$,P+1,1))-AS
2180 C$=RIGHT$(S$,LEN(S$)-(P+1))
2190 S1=F(1):S2=F(2):S3=F(5)
2200 FOR I=1 TO 2
2210 FOR J=1 TO 3
2220 M((I-1)*3+J)=O(16+I)*F(7)
2230 NEXT J:NEXT I
2240 IF O(16)=1 THEN LT=20
2250 RETURN
2260 M$="ONE MOMENT PLEASE":GOSUB 430
2270 S$="":T$=""
2280 FOR Y=1 TO 15
2290 FOR X=1 TO 15
2300 T$=T$+CHR$(R(X,Y))
2310 NEXT X:NEXT Y
2320 T$=T$+CHR$(OS+NX)
2330 T$=T$+CHR$(OS+NY)
2340 T$=T$+CHR$(OS+LE)
2350 S$=S$+CHR$(AS+OT)
2360 FOR I=1 TO 8
2370 S$=S$+CHR$(F(I)+AS)
2380 NEXT I
2390 FOR I=1 TO OT
2400 S$=S$+CHR$(O(I)+AS)
2410 NEXT I
2420 S$=S$+CHR$(GC+AS)
2430 S$=S$+CHR$(TR+AS)
2440 S$=S$+C$
2450 M$="ANY KEY TO SAVE":GOSUB 370
2460 S=OPENOUT "HERO":PRINT#S,S$:CLOSE#S
2465 A$="LEVEL"+STR$(LE)
2470 S=OPENOUT A$:PRINT#S,T$:CLOSE#S
2480 FI=1
2490 RETURN
2500 C$="ROLE PLAYING GAME":B$=""
2510 W=20:OS=224
2520 FOR I=1 TO W:B$=B$+" ":NEXT I
2530 DIM R(15,15),F(8),O(24)
2540 DIM W$(11),T$(12)
2550 DIM M(6),D(4,2),T(18)
2560 DATA "GR SWORD","SWORD","AXE","MACE","FLAIL","DAGGER","ARMOUR","ARMOUR"
2570 DATA "ARMOUR","HELMET","HEADPC."
2580 FOR I = 1 TO 11
2590 READ W$(I)
2600 NEXT I
2610 DATA "A GOOD BLOW","WELL HIT SIRE","THY AIM IS TRUE","MISSED!","HIT THEE!!"
2620 DATA "THE MONSTER IS SLAIN","NO LIGHT","BROKEN THY ","SPELL EXAUSTED"
2630 DATA "PRESS ANY KEY","YOU NEED EXPERIENCE","EXIT FROM THIS LEVEL"
2640 FOR I = 1 TO 12
2650 READ T$(I)
2660 NEXT I
2670 DATA 0,-1,1,0,0,1,-1,0
2680 FOR I=1 TO 4:READ D(I,1),D(I,2):NEXT I
2690 FI=0:DX=255:NF=0
2700 TX=0:TY=0:TF=0:TR=0
2710 MX=0:MY=0:DY=12:F$=""
2720 NX=1:NY=1:RE=0:LT=0:LE=0
2730 FOR I = 1 TO 5
2740 F$=F$+CHR$(OS+I)
2750 NEXT I
2760 DATA 69,117,73,121,81,129,69,117,73,121,81,129,89,137,97,145,101,149
2770 FOR I = 1 TO 18:READ T(I):NEXT I:GOSUB 2930
2780 RETURN
2790 COLOUR 1+128:CLS
2800 COLOUR 3+128:COLOUR 0
2810 PRINT C$;LEFT$(B$,W-LEN(C$));
2820 COLOUR 2+128:COLOUR 3
2830 FOR I=1 TO 5:PRINT LEFT$(B$,W);:NEXT I
2840 COLOUR 0+128:COLOUR 1
2850 FOR I=1 TO 15:PRINT TAB(1,5+I);LEFT$(B$,15);:NEXT I
2860 COLOUR 1+128:COLOUR 3
2870 PRINT TAB(16,7);"STR";
2880 PRINT TAB(16,10);"VIT";
2890 PRINT TAB(16,13);"AUR";
2900 PRINT TAB(16,16);"FACE";
2910 PRINT TAB(16,19);"EXP";
2911 PRINT TAB(1,21);"ATT";
2912 PRINT TAB(5,21);"SPELLS";
2913 PRINT TAB(12,21);"CAN";
2914 PRINT TAB(16,21);"POT";
2920 RETURN
2930 REM *** USER DEF'D CHARACTERS ***
2940 MODE 5:VDU 23;8202;0;0;0;
2960 FOR I=0 TO 17:VDU 23,224+I
2970 FOR J=0 TO 7:READ A:VDU A
2980 NEXT J: NEXT I
3170 AS=65:C0=OS+6
3180 C1=C0+1:C2=C0+2:C3=C0+3:C4=C0+4
3190 C5=C0+6:C6=C0+7:C7=C0+8:C8=C0+12
3200 RETURN
3500 DATA 255,255,255,255,255,255,255,255
3510 DATA 56,56,16,56,84,16,40,68
3520 DATA 28,28,8,30,40,40,20,18
3530 DATA 56,56,16,84,56,40,68,40
3540 DATA 56,56,16,120,148,20,40,72
3550 DATA 0,0,0,0,8,209,254,221
3560 DATA 0,0,0,0,0,0,0,0
3570 DATA 85,170,85,170,85,170,85,170
3580 DATA 0,60,24,60,126,126,126,60
3590 DATA 0,56,100,114,95,73,41,31
3600 DATA 20,42,20,20,93,93,62,99
3610 DATA 60,126,255,255,255,253,255,255
3620 DATA 60,102,195,129,129,129,133,129
3630 DATA 129,66,36,0,0,36,66,129
3640 DATA 0,60,66,66,66,66,60,0
3650 DATA 76,158,170,190,84,30,37,88
3660 DATA 0,56,84,124,56,44,68,102
3670 DATA 0,8,28,42,127,85,65,34