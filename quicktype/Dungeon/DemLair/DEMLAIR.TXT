90 GOSUB 20500
100 DIM SO (4), AR (4), OB (8), EX (8), ZA (3), ZD (3)
105 DIM LM $ (10), ZM (10.13), GT (10.10), NS $ (5)
110 DIM LA $ (9), PA (9), DM (8), HA (4), LS $ (4), PS (4)
120 FOR I = 1 TO 4: READ LA $ (I), PA (I), DM (I), HA (I): NEXT I: FOR I = 5 TO 8: READ LA $ (I), PA (I ), DM (I): NEXT I: READ LA $ (9), PA (9)
130 FOR I = 1 TO 4: READ LS $ (I), PS (I): NEXT I
140 FOR I = 1 TO 10: READ LM $ (I): FOR J = 1 TO 13: READ ZM (I, J): NEXT J: NEXT I
150 FOR I = 1 TO 10: FOR J = 1 TO 10: READ GT (I, J): NEXT J: NEXT I
160 FOR I = 1 TO 10: FOR J = 1 TO 10: READ GD% (I, J): NEXT J: NEXT I
170 FOR I = 1 TO 5: READ N $ (I): NEXT I
200 DEF FN DE (N) = INT (N * RND (1)) + 1
300 EN = 0: HOME: F = 2: IN = 0: CO = 0: DX = 0: PU = 0
310 HTAB 8: PRINT "CHARACTER CREATION"
320 HTAB 8: PRINT "----------------------"
330 FOR I = 1 TO 3: F = F + FN DE (6): NEXT I: PRINT: PRINT "FORCE:"; F
340 FOR I = 1 TO 3: IN = IN + FN DE (6): NEXT I: PRINT "INTELLIGENCE:"; IN
350 FOR I = 1 TO 3: CO = CO + FN DE (6): NEXT I: PRINT "CONSTITUTION:"; CO
360 FOR I = 1 TO 3: DX = DX + FN DE (6): NEXT I: PRINT "DEXTERITY:"; DX
370 FOR I = 1 TO 3: PU = PU + FN DE (6): NEXT I: PRINT "POWER:"; PU: PC = PU
380 ST = CO: IF PU> 14 THEN ST = ST + 1
390 IF PU <7 THEN ST = ST - 1
400 PRINT: PRINT "LIFE POINTS:"; ST: PV = ST
410 PO = FN DE (100) + PU * 5: PRINT "PIECES D'OR:"; PO
420 MA = 5 + 5 * INT ((DX - 5) / 4) + 5 * INT ((IN + PU) / 10 - 1): PRINT: PRINT "MANIPULATION:"; MA; "%"
430 KN = 5 * INT ((IN + DX - 15) / 4) + 5 * INT ((PU - 5) / 10): PRINT "DEFENSE:"; KN; "%"
440 CA = 15 + 5 * INT ((DX - 5) / 4) + 5 * INT ((IN - PU) / 10 - 1): PRINT "CAMOUFLAGE:"; CA; "%"
450 AR (1) = 10: AR (2) = 20: AR (3) = 10: AR (4) = 5: AB = 5 * INT ((F - 7) / 3) + 5 * INT ((DX + PU + IN) / 10 - 2): PRINT: PRINT "ATTACK BONUS:"; AB; "%"
460 FOR I = 1 TO 4: AR (I) = AR (I) + AB: NEXT I
465 PRINT: PRINT "OK?" ;: GET R $: IF R $ <> "O" THEN GOTO 300
466 PRINT: INPUT "WHAT IS YOUR NAME?"; N $
470 HOME: PRINT TAB (13); "THE LIRA OF THE DEMON"
471 PRINT TAB (13); "================"
472 VTAB 5: PRINT "DO YOU WANT:"
480 PRINT: PRINT "(1) - GO TO THE MERCHANT"
490 PRINT "(2) - GO TO THE TEMPLE"
500 PRINT "(3) - ENTER THE CAVES"
510 PRINT "(4) - YOU TRAIN": PRINT "(5) - YOU PREPARE": PRINT "(6) - YOU REPOSIT"
515 PRINT: INVERSE: PRINT "WHAT ARE YOU DOING?" ;: NORMAL: GET R $
516 PRINT: PRINT
520 R = VAL (R $): ON R GOSUB 1000,2000,10000,3000,9000,9600
530 GOTO 470
1000 HOME: HTAB 12: PRINT "BIZARRE BAZAR"
1010 HTAB 12: PRINT "=============="
1020 PRINT: PRINT "ARMS": PRINT: FOR I = 1 TO 4: PRINT ""; I; ""; LA $ (I) ;: HTAB 20: PRINT PA (I); "PIECES D'OR": NEXT I
1030 PRINT: PRINT "ARMORS": PRINT: FOR I = 5 TO 8: PRINT ""; I; ""; LA $ (I) ;: HTAB 20: PRINT PA (I); "PIECES D'OR": NEXT I
1040 PRINT: PRINT "9"; LA $ (9) ;: HTAB 20: PRINT PA (9); "GOLD COINS"
1045 PRINT: PRINT "YOU REMAIN"; PO; "GOLD COINS"
1050 PRINT: INVERSE: PRINT "WHAT DO YOU WANT TO BUY?": NORMAL: GET R $: R = VAL (R $): IF R <1 OR R> 9 GOTO 1999
1060 IF PA (R)> PO GOTO 1000
1070 I = 1
1080 IF OB (I) = 0 GOTO 1100
1090 I = I + 1: IF I <9 THEN 1080
1095 PRINT "YOU ARE TOO LOADED": FOR I = 1 TO 1000: NEXT I: GOTO 1999
1100 OB (I) = R: PO = PO - PA (R): IF R> 4 GOTO 1000
1110 OB (I) = OB (I) + (HA (R) / 100): GOTO 1000
1999 RETURN
2000 HOME: HTAB 14: PRINT "SANCTUARY": HTAB 14: PRINT "=========="
2010 PRINT: PRINT "WELCOME TO THE TEMPLE, TRAVELER" 
2011 PRINT: PRINT "WANT-TU:": PRINT: PRINT "1-LEARN A FELL": PRINT "2-TAKE CARE": PRINT
2020 GET R $: R = VAL (R $): IF R = 0 GOTO 2999
2030 IF R> 2 GOTO 2000
2040 IF R = 2 GOTO 2500
2045 PRINT: PRINT "SORT";: HTAB 16: PRINT "PTS POSSEDES" ;: HTAB 30: PRINT "1 PT SUP."
2050 PRINT: FOR I = 1 TO 4: PRINT I; ""; LS $ (I) ;: HTAB 20: PRINT SO (I); "PTS";: HTAB 28: PRINT PS (I) * (SO (I ) + 1); "P.D'OR": NEXT I
2055 PRINT: INVERSE: PRINT "YOU REMAIN"; PO; "GOLD COINS": NORMAL
2060 GET R $: R = VAL (R $): IF R <1 OR R> 4 GOTO 2000
2070 IF PS (R) * (SO (R) + 1)> PO THEN PRINT "YOU DON'T HAVE ENOUGH MONEY": FOR I = 1 TO 1000: NEXT: GOTO 2000
2075 IF R = 1 AND SO (R)> 0 THEN 2200
2080 IF SO (R)> 3 THEN 2200
2100 PO = PO - PS (R) * (SO (R) + 1): SO (R) = SO (R) + 1: GOTO 2000
2200 PRINT "YOU HAVE REACHED THE MAXIMUM POINTS": PRINT "POUR LE SORT"; LS $ (R): FOR I = 1 TO 1000: NEXT I: GOTO 2000
2500 R = 100 +. 2 * PO: IF PO <R THEN R = PO
2505 IF R <40 THEN PRINT "YOU DON'T HAVE THE MEANS": FOR I = 1 TO 1000: NEXT I: GOTO 2000
2510 PRINT: PRINT "THE PRICE OF CARE IS"; R: PRINT: PRINT "WOULD YOU LIKE TO PAY?" ;: GET R $: IF R $ <> "O" THEN 2000
2520 PO = PO - R: PV = ST: GOTO 2000
2999 RETURN
3000 PRINT: PRINT "A PROUD WARRIOR MEETS YOUR CHALLENGE!": ZA (1) = 0: FOR I = 1 TO 4: ZA (1) = AR (I) + ZA (1): NEXT I: ZA (1) = ZA (1) / 4: ZD (1) = 7: ZA (2) = 0: IF ZA (1)> 45 THEN ZA (2) = ZA (1) / 2: ZD (2) = 6: ZA (3) = 0
3005 ZS = 0: IF SO (1) <> 0 THEN ZS = 1
3010 ZX = DX + FN DE (5) - 3: ZP = PC + FN DE (5) - 3: ZR = PP + FN DE (3) - 2: ZH = 5 + FN DE (13): ZT = ZA (1): GOSUB 5000: IF F3 = 0 THEN PRINT "YOU POCKET THE WINNER'S BONUS": PRINT: PRINT ZT; "PIECES D'OR": PO = PO + ZT
3015 IF F3 = 1 OR EN = 1 THEN FOR I = 1 TO 8: EX (I) = 0: NEXT I
3020 EN = 1: RETURN
4000 PRINT: PRINT "A SILHOUETTE IS PROFILEING BEFORE YOU": PRINT "WHAT ARE YOU DOING:": PRINT "(1) -You are hiding": PRINT "(2) -You will draw an arrow": PRINT "(3) - YOU PUT YOURSELF INTO POSITION "
4010 GET R $: R = VAL (R $): PRINT "C'EST UN"; LM $ (M): ON R GOTO 4100,4200,5000
4100 R = FN DE (100): IF R> 95 THEN 4150
4105 IF CA <R THEN 4150
4110 EX (8) = 1: PRINT "IT IS GOING WITHOUT SEEING YOU": PRINT "WOULD YOU LIKE": PRINT "(1) - LET IT GO": PRINT "(2) - ATTACK IT BY SURPRISE": GET R $ : R = VAL (R $): ON R GOTO 4120,4130
4120 PRINT: PRINT "IL S'EN VA": RETURN
4130 F2 = 1: GOSUB 6000: GOTO 5000
4150 R2 = WP: WP = O: PRINT "HE SEEN YOU AND HITS YOU BY SURPRISE": GOSUB 7000: WP = R2: GOTO 5000
4200 IF INT (OB (WP)) = 3 THEN 4220
4210 PRINT "YOU HAVE NO ARC IN HAND": GOTO 5000
4220 R2 = FN DE (2): PRINT "YOU HAVE TIME TO SHOOT"; R2; "ARROWS"
4230 F2 = 1: GOSUB 6000: R2 = R2 - 1: IF R2> 0 GOTO 4230
4240 GOTO 5000
5000 AI = 0: PT = 0: F1 = 0: F3 = 0: F2 = 0
5002 PRINT: PRINT "MELEE": PRINT "====="
5005 PRINT "YOU REMAIN"; PV; "PT OF LIFE": PRINT "AND"; PC; "PT OF POWER"
5010 PRINT "WHAT ARE YOU DOING THIS TURN:": PRINT "(1) - WEAR"
5020 PRINT "(2) -JET A SPELL": PRINT "(3) -FUIR": PRINT "(4) -TOP ANOTHER WEAPON"
5030 GET R $: R = VAL (R $): ON R GOTO 5100,5400,5200,5300
5100 IF F2 = 1 GOTO 5180
5110 IF ZX> DX THEN 5130
5120 GOSUB 6000: IF F1 = 1 THEN RETURN
5123 IF F2 = 0 THEN GOSUB 7000: IF F1 = 1 THEN RETURN
5125 GOTO 5002
5130 GOSUB 7000: IF F1 = 1 THEN RETURN
5135 GOSUB 6000: IF F1 = 1 THEN RETURN
5140 GOTO 5002
5180 GOSUB 6000: IF F1 = 1 THEN RETURN
5185 F2 = 0: GOTO 5002
5200 IF DX> ZX THEN 5220
5205 IF F2 = 1 GOTO 5220
5210 GOSUB 7000
5220 F3 = 1: RETURN
5300 FOR I = 1 TO 8: PRINT I; "-"; LA $ (OB (I)): NEXT I
5310 PRINT "WHAT EQUIPMENT NUMBER": GET R $: R = VAL (R $): IF OB (R) <5 AND OB (R)> 0 THEN WP = R: DG = DM (OB (R))
5320 IF F2 = 1 THEN F2 = 0: GOTO 5002
5330 GOSUB 7000: IF F1 = 1 THEN RETURN
5340 GOTO 5002
5400 FOR I = 1 TO 4: PRINT I; "-"; LS $ (I); ""; SO (I): NEXT I
5410 PRINT: PRINT "WHAT KIND WOULD YOU LIKE": GET R $: R = VAL (R $): ON R GOTO 5600,5450,5500,5550
5420 IF F2 = 1 GOTO 5440
5430 GOSUB 7000: IF F1 = 1 THEN RETURN
5440 F2 = 0: GOTO 5002
5450 PRINT "YOU KNOW"; SO (R); "PT": PRINT "HOW MANY PT ARE YOU USING";: GET R $: I = VAL (R $): IF I> SO (R) OR I> PC THEN PRINT "BE REASONABLE ..": GOTO 5420
5460 PC = PC - 1: A1 = I: GOTO 5420
5500 PRINT "YOU KNOW"; SO (R); "PT": PRINT "HOW MANY PT ARE YOU USING";: GET R $: I = VAL (R $): IF I> SO (R) OR I> PC THEN PRINT "BE REASONABLE ..": GOTO 5420
5510 PV = PV + I: IF PV> ST THEN PV = ST
5520 PC = PC - I: GOTO 5420
5550 PRINT "YOU KNOW"; SO (R); "PT": PRINT "HOW MANY PT ARE YOU USING";: GET R $: I = VAL (R $): IF I> SO (R) OR I> PC THEN PRINT "BE REASONABLE ..": GOTO 5420
5560 PT = I: PC = PC - I: GOTO 5420
5600 IF SO (1) = 0 THEN PRINT "YOU DON'T KNOW THIS FELL": GOTO 5420
5605 IF PC = 0 THEN PRINT "YOU HAVE NO MORE POINTS": GOTO 5420
5610 PRINT "YOU ARE TRYING TO OVERCOME ITS RESISTANCE": R = FN DE (100): IF R <05 THEN 5650
5620 IF R> 95 THEN 5640
5630 IF (PC - ZP) * 5> R - 50 THEN 5650
5640 PRINT: PRINT "YOU FAIL ..": PC = PC - 1: GOTO 5420
5650 PC = PC - 1: EX (5) = 1: PRINT "IT IS REACHED": D = FN DE (3): ZH = ZH - D: IF ZH <0 THEN PRINT "IT IS DEAD": RETURN
5660 GOTO 5420
6000 IF WP = 0 THEN PRINT "YOU HAVE NO WEAPON IN HAND.": RETURN
6005 PRINT: PRINT "YOU ARE TRYING TO TOUCH IT";: R = FN DE (100): PRINT ""; R: IF R <05 THEN 6100
6010 IF R> 95 THEN 6030
6020 IF R + ZF <AR (OB (WP)) + A1 * 5 THEN 6100
6030 PRINT "MISSING YOU": RETURN
6100 EX (OB (WP)) = 1: R1 = FN DE (100): IF F2 = 0 AND R1 <ZA (1) THEN 6150
6110 PRINT "YOUR COUP DOOR": D = FN DE (DG) + A1: IF 20 * R <AR (OB (WP)) + A1 * 5 THEN 6140
6115 IF (INT (OB (WP)) = 3 OR INT (OB (WP)) = 4) AND 5 * R <AR (OB (WP)) + A1 * 5 THEN 6160
6120 IF D <= ZR THEN PRINT "BUT DOES NOT CROSS ITS ARMOR": RETURN
6130 D = D - ZR
6132 ZH = ZH - D: IF ZH <0 THEN F1 = 1: PRINT: PRINT "IT IS DEAD": RETURN
6135 PRINT: PRINT "HE IS HURT": RETURN
6140 PRINT "THE KICK IS CRITICAL": GOTO 6132
6150 PRINT "IT PREVENTS YOUR BLOW": IF FN DE (5) = 1 THEN PRINT "ITS WEAPON IS BREAKING": F2 = 1
6155 RETURN
6160 PRINT "YOUR ARME A TRANSPERCE": D = D + DG - ZR: GOTO 6132
7000 IF ZS = 0 GOTO 7020
7010 IF FN DE (100) <4 * ZP THEN 7200
7020 IF FN DE (7)> ​​ZH THEN 7270
7030 P1 = 0: I = 1
7035 IF ZA (I) = 0 THEN RETURN
7040 PRINT "IT IS ATTACKING YOU": R = FN DE (100): IF R> 95 THEN 7180
7050 IF R <05 THEN 7065
7060 IF R + KN> ZA (I) THEN 7180
7065 IF P1 <> 0 THEN 7100
7067 IF WP = 0 GOTO 7100
7070 PRINT "HIS STROKE SEEMS TERRIBLE": INPUT "TRY TO PREVENT"; R $: IF LEFT $ (R $, 1) <> "O" THEN 7100
7075 P1 = 1: R = FN DE (100): IF AR (OB (WP))> R THEN 7085
7080 PRINT "YOU DID NOT SUCCEED": GOTO 7100
7085 PRINT "YOU STOP YOUR STROKE": D1 = 100 * (OB (WP) - INT (OB (WP))): D1 = D1 - FN DE (ZD (I)): OB (WP) = INT (OB ( WP)) + D1 / 100: IF D1 <1 THEN PRINT "YOUR WEAPON IS BROKEN": OB (WP) = 0: WP = 0
7086 I = I + 1: IF I> 3 THEN RETURN
7087 GOTO 7035
7100 PRINT "YOU ARE TOUCHED": IF 20 * R <ZA (I) GOTO 7170
7105 R = FN DE (ZD (I)): IF R <= PP + PT THEN PRINT "THE SHOT DOESN'T CROSS YOUR ARMOR": GOTO 7175
7110 R = R - (PT + PP)
7115 PRINT "YOU LOSE"; R "LIFE PT": PV = PV - R: IF PV <0 THEN PRINT "YOU ARE DEAD ...": END
7120 GOTO 7175
7170 PRINT "AIE .. THE KICK IS CRITICAL": R = FN DE (ZD (I)): GOTO 7115
7175 I = I + 1: IF I> 3 THEN RETURN
7176 GOTO 7035
7180 IF R <= ZA (I) THEN PRINT "YOUR DEFENSE PROTECTS YOU": EX (7) = 1
7185 PRINT "SON COUP MISSED": GOTO 7175
7200 PRINT "IT IS THROWING A SPELL": R = FN DE (100): IF R <6 THEN 7250
7210 IF R> 95 THEN 7230
7220 IF (ZP - PC) * 5> R - 50 THEN 7250
7230 PRINT "YOU RESIST ..": ZP = ZP - 1: RETURN
7250 PRINT "A MENTAL ATTACK": R = FN DE (3): PRINT "YOU LOSE"; R; "LIFE PT": PV = PV - R: IF PV <0 THEN PRINT "YOU ARE DEAD ..": END
7260 ZP = ZP - 1: RETURN
7270 PRINT: PRINT "IT LEAKS": F1 = 1: RETURN
9000 HOME: HTAB 14: PRINT N $: HTAB 14: FOR I = 1 TO LEN (N $): PRINT "=" ;: NEXT I
9010 PRINT: PRINT "FORCE:"; F;: HTAB 20: PRINT "PT VIE MAX"; ST
9020 PRINT "INT.:"; IN;: HTAB 20: PRINT "PT VIE"; PV
9030 PRINT "CONST.:"; CO: PRINT "DEXT.:"; DX;: HTAB 20: PRINT "P. D'OR"; PO
9040 PRINT "POWER:"; PC; "("; PU; ")": HTAB 20: PRINT "BONUS ATTACK"; AB; "%"
9050 HTAB 20: PRINT "MANIPULATION"; MA; "%"
9060 PRINT "DEFENSE"; KN; "%" ;: HTAB 20: PRINT "CAMOUFLAGE"; CA; "%"
9070 INVERSE: PRINT "SORTS:": NORMAL: FOR I = 1 TO 3 STEP 2: PRINT I; "-"; LS $ (I); ""; SO (I) ;: HTAB 22: PRINT I + 1; "-"; LS $ (I + 1); ""; SO (I + 1): NEXT I
9080 INVERSE: PRINT "EQUIPMENT:": NORMAL: FOR I = 1 TO 7 STEP 2: PRINT I; "-"; LA $ (OB (I)); "";: HTAB 22: PRINT I + 1; "- "; LA $ (OB (I + 1)): NEXT I
9090 INVERSE: PRINT "ATTACK PROBABILITY": NORMAL: FOR I = 1 TO 3 STEP 2: PRINT LA $ (I); ""; AR (I); "%" ;: HTAB 22: PRINT LA $ (I +1); ""; AR (I + 1); "%": NEXT I
9100 PRINT: PRINT "YOU ARE WEARING:";: IF AP <> 0 THEN PRINT LA $ (OB (AP));
9110 PRINT: PRINT "BY MAIN:";: IF WP <> 0 THEN PRINT LA $ (OB (WP));
9120 GET R $: PRINT
9125 PRINT "DO YOU WANT:"
9130 PRINT "1- PUT AN ARMOR": PRINT "2- TAKE A WEAPON": PRINT "3- THROW AN OBJECT": PRINT "4- Heal yourself"
9140 GET R $: R = VAL (R $): ON R GOTO 9200,9300,9500,9350
9150 RETURN
9200 PRINT: INPUT "WHICH EQUIPMENT NUMBER?"; R: IF OB (R)> 4 AND OB (R) <9 THEN AP = R: PP = DM (OB (R))
9210 GOTO 9000
9300 PRINT: INPUT "WHICH EQUIPMENT NUMBER?"; R: IF OB (R) <5 THEN WP = R: DG = DM (OB (R))
9310 GOTO 9000
9350 PRINT: PRINT "WANT (1) - DRINK A POTION": PRINT "(2) - USE A SPELL": GET R $: R = VAL (R $): ON R GOTO 9400.9460
9360 GOTO 9000
9400 I = 0
9410 I = I + 1: IF I> 8 GOTO 9450
9420 IF OD (I) <> 9 GOTO 9410
9430 OB (I) = 0: PV = PV + 2: IF PV> ST THEN PV = ST
9440 PRINT "SLURP ...": FOR I = 1 TO 1000: NEXT I: GOTO 9000
9450 PRINT "YOU HAVE NO POTION": FOR I = 1 TO 1000: NEXT I: GOTO 9000
9460 IF SO (3) = 0 THEN PRINT "YOU HAVE NO HEALING POINT": FOR I = 1 TO 1000: NEXT I: GOTO 9000
9470 PRINT "YOU MAY USE"; SO (3); "POINTS": INPUT "HOW MUCH POWER ARE YOU USING"; R
9480 IF R> SO (3) OR R> PC THEN PRINT "BE REASONABLE!": FOR I = 1 TO 1000: NEXT I
9490 PC = PC - R: PV = PV + R: IF PV> ST THEN PV = ST
9495 GOTO 9000
9500 PRINT: PRINT "WHAT OBJECT DO YOU WANT TO DISCARD": GET R $: R = VAL (R $): IF R = 0 GOTO 9000
9510 OB (R) = 0: IF R = AP THEN AP = 0
9520 IF R = WP THEN WP = 0
9530 GOTO 9000
9600 PRINT: PRINT "YOU FEEL BETTER": PC = PU
9610 FOR I = 1 TO 4: IF EX (I) = 1 THEN IF 100 + IN - AR (I)> FN DE (100) THEN PRINT "+ 5% WITH"; LA $ (I); "->" ;: AR (I) = AR (I) + 5: PRINT AR (I)
9615 NEXT I
9620 IF EX (5) = 1 THEN IF (18 - PU) * 5> FN DE (100) THEN PRINT "YOUR POWER INCREASES BY 1";: PU = PU + 1: PC = PC + 1
9630 IF EX (6) = 1 THEN IF 100 + IN - MA> FN DE (100) THEN MA = MA + 5: PRINT "MANIPULATION ->"; MA
9640 IF EX (7) = 1 THEN IF IN> = FN DE (100) THEN KN = KN + 5: PRINT "DEFENSE ->"; KN
9650 IF EX (8) = 1 THEN IF 100 + IN - CA> FN DE (100) THEN CA = CA + 5: PRINT "CAMOUFLAGE ->"; CA
9660 FOR I = 1 TO 8: EX (I) = 0: NEXT: FOR I = 1 TO 1000: NEXT I: RETURN
10000 I3 = 1: J3 = 5: DP = 0
10002 HOME
10005 H1 $ = STR $ (GD% (I3, J3))
10010 PRINT "YOU ARE IN"; N $ (VAL (LEFT $ (H1 $, 1)))
10020 ON VAL (MID $ (H1 $, 2,1)) GOTO 10100,10200,10300
10030 IF FN DE (100)> 15 GOTO 10500
10040 IF I3 <6 AND J3 <7 THEN M = FN DE (4): GOTO 10105
10041 IF I3> 5 AND J3 <7 THEN M = 3 + FN DE (4): GOTO 10105
10042 IF J3> 6 THEN M = 5 + FN DE (4): GOTO 10105
10100 M = VAL (RIGHT $ (H1 $, 1))
10105 GOSUB 20100: IF F3 = 0 THEN ZT = ZT + FN DE (20) - 10: PRINT "YOU FIND"; ZT; "PIECES D'OR": PO = PO + ZT: GOSUB 20200: GOTO 10500
10110 R = FN DE (4): IF MID $ (H $, R, 1) = "1" GOTO 20050
10120 GOTO 10005
10200 PRINT: PRINT "THERE IS A CHEST": PRINT "YOU CAN:": PRINT "(1) - LEAVE IT": PRINT "(2) - TRY TO OPEN": GET R $: R = VAL ( R $): ON R GOTO 10500,10220
10210 GOTO 10500
10220 IF MA> FN DE (100) THEN 10260
10225 PRINT "YOU FAIL": IF FN DE (100)> PU * 5 THEN PRINT "..... BAOUMMM! .....": R = FN DE (6): PV = PV - R: PRINT " YOU LOSE "; R;" PT OF LIFE ": GOTO 10280
10230 GOSUB 20200: GOTO 10200
10260 EX (6) = 1: ZT = FN DE (100) * VAL (RIGHT $ (H1 $, 1)): PRINT: PRINT "IT CONTAINS THE FABULOUS SUM OF": PRINT ""; ZT; "PIECES D ' OR ": PO = PO + ZT: GOSUB 20200: GOTO 10500
10280 IF PV <0 THEN PRINT: PRINT "WHAT A SAD END OF ENDING IN A BOIL!" : END
10290 GOTO 10500
10300 PRINT: PRINT "THE GROUND IS RIPPING UNDER YOUR FEET ...": FOR I = 1 TO 1000: NEXT I: PRINT "YOU TAKE BACK TO KNOWLEDGE";
10310 FOR I = 1 TO 3: R = FN DE (8): IF INT (OB (R)) = 0 THEN 10380
10320 PRINT "DAMNATION, YOUR"; LA $ (OB (R)); "MISSING": OB (R) = 0
10380 NEXT I
10390 PRINT: PRINT "YOU GET OUT OF THE HATCH": GOTO 10500
10500 GOSUB 20000: DP = DP + 1: IF DP = 10 THEN DP = 0: PC = PC + 1: IF PC> PU THEN PC = PU
10505 IF I3 = 0 THEN RETURN
10510 PRINT: GOTO 10005
20,000 H $ = STR $ (INT (GT (I3, J3))): H $ = RIGHT $ ("0000" + H $, 4)
20005 PRINT "YOU CAN GO:"
20010 IF MID $ (H $, 1,1) = "1" THEN PRINT "1-A L'OUEST"
20015 IF MID $ (H $, 2,1) = "1" THEN PRINT "2-NORTH"
20020 IF MID $ (H $, 3,1) = "1" THEN PRINT "3-A L'EST"
20025 IF MID $ (H $, 4,1) = "1" THEN PRINT "4-AU SUD"
20027 PRINT: PRINT "5-PREPARING"
20030 PRINT: INVERSE: PRINT "WHAT ARE YOU DOING?";: NORMAL: GET R $: PRINT: IF R $ = "P" THEN PRINT "YOUR POSITION IS ("; I3; ","; J3; ")": PRINT: GOTO 20005
20031 R = VAL (R $): IF R <1 OR R> 5 THEN 20030
20035 IF R = 5 GOTO 20095
20040 IF MID $ (H $, R, 1) <> "1" THEN 20030
20050 ON R GOTO 20060,20070,20080,20090
20060 J3 = J3 - 1: RETURN
20070 I3 = I3 + 1: RETURN
20080 J3 = J3 + 1: RETURN
20090 I3 = I3 - 1: RETURN
20095 GOSUB 9000: GOTO 20005
20100 ZF = ZM (M, 1): FOR I = 1 TO 3: ZA (I) = ZM (M, 2 * I): ZD (I) = ZM (M, 2 * I + 1): NEXT I: ZS = ZM (M, 8): ZX = ZM (M, 9): ZP = ZM (M, 10): ZR = ZM (M, 11): ZH = ZM (M, 12): ZT = ZM (M , 13): GOTO 4000
20200 H1 $ = LEFT $ (H1 $, 1) + "00": GD% (I3, J3) = VAL (H1 $): RETURN
20499 REM ***** INTRO *****
20500 HOME: GR
20510 FOR Y = 0 TO 39
20530 FOR X = 0 TO 39
20540 READ CO
20550 COLOR = CO
20560 PLOT X, Y
20570 NEXT X 
20580 NEXT Y
20585 VTAB 21: PRINT TAB (9) ;: INVERSE: PRINT "*** THE DEMON'S LAIR ***": NORMAL
20590 PRINT: PRINT "Frederic Neuville - SVM 7 - June 1984"
20591 PRINT "Improvement D. Rioual - November 2018";
20595 GET R $
20600 TEXT: HOME
20610 RETURN
29999 REM ***** IMAGE ENCODING INTRO *****
30000 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30010 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30020 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30030 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5, 0, 0, 5, 0, 9, 9, 9, 1, 10, 9, 9, 9, 9, 5, 0, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0
30040 DATA 0, 0, 0, 0, 0, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 9, 9, 11, 9, 9, 9, 10, 10, 15, 10, 10, 10, 10, 10, 10, 10, 10, 0, 0, 0, 0, 0
30050 DATA 0, 0, 0, 0, 10, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 10, 5, 0, 0, 0
30060 DATA 0, 0, 0, 10, 15, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 15, 10, 0, 0, 0
30070 DATA 0, 0, 15, 10, 15, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 5, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 15, 10, 0, 0
30080 DATA 0, 0, 10, 10, 10, 10, 5, 5, 5, 5, 5, 5, 5, 5, 5, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 10, 10, 10, 5, 0
30090 DATA 0, 0, 10, 10, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 5, 5, 10, 10, 10, 0
30100 DATA 0, 0, 10, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 10, 10, 0
30110 DATA 0, 0, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, 9, 9, 9, 1, 1, 9, 9, 9, 9, 1, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 10, 10, 0
30120 DATA 0, 10, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 9, 1, 9, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 0
30130 DATA 0, 5, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 9, 9, 1, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 0
30140 DATA 0, 0, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 10, 0
30150 DATA 0, 0, 10, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 9, 9, 9, 1, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 5, 0
30160 DATA 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 13, 0, 9, 9, 9, 9, 9, 9, 9, 9, 9, 13, 1, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0
30170 DATA 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 1, 13, 13, 9, 9, 9, 9, 9, 9, 9, 13, 8, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0
30180 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 8, 0, 0, 0, 1, 0, 0, 0, 0, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0
30190 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, 9, 9, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30200 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 1, 9, 9, 9, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30210 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 1, 9, 9, 9, 0, 9, 9, 15, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30220 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, 9, 9, 0, 0, 9, 0, 1, 9, 1, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30230 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 15, 9, 9, 0, 9, 1, 9, 1, 8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30240 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 15, 9, 9, 1, 9, 9, 1, 13, 0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30250 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 13, 9, 9, 9, 9, 15, 13, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30260 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 13, 13, 13, 13, 15, 13, 0, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30270 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 13, 8, 8, 0, 13, 13, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30280 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, 9, 13, 13, 13, 13, 13, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30290 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 13, 13, 13, 13, 13, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30300 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 13, 13, 13, 13, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30310 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 13, 13, 8, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30320 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 9, 1, 11, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30330 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30340 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 1, 0, 1, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30350 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30360 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30370 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30380 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
30390 DATA 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
50000 DATA SWORD, 30,8,25, MASS, 15,6,20, ARC, 30,6,1, LANCE, 25,8, 15, COAT, 10,1, BOILED LEATHER, 40,3, MESH COTTON , 80.5, PLATE ARMOR, 300.6, POTION, 50
50010 DATA MENTAL ATTACK, 300, FINE BLADE, 400, CARE, 200, PROTECTION, 300
50020 DATA GOBLIN, 0,30,6,0,0,0,0,0,0,14,6,3,8,10
50030 DATA ORC, 5,45,7,0,0,0,0,0,0,12,8,3,11,20
50040 DATA BANDIT, 10,50,8,20,6,0,0,0,15,11,4,12,30
50050 DATA TROLL, 5,40,7,40,7,0,0,0,11,8,4,14,50
50060 DATA OGRE, 10,60,8,0,0,0,0,0,0,11,8,4,16,60
50070 DATA MAGE, 30,40,6,0,0,0,0,0,1,13,18,2,10,70
50080 DATA SHAMANE, 25,60,7,0,0,0,0,0,1,14,15,3,13,100
50090 DATA NINJA, 35,60,9,60,7,60,6,0,18,8,3,10,300
50100 DATA BLACK WARRIOR, 25,80,8,0,0,0,0,0,1,12,12,5,16,600
50110 DATA DEMON, 40,90,10,60,6,60,6,1,60,15,6,20,10000

50120 DATA 0110,1000,0110,1010,1111,1100,0110,0110,1110,1100
50130 DATA 0111,1100,0101,0100,0101,0101,0101,0011,1111,1001
50140 DATA 0101,0101,0111,1111,1001,0101,0111,1100,0101,0100
50150 DATA 0101,0011,1011,1111,1010,1001,0101,0011,1001,0101
50160 DATA 0011,1000,0010,1011,1010,1100,0111,1100,0100,0101
50170 DATA 0110,1010,1010,1010,1010,1101,0011,1011,1011,1101
50180 DATA 0101,0110,1010,1010,1100,0101,0110,1110,1110,1101
50190 DATA 0101,0101,0010,1010,1001,0101,0111,1011,1011,1001
50200 DATA 0101,0101,0110,1110,1010,1001,0011,1010,1010,1100
50210 DATA 0011,1011,1001,0011,1010,1010,1010,1010,1010,1001
50220 DATA 200,113,200,200,100, 200,200,100,100,523
50230 DATA 100,200,200,321,200, 200,200,200,410,200
50240 DATA 300,200,130,100,200,200,119,200,200,323
50250 DATA 300,200,100,112,200, 200,200,200,200,300
50260 DATA 314,321,100,100,200,200,130,200,122,300
50270 DATA 200,200,200,200,200, 200,200,100,100,118
50280 DATA 215,316,300,300,300, 200,200,130,100,100
50290 DATA 200,300,330,300,300, 216,118,100,100,130
50300 DATA 200,300,200,100,200, 200,200,200,200,200
50310 DATA 200,100,200,217,200, 200,200,200,200,200
50320 DATA A VAULTED ROOM, A DARK CORRIDOR, A WET CELLAR, THE DEMON'S LAIR, THE TREASURE ROOM




