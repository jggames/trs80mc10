5 REM FOUND ON AN ARCHIVED 6800 FLEX 2 GAMES DISK
6 REM MODIFIED LIGHTLY FOR ALTAIR BASIC BY DAVE HASSLER '23
10 PRINT:PRINT"     * * *   H A T E   * * *"
20 PRINT:INPUT"DO YOU REQUIRE INSTRUCTIONS";A$
30 IF LEFT$(A$,1)="Y" THEN GOSUB 9000
90 DIM C(52),H1(52),H2(52)
100 GOSUB 8000
110 FOR S=1TO3
120 H1(S)=C(S)
130 H2(S)=C(S+3)
140 NEXT S
150 N1=3:N2=3:D=8
160 U=C(7)
170 IF N2=0GOTO4005
173 PRINT "I HAVE ";N1;"CARDS IN MY HAND."
175 GOSUB 5900
180 INPUT"DRAW OR PLAY";A$
190 IF LEFT$(A$,1)="D"GOTO1000
200 B$=MID$(A$,2,1)
210 IF B$="D" THEN W=0:GOTO300
220 IF B$="C" THEN W=13:GOTO300
230 IF B$="H" THEN W=26:GOTO300
240 IF B$="S" THEN W=39:GOTO300
250 PRINT "INVALID SUIT"
260 GOTO 180
300 B$=LEFT$(A$,1)
305 IF B$="A" THEN W=W+1:GOTO500
310 IF B$="1" THEN W=W+1:GOTO500
320 IF B$="2" THEN W=W+2:GOTO500
330 IF B$="3" THEN W=W+3:GOTO500
340 IF B$="4" THEN W=W+4:GOTO500
350 IF B$="5" THEN W=W+5:GOTO500
360 IF B$="6" THEN W=W+6:GOTO500
370 IF B$="7" THEN W=W+7:GOTO500
380 IF B$="8" THEN W=W+8:GOTO500
390 IF B$="9" THEN W=W+9:GOTO500
400 IF B$="T" THEN W=W+10:GOTO500
410 IF B$="J" THEN W=W+11:GOTO500
420 IF B$="Q" THEN W=W+12:GOTO500
430 IF B$="K" THEN W=W+13:GOTO500
440 PRINT "INVALID CARD"
450 GOTO 180
500 S1=INT((W-1)/13)+1
510 S2=W-((S1-1)*13)
520 S3=INT((U-1)/13)+1
530 S4=U-((S3-1)*13)
540 IF S2=11GOTO600
550 IF S2=S4GOTO600
560 IF S1=S3GOTO600
570 PRINT "YOU MUST FOLLOW SUIT."
580 GOTO 180
600 GOTO 5700
605 U=W
607 IF S2=11GOTO800
610 IF S2=8GOTO640
620 IF S2=13GOTO640
630 GOTO 660
640 PRINT "YOU GET ANOTHER TURN."
650 GOTO 170
660 IF S2=4GOTO700
670 IF S2=2GOTO700
680 GOTO 4000
700 PRINT "I HATE A";S2;"."
710 FOR S=1TOS2
720 N1=N1+1
725 GOSUB 5600
730 H1(N1)=C(D)
740 D=D+1
750 IF D>52 THEN GOSUB 8000
760 NEXT S
770 GOTO 640
800 INPUT"WHAT SUIT DO YOU WISH TO CHANGE TO";A$
810 B$=LEFT$(A$,1)
820 IF B$="D"THEN U=11:GOTO880
830 IF B$="C"THEN U=24:GOTO880
840 IF B$="H"THEN U=37:GOTO880
850 IF B$="S"THEN U=50:GOTO880
860 PRINT "INVALID SUIT."
870 GOTO 800
880 GOTO 4000
1000 GOSUB 5600
1005 W=C(D)
1010 D=D+1
1020 IF D>52 THEN GOSUB 8000
1030 N2=N2+1
1040 H2(N2)=W
1050 PRINT "YOU DREW ";
1060 GOSUB 5000
1070 INPUT "CAN YOU PLAY IT";A$
1080 IF LEFT$(A$,1)="N"GOTO4000
1090 S1=INT((W-1)/13)+1
1095 S3=INT((U-1)/13)+1
1100 S2=W-((S1-1)*13)
1105 S4=U-((S3-1)*13)
1110 IF S1=S3GOTO500
1120 IF S2=S4GOTO500
1130 IF S2=11GOTO500
1140 PRINT "YOU CANNOT PLAY THAT CARD."
1150 GOTO 4000
4000 D7=0:C7=0:H7=0:S7=0:J7=0
4003 IF T=1 THEN GOSUB 6100
4005 IF N2=0THENPRINT"YOU WIN - LUCKY.":END
4010 FOR S=1TON1
4020 IF H1(S)<14THEND7=D7+1:GOTO4060
4030 IF H1(S)<27THENC7=C7+1:GOTO4060
4040 IF H1(S)<40THENH7=H7+1:GOTO4060
4050 S7=S7+1
4060 S3=INT((H1(S)-1)/13)+1
4063 S4=H1(S)-((S3-1)*13)
4065 IF S4=11THENJ7=S
4070 NEXT S
4080 S3=INT((U-1)/13)+1
4090 S4=U-((S3-1)*13)
4100 FOR S=1TON1
4110 IF H1(S)=(S3-1)*13+4GOTO4300
4120 IF H1(S)=(S3-1)*13+2GOTO4301
4130 IF H1(S)=(S3-1)*13+13GOTO4700
4140 IF H1(S)=(S3-1)*13+8GOTO4700
4150 NEXT S
4160 FOR S=1TON1
4165 S1=INT((H1(S)-1)/13)+1
4170 S2=H1(S)-((S1-1)*13)
4175 IF S1=S3 THEN IF S2<>11 GOTO 4900
4180 NEXT S
4183 GOTO 4820
4185 IF J7>0GOTO4500
4190 GOSUB 5600
4200 W=C(D)
4210 D=D+1
4220 IF D>52 THEN GOSUB 8000
4230 N1=N1+1
4240 H1(N1)=W
4250 S=N1
4260 S1=INT((H1(S)-1)/13)+1
4270 S2=H1(S)-((S1-1)*13)
4275 IF S2=11THENJ7=N1:GOTO4500
4277 IF S2=S4GOTO7000
4280 IF S1<>S3THENPRINT"I DREW AND COULDN'T PLAY.":GOTO170
4285 IF S2=4GOTO4305
4286 IF S2=2GOTO4305
4287 IF S2=13GOTO4700
4288 IF S2=8GOTO4700
4290 GOTO 4900
4295 GOTO 170
4300 S2=4:GOTO4305
4301 S2=2
4305 PRINT "HA HA! I PLAY THE ";
4310 W=H1(S)
4315 U=W
4320 GOSUB 5000
4330 FOR W=1TOS2
4340 N2=N2+1
4350 GOSUB 5600
4360 H2(N2)=C(D)
4370 D=D+1
4380 IF D>52 THEN GOSUB 8000
4390 NEXT W
4395 IF S=N1THENH1(N1)=0:GOTO4430
4400 FOR S=S TON1
4410 H1(S)=H1(S+1)
4420 NEXT S
4430 N1=N1-1
4435 IF N1=0GOTO4800
4440 GOTO 4000
4500 PRINT "I PLAY A JACK AND CALL IT ";
4510 IF D7>=C7THENIFD7>=H7THENIFD7>=S7THENPRINT"DIAMONDS.":W=1:GOTO4550
4520 IF C7>=D7THENIFC7>=H7THENIFC7>=S7THENPRINT"CLUBS.":W=2:GOTO4550
4530 IF H7>=D7THENIFH7>=C7THENIFH7>=S7THENPRINT"HEARTS.":W=3:GOTO4550
4540 PRINT "SPADES.":W=4
4550 S=J7
4555 U=(W-1)*13+11
4560 IF S=N1 THEN H1(N1)=0:GOTO4600
4570 FOR S=S TON1
4580 H1(S)=H1(S+1)
4590 NEXT S
4600 N1=N1-1
4605 IF N1=0GOTO4800
4610 GOTO 170
4700 PRINT "I PLAY THE ";
4710 W=H1(S)
4720 U=W
4730 GOSUB 5000
4740 PRINT "I GET ANOTHER TURN."
4750 GOTO 4395
4800 PRINT "MY SKILL WINS AGAIN!"
4810 END 
4820 FOR S=1TON1
4830 S1=INT((H1(S)-1)/13)+1
4840 S2=H1(S)-((S1-1)*13)
4850 IF S2=S4GOTO7000
4860 NEXT S
4870 GOTO 4185
4900 PRINT "I PLAY THE ";
4910 W=H1(S)
4920 GOSUB 5000
4930 U=H1(S)
4940 GOTO 4560
5000 S1=INT((W-1)/13)+1
5010 S2=W-((S1-1)*13)
5020 IF S2>7GOTO5040
5030 ON S2GOTO5050,5060,5070,5080,5090,5100,5110
5040 ON S2-7GOTO5120,5130,5140,5150,5160,5170
5050 PRINT "  ACE";
5055 GOTO 5180
5060 PRINT "  TWO";
5065 GOTO 5180
5070 PRINT "THREE";
5075 GOTO 5180
5080 PRINT " FOUR";
5085 GOTO 5180
5090 PRINT " FIVE";
5095 GOTO 5180
5100 PRINT "  SIX";
5105 GOTO 5180
5110 PRINT "SEVEN";
5115 GOTO 5180
5120 PRINT "EIGHT";
5125 GOTO 5180
5130 PRINT " NINE";
5135 GOTO 5180
5140 PRINT "  TEN";
5145 GOTO 5180
5150 PRINT " JACK";
5155 GOTO 5180
5160 PRINT "QUEEN";
5165 GOTO 5180
5170 PRINT " KING";
5180 ON S1GOTO5190,5200,5210,5220
5190 PRINT " OF DIAMONDS.":GOTO5230
5200 PRINT " OF CLUBS.":GOTO5230
5210 PRINT " OF HEARTS.":GOTO5230
5220 PRINT " OF SPADES."
5230 RETURN 
5600 IF C(D)<>0THENRETURN
5610 D=D+1
5620 IF D>52 THEN GOSUB 8000
5630 GOTO 5600
5700 FOR S=1TON2
5710 IF H2(S)=W GOTO5750
5720 NEXT S
5730 PRINT "YOU DON'T HAVE THAT CARD."
5740 GOTO 180
5750 FOR R=S TON2
5760 H2(R)=H2(R+1)
5770 NEXT R
5780 N2=N2-1
5790 GOTO 605
5900 PRINT TAB(20);"*** DISCARD = ";
5910 W=U
5920 GOSUB 5000
6000 FOR S=1TON2
6010 W=H2(S)
6020 GOSUB 5000
6030 NEXT S
6040 RETURN 
6100 FOR S=1TON1
6110 W=H1(S)
6115 PRINT TAB(25);
6120 GOSUB 5000
6130 NEXT S
6140 RETURN 
7000 IF S2=4GOTO4305
7010 IF S2=2GOTO4305
7020 IF S2=13GOTO4700
7030 IF S2=8GOTO4700
7040 GOTO 4900
8000 PRINT "SHUFFLING"
8005 FOR S=1TO52
8010 C(S)=S
8015 NEXT S
8020 GOSUB 8200
8030 FOR S=1TO52
8040 R=INT(RND(1)*52+1)
8050 H=C(S)
8060 C(S)=C(R)
8070 C(R)=H
8080 NEXT S
8085 D=1: S=1
8090 RETURN 
8200 IF N1=0GOTO8225
8205 FOR S=1TON1
8210 C(H1(S))=0
8220 NEXT S
8225 IF N2=0GOTO8260
8230 FOR S=1TON2
8240 C(H2(S))=0
8250 NEXT S
8260 IF U=0THEN RETURN
8270 C(U)=0
8280 RETURN 
9000 PRINT
9005 PRINT"THIS IS A VARIANT OF THE CARD GAME 'SWITCH'."
9010 PRINT"DISPENSE OF YOUR CARDS BEFORE THE COMPUTER CAN"
9020 PRINT"DISCARD ALL OF ITS CARDS. FOLLOW NUMBER OR SUIT."
9022 PRINT"IF YOU HAVE NOTHING TO PLAY, ENTER 'D' TO DRAW."
9024 PRINT"DO NOT ENTER 'P' TO PLAY A CARD; INSTEAD,
9025 PRINT"ENTER THE CARD TO PLAY AS 'VALUE' THEN 'SUIT'."
9027 PRINT"E.G. ENTER '2H' FOR THE TWO OF HEARTS, OR 'QD'"
9028 PRINT"FOR THE QUEEN OF DIAMONDS. JACKS ARE WILD,"
9030 PRINT"PLAYED EIGHTS OR KINGS EARN AN EXTRA TURN,"
9032 PRINT"AND THE COMPUTER HATES TWOS AND FOURS." 
9035 PRINT"PRESS ANY KEY THEN HIT <RETURN>."
9040 INPUT A$
9050 RETURN
