100 CLS:PRINTTAB(11)"PENTOMINOS":PRINT
110 DATA i,2
120 DATA 0,1,0,2,0,3,0,4
130 DATA 1,0,2,0,3,0,4,0
140 DATA x,1
150 DATA 1,-1,1,0,2,0,1,1
160 DATA v,4
170 DATA 0,1,0,2,1,0,2,0
180 DATA 0,1,0,2,1,2,2,2
190 DATA 1,0,2,0,2,1,2,2
200 DATA 1,0,2,0,2,-1,2,-2
210 DATA t,4
220 DATA 0,1,0,2,1,1,2,1
230 DATA 1,0,1,1,2,0,1,2
240 DATA 1,0,2,0,1,-1,1,-2
250 DATA 2,-1,2,0,2,1,1,0
260 DATA w,4
270 DATA 0,1,1,1,1,2,2,2
280 DATA 1,0,1,1,2,1,2,2
290 DATA 0,1,1,-1,1,0,2,-1
300 DATA 1,-1,1,0,2,-2,2,-1
310 DATA u,4
320 DATA 0,2,1,0,1,1,1,2
330 DATA 2,0,0,1,1,1,2,1
340 DATA 0,1,1,0,2,0,2,1
350 DATA 1,0,0,1,0,2,1,2
360 DATA f,8
370 DATA 0,1,1,-1,1,0,2,0
380 DATA 1,-1,2,-1,1,0,1,1
390 DATA 1,-1,1,0,1,1,2,1
400 DATA 1,-1,1,0,2,0,2,1
410 DATA 0,1,1,1,1,2,2,1
420 DATA 1,0,1,1,2,1,1,2
430 DATA 1,0,1,1,2,-1,2,0
440 DATA 1,-2,1,-1,2,-1,1,0
450 DATA l,8
460 DATA 1,0,2,0,3,0,3,1
470 DATA 0,1,0,2,0,3,1,3
480 DATA 1,-3,1,-2,1,-1,1,0
490 DATA 1,0,2,0,3,0,3,-1
500 DATA 1,0,2,0,3,0,0,1
510 DATA 0,1,0,2,0,3,1,0
520 DATA 0,1,1,1,2,1,3,1
530 DATA 1,0,1,1,1,2,1,3
540 DATA y,8
550 DATA 0,1,0,2,0,3,1,1
560 DATA 1,0,2,0,3,0,1,1
570 DATA 1,-1,1,0,1,1,1,2
580 DATA 1,-1,1,0,2,0,3,0
590 DATA 0,1,0,2,0,3,1,2
600 DATA 1,0,2,0,3,0,2,1
610 DATA 1,-2,1,-1,1,0,1,1
620 DATA 1,0,2,0,3,0,2,-1
630 DATA z,4
640 DATA 0,1,1,1,2,1,2,2
650 DATA 1,0,1,1,1,2,2,2
660 DATA 1,-2,1,-1,1,0,2,-2
670 DATA 2,-1,1,0,2,0,0,1
680 DATA p,8
690 DATA 0,1,1,0,1,1,2,0
700 DATA 1,0,0,1,1,1,0,2
710 DATA 0,1,1,0,1,1,1,2
720 DATA 1,0,0,1,1,1,2,1
730 DATA 1,-1,1,0,2,-1,2,0
740 DATA 1,-1,1,0,0,1,1,1
750 DATA 0,1,0,2,1,1,1,2
760 DATA 1,0,2,0,1,1,2,1
770 DATA r,8
780 DATA 0,1,0,2,1,2,1,3
790 DATA 1,0,2,0,2,1,3,1
800 DATA 1,-1,1,0,2,-1,3,-1
810 DATA 1,-1,1,0,0,1,0,2
820 DATA 0,1,1,1,1,2,1,3
830 DATA 1,0,1,1,2,1,3,1
840 DATA 1,0,2,-1,2,0,3,-1
850 DATA 1,-2,1,-1,1,0,0,1
860 DATA a,0
1000 DIM X(63,4),Y(63,4),P(64),P$(13),S(13),T(13),B(6,20)
1001 DIM X1(5),Y1(5),X2(12),Y2(12),U(12)
1010 READP$,N:IFN=0THEN1070
1020 T=T+1:P$(T)=P$:S(T)=V+1
1030 FORJ=V+1TOV+N:P(J)=T
1040 FORK=0TO3:READX(J,K),Y(J,K):NEXT:NEXT
1050 V=V+N:PRINTP$;
1060 GOTO1010
1070 PRINT@64,"CHOOSE:"
1080 FORJ=3TO6:PRINTJ;" BY";60/J:NEXTJ
1090 INPUT"SELECT 3 THRU 6";W1
1100 IFW1<3ORW1>6ORW1<>INT(W1)THEN1070
1110 W2=60/W1
1120 CLS:FORX=1TOW2:FORY=1TOW1:PRINT@X+(Y+2)*32,"ß";:NEXT:NEXT
2000 REM FIND NEW SPACE TO FILL
2010 GOSUB3000:P=J:GOSUB3200:IFX1>W2THEN2170
2020 REM GET A NEW PIECE
2030 T(P)=S(P)
2040 PRINT@33,P$(P)
2050 REM TRY FITTING PIECE
2060 C$=P$(P):X1(0)=X1:Y1(0)=Y1:FORJ=1TO4
2070 X=X(T(P),J-1)+X1:Y=Y(T(P),J-1)+Y1:X1(J)=X:Y1(J)=Y
2080 IFX<1ORY<1ORX>W2ORY>W1THEN2260
2090 IFB(Y,X)THEN2260
2100 NEXTJ
2110 REM IT FITS - PUT PIECE IN PLACE
2120 B=P:FORJ=.TO4
2130 X=X1(J):Y=Y1(J):GOSUB3500
2140 NEXTJ
2150 X2(P)=X1:Y2(P)=Y1:P1=P1+1:U(P1)=P:GOTO2010
2160 REM BOARD FILLED
2170 PRINT@385,"SOLUTION":END
2180 REM UNDRAW LAST ONE
2190 P=U(P1):U(P1)=.:P1=P1-1:IFP1<.THENPRINT"THAT"S ALL":END
2200 B=.:X=X2(P):Y=Y2(P):C$="ß":GOSUB3500
2210 X1=X:Y1=Y:FORJ=1TO4
2220 X=X(T(P),J-1)+X1:Y=Y(T(P),J-1)+Y1:X1(J)=X:Y1(J)=Y
2230 GOSUB3500
2240 NEXTJ
2250 REM ROTATE THE PIECE
2260 T(P)=T(P)+1:IFP(T(P))=PTHEN2060
2270 REM GIVE UP ON PIECE
2280 T(P)=.
2290 REM LOOK FOR NEW PIECE 
2300 P=P+1:IFP>12THEN2190 
2310 IFT(P)THEN2300 
2320 GOTO2030
3000 FORJ=1TO12:IFT(J)THENNEXTJ
3010 RETURN
3200 FORX1=1TOW2:FORY1=1TOW1:IFB(Y1,X1)=.THEN3230
3220 NEXT:NEXT
3230 RETURN
3500 PRINT@X+(Y+2)*32,C$;:B(Y,X)=B
3510 RETURN
