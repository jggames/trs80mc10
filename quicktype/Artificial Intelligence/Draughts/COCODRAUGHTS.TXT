1 GOSUB60005:GOSUB60000:I=RND(-TIMER)
2 PRINT@ 72,"ediciel presente"
3 PRINT@201,CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)CHR$(191)
4 PRINT@233,CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)
5 PRINT@265,CHR$(128)CHR$(128)CHR$(128)+draughtsCHR$(128)CHR$(128)CHR$(128)
6 PRINT@297,CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)CHR$(128)
7 PRINT@329,CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)CHR$(175)
8 PRINT@361,CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)CHR$(159)
9 PRINT@480,"(C) EDICIEL MATRA HACHETTE 1984";
10 FOR I=1 TO10:SOUND 120+10*I,12-I:NEXTI
20 CLEAR 700
30 DIMC1(9):DIMC2(9):DIMC3(9):DIMC4(9)
40 DIMB0(50):DIMA(50):DIMA0(50)
50 DIMS$(50):DIMS0$(50):DIMS1$(50)
60 DIMP(50):DIMP0(50):DIMP1(50):MC=1024-16384
65 PO=20:PJ=20
70 FOR I=1 TO 50
80 IF I<21 THEN B0(I)=1
85 IFI>20 AND I<31 THEN B0(I)=0
90 IF I>30 THEN B0(I)=-1
95 NEXT I
97 GOSUB 30000
100 REM
105 SOUND 180,2
110 CLS:PRINT@160,"WOULD YOU LIKE TO CHALLENGE ME? "
115 PRINT@207,"";:INPUT"";Z$
120 IF LEFT$(Z$,1)="Y" THEN Z$="OUI":GOTO190
130 IF LEFT$(Z$,1)="N" THEN Z$="NON":GOTO500
140 GOTO 110
150 FOR I=1 TO 2000:NEXT I
160 SOUND 180,2
190 CLS:PRINT@228,"";:INPUT"CHOOSE LEVEL (1-5)";NI
195 ON NI GOTO 259,240,240,240,240
200 GOTO 190
240 DIMT1$(31):DIMT1(31):DIMB2(50)
245 DIML(20)
250 DIMT0$(31):DIMT0(31):DIMB1(50)
259 FOR I=1 TO 2000:NEXTI:SOUND180,2
260 CLS:PRINT@168,"I WILL CHOOSE WHO":PRINT@235,"GOES FIRST."
270 J=RND(2):FORI=1 TO2000:NEXTI:CLS:SOUND180,2:PRINT@198,"I'M THE BLUE PIECES."
280 IFJ=1 THENPRINT@297,"AND I GO FIRST."
290 IFJ=2 THENPRINT@298,"YOU GO FIRST."
295 FORI=1 TO 2000:NEXTI:SOUND180,2
296 CLS:PRINT@194,"PLEASE WAIT A FEW MOMENTS...":PRINT@296,"I'M SETTING UP."
297 FOR I=1 TO 2000:NEXT I
300 REM
302 CLS0:FOR Y=0 TO 12 STEP 3:FOR X=0 TO 4
315 POKEMC+16417+32*Y+4*X,207:POKEMC+16418+32*Y+4*X,207
316 POKEMC+16419+32*Y+4*X,192:POKEMC+16420+32*Y+4*X,192
317 POKEMC+16449+32*Y+4*X,204:POKEMC+16450+32*Y+4*X,204
318 POKEMC+16451+32*Y+4*X,195:POKEMC+16452+32*Y+4*X,195
319 POKEMC+16481+32*Y+4*X,192:POKEMC+16482+32*Y+4*X,192
320 POKEMC+16483+32*Y+4*X,207:POKEMC+16484+32*Y+4*X,207
325 NEXT X:NEXT Y
330 FOR X=1 TO 10:POKEMC+16383+2*X-1,96:POKEMC+16383+2*X,111+X:NEXTX
335 POKEMC+16404,96:POKE16405,96
340 FOR X=1 TO 5
345 POKEMC+16320+96*X,63+2*X
346 POKEMC+16341+96*X,63+2*X
347 POKEMC+16352+96*X,96
348 POKEMC+16373+96*X,96
349 POKEMC+16384+96*X,64+2*X
350 POKEMC+16405+96*X,64+2*X
355 NEXT X
360 FOR I=1 TO 5
365 SET(8*I-1,3,6):SET(8*I,3,6)
366 SET(8*I-5,6,6):SET(8*I-4,6,6)
367 SET(8*I-1,9,6):SET(8*I,9,6)
368 SET(8*I-5,12,6):SET(8*I-4,12,6)
369 SET(8*I-1,21,8):SET(8*I,21,8)
370 SET(8*I-5,24,8):SET(8*I-4,24,8)
371 SET(8*I-1,27,8):SET(8*I,27,8)
372 SET(8*I-5,30,8):SET(8*I-4,30,8)
375 NEXT I
380 FOR I=1 TO 12:PRINT@ 32*I-9,"         ";:NEXTI
394 IF Z$="NON" THEN ON J GOTO 700,610
395 ON J GOTO 1000,3000
500 CLS:PRINT@132,"NAME OF FIRST PLAYER:":PRINT@196,"(LESS THAN 8 CHARACTERS)"
502 PRINT@268,"";:INPUT"";X$
505 IF LEN(X$)>8 THEN500
507 PRINT@323,"YOU HAVE THE BLUE PIECES."
508 FOR I=1 TO 2000:NEXTI
509 SOUND 180,2
510 CLS:PRINT@132,"NAME OF THE 2ND PLAYER:":PRINT@196,"(LESS THAN 8 CHARACTERS)"
512 PRINT@268,;:INPUTY$
515 IF LEN(Y$)>8 THEN510
517 PRINT@323,"YOU HAVE THE ORANGE PIECES."
518 FOR I=1 TO 2000:NEXTI
519 SOUND 180,2
520 CLS:PRINT@166,"I WILL CHOOSE WHO":PRINT@234,"GOES FIRST."
530 FOR I=1 TO 2000:NEXTI
535 J=RND(2):SOUND 180,2
540 IFJ=1 THEN CLS:PRINT@224,"IT'S ";X$;" WHO GOES FIRST."
550 IFJ=2 THEN CLS:PRINT@224,"IT'S ";Y$;" WHO GOES FIRST."
555 FOR I=1 TO 2000:NEXTI:GOTO295
600 IF IN=1 THEN 700
610 PRINT@55,"YOUR TURN";:PRINT@87,"        ";:PRINT@87,Y$;
620 PP=PJ:IN=1:GOTO3010
700 PRINT@55,"YOUR TURN";:PRINT@87,"        ";:PRINT@87,X$;
710 PP=PO:IN=0:GOTO3010
800 IFIN=1 THENCLS:PRINT@232,Y$;" LOST!":GOTO52000
810 CLS:PRINT@232,X$;" LOST!":GOTO52000
1000 REM
1001 PRINT@24,"LEVEL";NI;:PRINT@55,"MY TURN  ";
1005 PP=PO:PS=-100:IN=0:FI=0:GOSUB30000:GOSUB7000
1030 IF FI=1 THEN 50000
1040 IF NI=1 THEN 2000
1050 GOSUB 36000:S0=NB:IF S0=1 THEN 2000
1080 FOR I=1 TO S0:T0$(I)=S$(I):T0(I)=P(I):NEXTI
1110 FORR0=1 TOS0
1111 M1=-100:MN=0:GOSUB38100
1120 FOR T=1 TO LEN(T0$(R0))/3:B1(VAL(MID$(T0$(R0),3*T-2,3)))=0:NEXT T
1137 IF LEN(T0$(R0))=6 THEN 1155
1140 IF VAL(MID$(T0$(R0),LEN(T0$(R0))-5,3))>45 THEN B1(VAL(MID$(T0$(R0),LEN(T0$(R0))-5,3)))=2:GOTO 1170
1150 B1(VAL(MID$(T0$(R0),LEN(T0$(R0))-5,3)))=B0(VAL(LEFT$(T0$(R0),3)))
1152 GOTO 1170
1155 IF VAL(RIGHT$(T0$(R0),3))>45 THEN B1(VAL(RIGHT$(T0$(R0),3)))=2:GOTO 1170
1158 B1(VAL(RIGHT$(T0$(R0),3)))=B0(VAL(LEFT$(T0$(R0),3)))
1170 GOSUB37100:IN=1:GOSUB30100:GOSUB7000
1185 IF FI=1 THEN M1=0:GOTO 1945
1190 GOSUB36000:S1=NB:FORI=1 TOS1:T1$(I)=S$(I):T1(I)=P(I):NEXTI
1230 IF NI=2 OR NI=3 THEN GOSUB 38000:T0(R0)=T0(R0)-MO:GOTO 1950
1300 FOR R1=1 TO S1
1305 GOSUB 37100:GOSUB 38200
1310 FOR T=1 TO LEN(T1$(R1))/3
1315 B2(VAL(MID$(T1$(R1),3*T-2,3)))=0
1320 NEXT T
1325 IF LEN(T1$(R1))=6 THEN 1340
1330 IF VAL(MID$(T1$(R1),LEN(T1$(R1))-5,3))<6 THEN B2(VAL(MID$(T1$(R1),LEN(T1$(R1))-5,3)))=-2:GOTO 1350
1335 B2(VAL(MID$(T1$(R1),LEN(T1$(R1))-5,3)))=B1(VAL(LEFT$(T1$(R1),3))):GOTO 1350
1340 IF VAL(RIGHT$(T1$(R1),3))<6 THEN B2(VAL(RIGHT$(T1$(R1),3)))=-2:GOTO 1350
1345 B2(VAL(RIGHT$(T1$(R1),3)))=B1(VAL(LEFT$(T1$(R1),3)))
1350 IN=0:GOSUB 30200
1355 GOSUB7000:GOSUB38000:T1(R1)=T1(R1)-MO
1357 IFNI=5 AND MO>0 AND T1(R1)+MO-MO/NB=0 THENT1(R1)=0.5
1358 IFS1=1 OR T1(R1)>0 THENT1(R1)=2*T1(R1)
1937 IFT1(R1)>M1 THENM1=T1(R1)
1938 IFT1(R1)>0 THENMN=MN+T1(R1)
1940 NEXT R1
1945 IFMN=0 THENT0(R0)=T0(R0)-M1
1946 IFMN>0 THENT0(R0)=T0(R0)-MN
1950 NEXT R0
1960 GOSUB 34000
1970 FORR0=1 TOS0:S$(R0)=T0$(R0):P(R0)=T0(R0):NEXTR0:IN=0:GOSUB39000
2000 O=INT(LEN(S$(1))/6-1/2):PJ=PJ-O:GOSUB 40000
2060 GOSUB 30000
3000 REM 
3002 IN=1:PRINT@55,"YOUR TURN";:PP=PJ
3010 IF IN=1 THEN GOSUB 37000
3020 GOSUB30000:GOSUB7000
3041 IF IN=1 THEN PO=PO-O
3042 IF IN=0 THEN PJ=PJ-O
3043 IF FI=1 AND Z$="OUI" THEN 51000
3044 IF FI=1 AND Z$="NON" THEN 800
3045 SOUND 102,5
3047 IFO>0 THENPRINT@119,"TAKE: ";:PRINT@125,O;
3050 FORI=1 TO7:PRINT@151+32*I,"         ";:NEXTI:PRINT@183,"YOUR MOVE";:A$="":N=0
3051 B$=INKEY$:IF B$="" THEN 3051
3052 IF ASC(B$)=13 THEN 3060
3053 IF (N+1)/2=INT((N+1)/2) AND (ASC(B$)>57 OR ASC(B$)<48) THEN3051
3054 IF N/2=INT(N/2) AND (ASC(B$)>74 OR ASC(B$)<65) THEN 3051
3055 N=N+1:A$=A$+B$:IF N/2=INT(N/2) THEN A$=A$+"/"
3056 FOR I=0 TO INT((LEN(A$))/9)
3057 IF LEN(RIGHT$(A$,LEN(A$)-9*I))<9 THEN 3059
3058 PRINT@ 215+32*I,MID$(A$,9*I+1,9);:NEXT I
3059 PRINT@215+32*I,RIGHT$(A$,LEN(A$)-9*I);:GOTO3051
3060 IF LEN(A$)<>6 AND O=0 THEN 3050
3070 IF LEN(A$)<>3+3*O AND O>0 THEN 3050
3145 B$=""
3150 FOR T=1 TO LEN(A$)/3
3160 A=ASC(MID$(A$,3*T-2,1))-65
3170 B=VAL(MID$(A$,3*T-1,1))
3180 IF (A+B)/2=INT((A+B)/2) THEN 3050
3190 C=5*A+1+INT(B/2)
3200 B$=B$+STR$(C)
3210 NEXT T
3220 A$=B$:GOSUB 41000
3240 FOR I=1 TO 50
3242 IF LEFT$(S$(I),3)<>LEFT$(A$,3) THEN 3260
3244 IF O<2 AND LEFT$(S$(I),6)=A$ THEN A$=S$(I):GOTO3300
3246 IF O<2 THEN 3260
3248 FOR J=1 TO O
3250 IF MID$(A$,1+3*J,3)<>MID$(S$(I),6*J-2,3) THEN 3260
3252 NEXT J
3254 A$=S$(I):GOTO 3300
3260 NEXT I
3270 GOTO 3050
3300 GOSUB 40050
3310 IF IN=1 THEN GOSUB 37000
3320 FOR I=1 TO 9:PRINT@87+32*I,"         ";:NEXTI
3400 IF Z$="NON" THEN GOSUB 30000:GOTO 600
3410 GOTO 1000
7000 REM
7010 FI=0:PT=0:J=1:O=0:O1=0
7020 FOR I=1 TO 50
7025 IF PT=PP THEN 7055
7030 IF A(I)<>1 THEN 7050
7035 PT=PT+1
7040 E=I:U=E-10*INT(E/10):GOSUB 10000
7050 NEXT I
7055 IF J=1 THEN 7300
7060 IF O1=0 AND O>0 THEN GOSUB 35000:GOSUB 33000
7070 FOR Q=1 TO J-1:A$=S$(Q):GOSUB41000:S$(Q)=A$:NEXT Q
7080 IF O1=0 THEN 7250
7090 GOSUB 33000
7100 R=1
7110 O=O+1:FOR Q=1 TO J-1
7120 IF LEN(S$(Q))<3+6*O THEN 7140
7130 S0$(R)=S$(Q):P0(R)=P(Q):R=R+1
7140 NEXT Q
7150 GOSUB 34000
7160 O1=0:J=1
7170 FOR Q=1 TO R-1
7180 FOR T=1 TO LEN(S0$(Q))/3
7190 A0(VAL(MID$(S0$(Q),3*T-2,3)))=0:NEXT T
7200 E=VAL(MID$(S0$(Q),LEN(S0$(Q))-5,3))
7210 A0(E)=1
7220 U=E-10*INT(E/10)
7230 GOSUB 10000
7240 GOSUB 31000
7244 NEXT Q
7246 GOTO 7060
7250 FOR I=1 TO 50
7260 IF S$(I)="" THEN 7300
7265 IF IN=1 THEN 7284
7270 IF LEN(S$(I))=6 AND VAL(RIGHT$(S$(I),3))>45 THEN P(I)=P(I)+1
7280 IF LEN(S$(I))>6 AND VAL(MID$(S$(I),LEN(S$(I))-5,3))>45 THENP(I)=P(I)+1
7282 GOTO 7290
7284 IF LEN(S$(I))=6 AND VAL(RIGHT$(S$(I),3))<6 THEN P(I)=P(I)+1
7286 IF LEN(S$(I))>6 AND VAL(MID$(S$(I),LEN(S$(I))-5,3))<6 THEN P(I)=P(I)+1
7290 NEXT I
7300 FOR I=1 TO 50
7305 IF PT=PP THEN 7410
7310 IF A(I)<2 THEN 7400
7315 PT=PT+1
7318 GOSUB 30500
7320 O0=0:Z=I:U=Z-10*INT(Z/10)
7330 GOSUB 20000
7340 IF O0=0 AND O=0 THEN 7400
7350 IF O0<O THEN 7400
7360 IF O0>O THEN O=O0:FOR T=1 TO 50:S$(T)=S1$(T):P(T)=P1(T):NEXT T:GOTO 7400
7370 FOR T=1 TO 50:IF S$(T)="" THEN R=T-1:GOTO 7390
7380 NEXT T
7390 FOR T=1 TO 50:IF S1$(T)="" THEN 7400
7395 S$(R+T)=S1$(T):P(R+T)=P1(T):NEXT T
7400 NEXT I
7410 IF S$(1)="" THEN FI=1
7420 FOR I=1 TO 50
7425 IF S$(I)="" THEN 7500
7430 A$=S$(I):GOSUB 41000:S$(I)=A$
7440 NEXT I
7500 RETURN
10000 IF U>0 AND U<5 THEN A=E-4:B=E-9:GOSUB11000
10010 IF U>0 AND U<5 THEN A=E+6:B=E+11:GOSUB11000
10020 IF U>1 AND U<6 THEN A=E-5:B=E-11:GOSUB11000
10030 IF U>1 AND U<6 THEN A=E+5:B=E+9:GOSUB11000
10040 IF U=1 OR U=0 THEN A=E+5:B=0:GOSUB11000
10050 IF U=1 OR U=0 THEN A=E-5:B=0:GOSUB11000
10060 IF U>5 THEN A=E-5:B=E-9:GOSUB11000
10070 IF U>5 THEN A=E+5:B=E+11:GOSUB11000
10080 IF U>6 OR U=0 THEN A=E-6:B=E-11:GOSUB11000
10090 IF U>6 OR U=0 THEN A=E+4:B=E+9:GOSUB11000
10100 RETURN
11000 IF A<1 OR A>50 THEN RETURN
11010 IF A0(A)>0 THEN RETURN
11015 IF IN=1 THEN 11025
11020 IF A0(A)=0 AND A<E THEN RETURN
11022 GOTO 11030
11025 IF A0(A)=0 AND A>E THEN RETURN
11030 IF A0(A)=0 AND O+O1>0 THEN RETURN
11040 IF A0(A)=0 THEN S$(J)=STR$(E)+STR$(A):J=J+1:RETURN
11050 IF B<1 OR B>50 THEN RETURN
11060 IF A0(A)>=0 OR A0(B)<>0 THEN RETURN
11065 IF O1=0 THEN O1=1
11070 IF O=0 THEN S$(J)=STR$(E)+STR$(B)+STR$(A):P(J)=-A(A)
11080 IF O>0 THEN S$(J)=S0$(Q)+STR$(B)+STR$(A):P(J)=P0(Q)-A(A)
11090 J=J+1:RETURN
20000 GOSUB 32000
20003 O1=0
20005 A=Z:B=Z:C=Z:D=Z
20010 FOR K=1 TO 9
20020 IF U>5 OR U=0 THEN M=K/2:N=(K+1)/2
20030 IF U<6 AND U>0 THEN M=(K+1)/2:N=K/2
20040 IF A-10*INT(A/10)=5  OR A<6 THEN 20070
20050 A=Z-4*INT(M)-5*INT(N)
20060 C1(K)=A0(A)
20070 IF B-10*INT(B/10)=5 OR B>45 THEN 20110
20080 B=Z+6*INT(M)+5*INT(N)
20090 C2(K)=A0(B)
20110 IF C-10*INT(C/10)=6 OR C>45 THEN 20140
20120 C=Z+5*INT(M)+4*INT(N)
20130 C3(K)=A0(C)
20140 IF D-10*INT(D/10)=6 OR D<6 THEN 20170
20150 D=Z-5*INT(M)-6*INT(N)
20160 C4(K)=A0(D)
20170 NEXT K
20400 C=0
20410 FOR K=1 TO 9
20420 IF C1(K)>0 THEN 20450
20425 IF C<0 AND C1(K)<0 THEN 20450
20430 IF C<0 AND C1(K)=0 THEN O1=1:GOTO 20700
20440 C=C+C1(K):NEXT K
20450 C=0
20460 FOR K=1 TO 9
20470 IF C2(K)>0 THEN 20500
20475 IF C<0 AND C2(K)<0 THEN 20500
20480 IF C<0 AND C2(K)=0 THEN O1=1:GOTO 20700
20490 C=C+C2(K):NEXT K
20500 C=0
20510 FOR K=1 TO 9
20520 IF C3(K)>0 THEN 20550
20525 IF C<0 AND C3(K)<0 THEN 20550
20530 IF C<0 AND C3(K)=0 THEN O1=1:GOTO 20700
20540 C=C+C3(K):NEXT K
20550 C=0
20560 FOR K=1 TO 9
20570 IF C4(K)>0 THEN 20700
20575 IF C<0 AND C4(K)<0 THEN 20700
20580 IF C<0 AND C4(K)=0 THEN O1=1:GOTO 20700
20590 C=C+C4(K):NEXT K
20700 IF O0>0 THEN RETURN
20710 IF O1=1 AND O0=0 THEN O0=O0+1:GOTO 22000
20720 IF O1=0 AND O>0 THEN RETURN
21000 S$=STR$(Z)
21010 A=Z:B=Z:C=Z:D=Z
21020 FOR K=1 TO 9
21030 IF U>5 OR U=0 THEN M=K/2:N=(K+1)/2
21040 IF U>0 AND U<6 THEN M=(K+1)/2:N=K/2
21050 IF A-10*INT(A/10)=5 OR A<6 THEN 21080
21060 A=Z-4*INT(M)-5*INT(N)
21070 IF A0(A)=0 THEN S$(J)=S$+STR$(A):J=J+1
21075 IF A0(A)<>0 THEN A=0
21080 IF B-10*INT(B/10)=5 OR B>45 THEN 21110
21090 B=Z+6*INT(M)+5*INT(N)
21100 IF A0(B)=0 THEN S$(J)=S$+STR$(B):J=J+1
21105 IF A0(B)<>0 THEN B=51
21110 IF C-10*INT(C/10)=6 OR C>45 THEN 21140
21120 C=Z+5*INT(M)+4*INT(N)
21130 IF A0(C)=0 THEN S$(J)=S$+STR$(C):J=J+1
21135 IF A0(C)<>0 THEN C=51
21140 IF D-10*INT(D/10)=6 OR D<6 THEN 21200
21150 D=Z-5*INT(M)-6*INT(N)
21160 IF A0(D)=0 THEN S$(J)=S$+STR$(D):J=J+1
21165 IF A0(D)<>0 THEN D=0
21200 NEXT K
21210 RETURN
22000 REM
22010 FOR L=1 TO 50:S0$(L)=STR$(Z):P0(L)=0:NEXTL
22030 Q=1:GOSUB 23000
22040 R=Q-1:FOR Q=1 TO R:S1$(Q)=S0$(Q):P1(Q)=P0(Q):NEXTQ:GOSUB33000:Q=1
22090 FOR P=1 TO R:A$=S1$(P):GOSUB41000:S1$(P)=A$:GOSUB31000
22120 FOR T=1 TO LEN(A$)/3
22125 IF T/2=INT(T/2) THEN A0(VAL(MID$(A$,3*T-2,3)))=0
22130 IF (T-1)/2=INT((T-1)/2) AND T<>1 THEN A0(VAL(MID$(A$,3*T-2,3)))=3
22135 NEXT T
22140 A0(VAL(MID$(A$,LEN(A$)-5,3)))=A0(VAL(LEFT$(A$,3)))
22145 A0(VAL(LEFT$(A$,3)))=0
22147 Z=VAL(MID$(A$,LEN(A$)-5,3)):U=Z-10*INT(Z/10)
22150 GOSUB 20000
22160 IF O1=0 THEN 22220
22180 Q0=Q:GOSUB23000:FOR T=Q0 TO Q-1:S0$(T)=S1$(P)+S0$(T):P0(T)=P1(P)+P0(T):NEXTT
22220 NEXT P
22230 IF S0$(1)="" THEN RETURN
22240 GOSUB 30500:O0=O0+1
22250 GOTO 22040
23000 A=Z:B=Z:C=Z:D=Z
23010 A0=0:B0=0:C0=0:D0=0
23020 FOR K=1 TO 9
23030 IF U>5 OR U=0 THEN M=K/2:N=(K+1)/2
23040 IF U<6 AND U>0 THEN M=(K+1)/2:N=K/2
23050 IF A-10*INT(A/10)=5 OR A<6 THEN 23150 
23060 A=Z-4*INT(M)-5*INT(N)
23070 IF A0(A)>0 THEN A=0:GOTO 23150
23080 IF A0(A)=0 AND A0=0 THEN 23150
23090 IF A0(A)=0 AND A0=1 THEN S0$(Q)=S0$(Q)+STR$(A)+STR$(A1):P0(Q)=P0(Q)-A0(A1):Q=Q+1
23100 IF A0(A)<0 AND A0=0 THEN A0=1:A1=A:GOTO 23150
23110 IF A0(A)<0 AND A0=1 THEN A=0
23150 IF B-10*INT(B/10)=5 OR B>45 THEN 23250
23160 B=Z+6*INT(M)+5*INT(N)
23170 IF A0(B)>0 THEN B=50:GOTO 23250
23180 IF A0(B)=0 AND B0=0 THEN 23250
23190 IF A0(B)=0 AND B0=1 THEN S0$(Q)=S0$(Q)+STR$(B)+STR$(B1):P0(Q)=P0(Q)-A0(B1):Q=Q+1
23200 IF A0(B)<0 AND B0=0 THEN B0=1:B1=B:GOTO 23250
23210 IF A0(B)<0 AND B0=1 THEN B=50
23250 IF C-10*INT(C/10)=6 OR C>45 THEN 23350
23260 C=Z+5*INT(M)+4*INT(N)
23270 IF A0(C)>0 THEN C=50:GOTO 23350
23280 IF A0(C)=0 AND C0=0 THEN 23350
23290 IF A0(C)=0 AND C0=1 THEN S0$(Q)=S0$(Q)+STR$(C)+STR$(C1):P0(Q)=P0(Q)-A0(C1):Q=Q+1
23300 IF A0(C)<0 AND C0=0 THEN C0=1:C1=C:GOTO 23350
23310 IF A0(C)<0 AND C0=1 THEN C=50
23350 IF D-10*INT(D/10)=6 OR D<6 THEN 23450
23360 D=Z-5*INT(M)-6*INT(N)
23370 IF A0(D)>0 THEN D=0:GOTO 23450
23380 IF A0(D)=0 AND D0=0 THEN 23450
23390 IF A0(D)=0 AND D0=1 THEN S0$(Q)=S0$(Q)+STR$(D)+STR$(D1):P0(Q)=P0(Q)-A0(D1):Q=Q+1
23400 IF A0(D)<0 AND D0=0 THEN D0=1:D1=D:GOTO 23450
23410 IF A0(D)<0 AND D0=1 THEN D=0
23450 NEXT K
23500 RETURN
30000 FOR I=1 TO 50:A(I)=B0(I):NEXT I:GOSUB 30450:RETURN
30100 FOR I=1 TO 50:A(I)=B1(I):NEXT I:GOSUB 30450:RETURN
30200 FOR I=1 TO 50:A(I)=B2(I):NEXT I:GOSUB 30450:RETURN
30450 FOR I=1 TO 50:A0(I)=A(I):S$(I)="":S0$(I)="":S1$(I)="":P(I)=0:P0(I)=0:P1(I)=0:NEXT I:RETURN
30500 FOR L=1 TO 50:S1$(L)="":P1(L)=0:NEXTL
31000 FOR L=1 TO 50:A0(L)=A(L):NEXTL:RETURN
32000 FOR K=1 TO 9:C1(K)=1:C2(K)=1:C3(K)=1:C4(K)=1:NEXT K:RETURN
33000 FOR L=1 TO 50:S0$(L)="":P0(L)=0:NEXTL:RETURN
34000 FOR L=1 TO 50:S$(L)="":P(L)=0:NEXTL:RETURN
35000 FOR L=1 TO 50:S$(L)=S0$(L):P(L)=P0(L):NEXTL:RETURN
36000 NB=0:FORI=1 TO 50:IF S$(I)="" THEN RETURN
36010 NB=NB+1:NEXTI:RETURN
37000 FOR I=1 TO 50:B0(I)=-B0(I):NEXTI:RETURN
37100 FOR I=1 TO 50:B1(I)=-B1(I):NEXTI:RETURN
38000 GOSUB 36000:MO=0:IF NB=0 THEN RETURN
38010 FORI=1 TO NB:MO=MO+P(I):NEXTI:RETURN
38100 FOR I=1 TO 50:B1(I)=B0(I):NEXTI:RETURN
38200 FOR I=1 TO 50:B2(I)=B1(I):NEXTI:RETURN
39000 FOR I=1 TO 30
39040 T1$(I)="":T1(I)=0
39050 T0$(I)="":T0(I)=0
39060 NEXT I
39070 RETURN
40000 REM
40005 K=0:FOR J=1 TO 50:IF S$(J)="" THEN 40030
40010 IF P(J)>PS THEN K=0:PS=P(J)
40015 IF P(J)=PS THEN K=K+1
40020 NEXT J
40030 IFNI>2 THEN40040
40032 L=RND(K):K=0:FOR J=1 TO 50
40034 IF P(J)=PS THEN K=K+1
40036 IF K=L THEN A$=S$(J):GOTO 40050
40038 NEXT J
40040 K=0:FOR J=1 TO 50:IF S$(J)="" THEN40049
40041 IFP(J)<PS THEN40048
40042 N=B0(VAL(LEFT$(S$(J),3))):IFO>0 THENM=(VAL(MID$(S$(J),6*O-2,3))+4)/5:GOTO40046
40043 IFO=0 THENM=(VAL(RIGHT$(S$(J),3))+4)/5
40046 IFINT(M)>K AND N=1 THENL=0:K=INT(M)
40047 IFINT(M)=K AND N=1 THENL=L+1:L(L)=J
40048 NEXT J
40049 ON1-(L<21) GOTO40032:K=RND(L):A$=S$(L(K))
40050 IF O>0 THEN 40100
40055 IF IN=0 AND VAL(RIGHT$(A$,3))>45 THEN B0(VAL(RIGHT$(A$,3)))=2:GOTO40070
40060 IF IN=1 AND VAL(RIGHT$(A$,3))<6 THEN B0(VAL(RIGHT$(A$,3)))=2:GOTO40070
40065 B0(VAL(RIGHT$(A$,3)))=B0(VAL(LEFT$(A$,3))):B0(VAL(LEFT$(A$,3)))=0
40070 X=VAL(LEFT$(A$,3)):GOSUB 40500
40080 X=VAL(RIGHT$(A$,3)):GOSUB 40600
40085 B0(VAL(LEFT$(A$,3)))=0
40090 RETURN
40100 X=VAL(LEFT$(A$,3)):GOSUB 40500
40110 FOR T=1 TO O
40115 IF T>1 THEN X=VAL(MID$(A$,6*T-8,3)):B0(X)=0:GOSUB 40500
40120 X=VAL(MID$(A$,6*T+1,3)):B0(X)=0:GOSUB 40500
40125 X=VAL(MID$(A$,6*T-2,3)):B0(X)=B0(VAL(LEFT$(A$,3))):GOSUB40600
40130 NEXT T
40135 X=X-4
40140 IF IN=0 AND X>45 THEN B0(X)=2:GOSUB 40600
40150 IF IN=1 AND X<6 THEN B0(X)=2:GOSUB 40600
40170 B0(VAL(LEFT$(A$,3)))=0
40180 GOTO 40580
40500 IF X-10*INT(X/10)>5 OR X-10*INT(X/10)=0 THEN 40550
40505 U=X-10*INT(X/10):X=X+4
40510 RESET(8*U-1,3*INT(X/5))
40520 RESET(8*U,3*INT(X/5))
40525 SOUND 180,2:RETURN
40550 U=X-5-10*INT((X-5)/10)
40555 X=X+4
40560 RESET(8*U-4,3*INT(X/5))
40570 RESET(8*U-5,3*INT(X/5))
40575 SOUND 180,2:RETURN
40580 IF O=0 THEN RETURN
40581 IF IN=0 THEN 40590
40582 FOR I=1 TO 20-PO
40583 IF I/2=INT(I/2) THEN SET(64-I,31,6):GOTO40585
40584 SET(64-I,30,6)
40585 NEXTI:RETURN
40590 FOR I=1 TO 20-PJ
40591 IF I/2=INT(I/2) THEN SET(64-I,27,8):GOTO 40594
40592 SET(64-I,26,8)
40594 NEXTI:RETURN
40600 U=X-10*INT(X/10)
40610 IF U>5 OR U=0 THEN 40700
40615 X=X+4
40618 FOR I=1 TO 6
40619 GOSUB 40510
40620 IF B0(X-4)=1 AND IN=0 THENSET(8*U-1,3*INT(X/5),6):SET(8*U,3*INT(X/5),6)
40630 IF B0(X-4)=1 AND IN=1 THENSET(8*U-1,3*INT(X/5),8):SET(8*U,3*INT(X/5),8)
40640 IF B0(X-4)=2 AND IN=0 THENSET(8*U-1,3*INT(X/5),3):SET(8*U,3*INT(X/5),3)
40650 IF B0(X-4)=2 AND IN=1 THENSET(8*U-1,3*INT(X/5),4):SET(8*U,3*INT(X/5),4)
40660 NEXT I:GOTO 40750
40700 U=X-5-10*INT((X-5)/10)
40705 X=X+4
40708 FOR I=1 TO 6
40709 GOSUB 40560
40710 IF B0(X-4)=1 AND IN=0 THENSET(8*U-4,3*INT(X/5),6):SET(8*U-5,3*INT(X/5),6)
40720 IF B0(X-4)=1 AND IN=1 THENSET(8*U-4,3*INT(X/5),8):SET(8*U-5,3*INT(X/5),8)
40730 IF B0(X-4)=2 AND IN=0 THENSET(8*U-4,3*INT(X/5),3):SET(8*U-5,3*INT(X/5),3)
40740 IF B0(X-4)=2 AND IN=1 THENSET(8*U-4,3*INT(X/5),4):SET(8*U-5,3*INT(X/5),4)
40748 NEXT I
40750 SOUND 180,2:RETURN
41000 FOR T=1 TO 50
41010 IF ASC(MID$(A$,3*T,1))<>32 THEN 41050
41020 A$=LEFT$(A$,3*T-3)+" "+RIGHT$(A$,LEN(A$)-3*T+3)
41050 IF LEN(A$)-3*T=2 THEN A$=LEFT$(A$,3*T)+" "+RIGHT$(A$,2):GOTO 41100
41060 IF LEN(A$)-3*T=0 THEN 41100
41070 NEXT T
41100 RETURN
50000 CLS:PRINT@234,"I HAVE LOST!":GOTO52000
51000 CLS:PRINT@233,"YOU HAVE LOST!":GOTO52000
52000 SOUND150,20:GOSUB60005:GOSUB60003:END
60000 IF PEEK(65535)=27 THEN POKE65497,0:GOTO60002 ELSE CLS:INPUT"CAN YOUR COMPUTER HANDLE DOUBLE SPEED (Y/N)";A$
60001 IF A$="Y" THEN POKE65495,0 ELSE IF A$<>"N" THEN52000
60002 CLS:RETURN
60003 IF PEEK(65535)=27 THEN POKE65496,0 ELSE POKE65494,0
60004 RETURN
60005 ' ENABLE DRAGON SPEEDKEY
60006 IF PEEK(65535)<>180 THEN 60008
60007 IF PEEK(269)+PEEK(270)<>1 THEN POKE65283,52:POKE256,116:POKE257,1:POKE258,81:POKE259,126:POKE260,PEEK(269):POKE 261,PEEK(270):POKE269,1:POKE270,0:POKE65283,53
60008 RETURN
60009 ' DISABLE DRAGON SPEEDKEY
60010 IF PEEK(65535)<>180 THEN 60012
60011 IF PEEK(269)+PEEK(270)=1 THEN POKE65283,52:POKE269,PEEK(260):POKE270,PEEK(261):POKE65283,53
60012 RETURN
