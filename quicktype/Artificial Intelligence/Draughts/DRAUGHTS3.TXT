1 CLS:I=RND(-(PEEK(9)*256+PEEK(10)))
2 PRINT@72,"ediciel presents"
3 PRINT@201,"¿¿¿¿¿¿¿¿¿¿¿¿¿¿"
4 PRINT@233,"€€€€€€€€€€€€€€"
5 PRINT@265,"€€€draughts€€€"
6 PRINT@297,"€€€€€€€€€€€€€€"
7 PRINT@329,"¯¯¯¯¯¯¯¯¯¯¯¯¯¯"
8 PRINT@361,"ŸŸŸŸŸŸŸŸŸŸŸŸŸŸ"
9 PRINT@480,"(C) EDICIEL MATRA HACHETTE 1984";
10 FORI=1TO10:SOUND120+10*I,12-I:NEXTI
20 CLEAR750
30 DIMC1(9),C2(9),C3(9),C4(9)
40 DIMB0(50),A(50),A0(50)
50 DIMS$(50),S0$(50),S1$(50)
60 DIMP(50),P0(50),P1(50)
65 PO=20:PJ=20
70 FORI=1TO50
80 IFI<21 THENB0(I)=1
85 IFI>20 AND I<31 THENB0(I)=0
90 IFI>30 THENB0(I)=-1
95 NEXT
97 GOSUB30000
100 REM
105 SOUND180,2
110 CLS:PRINT@160,"WOULD YOU LIKE TO CHALLENGE ME? "
115 PRINT@207,"";:INPUT"";Z$
120 IFLEFT$(Z$,1)="Y" THENZ$="YES":GOTO190
130 IFLEFT$(Z$,1)="N" THENZ$="NO":GOTO500
140 GOTO110
150 FORI=1TO2000:NEXT I
160 SOUND180,2
190 CLS:PRINT@230,"CHOOSE LEVEL (1-5)"
192 PRINT@168,"";:INPUT"WHICH LEVEL";NI
195 ONNIGOTO259,240,240,240,240
200 GOTO190
240 DIMT1$(30),T1(30),B2(50),L(20)
250 DIMT0$(30),T0(30),B1(50)
259 FORI=1TO2000:NEXTI:SOUND180,2
260 CLS:PRINT@168,"I WILL CHOOSE WHO":PRINT@235,"GOES FIRST."
270 J=RND(2):FORI=1TO2000:NEXTI:CLS:SOUND180,2:PRINT@198,"I'M THE BLUE PIECES."
280 IFJ=1 THENPRINT@297,"AND I GO FIRST"
290 IFJ=2 THENPRINT@298,"YOU GO FIRST"
295 FORI=1TO2000:NEXTI:SOUND180,2
296 CLS:PRINT@194,"PLEASE WAIT A FEW MOMENTS...":PRINT@296,"I'M SETTING UP."
297 FORI=1TO2000:NEXTI
300 REM
302 CLS0:FORY=0TO12STEP3:FORX=0TO4
310 POKE16417+32*Y+4*X,207:POKE16418+32*Y+4*X,207:POKE16419+32*Y+4*X,192:POKE16420+32*Y+4*X,192
315 POKE16449+32*Y+4*X,204:POKE16450+32*Y+4*X,204:POKE16451+32*Y+4*X,195:POKE16452+32*Y+4*X,195
320 POKE16481+32*Y+4*X,192:POKE16482+32*Y+4*X,192:POKE16483+32*Y+4*X,207:POKE16484+32*Y+4*X,207
325 NEXTX:NEXTY
330 FORX=1TO10:POKE16383+2*X-1,96:POKE16383+2*X,111+X:NEXTX
335 POKE16404,96:POKE16405,96
340 FORX=1TO5:POKE16320+96*X,63+2*X:POKE16341+96*X,63+2*X:POKE16352+96*X,96:POKE16373+96*X,96:POKE16384+96*X,64+2*X
350 POKE16405+96*X,64+2*X:NEXTX
360 FORI=1TO5
365 SET(8*I-1,3,6):SET(8*I,3,6):SET(8*I-5,6,6):SET(8*I-4,6,6):SET(8*I-1,9,6):SET(8*I,9,6):SET(8*I-5,12,6):SET(8*I-4,12,6)
370 SET(8*I-1,21,8):SET(8*I,21,8):SET(8*I-5,24,8):SET(8*I-4,24,8):SET(8*I-1,27,8):SET(8*I,27,8):SET(8*I-5,30,8):SET(8*I-4,30,8)
375 NEXTI
380 FORI=1TO12:PRINT@32*I-9,"         ";:NEXTI
394 IFZ$="NO" THENONJGOTO700,610
395 ONJGOTO1000,3000
500 CLS:PRINT@132,"NAME OF FIRST PLAYER:":PRINT@196,"(LESS THAN 8 CHARACTERS)"
502 PRINT@268,"";:INPUT"";X$
505 IFLEN(X$)>8 THEN500
507 PRINT@323,"YOU HAVE THE BLUE PIECES."
508 FORI=1TO2000:NEXTI
509 SOUND180,2
510 CLS:PRINT@132,"NAME OF THE 2ND PLAYER:":PRINT@196,"(LESS THAN 8 CHARACTERS)"
512 PRINT@268,"";:INPUT"";Y$
515 IFLEN(Y$)>8 THEN510
517 PRINT@323,"YOU HAVE THE ORANGE PIECES."
518 FORI=1TO2000:NEXTI
519 SOUND180,2
520 CLS:PRINT@166,"I WILL CHOOSE WHO":PRINT@234,"GOES FIRST."
530 FORI=1TO2000:NEXTI
535 J=RND(2):SOUND180,2
540 IFJ=1 THEN CLS:PRINT@224,"IT'S ";X$;" WHO GOES FIRST."
550 IFJ=2 THEN CLS:PRINT@224,"IT'S ";Y$;" WHO GOES FIRST."
555 FORI=1TO2000:NEXTI:GOTO295
600 IFIN=1 THEN700
610 PRINT@55,"YOUR TURN";:PRINT@87,"        ";:PRINT@87,Y$;
620 PP=PJ:IN=1:GOTO3010
700 PRINT@55,"YOUR TURN";:PRINT@87,"        ";:PRINT@87,X$;
710 PP=PO:IN=0:GOTO3010
800 IFIN=1 THENCLS:PRINT@232,Y$;"LOST!":GOTO60000
810 CLS:PRINT@232,X$;"LOST!":GOTO60000
1000 REM
1001 PRINT@55,"MY TURN  ";
1005 PP=PO:PS=-100:IN=0:FI=0:GOSUB30000:GOSUB7000
1030 IFFI=1 THEN50000
1040 IFNI=1 THEN2000
1050 GOSUB36000:S0=NB:IFS0=1 THEN2000
1080 FORI=1TOS0:T0$(I)=S$(I):T0(I)=P(I):NEXTI
1110 FORR0=1TOS0
1111 M1=-100:MN=0:GOSUB38100
1120 FORT=1TO LEN(T0$(R0))/3:B1(VAL(MID$(T0$(R0),3*T-2,3)))=0:NEXTT
1137 IFLEN(T0$(R0))=6 THEN1155
1140 IFVAL(MID$(T0$(R0),LEN(T0$(R0))-5,3))>45 THENB1(VAL(MID$(T0$(R0),LEN(T0$(R0))-5,3)))=2:GOTO1170
1150 B1(VAL(MID$(T0$(R0),LEN(T0$(R0))-5,3)))=B0(VAL(LEFT$(T0$(R0),3)))
1152 GOTO1170
1155 IFVAL(RIGHT$(T0$(R0),3))>45 THENB1(VAL(RIGHT$(T0$(R0),3)))=2:GOTO1170
1158 B1(VAL(RIGHT$(T0$(R0),3)))=B0(VAL(LEFT$(T0$(R0),3)))
1170 GOSUB37100:IN=1:GOSUB30100:GOSUB7000
1185 IFFI=1 THENM1=0:GOTO1945
1190 GOSUB36000:S1=NB:FORI=1TOS1:T1$(I)=S$(I):T1(I)=P(I):NEXTI
1230 IFNI=2 OR NI=3 THENGOSUB38000:T0(R0)=T0(R0)-MO:GOTO1950
1300 FORR1=1TOS1
1305 GOSUB37100:GOSUB38200
1310 FORT=1TOLEN(T1$(R1))/3
1315 B2(VAL(MID$(T1$(R1),3*T-2,3)))=0
1320 NEXTT
1325 IFLEN(T1$(R1))=6 THEN1340
1330 IFVAL(MID$(T1$(R1),LEN(T1$(R1))-5,3))<6 THENB2(VAL(MID$(T1$(R1),LEN(T1$(R1))-5,3)))=-2:GOTO1350
1335 B2(VAL(MID$(T1$(R1),LEN(T1$(R1))-5,3)))=B1(VAL(LEFT$(T1$(R1),3))):GOTO1350
1340 IFVAL(RIGHT$(T1$(R1),3))<6 THENB2(VAL(RIGHT$(T1$(R1),3)))=-2:GOTO1350
1345 B2(VAL(RIGHT$(T1$(R1),3)))=B1(VAL(LEFT$(T1$(R1),3)))
1350 IN=0:GOSUB30200
1355 GOSUB7000:GOSUB38000:T1(R1)=T1(R1)-MO
1357 IFNI=5 AND MO>0 AND T1(R1)+MO-MO/NB=0 THENT1(R1)=0.5
1358 IFS1=1 OR T1(R1)>0 THENT1(R1)=2*T1(R1)
1937 IFT1(R1)>M1 THENM1=T1(R1)
1938 IFT1(R1)>0 THENMN=MN+T1(R1)
1940 NEXTR1
1945 IFMN=0 THENT0(R0)=T0(R0)-M1
1946 IFMN>0 THENT0(R0)=T0(R0)-MN
1950 NEXTR0
1960 GOSUB34000
1970 FORR0=1TO S0:S$(R0)=T0$(R0):P(R0)=T0(R0):NEXTR0:IN=0:GOSUB39000
2000 O=INT(LEN(S$(1))/6-1/2):PJ=PJ-O:GOSUB40000
2060 GOSUB30000
3000 REM
3002 IN=1:PRINT@55,"YOUR TURN";:PP=PJ
3010 IFIN=1 THENGOSUB37000
3020 GOSUB30000:GOSUB7000
3041 IFIN=1 THENPO=PO-O
3042 IFIN=0 THENPJ=PJ-O
3043 IFFI=1 AND Z$="YES" THEN51000
3044 IFFI=1 AND Z$="NO" THEN800
3045 SOUND102,5
3047 IFO>0 THENPRINT@119,"TAKE: ";:PRINT@125,O;
3050 FORI=1TO7:PRINT@151+32*I,"         ";:NEXTI:PRINT@183,"YOUR MOVE";:A$="":N=0
3051 B$=INKEY$:IFB$="" THEN3051
3052 IFASC(B$)=13 THEN3060
3053 IF(N+1)/2=INT((N+1)/2) AND (ASC(B$)>57 OR ASC(B$)<48) THEN3051
3054 IFN/2=INT(N/2) AND (ASC(B$)>74 OR ASC(B$)<65) THEN3051
3055 N=N+1:A$=A$+B$:IFN/2=INT(N/2) THENA$=A$+"/"
3056 FORI=0TOINT((LEN(A$))/9)
3057 IFLEN(RIGHT$(A$,LEN(A$)-9*I))<9 THEN3059
3058 PRINT@215+32*I,MID$(A$,9*I+1,9);:NEXTI
3059 PRINT@215+32*I,RIGHT$(A$,LEN(A$)-9*I);:GOTO3051
3060 IFLEN(A$)<>6 AND O=0 THEN3050
3070 IFLEN(A$)<>3+3*O AND O>0 THEN3050
3145 B$=""
3150 FORT=1TO LEN(A$)/3
3160 A=ASC(MID$(A$,3*T-2,1))-65
3170 B=VAL(MID$(A$,3*T-1,1))
3180 IF(A+B)/2=INT((A+B)/2) THEN3050
3190 C=5*A+1+INT(B/2)
3200 B$=B$+STR$(C)
3210 NEXTT
3220 A$=B$:GOSUB41000
3240 FORI=1TO50
3242 IFLEFT$(S$(I),3)<>LEFT$(A$,3) THEN3260
3244 IFO<2 AND LEFT$(S$(I),6)=A$ THENA$=S$(I):GOTO3300
3246 IFO<2 THEN3260
3248 FORJ=1TO O
3250 IFMID$(A$,1+3*J,3)<>MID$(S$(I),6*J-2,3) THEN3260
3252 NEXTJ
3254 A$=S$(I):GOTO3300
3260 NEXTI
3270 GOTO3050
3300 GOSUB40050
3310 IFIN=1 THENGOSUB37000
3320 FORI=1TO9:PRINT@87+32*I,"         ";:NEXTI
3400 IFZ$="NO" THENGOSUB30000:GOTO600
3410 GOTO1000
7000 REM
7010 FI=0:PT=0:J=1:O=0:O1=0
7020 FORI=1TO50
7025 IFPT=PP THEN7055
7030 IFA(I)<>1 THEN7050
7035 PT=PT+1
7040 E=I:U=E-10*INT(E/10):GOSUB10000
7050 NEXTI
7055 IFJ=1 THEN7300
7060 IFO1=0 AND O>0 THENGOSUB35000:GOSUB33000
7070 FORQ=1TOJ-1:A$=S$(Q):GOSUB41000:S$(Q)=A$:NEXTQ
7080 IFO1=0 THEN7250
7090 GOSUB33000
7100 R=1
7110 O=O+1:FORQ=1TO J-1
7120 IFLEN(S$(Q))<3+6*O THEN7140
7130 S0$(R)=S$(Q):P0(R)=P(Q):R=R+1
7140 NEXTQ
7150 GOSUB34000
7160 O1=0:J=1
7170 FORQ=1TO R-1
7180 FORT=1TO LEN(S0$(Q))/3
7190 A0(VAL(MID$(S0$(Q),3*T-2,3)))=0:NEXT T
7200 E=VAL(MID$(S0$(Q),LEN(S0$(Q))-5,3))
7210 A0(E)=1
7220 U=E-10*INT(E/10)
7230 GOSUB10000
7240 GOSUB31000
7244 NEXTQ
7246 GOTO7060
7250 FORI=1TO50
7260 IFS$(I)="" THEN7300
7265 IFIN=1 THEN7284
7270 IFLEN(S$(I))=6 AND VAL(RIGHT$(S$(I),3))>45 THENP(I)=P(I)+1
7280 IFLEN(S$(I))>6 AND VAL(MID$(S$(I),LEN(S$(I))-5,3))>45 THENP(I)=P(I)+1
7282 GOTO7290
7284 IFLEN(S$(I))=6 AND VAL(RIGHT$(S$(I),3))<6 THEN P(I)=P(I)+1
7286 IFLEN(S$(I))>6 AND VAL(MID$(S$(I),LEN(S$(I))-5,3))<6 THENP(I)=P(I)+1
7290 NEXTI
7300 FORI=1TO50
7305 IFPT=PP THEN7410
7310 IFA(I)<2 THEN7400
7315 PT=PT+1
7318 GOSUB30500
7320 O0=0:Z=I:U=Z-10*INT(Z/10)
7330 GOSUB20000
7340 IFO0=0 AND O=0 THEN7400
7350 IFO0<O THEN7400
7360 IFO0>O THENO=O0:FORT=1TO50:S$(T)=S1$(T):P(T)=P1(T):NEXTT:GOTO7400
7370 FORT=1TO50:IFS$(T)="" THENR=T-1:GOTO7390
7380 NEXTT
7390 FORT=1TO50:IFS1$(T)="" THEN7400
7395 S$(R+T)=S1$(T):P(R+T)=P1(T):NEXTT
7400 NEXTI
7410 IFS$(1)="" THENFI=1
7420 FORI=1TO50
7425 IFS$(I)="" THEN7500
7430 A$=S$(I):GOSUB41000:S$(I)=A$
7440 NEXTI
7500 RETURN
10000 IFU>0 AND U<5 THENA=E-4:B=E-9:GOSUB11000
10010 IFU>0 AND U<5 THENA=E+6:B=E+11:GOSUB11000
10020 IFU>1 AND U<6 THENA=E-5:B=E-11:GOSUB11000
10030 IFU>1 AND U<6 THENA=E+5:B=E+9:GOSUB11000
10040 IFU=1 OR U=0 THENA=E+5:B=0:GOSUB11000
10050 IFU=1 OR U=0 THENA=E-5:B=0:GOSUB11000
10060 IFU>5 THENA=E-5:B=E-9:GOSUB11000
10070 IFU>5 THENA=E+5:B=E+11:GOSUB11000
10080 IFU>6 OR U=0 THENA=E-6:B=E-11:GOSUB11000
10090 IFU>6 OR U=0 THENA=E+4:B=E+9:GOSUB11000
10100 RETURN
11000 IFA<1 OR A>50 THENRETURN
11010 IFA0(A)>0 THENRETURN
11015 IFIN=1 THEN11025
11020 IFA0(A)=0 AND A<E THENRETURN
11022 GOTO11030
11025 IFA0(A)=0 AND A>E THENRETURN
11030 IFA0(A)=0 AND O+O1>0 THENRETURN
11040 IFA0(A)=0 THENS$(J)=STR$(E)+STR$(A):J=J+1:RETURN
11050 IFB<1 OR B>50 THENRETURN
11060 IFA0(A)>=0 OR A0(B)<>0 THENRETURN
11065 IFO1=0 THENO1=1
11070 IFO=0 THENS$(J)=STR$(E)+STR$(B)+STR$(A):P(J)=-A(A)
11080 IFO>0 THENS$(J)=S0$(Q)+STR$(B)+STR$(A):P(J)=P0(Q)-A(A)
11090 J=J+1:RETURN
20000 GOSUB32000
20003 O1=0
20005 A=Z:B=Z:C=Z:D=Z
20010 FORK=1TO9
20020 IFU>5 OR U=0 THENM=K/2:N=(K+1)/2
20030 IFU<6 AND U>0 THENM=(K+1)/2:N=K/2
20040 IFA-10*INT(A/10)=5 OR A<6 THEN20070
20050 A=Z-4*INT(M)-5*INT(N)
20060 C1(K)=A0(A)
20070 IFB-10*INT(B/10)=5 OR B>45 THEN20110
20080 B=Z+6*INT(M)+5*INT(N)
20090 C2(K)=A0(B)
20110 IFC-10*INT(C/10)=6 OR C>45 THEN20140
20120 C=Z+5*INT(M)+4*INT(N)
20130 C3(K)=A0(C)
20140 IFD-10*INT(D/10)=6 OR D<6 THEN20170
20150 D=Z-5*INT(M)-6*INT(N)
20160 C4(K)=A0(D)
20170 NEXTK
20400 C=0
20410 FORK=1TO9
20420 IFC1(K)>0 THEN20450
20425 IFC<0 AND C1(K)<0 THEN20450
20430 IFC<0 AND C1(K)=0 THENO1=1:GOTO20700
20440 C=C+C1(K):NEXT K
20450 C=0
20460 FORK=1TO9
20470 IFC2(K)>0 THEN20500
20475 IFC<0 AND C2(K)<0 THEN20500
20480 IFC<0 AND C2(K)=0 THENO1=1:GOTO20700
20490 C=C+C2(K):NEXT K
20500 C=0
20510 FORK=1TO9
20520 IFC3(K)>0 THEN20550
20525 IFC<0 AND C3(K)<0 THEN20550
20530 IFC<0 AND C3(K)=0 THENO1=1:GOTO20700
20540 C=C+C3(K):NEXT K
20550 C=0
20560 FORK=1TO9
20570 IFC4(K)>0 THEN20700
20575 IFC<0 AND C4(K)<0 THEN20700
20580 IFC<0 AND C4(K)=0 THENO1=1:GOTO20700
20590 C=C+C4(K):NEXTK
20700 IFO0>0 THENRETURN
20710 IFO1=1 AND O0=0 THENO0=O0+1:GOTO22000
20720 IFO1=0 AND O>0 THENRETURN
21000 S$=STR$(Z)
21010 A=Z:B=Z:C=Z:D=Z
21020 FORK=1TO9
21030 IFU>5 OR U=0 THENM=K/2:N=(K+1)/2
21040 IFU>0 AND U<6 THENM=(K+1)/2:N=K/2
21050 IFA-10*INT(A/10)=5 OR A<6 THEN 21080
21060 A=Z-4*INT(M)-5*INT(N)
21070 IFA0(A)=0 THENS$(J)=S$+STR$(A):J=J+1
21075 IFA0(A)<>0 THENA=0
21080 IFB-10*INT(B/10)=5 OR B>45 THEN21110
21090 B=Z+6*INT(M)+5*INT(N)
21100 IFA0(B)=0 THENS$(J)=S$+STR$(B):J=J+1
21105 IFA0(B)<>0 THENB=51
21110 IFC-10*INT(C/10)=6 OR C>45 THEN21140
21120 C=Z+5*INT(M)+4*INT(N)
21130 IFA0(C)=0 THENS$(J)=S$+STR$(C):J=J+1
21135 IFA0(C)<>0 THENC=51
21140 IFD-10*INT(D/10)=6 OR D<6 THEN 21200
21150 D=Z-5*INT(M)-6*INT(N)
21160 IFA0(D)=0 THENS$(J)=S$+STR$(D):J=J+1
21165 IFA0(D)<>0 THEND=0
21200 NEXT K
21210 RETURN
22000 REM
22010 FORL=1TO50:S0$(L)=STR$(Z):P0(L)=0:NEXTL
22030 Q=1:GOSUB23000
22040 R=Q-1:FORQ=1TO R:S1$(Q)=S0$(Q):P1(Q)=P0(Q):NEXTQ:GOSUB33000:Q=1
22090 FORP=1TO R:A$=S1$(P):GOSUB41000:S1$(P)=A$:GOSUB31000
22120 FORT=1TOLEN(A$)/3
22125 IFT/2=INT(T/2) THENA0(VAL(MID$(A$,3*T-2,3)))=0
22130 IF(T-1)/2=INT((T-1)/2) AND T<>1 THENA0(VAL(MID$(A$,3*T-2,3)))=3
22135 NEXTT
22140 A0(VAL(MID$(A$,LEN(A$)-5,3)))=A0(VAL(LEFT$(A$,3)))
22145 A0(VAL(LEFT$(A$,3)))=0
22147 Z=VAL(MID$(A$,LEN(A$)-5,3)):U=Z-10*INT(Z/10)
22150 GOSUB20000
22160 IFO1=0 THEN22220
22180 Q0=Q:GOSUB23000:FOR T=Q0 TO Q-1:S0$(T)=S1$(P)+S0$(T):P0(T)=P1(P)+P0(T):NEXTT
22220 NEXTP
22230 IFS0$(1)="" THENRETURN
22240 GOSUB30500:O0=O0+1
22250 GOTO22040
23000 A=Z:B=Z:C=Z:D=Z
23010 A0=0:B0=0:C0=0:D0=0
23020 FORK=1TO9
23030 IFU>5 OR U=0 THENM=K/2:N=(K+1)/2
23040 IFU<6 AND U>0 THENM=(K+1)/2:N=K/2
23050 IFA-10*INT(A/10)=5 OR A<6 THEN23150 
23060 A=Z-4*INT(M)-5*INT(N)
23070 IFA0(A)>0 THENA=0:GOTO23150
23080 IFA0(A)=0 AND A0=0 THEN23150
23090 IFA0(A)=0 AND A0=1 THENS0$(Q)=S0$(Q)+STR$(A)+STR$(A1):P0(Q)=P0(Q)-A0(A1):Q=Q+1
23100 IFA0(A)<0 AND A0=0 THENA0=1:A1=A:GOTO23150
23110 IFA0(A)<0 AND A0=1 THENA=0
23150 IFB-10*INT(B/10)=5 OR B>45 THEN23250
23160 B=Z+6*INT(M)+5*INT(N)
23170 IFA0(B)>0 THENB=50:GOTO23250
23180 IFA0(B)=0 AND B0=0 THEN23250
23190 IFA0(B)=0 AND B0=1 THENS0$(Q)=S0$(Q)+STR$(B)+STR$(B1):P0(Q)=P0(Q)-A0(B1):Q=Q+1
23200 IFA0(B)<0 AND B0=0 THENB0=1:B1=B:GOTO23250
23210 IFA0(B)<0 AND B0=1 THENB=50
23250 IFC-10*INT(C/10)=6 OR C>45 THEN23350
23260 C=Z+5*INT(M)+4*INT(N)
23270 IFA0(C)>0 THENC=50:GOTO23350
23280 IFA0(C)=0 AND C0=0 THEN23350
23290 IFA0(C)=0 AND C0=1 THENS0$(Q)=S0$(Q)+STR$(C)+STR$(C1):P0(Q)=P0(Q)-A0(C1):Q=Q+1
23300 IFA0(C)<0 AND C0=0 THENC0=1:C1=C:GOTO23350
23310 IFA0(C)<0 AND C0=1 THENC=50
23350 IFD-10*INT(D/10)=6 OR D<6 THEN23450
23360 D=Z-5*INT(M)-6*INT(N)
23370 IFA0(D)>0 THEND=0:GOTO23450
23380 IFA0(D)=0 AND D0=0 THEN23450
23390 IFA0(D)=0 AND D0=1 THENS0$(Q)=S0$(Q)+STR$(D)+STR$(D1):P0(Q)=P0(Q)-A0(D1):Q=Q+1
23400 IFA0(D)<0 AND D0=0 THEND0=1:D1=D:GOTO23450
23410 IFA0(D)<0 AND D0=1 THEND=0
23450 NEXTK
23500 RETURN
30000 FORI=1TO50:A(I)=B0(I):NEXT I:GOSUB30450:RETURN
30100 FORI=1TO50:A(I)=B1(I):NEXT I:GOSUB30450:RETURN
30200 FORI=1TO50:A(I)=B2(I):NEXT I:GOSUB30450:RETURN
30450 FORI=1TO50:A0(I)=A(I):S$(I)="":S0$(I)="":S1$(I)="":P(I)=0:P0(I)=0:P1(I)=0:NEXT I:RETURN
30500 FORL=1TO50:S1$(L)="":P1(L)=0:NEXTL
31000 FORL=1TO50:A0(L)=A(L):NEXTL:RETURN
32000 FORK=1TO9:C1(K)=1:C2(K)=1:C3(K)=1:C4(K)=1:NEXT K:RETURN
33000 FORL=1TO50:S0$(L)="":P0(L)=0:NEXTL:RETURN
34000 FORL=1TO50:S$(L)="":P(L)=0:NEXTL:RETURN
35000 FORL=1TO50:S$(L)=S0$(L):P(L)=P0(L):NEXTL:RETURN
36000 NB=0:FORI=1TO50:IFS$(I)="" THENRETURN
36010 NB=NB+1:NEXTI:RETURN
37000 FORI=1TO50:B0(I)=-B0(I):NEXTI:RETURN
37100 FORI=1TO50:B1(I)=-B1(I):NEXTI:RETURN
38000 GOSUB36000:MO=0:IFNB=0 THENRETURN
38010 FORI=1TONB:MO=MO+P(I):NEXTI:RETURN
38100 FORI=1TO50:B1(I)=B0(I):NEXTI:RETURN
38200 FORI=1TO50:B2(I)=B1(I):NEXTI:RETURN
39000 FORI=1TO30
39040 T1$(I)="":T1(I)=0
39050 T0$(I)="":T0(I)=0
39060 NEXTI
39070 RETURN
40000 REM
40005 K=0:FORJ=1TO50:IFS$(J)="" THEN40030
40010 IFP(J)>PS THENK=0:PS=P(J)
40015 IFP(J)=PS THENK=K+1
40020 NEXTJ
40030 IFNI>2 THEN40040
40032 L=RND(K):K=0:FORJ=1TO50
40034 IFP(J)=PS THENK=K+1
40036 IFK=L THENA$=S$(J):GOTO40050
40038 NEXTJ
40040 K=0:FOR J=1 TO 50:IFS$(J)="" THEN40049
40041 IFP(J)<PS THEN40048
40042 N=B0(VAL(LEFT$(S$(J),3))):IFO>0 THENM=(VAL(MID$(S$(J),6*O-2,3))+4)/5:GOTO40046
40043 IFO=0 THENM=(VAL(RIGHT$(S$(J),3))+4)/5
40046 IFINT(M)>K AND N=1 THENL=0:K=INT(M)
40047 IFINT(M)=K AND N=1 THENL=L+1:L(L)=J
40048 NEXTJ
40049 K=RND(L):A$=S$(L(K))
40050 IFO>0 THEN40100
40055 IFIN=0 AND VAL(RIGHT$(A$,3))>45 THENB0(VAL(RIGHT$(A$,3)))=2:GOTO40070
40060 IFIN=1 AND VAL(RIGHT$(A$,3))<6 THENB0(VAL(RIGHT$(A$,3)))=2:GOTO40070
40065 B0(VAL(RIGHT$(A$,3)))=B0(VAL(LEFT$(A$,3))):B0(VAL(LEFT$(A$,3)))=0
40070 X=VAL(LEFT$(A$,3)):GOSUB40500
40080 X=VAL(RIGHT$(A$,3)):GOSUB40600
40085 B0(VAL(LEFT$(A$,3)))=0
40090 RETURN
40100 X=VAL(LEFT$(A$,3)):GOSUB40500
40110 FORT=1TO O
40115 IFT>1 THENX=VAL(MID$(A$,6*T-8,3)):B0(X)=0:GOSUB40500
40120 X=VAL(MID$(A$,6*T+1,3)):B0(X)=0:GOSUB40500
40125 X=VAL(MID$(A$,6*T-2,3)):B0(X)=B0(VAL(LEFT$(A$,3))):GOSUB40600
40130 NEXTT
40135 X=X-4
40140 IFIN=0 AND X>45 THENB0(X)=2:GOSUB40600
40150 IFIN=1 AND X<6 THENB0(X)=2:GOSUB40600
40170 B0(VAL(LEFT$(A$,3)))=0
40180 GOTO40580
40500 IFX-10*INT(X/10)>5 OR X-10*INT(X/10)=0 THEN40550
40505 U=X-10*INT(X/10):X=X+4
40510 RESET(8*U-1,3*INT(X/5))
40520 RESET(8*U,3*INT(X/5))
40525 SOUND180,2:RETURN
40550 U=X-5-10*INT((X-5)/10)
40555 X=X+4
40560 RESET(8*U-4,3*INT(X/5))
40570 RESET(8*U-5,3*INT(X/5))
40575 SOUND180,2:RETURN
40580 IFO=0 THENRETURN
40581 IFIN=0 THEN40590
40582 FORI=1TO20-PO
40583 IFI/2=INT(I/2) THENSET(64-I,31,6):GOTO40585
40584 SET(64-I,30,6)
40585 NEXTI:RETURN
40590 FORI=1TO20-PJ
40591 IFI/2=INT(I/2) THENSET(64-I,27,8):GOTO40594
40592 SET(64-I,26,8)
40594 NEXTI:RETURN
40600 U=X-10*INT(X/10)
40610 IFU>5 OR U=0 THEN40700
40615 X=X+4
40618 FORI=1TO6
40619 GOSUB40510
40620 IFB0(X-4)=1 AND IN=0 THENSET(8*U-1,3*INT(X/5),6):SET(8*U,3*INT(X/5),6)
40630 IFB0(X-4)=1 AND IN=1 THENSET(8*U-1,3*INT(X/5),8):SET(8*U,3*INT(X/5),8)
40640 IFB0(X-4)=2 AND IN=0 THENSET(8*U-1,3*INT(X/5),3):SET(8*U,3*INT(X/5),3)
40650 IFB0(X-4)=2 AND IN=1 THENSET(8*U-1,3*INT(X/5),4):SET(8*U,3*INT(X/5),4)
40660 NEXTI:GOTO40750
40700 U=X-5-10*INT((X-5)/10)
40705 X=X+4
40708 FORI=1TO6
40709 GOSUB40560
40710 IFB0(X-4)=1 AND IN=0 THENSET(8*U-4,3*INT(X/5),6):SET(8*U-5,3*INT(X/5),6)
40720 IFB0(X-4)=1 AND IN=1 THENSET(8*U-4,3*INT(X/5),8):SET(8*U-5,3*INT(X/5),8)
40730 IFB0(X-4)=2 AND IN=0 THENSET(8*U-4,3*INT(X/5),3):SET(8*U-5,3*INT(X/5),3)
40740 IFB0(X-4)=2 AND IN=1 THENSET(8*U-4,3*INT(X/5),4):SET(8*U-5,3*INT(X/5),4)
40748 NEXTI
40750 SOUND180,2:RETURN
41000 FORT=1TO50
41010 IFASC(MID$(A$,3*T,1))<>32 THEN41050
41020 A$=LEFT$(A$,3*T-3)+" "+RIGHT$(A$,LEN(A$)-3*T+3)
41050 IFLEN(A$)-3*T=2 THENA$=LEFT$(A$,3*T)+" "+RIGHT$(A$,2):GOTO41100
41060 IFLEN(A$)-3*T=0 THEN41100
41070 NEXTT
41100 RETURN
50000 CLS:PRINT@234,"I HAVE LOST!":GOTO60000
51000 CLS:PRINT@233,"YOU HAVE LOST!":GOTO60000
60000 SOUND150,20:GOTO20
