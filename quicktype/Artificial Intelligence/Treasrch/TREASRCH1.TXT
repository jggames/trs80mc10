100 CLEAR100:CLS:SH=0:ST=0:MC=-124
110 PRINT@256,"PLEASE ENTER YOUR NAME":INPUTN$:N$=LEFT$(N$,7)
120 DIMA(255),B(99),D(4),E(12),M(12)
130 DIMPV(12,12),Q(12),V(12),Z(12)
140 D(1)=-10:D(2)=-1:D(3)=1:D(4)=10
150 A(65)=-1:A(83)=1:A(87)=10:A(90)=-10:CLS
160 PRINT@256,"TRS-80 PLAYING STRENGTH (1-5)":INPUTY
170 DM=2*Y:FORI=11TO88:B(I)=RND(9):NEXTI
180 FORI=0TO10:B(I)=99:NEXTI:FORI=89TO99:B(I)=99:NEXTI
190 FORI=19TO79STEP10:B(I)=99:B(I+1)=99:NEXTI
220 CLS:FORI=11TO88:IFB(I)=99THEN240
230 X$=RIGHT$(STR$(B(I)),1):GOSUB1000
240 NEXTI:PRINT@8,"TREASURE SEARCH";Y;
250 PRINT@129,N$;:PRINT@225,"TRS-80";:Y$="         "
260 T=54:T$="*":H=45:H$="x"
270 I=T:X$=T$:GOSUB1000:B(T)=99:B(H)=99
280 I=H:X$=H$:GOSUB1000:GOTO300
290 PRINT@448,"ILLEGAL MOVE. TRY AGAIN";:FORI=1TO2500:NEXTI
300 PRINT@448,"":PRINT@448,"WHICH DIRECTION FOR x?";
310 M$=INKEY$:IFM$=""THEN310
311 R=ASC(M$)
320 J=H+A(R)
330 IFB(J)=99THEN290
331 PRINT@448,""
360 I=H:B(I)=0:X$="-":GOSUB1000:SH=SH+B(J)
370 H=J:B(H)=99:I=H:X$=H$:GOSUB1000
380 PRINT@162,SH;:IFSH>99THEN930
510 DT=DM
520 L=1:SC=0:S=-1
530 V(0)=-99:V(1)=-99:M(0)=T:M(1)=H
540 L=L+1:Q(L)=0:S=-S:V(L)=V(L-2)
580 Q(L)=Q(L)+1:IFQ(L)>4THEN760
590 J=M(L-2)+D(Q(L))
600 IFB(J)=99THEN580
601 M(L)=J:E(L)=B(J)
610 B(J)=99:B(M(L-2))=0:SC=SC+S*E(L)
620 PRINT@179+MC+32*L,STR$(J);STR$(SC);STR$(V(L))" ";:IFL<DTTHEN540
670 V(L+1)=-S*SC
680 B(M(L))=E(L):B(M(L-2))=99:SC=SC-S*E(L)
700 IFV(L)<-V(L+1)THENV(L)=-V(L+1):GOTO740
701 GOTO580
740 IFL=2THENBM=M(L):PRINT@180+MC,STR$(BM);STR$(V(2));
750 IFV(L)<-V(L-1)THEN580:REM GOTO580
760 L=L-1:S=-S:PRINT@243+MC+32*L,Y$;:IFL>1THEN680
800 I=T:B(I)=0:X$="-":GOSUB1000:PRINT@179+MC,Y$;
810 T=BM:ST=ST+B(T):B(T)=99:I=T:X$=T$
820 GOSUB1000:PRINT@258,ST;:IFST<100THEN300
910 PRINT@448,"THANK YOU FOR A PLEASANT GAME";
920 PRINT@480,"TRY AGAIN? (Y/N)";
921 M$=INKEY$
922 IFM$="Y"THENRUN
923 IFM$="N"THENEND
924 GOTO921
930 PRINT@448,"CONGRATULATIONS, YOU WIN";:GOTO920
1000 R=INT(I/10):C=I-10*R:K=70+(8-R)*32+C*2
1010 PRINT@K,X$;:RETURN

REM 550 J=Z(L):I=0
REM 560 I=I+1:IFJ=M(L-2)+D(I)THEN600
REM 561 IFI<4THEN560
REM 590 J=M(L-2)+D(Q(L)):IFJ=Z(L)THEN580
REM 710 IFL>2THENZ(L)=M(L)

REM 500 FORI=4TODM:Z(I-2)=PV(2,I):NEXTI
REM 510 IFPV(2,3)=HTHENDT=DM:GOTO520
REM 511 DT=2

REM 720 I=L:PV(L,I)=M(L):IFL=DTTHEN740
REM 730 I=I+1:PV(L,I)=PV(L+1,I):IFI<DTTHEN730
REM 780 IFDT=DMTHEN800
REM 790 FORI=2TODT:Z(I)=PV(2,I):NEXTI:DT=DT+2:GOTO520 
