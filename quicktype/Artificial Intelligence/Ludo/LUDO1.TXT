0 REM VERSION VOM 1.10.1988
1 POKE31125,201:POKE31126,39:POKE30862,82:POKE30863,121
2 COLOR,0:POKE30744,1:POKE31173,201:POKE31172,243
4 FORQ%=30977TO31002:POKEQ%,2:NEXT
6 POKE31058,205:POKE31059,211:POKE31060,1:POKE31061,195
7 POKE31062,201:POKE31063,20
10 DIMCR(4),SR(4),CP(4),SP(4),CF(47),SF(47),H(4)
12 CR(1)=-4:CR(2)=-3:CR(3)=-2:CR(4)=-1
14 SR(1)=-4:SR(2)=-3:SR(3)=-2:SR(4)=-1:GOSUB18000
16 GOSUB13000
20 CLS
100 GOSUB2000:GOSUB4000
112 IFSZ>=4ORCZ>=4THEN14000
120 W=USR(6):PRINT@206,"ICH HABE EINE";W
130 PRINT@238,"GEWUERFELT.":PRINT@270,"WARTEN SIE KURZ,"
140 PRINT@302,"DENN ICH MUSS":PRINT@334,"UEBERLEGEN."
150 IFCG=0THEN12000
152 IFCSTHEN12000
160 GOTO12070
300 GOSUB4000:GOSUB2000
312 IFSZ=4THEN14000
320 W=USR(6)
330 PRINT@206,"SIE HABEN EINE";W;
340 PRINT@238,"GEWUERFELT."
342 IFSG=0ANDW<>6THENPRINT@270,"ICH BIN DRAN":GOTO100
344 IFSG=1THENI=USR(4)ELSE350
345 IF((SR(I)<0)AND(W<>6))ORSR(I)>39,330ELSEIFW<>6,400
350 PRINT@270,"MIT WELCHER FIGUR";
360 PRINT@302,"(1-4) ZIEHEN SIE?";
370 PRINT@366,"    ^    ^";
380 PRINT@0,;:INPUT"FIGUR";I
390 IFI<1ORI>4THEN380
400 IFSR(I)<0ANDW=6THEN12200
402 IFSR(I)<0THEN380
410 IFSR(I)>39THEN380
420 SR(I)=SR(I)+W
430 IFSR(I)>43THENSR(I)=SR(I)-1:GOTO430
432 GOSUB460
440 IFW=6THEN300
450 GOTO100
460 GOSUB10000
478 C=0
480 FORA=1TO4
490 IFSP(I)=CP(A)THENC=A:A=4
500 NEXT
510 IFC=0THENRETURN
520 CR(C)=C-5
530 SOUND31,9:RETURN
700 FORZ=1TO4
710 IF362=CP(Z)THENSOUND31,9:M=Z:Z=4
715 NEXT
716 CR(M)=M-5
720 RETURN
2000 COLOR7:FORA=5TO15
2020 IFA=9ORA=11THENPRINT@(A*32),"*****+*****":GOTO2050
2030 IFA=10THENPRINT@(A*32),"*++++%++++*":GOTO2050
2032 IFA=5ORA=15THENPRINT@(A*32+4),"***";:GOTO2050
2040 PRINT@(A*32+4),"*+*"
2050 NEXT:PRINT@0,;
2052 PRINT@224,"    ":PRINT@423,"    "
2060 PRINT@256,"=>"
2070 PRINT@393,"<="
2080 GOSUB10000
2090 COLOR2
2100 PRINT@CP(1),"%";
2110 PRINT@CP(2),"%";
2120 PRINT@CP(3),"%";
2130 PRINT@CP(4),"%";
2140 PRINT@SP(1),"";
2150 PRINT@SP(2),"";
2160 PRINT@SP(3),"ݻ";
2170 PRINT@SP(4),"";
2190 FORQ1=0TO4:PRINT@Q1*32,"                                ";
2210 NEXT
2240 COLOR7
2250 PRINT@173,"^";:FORQ1=6TO14
2260 PRINT@(Q1*32+13),"                 ";:NEXT:PRINT@0,;
2270 PRINT@493,"";:POKE29183,128+6*16+8
2290 FORQ1=0TO2:PRINT@Q1*32,"                                ";
2300 NEXT:RETURN
4000 CS=0:CZ=0:SS=0:SZ=0
4020 IFCR(1)<0THENCS=CS+1
4030 IFCR(2)<0THENCS=CS+1
4040 IFCR(3)<0THENCS=CS+1
4050 IFCR(4)<0THENCS=CS+1
4060 IFCR(1)>39THENCZ=CZ+1
4070 IFCR(2)>39THENCZ=CZ+1
4080 IFCR(3)>39THENCZ=CZ+1
4090 IFCR(4)>39THENCZ=CZ+1
4100 IFSR(1)<0THENSS=SS+1
4110 IFSR(2)<0THENSS=SS+1
4120 IFSR(3)<0THENSS=SS+1
4130 IFSR(4)<0THENSS=SS+1
4140 IFSR(1)>39THENSZ=SZ+1
4150 IFSR(2)>39THENSZ=SZ+1
4160 IFSR(3)>39THENSZ=SZ+1
4170 IFSR(4)>39THENSZ=SZ+1
4180 CG=4-CZ-CS:SG=4-SZ-SS:RETURN
10000 FORX=1TO4:CP(X)=CF(CR(X)+4):SP(X)=SF(SR(X)+4):NEXT:RETURN
11000 Q=0:FORA=1TO4:FORB=1TO4:IFCR(A)+W>39,Q=1:Y=A:GOTO11100
11010 C=CR(A):IFC<6ORC>39GOTO11100
11020 S=SR(B)+20:IFS>39,S=S-40
11030 IFC-S>0ANDC-S<7,Q=1:Y=A
11100 IFQ=1,Q=0:A=4:B=4
11110 NEXT:NEXT
11120 IFYTHENRETURN
11130 Q=0:A=CR(1):B=CR(2):C=CR(3):D=CR(4):E=-1:F=39
11140 IFA>EANDA<FTHENQ=1
11150 IFB>EANDB<FANDB>ATHENQ=2
11160 IFC>EANDC<FANDC>BTHENQ=3
11170 IFD>EANDD<FANDD>CTHENQ=4
11180 IFQTHENY=Q
11190 RETURN
12000 IFCS=0THEN12070
12008 IFW<>6ANDCS<4THEN12070
12010 IFW<>6THEN300
12020 IFCR(1)<0THENI=1
12030 IFCR(2)<0THENI=2
12040 IFCR(3)<0THENI=3
12050 IFCR(4)<0THENI=4
12052 GOSUB10000:C=0:FORD=1TO4
12054 IF288=SP(D)THENC=D:D=4
12056 NEXT:IFCTHENSOUND9,9:SR(C)=C-5
12060 CR(I)=0:GOTO100
12070 GOSUB4000
12080 IFCG=0GOTO300
12090 Y=0:FORA=1TO4:FORB=1TO4:Q=0
12110 IFCR(A)<0ORCR(A)>37THEN12115ELSEIFCF(CR(A)+4+W)=SP(B),Q=1
12115 IFQ,Q=0:Y=A:A=4:B=4
12120 NEXT:NEXT
12122 IFY=0GOSUB11000
12130 IFY=0THENY=USR(4)
12132 IFCR(Y)<0ORCR(Y)>39THENY=0:GOTO12130
12134 IFCZ>=4THENSOUND31,9:GOTO14000
12136 CR(Y)=CR(Y)+W
12138 IFCR(Y)>43THENCR(Y)=43
12140 GOSUB10000
12150 FORA=1TO4
12160 IFCP(Y)=SP(A)THENSR(A)=A-5:SOUND1,9
12170 NEXT:IFW=6THEN100
12180 GOTO300
12200 GOSUB700:SR(I)=0:GOSUB4000:GOSUB2000:GOTO320
13000 COLOR4:FORA=28672TO29183:POKEA,128:NEXT
13010 PRINT@128,;
13020 PRINT"^%%
13030 PRINT"%%%^
13040 PRINT"%%^%
13050 PRINT"%%^
13060 PRINT"%%
13070 PRINT"%%
13080 PRINT"%%%%%%&%
13090 PRINT@480,"1988BYLPV"CHR$(27)CHR$(27)CHR$(27);
13100 PRINT@0,"EIN PROGRAMM VON
13110 SOUND16,3;20,3;20,3;23,3;23,3;28,7
13130 FORQ=28672TO29183:POKEQ,128:NEXT:COLOR6
13140 PRINT@0,;
13150 PRINT"MENSCH%%AERGERE
13160 PRINT"^
13170 PRINT"
13180 PRINT"%%
13190 PRINT"^
13200 PRINT"
13210 PRINT"%%%%%%
13220 PRINT"^^^^
13230 PRINT"
13240 PRINT"%%%%%%
13250 PRINT"^
13260 PRINT"
13270 PRINT"%%
13280 PRINT"^
13290 PRINT"
13300 PRINT"DICH%%NICHT !"CHR$(28);
13310 FORQ=1TO4000:NEXT
13320 RETURN
14000 IFSZ=4THEN15000
14020 GOSUB13130
14030 FORQ=28672TO29183:POKEQ,128:NEXT:COLOR5
14040 PRINT@0,"
14050 PRINT"&
14060 PRINT""
14070 COLOR4:PRINT:PRINT:PRINT
14080 PRINT"&&
14090 PRINT"
14100 PRINT"&&&
14110 FORQ=1TO31STEPUSR(10):SOUNDQ,1:NEXT
14130 FORC=1TO3:A=16*(USR(8)-1):FORD=28672TO29000:E=PEEK(D)
14170 F=EAND143ORA:POKED,F:NEXT:NEXT
14190 FORQ=28672TO29183:POKEQ,128:NEXT
14200 PRINT@0,;:COLOR8
14210 PRINT"&
14220 PRINT"&
14230 PRINT"&&
14240 PRINTCHR$(10)CHR$(10)CHR$(10);
14250 COLOR6
14260 PRINT"&
14270 PRINT"&
14280 PRINT"
14290 PRINTCHR$(10)CHR$(10)CHR$(10);
14300 COLOR3
14310 PRINT"&&
14320 PRINT"
14330 PRINT"&";:PRINT@0,;
14340 A$=INKEY$:A$=INKEY$:A$=INKEY$:A$=INKEY$:A$=INKEY$
14350 A$=INKEY$
14360 IFA$="J"RUN
14370 IFA$="N"THEN16000ELSE14350
15000 FORQ=28672TO29183:POKEQ,128:NEXT:COLOR5:PRINT@0,;
15020 PRINT"
15030 PRINT"&&
15040 PRINT"&
15050 GOTO14070
16000 FORQ=28672TO29183:POKEQ,128:NEXT:PRINT@0,;:COLOR1
16010 PRINT"&
16020 PRINT"&
16030 PRINT"
16050 PRINTCHR$(10)CHR$(10)CHR$(10);
16060 PRINT"&&&
16070 PRINT"
16080 PRINT"
16090 PRINTCHR$(10)CHR$(10)CHR$(10);
16100 PRINT"
16110 PRINT"&&
16120 PRINT"&";CHR$(28);
16130 SOUND16,3;20,3;20,3;23,3;23,3;28,7:CLS:END
17000 DATA224,225,226,227,288,289,290,291,292,260,228,196,164
17010 DATA165,166,198,230,262,294,295,296,297,298,330,362,361
17020 DATA360,359,358,390,422,454,486,485,484,452,420,388,356
17030 DATA355,354,353,352,320,321,322,323,324
17100 DATA426,425,424,423,362,361,360,359,358,390,422,454,486
17110 DATA485,484,452,420,388,356,355,354,353,352,320,288,289
17120 DATA290,291,292,260,228,196,164,165,166,198,230,262,294
17130 DATA295,296,297,298,330,329,328,327,326
18000 RESTORE:FORQ=0TO47:READCF(Q):NEXT:FORQ=0TO47:READSF(Q)
18010 NEXT:RETURN
