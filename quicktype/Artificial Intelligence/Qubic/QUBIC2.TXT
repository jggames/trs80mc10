0 CLEAR500:DIMCC,ZZ,M$,I$:GOTO50
1 ZZ=1:CC=32:FORCC=CCTOZZSTEP-1:I$=MID$(M$,CC,1):IFI$=" "ORI$=""THEN?MID$(M$,ZZ,CC-ZZ):ZZ=CC+1:CC=ZZ+32:IFI$=""THENCC=0
2 NEXT:RETURN
3 ZZ=1:CC=8:FORCC=CCTOZZSTEP-1:I$=MID$(M$,CC,1)
4 IFI$=" "ORI$=""THENPRINT@PP,MID$(M$,ZZ,CC-ZZ);:PP=PP+32:ZZ=CC+1:CC=ZZ+8:IFI$=""THENCC=0
5 NEXT:M$="":RETURN
50 CLS
100 PRINTTAB(13)"QUBIC":PRINT
110 PRINTTAB(7)"CREATIVE COMPUTING":PRINTTAB(5)"MORRISTOWN, NEW JERSEY":PRINT:PRINT
120 M$="THE GAME IS TIC-TAC-TOE IN A 4 X 4 X 4 CUBE.":GOSUB1:PRINT:PRINT
210 PRINT"DO YOU WANT INSTRUCTIONS";
220 INPUTC$
230 IFLEFT$(C$,1)="N"THEN315
240 IFLEFT$(C$,1)="Y"THEN265
250 M$="INCORRECT ANSWER.  PLEASE TYPE 'YES' OR 'NO'":GOSUB1
260 GOTO220
265 CLS
280 M$="   EACH MOVE IS INDICATED BY A 3 DIGIT NUMBER, WITH EACH "
290 M$=M$+"DIGIT BETWEEN 1 AND 4 INCLUSIVE. THE DIGITS INDICATE THE "
300 M$=M$+"LEVEL, ROW, AND COLUMN, RESPECTIVELY, OF THE OCCUPIED "
305 M$=M$+"PLACE. ":GOSUB1
308 M$="   THE PROGRAM WILL PRINT THE BOARD WITH YOUR MOVES INDI"
309 M$=M$+"CATED WITH A 'X', THE MACHINE'S MOVES WITH AN 'O' AND "
310 M$=M$+"UNUSED SQUARES WITH A '.'":GOSUB1
312 M$="   TO STOP THE PROGRAM RUN, TYPE 1 AS YOUR MOVE.":GOSUB1
315 DIMX(64),L(76),M(76,4),Y(16)
320 FORI=1TO16
330 READY(I)
340 NEXT
350 FORI=1TO76
360 FORJ=1TO4
370 READM(I,J)
380 NEXT
390 NEXT
400 FORI=1TO64
410 X(I)=0
420 NEXT
430 Z=1
440 PRINT:PRINT"DO YOU WANT TO MOVE FIRST";
450 INPUTS$
460 IFLEFT$(S$,1)="N"THENCLS:GOSUB2550:GOTO630
470 IFLEFT$(S$,1)="Y"THENCLS:GOTO500
480 M$="INCORRECT ANSWER.  PLEASE TYPE 'Y' OR 'N'.":GOSUB1
490 GOTO450
500 GOSUB2550
510 PRINT@0*32+25,"your";:PRINT@1*32+25,"move";:PRINT@2*32+24,"":PRINT@2*32+25,;
520 INPUTJ1:FORCC=3TO14:PRINT@32*CC+24,"":NEXT
521 IFJ1=1THEN2770
522 IFJ1<>0THEN525
524 GOTO500
525 IFJ1<111THEN2750
526 IFJ1>444THEN2750
530 GOSUB2500
540 K1=INT(J1/100)
550 J2=(J1-K1*100)
560 K2=INT(J2/10)
570 K3=J1-K1*100-K2*10
580 M=16*K1+4*K2+K3-20
590 IFX(M)=0THEN620
600 PP=3*32+24:M$="THAT SQUARE IS USED, TRY AGAIN.":GOSUB3
610 GOTO500
620 X(M)=1
630 GOSUB1640
640 J=1
650 I=1
660 IFJ=1THEN720
670 IFJ=2THEN790
680 IFJ=3THEN930
690 I=I+1:IFI<=76THEN660
700 J=J+1:IFJ<=3THEN650
710 GOTO1300
720 IFL(I)<>4THEN690
730 PP=6*32+24:M$="YOU WIN AS FOLLOWS":GOSUB3
740 FORJ=1TO4
750 M=M(I,J)
760 GOSUB1570
770 NEXTJ
780 GOTO1490
790 IFL(I)<>15THEN690
800 FORJ=1TO4
810 M=M(I,J)
820 IFX(M)<>0THEN860
830 X(M)=5
840 PP=3*32+24:M$="MACHINE MOVES TO"
850 GOSUB1570
860 NEXTJ
870 PP=6*32+24:M$="AND WINS AS FOLLOWS":GOSUB3
880 FORJ=1TO4
890 M=M(I,J)
900 GOSUB1570
910 NEXTJ
920 GOTO1490
930 IFL(I)<>3THEN690
940 PP=3*32+24:M$="NICE TRY. MACHINE MOVES TO"
950 FORJ=1TO4 
960 M=M(I,J)
970 IFX(M)<>0THEN1010
980 X(M)=5
990 GOSUB1570
1000 GOTO500
1010 NEXTJ
1020 GOTO1300
1030 I=1
1040 L(I)=X(M(I,1))+X(M(I,2))+X(M(I,3))+X(M(I,4))
1050 L=L(I)
1060 IFL<2THEN1130
1070 IFL>=3THEN1130
1080 IFL>2THEN2230
1090 FORJ=1TO4
1100 IF X(M(I,J))<>0THEN1120
1110 X(M(I,J))=1/8
1120 NEXTJ
1130 I=I+1:IFI<=76THEN1040
1140 GOSUB1640
1150 I=1
1160 IFL(I)=1/2THEN2360
1170 IFL(I)=1+3/8THEN2360
1180 I=I+1:IFI<=76THEN1160
1190 GOTO1830
1200 Z=1
1210 IFX(Y(Z))=0THEN1250
1220 Z=Z+1
1230 IFZ<>17THEN1210
1240 GOTO1720
1250 M=Y(Z)
1260 X(M)=5
1270 PP=3*32+24:M$="MACHINE MOVES TO"
1280 GOSUB1570
1290 GOTO500
1300 X=X
1310 I=1
1320 L(I)=X(M(I,1))+X(M(I,2))+X(M(I,3))+X(M(I,4))
1330 L=L(I)
1340 IFL<10THEN1410
1350 IFL>=11THEN1410
1360 IFL>10THEN2230
1370 FORJ=1TO4
1380 IFX(M(I,J))<>0THEN1400
1390 X(M(I,J))=1/8
1400 NEXTJ
1410 I=I+1:IFI<=76THEN1320
1420 GOSUB1640
1430 I=1
1440 IFL(I)=.5THEN2360
1450 IFL(I)=5+3/8THEN2360
1460 I=I+1:IFI<=76THEN1440
1470 GOSUB2500
1480 GOTO1030
1490 GOSUB2550:PRINT@15*32+24,"another";:POKE16384+511,63
1510 X$=INKEY$:IFX$=""THEN1510
1520 IFX$="Y"THENCLS:GOTO400
1530 IFX$="N"THENCLS:GOTO1560
1550 GOTO1510
1560 END
1570 K1=INT((M-1)/16)+1
1580 J2=M-16*(K1-1)
1590 K2=INT((J2-1)/4)+1
1600 K3=M-(K1-1)*16-(K2-1)*4
1610 M=K1*100+K2*10+K3
1620 M$=M$+STR$(M):GOSUB3
1630 RETURN
1640 FORS=1TO76
1650 J1=M(S,1)
1660 J2=M(S,2)
1670 J3=M(S,3)
1680 J4=M(S,4)
1690 L(S)=X(J1)+X(J2)+X(J3)+X(J4)
1700 NEXTS
1710 RETURN
1720 FORI=1TO64
1730 IFX(I)<>0THEN1800
1740 X(I)=5
1750 M=I
1760 PP=3*32+24:M$="MACHINE LIKES"
1770 GOSUB1570
1790 GOTO500
1800 NEXTI
1810 PP=6*32+24:M$="THE GAME IS A DRAW.":GOSUB3
1820 GOTO1490
1830 FORK=1TO18
1840 P=0
1850 FORI=4*K-3TO4*K
1860 FORJ=1TO4
1870 P=P+X(M(I,J))
1880 NEXTJ
1890 NEXTI
1900 IFP<4THEN1940
1910 IFP<5THEN1970
1920 IFP<9THEN1940
1930 IFP<10THEN1970
1940 NEXTK
1950 GOSUB2500
1960 GOTO1200
1970 S=1/8
1980 FORI=4*K-3TO4*K
1990 GOTO2370
2000 NEXTI
2010 S=0
2020 GOTO1980
2030 DATA 1,49,52,4,13,61,64,16,22,39,23,38,26,42,27,43
2040 DATA 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20
2050 DATA 21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38
2060 DATA 39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56
2070 DATA 57,58,59,60,61,62,63,64
2080 DATA 1,17,33,49,5,21,37,53,9,25,41,57,13,29,45,61
2090 DATA 2,18,34,50,6,22,38,54,10,26,42,58,14,30,46,62
2100 DATA 3,19,35,51,7,23,39,55,11,27,43,59,15,31,47,63
2110 DATA 4,20,36,52,8,24,40,56,12,28,44,60,16,32,48,64
2120 DATA 1,5,9,13,17,21,25,29,33,37,41,45,49,53,57,61
2130 DATA 2,6,10,14,18,22,26,30,34,38,42,46,50,54,58,62
2140 DATA 3,7,11,15,19,23,27,31,35,39,43,47,51,55,59,63
2150 DATA 4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64
2160 DATA 1,6,11,16,17,22,27,32,33,38,43,48,49,54,59,64
2170 DATA 13,10,7,4,29,26,23,20,45,42,39,36,61,58,55,52
2180 DATA 1,21,41,61,2,22,42,62,3,23,43,63,4,24,44,64
2190 DATA 49,37,25,13,50,38,26,14,51,39,27,15,52,40,28,16
2200 DATA 1,18,35,52,5,22,39,56,9,26,43,60,13,30,47,64
2210 DATA 49,34,19,4,53,38,23,8,57,42,27,12,61,46,31,16
2220 DATA 1,22,43,64,16,27,38,49,4,23,42,61,13,26,39,52
2230 FORJ=1TO4
2240 IFX(M(I,J))<>1/8THEN2330
2250 X(M(I,J))=5
2260 IFL(I)<5THEN2290
2270 PP=3*32+24:M$="LET'S SEE YOU GET OUT OF THIS: MACHINE MOVES TO"
2280 GOTO2300
2290 PP=3*32+24:M$="YOU FOX. JUST IN THE NICK OF TIME, MACHINE MOVES TO"
2300 M=M(I,J)
2310 GOSUB1570
2320 GOTO500
2330 NEXTJ
2340 PP=3*32+24:M$="MACHINE CONCEDES THIS GAME.":GOSUB3
2350 GOTO1490
2360 S=1/8
2370 IFI-INT(I/4)*4>1THEN2400
2380 A=1
2390 GOTO2410
2400 A=2
2410 FORJ=ATO5-ASTEP5-2*A
2420 IFX(M(I,J))=STHEN2450
2430 NEXTJ
2440 GOTO2000
2450 X(M(I,J))=5
2460 M=M(I,J)
2470 PP=3*32+24:M$="MACHINE TAKES"
2480 GOSUB1570
2490 GOTO500
2500 FORI=1TO64
2510 IFX(I)<>1/8THEN2530
2520 X(I)=0
2530 NEXTI
2540 RETURN
2550 CC=0:PRINT@CC*32,;:FORI=1TO4
2560 FORJ=1TO4:FORI1=1TOJ:PRINT"   ";:NEXT
2570 FORK=1TO4
2600 Q=16*I+4*J+K-20
2610 IFX(Q)<>OTHEN2630
2620 PRINT".  ";
2630 IFX(Q)<>5THEN2650
2640 PRINT"O  ";
2650 IFX(Q)<>1THEN2660
2655 PRINT"X  ";
2660 IFX(Q)<>1/8THEN2670
2665 PRINT".  ";
2670 NEXT
2680 CC=CC+1:IFCC<16THENPRINT@CC*32,;
2700 NEXT
2730 NEXT
2735 SOUND1,1
2740 RETURN
2750 PP=32*32+24:M$="INCORRECT MOVE, RETYPE IT--":GOSUB3
2760 GOTO520
2770 END
