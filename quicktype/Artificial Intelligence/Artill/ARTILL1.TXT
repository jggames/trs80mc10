1 CLEAR7:CLS(0):DIMA(13):V2=9:EL=45:V3=10:CL=40:PI=3.1416/180:GOSUB43
2 A(0)=B/2+3:A(1)=A-4:A(5)=-2:A(4)=2:A(7)=62-C/2:A(8)=E-4:C$="EL,MV"
4 X=B/2:Y=A-1:X1=0:GOSUB51:X=63-C/2:Y=E-1:X1=1:GOSUB51
5 IFA(13)=0THEN11
6 I=1:GOSUB34:GOSUB35:IFZ=0THEN A(9)=H1:A(10)=V1:GOTO14ELSE A(13)=0:ON Z GOTO14,30,7,7,10
7 IFH1>B/2THEN IF H1>B+D THEN IF CL>45 THEN IF V3>12 THEN8ELSE12 ELSE8 ELSE12 ELSE CL=CL+3:GOTO13
8 CL=CL+5:IFCL>75 THEN CL=72:V3=V3+.5
9 GOTO13
10 GOSUB29:GOTO14
11 GOSUB28:A(11)=-SIN(PI*(90-CL))*V3*.25:A(12)=SIN(CL*PI)*V3*.25:A(13)=1:A(9)=A(7):A(10)=A(8):GOTO14
12 V3=V3+1
13 PRINT@496,C$;CL;V3;
14 IFA(6)<>0THEN16
15 IFA$="F"THENA(4)=SIN(PI*(90-EL))*V2*.3:A(5)=SIN(EL*PI)*V2*.3:A(6)=1:A(2)=A(0):A(3)=A(1):GOSUB28
16 A$=INKEY$:IFA$="W"THEN18ELSEIFA$=CHR$(10)THEN20ELSEIFA$="1"THEN V2=(V2-1)AND15:GOTO21ELSEIFA$="2"THEN V2=(V2+1)AND15:GOTO21ELSE IF A$="D" AND A(6)<>0 THEN A(6)=0:IFA(3)>0THEN RESET(A(2),A(3))
17 GOTO22
18 IFEL<85THENEL=EL+5
19 GOTO21
20 IFEL>5THENEL=EL-5
21 PRINT@481,C$;EL;V2;
22 IFA(6)=0THEN5ELSE I=0:GOSUB34:GOSUB35:A(2)=H1:A(3)=V1:IFZ=1THEN GOSUB30
25 IFZ=5THEN GOSUB29
26 IF Z<>0THENA(6)=0
27 GOTO5
28 FORI=1TO3:SOUND RND(16)+230,1:NEXTI:RETURN
29 GOSUB38:A(6)=0:A(13)=0:RESET(A(2),A(3)):RESET(A(9),A(10)):RETURN
30 K=((K+1)*7)AND7:FORI=1TO45:SOUND RND(255),1:SET(A(K)-7+4*K/7+RND(8),A(K+1)-5+RND(8),RND(8)):NEXTI
31 CLS(RMD(8)):PRINT"YOU ";:IFZ=1THEN PRINT"WIN";ELSE PRINT"LOSE";
32 PRINT"!!!":PRINT:PRINT"DO YOU WANT TO PLAY ANOTHER GAME (Y OR N)?":PRINT
33 A$=INKEY$:IFA$="N"THEN STOP ELSE IF A$<>"Y" THEN33ELSE RUN
34 K=I*7:H1=A(K)+A(K+4)*A(K+6):V1=A(K+1)-A(K+5)*A(K+6)+A(K+6)*A(K+6)*.1:A(K+6)=A(K+6)+1:IF A(K+3)<0 THEN RETURN ELSE RESET(A(K+2),A(K+3)):RETURN
35 Z=0:IF H1<0 OR H1>63 OR V1>31THEN Z=4:GOSUB39:RETURN
36 IFV1<0THEN RETURN ELSE IF POINT(H1,V1)>0THEN Z=3:GOSUB39:RETURN
37 SET(H1,V1,6):RETURN
38 FORI=1TO4:SOUND RND(99),1:NEXTI:RETURN
39 GOSUB38:IF(H1>=B/2)AND(H1<B/2+3)AND(V1>A-4)AND(V1<A+2)THENZ=2:RETURN
40 IF(I=0 AND INT(H1)=INT(A(9)) AND INT(V1)=INT(A(10)))OR(I=1 AND INT(H1)=INT(A(2)) AND INT(V1)=INT(A(3)))THEN Z=5:GOSUB38:RETURN
41 IF(H1>63-C/2)AND(H1<66-C/2)AND(V1>E-4)AND(V1<E+2)THENZ=1
42 RETURN
43 B=RND(12)+8:C=RND(12)+8:D=RND(62-B-C):F=6+RND(8):IF RND(2)=2THENA=27:E=RND(14)+12ELSE E=27:A=RND(14)+12
44 X=0:FORI=0TOB:Y=A:GOSUB45:NEXTI:FORI=1TO D:Y=A-(I*(A-F)/D):GOSUB45:NEXTI:FORI=1TO63-B-C-D:Y=F+(I*(E-F)/(63-B-C-D)):GOSUB45:NEXTI:FORI=1TO C:Y=E:GOSUB45:NEXTI:RETURN
45 FORJ=INT(Y)TO29:SET(X,J,1):NEXTJ:X=X+1:RETURN
51 SET(X,Y,7):SET(X+1,Y,7):SET(X+2,Y,7):SET(X+1,Y-1,7):SET(X+1,Y-2,7):SET(X,Y-2-X1,7):SET(X+2,Y-3+X1,7):RETURN
