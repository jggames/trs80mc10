1 REM BY JAMES L FULLER, FULLER'S ELECTRONICS  SANTA ANA  CALIF
	  COPYRIGHT (C) CLOAD 1980
2 CLS:PRINT" Gomoku, the Japanese game of five in a row.
Try to get five in a row horizontally, vertically or diagonally.Place your piece (Y) by using the arrow keys - then press
=Enter=. The computer will think & then make its move (C).
4 PRINT"
Press <R> to resign...
 
6 CLEAR:DEFINTA-Z:DEFSNGE,G,V,W:DEFSTRL,O,S:T=0:I=T:D=T:H=T:J=T:K=T:B1=T:E=T:W=T:F=T:Y=16444:B=T:RL=9:RH=1:CL=9:CH=1:V=15360:R=5:C=5:P=544:L=CHR$(143):DIMF(4),G(4),B(81),V(81)
8 F(0)=4:F(1)=12:F(2)=30:F(3)=90:F(4)=1E4:G(0)=5:G(1)=15:G(2)=35:G(3)=100:G(4)=1E5:FORI=1TO81:B(I)=0:NEXT:GOSUB52:CLS:GOSUB48:IFM=0THENB(41)=2:PRINT@896,"I move to: 5,5";:S="C":RL=R:RH=R:CL=C:CH=C:GOSUB50
10 PRINT@832,"Your move:"CHR$(30)CHR$(29)STRING$(2,26)"(Use arrow-keys - then =Enter=)";:GOSUB74:T=R*9-9+C:IFB(T)THEN10
12 GOSUB58:S="Y":GOSUB50:B(T)=1:IFB(41)=0THENH=41:GOTO44ELSEFORI=1TO81:V(I)=0:NEXT:PRINT@896,CHR$(31)"Thinking...";:FORR=RLTORH:FORC=CLTOCH:Q=140+64*R+4*C:U=PEEK(V+Q):PRINT@Q,L;:I=9*R-9+C:D=0:IFC>2ANDC<8THEND=1:H=1:GOSUB20
14 IFR>2ANDR<8THEND=D+1:H=9:GOSUB20
16 IFD>1THENH=10:GOSUB20:H=8:GOSUB20
18 PRINT@Q,CHR$(U);:NEXT:NEXT:GOTO40
20 N(0)=0:N(1)=0:N(2)=0:FORJ=-2TO2:K=B(I+J*H):N(K)=N(K)+1:NEXT:IFN(1)=0THEN24
22 IFN(2)THENRETURN
24 IFN(1)>4THENPRINT@Q,CHR$(U);:PRINT@896,"You Win!"CHR$(31):GOTO92
26 IFN(2)=4THENB1=1
28 IFN(1)=0THENE=G(N(2))ELSEE=F(N(1))
30 T=I-H-H:IFB(T)=0THENV(T)=V(T)+E
32 T=I-H:IFB(T)=0THENV(T)=V(T)+E
34 IFB(I)=0THENV(I)=V(I)+E
36 T=I+H:IFB(T)=0THENV(T)=V(T)+E
38 T=T+H:IFB(T)=0THENV(T)=V(T)+E:RETURNELSERETURN
40 H=1:W=V(1):FORJ=2TO81:IFW<=V(J)THENH=J:W=V(J)
42 NEXT:IFW<4THENPRINT@896,"Game is drawn"CHR$(30):GOTO92
44 B(H)=2:R=(H-1)/9+1:C=H-9*R+9:PRINT@896,"I move to:";:GOSUB90:S="C":GOSUB50
46 GOSUB58:IFB1PRINT@832,"I Win!"CHR$(31):GOTO92ELSE10
48 PRINT@18,CHR$(23)"* G O M O K U *":PRINT@144,"1 2 3 4 5 6 7 8 9":FORZ=1TO9:PRINTTAB(5)Z"+ + + + + + + + +"Z:NEXT:PRINTTAB(8)"1 2 3 4 5 6 7 8 9":RETURN
50 PRINT@140+64*R+4*C,S;:RETURN
52 PRINT"Do you wish to move first?
54 S=INKEY$:IFS=""THEN54ELSEIFS="Y"THENM=1ELSEIFS="N"THENM=0ELSE54
56 RETURN
58 IFR>RHTHENRH=R
60 IFR<RLTHENRL=R
62 IFC>CHTHENCH=C
64 IFC<CLTHENCL=C
66 IFRH<3THENRH=3
68 IFRL>7THENRL=7
70 IFRH=RLTHENRH=RH+1
72 RETURN
74 P=140+64*R+4*C:O=CHR$(PEEK(V+P))
76 POKEY,0:PRINT@P,L;:S=INKEY$:PRINT@P,O;:IFS=""THEN76ELSEX=ASC(S)
78 IFX=82THENB1=1:GOTO46
80 IFX=8IFC>1THENC=C-1:P=P-4ELSEC=9:P=P+32
82 IFX=9IFC<9THENC=C+1:P=P+4ELSEC=1:P=P-32
84 IFX=10IFR<9THENR=R+1:P=P+64ELSER=1:P=P-512
86 IFX=91IFR>1THENR=R-1:P=P-64ELSER=9:P=P+512
88 PRINT@852,;:IFX-13GOSUB90:GOTO74
90 PRINTRCHR$(24)",";:PRINTUSING"#";C;:RETURN
92 PRINT"Press =Enter=";:FORI=0TO1STEP0:IFINKEY$<>CHR$(13)NEXTELSECLS:GOTO6
