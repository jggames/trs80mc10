0 CLS:DIM A(9,9),B(9,9),C(9,9),S(31,2),Y(9,9),A$,B$(9)
10 REM 5/72 CONTRIBUTED BY GREG THAGARD, MENLO COLLEGE
20 PRINT "DO YOU NEED INSTRUCTIONS";
30 C$=""
40 INPUT C$
50 IF C$="N" THEN 210
60 CLS:PRINT"gomoku IS A TRADITIONAL JAPANESE";
61 PRINT"GAME PLAYED ON A 19X19 BOARD."
65 PRINT"THE OBJECT IS TO OCCUPY FIVE"
66 PRINT"ADJACENT POINTS IN A LINE"
70 PRINT"(HORIZONTAL,VERTICAL,DIAGONAL)."
75 PRINT 
80 PRINT"THIS PROGRAM PLAYS GOMOKU ON A"
81 PRINT"9X9 BOARD. EACH MOVE IS A TWO-"
82 PRINT"DIGIT NUMBER. THE FIRST DIGIT "
83 PRINT"IS THE ROW AND THE SECOND IS"
84 PRINT"THE COLUMN."
90 PRINT
95 PRINT"YOU ARE WHITE THE COMPUTER IS"
96 PRINT"BLACK."
210 D1=1
220 PRINT"DO YOU WANT TO MOVE FIRST";
230 INPUTFM$
240 IFFM$="N"THEN260
250 D1=-1
260 FORC1=0TO31:FORZZ=0TO2:S(C1,ZZ)=0:NEXT:NEXT:REM MAT S=ZER
270 A9=1
280 FORC1=0TO9:FORZZ=0TO9:Y(C1,ZZ)=0:NEXT:NEXT:REM MAT Y=ZER
290 Q9=0
300 REM DIM A(9,9),B(9,9),C(9,9),S(31,2),Y(9,9),A$(9),B$(9),C$(10)
310 A$="123456789"
320 S(1,1)=1
330 G2=0
340 G3=0
350 S(1,2)=1
360 S(2,1)=3
370 S(7,2)=3
380 S(3,1)=11
390 S(13,2)=11
400 S(4,1)=43
410 S(19,2)=43
420 S(5,1)=168421.
430 S(25,2)=168421.
440 S(6,1)=3.36842E+06
450 S(31,2)=3.36842E+06
460 REM THIS IS THE BEGINNING OF THE GAME.
470 G1=1
480 Q1=0
500 REM CLEAR THE BOARD FOR A NEW GAME
510 FORJ4=1TO9
520 FORI4=1TO9
530 B(J4,I4)=0
540 NEXT
550 NEXT
560 IFC$<>"Y"THEN600
570 IFFM$<>"Y"THEN600
580 GOSUB2550
590 C$=""
600 F3=0
610 D1=D1*(-1)
620 IFD1=1THEN700
630 J4=5
640 I4=5
650 REM HERE TO SHOE THE COMPUTER MOVE
660 PRINT "I MOVE TO";J4;I4
670 B(I4,J4)=1
680 GOSUB 2550
690 GOSUB 1440
700 IF F3=-1 THEN 1180
710 REM HERE TO PROMPT THE USER FOR HIS MOVE
720 PRINT"WHAT IS YOUR MOVE";
730 GOSUB2440
740 IFI3>9ORI3<1ORJ3>9ORJ3<1THEN2150
750 IFB(I3,J3)>0THEN2190
760 B(I3,J3)=6
770 REM ENTRY NOW MADE ON THE BOARD. CALCULATE ITS VALUE.
780 GOSUB1440
790 IFF3=1THEN1400
800 Y4=0
810 C4=0
820 FORI4=1TO9
830 FORJ4=1TO9
840 IFY(I4,J4)<=Y4THEN880
850 Y4=Y(I4,J4)
860 I5=I4
870 J5=J4
880 IFC(I4,J4)<=C4THEN920
890 C4=C(I4,J4)
900 I6=I4
910 J6=J4
920 NEXTJ4
930 NEXTI4
940 IFY4>=16800THEN1140
950 C4=0
960 FORM8=1TO9
970 FORM9=1TO9
980 C(M8,M9)=C(M8,M9)+A9*Y(M8,M9)
990 IFC(M8,M9)<=C4THEN1030
1000 C4=C(M8,M9)
1010 N8=M8
1020 N9=M9
1030 NEXTM9
1040 NEXTM8
1050 IFC4=0THEN1110
1060 I4=N8
1070 J4=N9
1080 REM GOSUB 2310
1090 REM GO TO PRINT THE BOARD
1100 GOTO650
1110 REM HERE FOR A DRAW.
1120 PRINT"THIS IS A DRAW GAME"
1130 GOTO1350
1140 REM HERE FOR THE WINNING MOVE
1150 I4=I5
1160 J4=J5
1170 GOTO650
1180 REM HERE FOR COMPUTER WINS.
1190 PRINT "I WIN THE GAME"
1200 G2=G2+1
1210 IFG2<3THEN1340
1220 PRINT"THAT MAKES"G2"GAMES IN A ROW"
1230 PRINT"I HAVE JUST MADE A DOWNWARD":PRINT"ADJUSTMENT IN MY ABILITY"
1240 A9=A9*.9
1250 IFG2=4THEN1290
1260 IFG2=5THEN1310
1270 IFG2>5THEN1330
1280 GOTO1340
1290 PRINT"PLEASE TRY THIS TIME"
1300 GOTO1340
1310 PRINT"YOU MUST NOT BE CONCENTRATING"
1320 GOTO1340
1330 PRINT"ARE YOU SURE YOU KNOW HOW":PRINT"TO PLAY THIS GAME?"
1340 REM LETS TRY A NEW GAME.
1350 G1=G1+1
1360 PRINT "WILL YOU PLAY ANOTHER GAME";
1370 INPUT C$
1380 IF C$="Y" THEN 210
1390 END 
1400 REM HERE FOR USER WINS.
1410 PRINT "YOU WIN GAME NO. ";G1
1420 G2=0
1430 GOTO1340
1440 REM CALCULATE THE VALUES OF ALL THE SQUARES ON THE BOARD.
1450 FORJ4=1TO9
1460 FORI4=1TO9
1470 C(J4,I4)=0
1480 Y(J4,I4)=0
1490 NEXT
1500 NEXT
1510 FORJ4=1TO9
1520 FORI4=1TO5
1530 K4=I4+4
1540 I9=0
1550 I8=0
1560 FORM4=I4TOK4
1570 I8=I8+B(J4,M4)
1580 I9=I9+B(M4,J4)
1590 NEXT
1600 IFI8=5ORI9=5THEN1620
1610 GOTO1650
1620 F3=-1
1630 REM GOSUB 2220
1640 RETURN 
1650 IFI8=30ORI9=30THEN1670
1660 GOTO1690
1670 F3=1
1680 GOTO1630
1690 I8=I8+1
1700 I9=I9+1
1710 FORM4=I4TOK4
1720 IFB(J4,M4)=0THEN1740
1730 GOTO1760
1740 C(J4,M4)=C(J4,M4)+S(I8,2)
1750 Y(J4,M4)=Y(J4,M4)+S(I8,1)
1760 IFB(M4,J4)=0THEN1780
1770 GOTO1800
1780 C(M4,J4)=C(M4,J4)+S(I9,2)
1790 Y(M4,J4)=Y(M4,J4)+S(I9,1)
1800 NEXT
1810 NEXT
1820 NEXT
1830 REM TRY TO ASSIGN VALUES TO THE DIAGONALS NOW.
1840 FORJ4=1TO5
1850 FORI4=1TO5
1860 I8=0
1870 I9=0
1880 FORM4=1TO5
1890 K4=J4+M4-1
1900 L4=I4+M4-1
1910 K5=10-K4
1920 I8=I8+B(K4,L4)
1930 I9=I9+B(K5,L4)
1940 NEXT
1950 IFI8=5ORI9=5THEN1620
1960 IFI8=30ORI9=30THEN1670
1970 I8=I8+1
1980 I9=I9+1
1990 FOR M4=1 TO 5
2000 K4=J4+M4-1
2010 L4=I4+M4-1
2020 K5=10-K4
2030 IFB(K4,L4)=0THEN2050
2040 GOTO2070
2050 C(K4,L4)=C(K4,L4)+S(I8,2)
2060 Y(K4,L4)=Y(K4,L4)+S(I8,1)
2070 IF B(K5,L4)=0THEN2090
2080 GOTO2110
2090 C(K5,L4)=C(K5,L4)+S(I9,2)
2100 Y(K5,L4)=Y(K5,L4)+S(I9,1)
2110 NEXT
2120 NEXT
2130 NEXT
2140 GOTO1630
2150 REM MOVE IS OFF BOARD
2170 PRINT"YOUR MOVE";STR$(J3);I3;"IS OFF THE BOARD "
2180 GOTO700
2190 REM HERE IF SQUARE IS OCCUPIED
2200 PRINT"SQUARE ";STR$(J3);I3;"ALREADY OCCUPIED"
2210 GOTO700
2220 PRINT"BOARD POSITIONS"
2230 FORC1=0TO9:FORZZ=0TO9:A(C1,ZZ)=B(C1,ZZ):NEXT:NEXT
2240 GOSUB2860
2250 PRINT 
2260 PRINT"VALUE TABLE C. USED BY USER "
2270 FORC1=0TO9:FORZZ=0TO9:A(C1,ZZ)=C(C1,ZZ):NEXT:NEXT:REM MAT A=C
2280 GOSUB2860
2290 PRINT 
2300 PRINT"VALUE TABLE Y. USED BY THE COMPUTER."
2310 FORC1=0TO9:FORZZ=0TO9:A(C1,ZZ)=Y(C1,ZZ):NEXT:NEXT:REM MAT A=Y
2320 GOSUB2860
2330 RETURN 
2340 PRINT"COMBINED TABLE.":PRINT"USED FOR FINDING THE BEST MOVE."
2350 FORC1=0TO9:FORZZ=0TO9:A(C1,ZZ)=C(C1,ZZ):NEXT:NEXT:REM MAT A=C
2360 GOSUB2860
2370 PRINT"BOARD POSITIONS."
2380 FORC1=0TO9:FORZZ=0TO9:A(C1,ZZ)=B(C1,ZZ):NEXT:NEXT:REM MAT A=B
2390 GOSUB2860
2400 PRINT"BEST VALUE IS";C4;"AT";J4;I4;"OR";N9;N8
2410 RETURN
2420 PRINTA9
2430 PRINTC4,I4,I6,J4,J6
2440 INPUTI$:IFLEN(I$)<2ORLEN(I$)>2THEN2440
2445 I$=LEFT$(I$,2)+"2":Q9=VAL(I$)
2450 IFQ9<100THEN2500
2460 J3=INT(Q9/100)
2470 I3=INT(Q9/10)-J3*10
2480 Q1=Q9-10*I3-100*J3
2490 RETURN
2500 J3=INT(Q9/10)
2510 I3=Q9-J3*10
2540 RETURN
2550 IFQ1=0THEN2850
2560 PRINT 
2570 PRINT" "
2580 PRINT"  ";
2590 FORI=1TO9
2600 PRINT" "MID$(A$,I,1)" ";
2610 NEXT
2620 PRINT 
2630 FORI=1TO9
2640 K=9
2650 FORJ=9TO1STEP-1
2660 IFB(J,I)<>0THEN2680
2670 NEXT J
2680 IFQ1=2THEN2700
2690 K=J
2700 PRINTMID$(A$,I,1);" ";
2710 FORJ=1TOK
2720 IFB(J,I)=1THEN2770
2730 IFB(J,I)=6THEN2790
2740 IFQ1<>2 THEN 2810
2750 PRINT" + ";
2760 GOTO2820
2770 PRINT" "CHR$(128)" ";
2780 GOTO2820
2790 PRINT" "CHR$(207)" ";
2800 GOTO2820
2810 PRINT"   ";
2820 NEXT
2830 PRINT 
2840 NEXT
2850 RETURN 
2860 FORA=1TO9
2870 FORA1=1TO9
2880 PRINTA(A1,A);
2890 NEXTA1
2900 PRINT 
2910 NEXTA
2920 RETURN 
2930 END 
