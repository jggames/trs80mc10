0 DIMC1,C2,C3,C4,M,M$,I$,AT(100),AM(100):C3=16384:C4=16383:GOTO2
1 C1=(PEEK(17024)AND1)*256+PEEK(17025)+C4:FORC2=1TOLEN(M$):POKEC1+C2,ASC(MID$(M$,C2))AND63:NEXT:?@C1-C3+C2,:RETURN
2 REM
3 CLS
4 REM
5 FC=7:BC=163:AM(9)=145:AM(0)=106:AM(1)=106:AM(2)=0:AM(3)=0
6 REM:RETURN
7 PRINT "(C)CHECKERSLEFT JOHN COLLINS":GOTO 3000
8 R=U:Q=-1:X=11:U=89:T=-1:V=8:A=12
9 NEXTQ:NEXTX
10 NEXTU:NEXTV:IFT<0THEN1200
11 STOP:RUN

20 GOSUB2000:PRINT@416,"ENTER RUN":END

50 CX=-71:FORU=ATO89:IFAT(U)<4THEN55
51 A=U:U=89
55 NEXTU:FORV=1TO8:PRINT@449,V;:FORU=ATO89:IFAT(U)<4THEN10
60 FORX=9TO11STEP2:FORQ=1TO-1STEP-2:IF AT(U)=4THENQ=-1
70 B=Q*X:S=U+B:IFAT(S)=0THEN9
75 IFV>2THENIFAT(S)<>3THEN9
80 C=B+B:F=Q*20:Z=V*100:ONVGOTO100,200,300,400,500,600,700,800
100 IFAT(U+C)<>3THEN9
200 IFAT(S)>2THEN9
220 IFV=1THENS=U+C:GOTO8
230 S=U-B:IFAT(S)<>3THEN9
235 IFAT(U-C+F)=2THEN260
240 IFAT(U-F)>3THENU=U-F:GOTO8
250 IFAT(U-C)>3THENU=U-C:GOTO8
260 S=U-B+F:IFAT(S)=3THEN8
290 GOTO9
300 IFAT(S-F)<>1THEN9
310 IFAT(S)=3THEN8
320 S=S-2*(X-10):IFAT(S)=3THEN8
330 GOTO9
400 IFAT(U+C)=0THENIFAT(U)=4THEN8
410 GOTO9
500 L=1
600 L=1:IFAT(U+C)<3THEN9
610 IFAT(U+F)<3THENIFAT(U+C-F)=3THEN9
620 IFAT(U+F)=3THENIFAT(U+C-F)=1THEN9
625 IFV=5THEN700
630 L=L+1:D=AT(U+L*B):IFD=0ANDD>3THEN9
650 IFL<>2THENIFD<3THEN8
660 GOTO630
700 IFAT(U)=5THEN9
800 GOTO8

REM FROM
1000 GOSUB1800:CY=1*32+1:PRINT@CY,"бзбнбедое";:PRINT@CY+32,"бпбндеезе";:PRINT@CY+96,;:GOSUB1700:R=I
REM TO
1005 CY=7*32+1:PRINT@CY,"взбе";:PRINT@CY+32,"кпде";:PRINT@CY+96,;:GOSUB1700:S=I
1010 IF(AT(R)>2)AND(AT(R)=0)AND(AT(S)<>3)THENSOUND1,1:GOTO1000
1040 IFAT(R)<>1THENIFR>STHENSOUND1,1:GOTO1000
1200 IF((S-R)*(S-R))<122THEN1600
1210 IFT>0THENIFAT((S+R)/2)<4THEN1000
1220 J=T:AT(S)=AT(R):AT((S+R)/2)=3:AT(R)=3
1400 FORX=9TO11STEP2:G=S+J*X:IFAT(G)=3+TANDAT(G)=3+T+TTHEN1450
1430 GOTO1500
1450 G=S+2*J*X:IFAT(G)<>3THEN1500
1470 R=S:S=G:X=11:NEXTX:GOTO1220
1500 NEXTX:IF(ABS(AT(S)-3))=2THENIFJ=TTHENJ=-T:GOTO1400
1510 GOSUB2000:GOTO1610
1600 AT(S)=AT(R):AT(R)=3:I=R:GOSUB2020:I=S:GOSUB2020
1610 IFT>0THENIFS>80THENAT(S)=1
1620 IFT<0THENIFS<20THENAT(S)=5
1630 IFT>0THEN50
1640 T=1:GOTO1000

1700 PRINT"COL";
1701 M$=INKEY$:IFM$<"1"ORM$>"8"THEN1701
1702 N=VAL(M$):PRINTN;:PRINT@CY+128,"ROW";
1703 M$=INKEY$:IFM$<"1"ORM$>"8"THEN1703
1705 M=VAL(M$):PRINTM;:I=M*10+N+1:RETURN
1800 FORC1=0TO480STEP32:PRINT@C1,"пппппппппппппппп";:NEXT:RETURN
2000 CLS7:GOSUB4000:FORI=12TO89:IFAT(I)=.THEN2003
2001 M=(((I/10)-INT(I/10))*10-1)*2+14+.5:N=16-((INT(I/10)-1)*2+1)
2002 PRINT@32*(N-1)+M,;:C1=I-1:I$=STR$(C1):M$=MID$(I$,3,1)+MID$(I$,2,1):GOSUB1
2003 NEXT
2010 FORI=12TO89:IFAT(I)THENGOSUB2020
2015 NEXTI:RETURN
2020 M=(((I/10)-INT(I/10))*10-1)*2+14+.5
2030 N=16-((INT(I/10)-1)*2+1)
2040 PRINT@32*N+M,"аа";:PRINT@32*N+M,;:IFAT(I)<3THENJ=ABS(AT(I)-3):PRINT"№№";
2050 IFAT(I)>3THENJ=ABS(AT(I)-3):PRINT"ћћ";
2100 RETURN
3000 FORI=1TO100:AT(I)=0:NEXTI:FORI=12TO18STEP2
3010 AT(I)=2:AT(I+11)=2:AT(I+20)=2:AT(I+31)=3:AT(I+40)=3
3020 AT(I+51)=4:AT(I+60)=4:AT(I+71)=4:NEXTI:A=67
3030 GOSUB2000:GOTO50
4000 PRINT"ппппппппппппппппппааппааппааппаа";
4001 PRINT"ппппппппппппппппппааппааппааппаа";
4002 PRINT"ппппппппппппппппааппааппааппаапп";
4003 PRINT"ппппппппппппппппааппааппааппаапп";
4004 PRINT"ппппппппппппппппппааппааппааппаа";
4005 PRINT"ппппппппппппппппппааппааппааппаа";
4006 PRINT"ппппппппппппппппааппааппааппаапп";
4007 PRINT"ппппппппппппппппааппааппааппаапп";
4008 PRINT"ппппппппппппппппппааппааппааппаа";
4009 PRINT"ппппппппппппппппппааппааппааппаа";
4010 PRINT"ппппппппппппппппааппааппааппаапп";
4011 PRINT"ппппппппппппппппааппааппааппаапп";
4012 PRINT"ппппппппппппппппппааппааппааппаа";
4013 PRINT"ппппппппппппппппппааппааппааппаа";
4014 PRINT"ппппппппппппппппааппааппааппаапп";
4015 PRINT"ппппппппппппппппааппааппааппаап";
4999 RETURN
