10 GOTO1000

20 C$(((X $ 5) - 5) «- NC(1))=M<DR)
:S^<<<K $ 5) - 5) + NCd))=St(DR)
:CD$(((X ; 5) - 5) + NC(1))=CDW(DR)




:C(<<X ;t 5) - 5) + NC(1))=C(DR)
: S( ( <X $ 5) - 5) + NC(1) )=S(DR)
:DR=DR + 1
:RETURN
C*<<<K ;t 5) - 5) -fr NC(2)) == C*<DR)
:S$(((X ;t 5) - 5) -«- NC(2)) '-= S«<DR)
:CD^<<<X t 5) - S) + NC(2))=CDt<DR)
:C( ((X $ 5) - 5) + NC(2))=C(DR)
:S(<<X $ 5) - 5) + NC(2))=S<DR)
:DR=DR + 1
:RETURN
C$(<<X ;t 5) •- 5) -e- NC(3) >=C$(DR)
3 S$(<(X t 5) - 5) + NC(3)) == S$(DR)
8 CD$(<<X ;t 5) - 5) + NC(3)>=CD^(DR)
:C( < (X ;t 5) - 5) + NC(3))=C(DR)
:S< < (X $ 5) - 5)+ NC(3)) = S(DR)
3 DR=DR + 1
5 RETURN


90 FOR X=1 TO 5
100 ;F P<K> < > O THEN 1550
130 FOR Y=1 TO 5
140 V<X,Y)=C(Y+;;X - 1> t 5))
:VS(KpY)=C$(Y+(<X - 1) ;c 5))
:ST<X,Y>=S<Y+<<X - 1) t 5)>
:ST^;X^Y) = St(Y -8- (<X - ;) t 5>)
170 NEXT
200 REM ONE PAIR
210 FOR N=1 TO 4
220 FOR ;=2 TO 5
240 ;F N < > ; AND V;X^H)=V(X,;) THEN
H^(X)="P" + RIGHT:< STR^ (N),!)
+ R;SHT^ ( STR* (;),1)
:N=4
:;=5
250 NEXT ;pN
260 ;F LEFT* (H*<X)pl> < > "P" THEN 610
270 ;F V<Xp VAL < M;D^ (Ht (X) p 2p 1 ) > ) >
= 11 THEN Ht(X)=H*(X> «• "J"
280 ;F H;D^ (H«(X)p251)="3" THEN 390
290 ;F M;D* <HS<X> 5,2^1)="4" AND
RIGHT* (H$(X)p1) < > "J" THEN 610
300 ;F M;D^ <HS<X>,2p1)="4" THEN 1360


310 FOR N=1 TO 4
320 FOR ;=N+1 TO S
330 ;F N = VAL < H;D# (H:(X)=2p 1 > ) OR N
« VAL < H;D* <Ht<K),3, 1>) THEN ;
= S
:BOTO 350
340 ;F V;X^n) == vex, ;) THEN Ht(X>="2"
4- LEFT:(H;;(X);,3)=R;BHT:( STR^
<N)p1) +R;BHT^ ( STR* C;),1)
:;=5
1 N=4
350 NEXT ls,N
360 ;F V<Xp VAL ( M;D:CH^ (X) p 3p 1 ) ) >=V
(Xs, VAL < M;D^ (HS(X)5,5s,1))) THEN
H^(X)="FOUR "=VW(X, VAL <
n;D^ (H^<X)p3s1))>="8"
:BOTO 1360
370 ;F LEFT^ (H^<X),1)="2" AND H;D^ <H
^(X)p3p1)="1" THEN 530
380 ;F LEFT* <H^<X)p1)="2" THEN BOTO 1
360



390 FOR N=1 TO 5
400 ;F N=VAL ; M;D* <H*<K>p2p1)> OR H
= VAL ; M;D* <H«<X)p3p1)) THEN 420
410 ;F V(K,N)=VCXp VAL ; M;Dt <H*<K),2
,1))) THEN H$<X>="T" 4- M;Dt (H*<
X>,2p2> +R;BHT^ < STR^ <N) ,
)
:1$ S3 5
420 NEXT N
430 ;F LEFT^ <H*<X)p1)==T" OR R;OHT^ <
HS(X)p1)="J" THEN 1360
450 BOTO 610


530 FOR N = 1 TO 5
540 FOR ;=3 TO 6
550 ;F N - VAL C M;D* CHt<K),;,1)) THEN
1 = 6
; FLAB=;
560 HEXT
1 ;F FLAB=1 THEN FLAB «
; BOTO 590
570 ;F VCKpN) = V<K;, VAL ; M;D* <£H*<X)j,3
p;))) THEN H^CK)="FH;l HOUSE "
4- V*<K, VAL ; H;D^ (H$<K)p3,1)))
4. "S"
:N=5
580 ;F V<KpN) - V<K, VAL C R;BHTt (H*<X)
,1))) THEM H«<X)="F\tU HOUSE "
•§- VtCKp VAL ; R;BHT^ <HtCK)p1)))
1 N = 5
590 NEXT
600 BOTO 1360


610 FOR N=1 TO 5
620 FOR ;=1 TO 5
630 ;F DUBCHK^(X) = "ON" AND N = S4
THEN 1-5
3 GOTO 650
635 ;F DUBCHK^<K)="0N2" AND N=S;
THEN 1-5
:GOTO 650
640 ;F V<X,N>=V(Xp;) + 3 THEN S; = ;
:S4=N
:N =^ 5
:; n) 5
; FLA:« 1
650 NEXT ;,N
9 ;F FLA:« 1 THEN FLA:=
:GOTO 760
660 ;F ;NCX)=THEN 720
670 ;NCX) =
680 FOR N=1 TO 5
690 ;F V(XpN)=1 THEN VCX^N) * 14
700 NEXT
705 ;F DUBCHK^(X)="ON" THEN DUBCHKS(X)
= "0N2"
:GOTO 61
O
710 DUBCHK^<X> - ""
; GOTO 910
720 FOR N = 1 TO 5
730 ;F V<XpN)=14 THEN V<X,N> - 1
740 NEXT
750 ;N<X)=1
; GOTO 610
760 FOR N = 1 TO 5


770 ;F V<Ks,N) n) VCX^S;)=2 THEN S3=N
§ N = 5
:FLA6=1
780 NEXT
3 ;F FLA8=1 THEN FLA8 = O
; GOTO 810
790 ;F DUBCHK$(K)="" THEN 0UBCHK1KK)
a: "OH"
:60T0 610
800 SOTO 680
810 FOR N=1 TO 5
820 ;F V(X,N)=V<XpS1) + 1 THEN S2=N
:N=5
:FLAG=1
830 NEXT
:;F FLA:== 1 THEN FLAG=0
:GOTO 850
840 GOTO 680
850 H^<X)="43" + RIGHT:< STR^ (S1)^)
+ RIGHT$( STR^ <S2),1) + RIGHT$(
STRt (S3)p) + RIGHT:< STR^ <S4) ^
)
860 FOR N=; TO 5
870 ;F V<X5.N)=V<X,S1) + 4 THEN H^(X)
= "STRA;GHT TO " + VS<X,N)
:CH<X)=V(X,N)
880 ;F V(X,N)=V(X,S1> - 1 THEN H^ < X
)
= "STRA;GHT TO " + V^(X,S4)
; CH(X)=V(X,S4)
890 NEXT
900 GOTO 1140

910
920
930
940
950
955
960
970
1
s
980
985
s
990
1000
1010
1020
3
1030
1040
1050
1055
1060
1070
1080
1090
REM ;NS;DE STRA;GHT
;FK=«2 0RX«30RX
< > "" THEN 1140
FOR N=1 TO 5
FOR ;=1 TO 5
;F DUBC;-KtCK)
THEN 1=5
GOTO 970
;F DUBCHK^(K)
THEN ;=5
GOTO 970
5 OR H$<X>
ON" AND N=S5<K)
0N2" AND N=31
V<Kpl> •«- 4 THEN S;=;
= O THEN 990
TO 5
^ 14 THEN S/;X^n)
;F S^;X^M)
S5CX)=N
N=5 1$5
FLAB=1
NEXT ;5N
;F FLA:^ 1 THEN FLA©=0
GOTO 1070
;F ;N<X)
;NCX)=0
GOTO 1030
FOR N=1
;F V<X,N)
NEXT
;N<X) = 1
GOTO 930
FOR N=; TO 5
;F VCXpN)=1 THEN V<X,N)=14
NEXT
;F DUBCHK^CX) = "ON" THEN DUBCHK^<X)
^ "0N2"
GOTO 930
;N<X) «
DUBCHKSCX) == ""
GOTO 1140
FOR N=1 TO 5
FOR ;=1 TO 5
;F V<XpN)=VCX.S1) 4- 3 AND V<X,;)
= Va^S1)+ 2 THEN H$(X> «= H^(X)
^ ";S" + RIGHT:< STR^ <S1),1) Hh
RIGHT$( STR^ (D^1) + RIGHT:<
STR* <N),1)+ RIGHT* < STR^ <S5(X>
)^1)=RIGHT* ( STR$V(Xs,S1) + 1>
,1)



1100 ;F VCKpN)=V<XpSl> + 3 AMD V<X,;)
= V<X,S1) + 1 THEM H^(X)=H^(X)
^ ";S"+R;6HT$ ; STR^ (S1),1) +
RIGHT:< STR*
STR^ (N),1) +
),1) ^- RIGHTS
,1)
1110 ;F V<XsN)=V<XpSl>=2 AND V<X,;)
= V<X,S1) -;- 1 THEN H;lCX)=H^<X)
-f;- ";S" + RIGHT$( STR^ <S1)p1) +
RIGHT:C STR^ (Dg1) + RIGHT* (
STR^ <N>5,1> 4- RIGHT:< STR^ (S5(X)
>,1) + RIGHT:< STR:(V(X,S1> + 3)
,1)
1120 NEXT ;,N
1130 ;F LEFT:<HS(X)g1) < > ";" AND DUBCH
KS(X)="" THEN DUBCHKS(X)="ON"
; GOTO 930


1140 FOR N=2 TO 5
1150 ;F ST<X,N) < > ST<X,1) THEN N=5
a FLAB = 1
1160 NEXT
:;F FLAB=1 THEN FLAB «
§ GOTO 1200
1170 ;F LEFT^ <H^(X)9 4) < > "STRA" THEN H
^<X)="FLUSH " + STSCXp1) -&- Sl%;X
,1) + ST^(Xs;1)
1180 ;F LEFT^ (HS(X),4)="STRA" THEN H^
(
X)="STRA;GHT FLUSH"
1190 GOTO 1360
1200 FOR N=1 TO 5
1210 FOR N2=1 TO 5
1220 FOR N3=1 TO 3
1230 ;F N2 = N3 OR N=N3 CMR N=N2 THEN
1250
1240 ;F ST(X,N)=ST(X,N2) AND ST<X,N) «
ST(X,N3) THEN H^<X)=H^(K) + "3F"
+ ST*<X,N)
:F(X)=N
:F2=N2
:F3=N3
3 N=5
:N2=5
:N3=5
:FLA:= 1
1250 NEXT N3,N25N
8 ;F FLA:«« THEN 1360ELSEFLAG=0
8 GOTO 1270
1270 FOR N4=1 TO 5
1280 ;F N4=F2 OR N4 = F3 OR N4=F<X)
THEN 1300
1290 ;F ST<XsN4) = 8T<X,F<X)) THEN H$(X)
«= "4F"=ST^<Xs;F(X))
:N4=5
; FLA:« 1
1300 NEXT
:;F FLAG=1 THEN FLAG=0
:GOTO 1360
1310 ;F X < > 1 AND LEFT^ (H^<X),2)="3F
" THEN H^<X)=""
:GOTO 1360


1320 ;F LEFT^ <H«<X),2>="3F" THEM 1360
1330 FOR ;=1 TO LEN <H^(X))
1340 ;F M;DH; (H^(X),;p2)="3F" THEN H^ (
X
> «= LEFT* (H*(X) jl - 1)
1350 NEXT


1360 REM ASS;BN H<X) VALUES
1380 ;F H^<X) == "" THEN H<X)=0
1390 ;F LEFT:(H^(X),2> == ";S" THEN H(X>
a:J[
1400 ;F LEFTH <H^(X>p2)="3F" THEN H<X)
« 2
1410 ;F LEFT^ <H*<X),2>="4S" THEN H(X)
= 3
1420 ;F LEFT^ <H^(X),2)="4F= Tfr«N H<X)
= 4
1430 ;F LEFT^ <H;;(X),1)="P" THEN H<X>
= 5
:;F LEN (HS(X)) > 3 THEN H<X) «= 6
14S0 ;F LEFT^ <H«(X),2>="2P" THEN H<X>
«= 7




1460 ;F LEFT^ <H1KX)p1) = "T" THEN H(K)
= a
1470 ;F LEFT^ <H^(X)p10)="STRA;SHT T"
THEN H(X)=9
1480 ;F LEFTH (Ht(K),2)="FL" THEN H(K)
= 10
1490 ;F LEFTt (H^<X)5,2)="FU" THEN H<K)
= 11
1500 ;F LEFT:<H^<K);2)="FO" THEN H(X>
= 12
1510 ;F LEFT:(H^(X)510)="STRA;SHT F"
THEN H<X)=13
1520 ;F REDO=1 THEN RETURN
1540 ON X GOSUB 1570,1630,1710^1900
1550 NEXT
1560 RETURN



1570 REM MARV;N
1580 ;F H<1> < 8 THEN BF<1)
:RF<1) =0
1590 ;F H(1)
= 2
; RF<1) «
1600 ;F H(1)
a RF<1> «
;&;O DF(1) =
1620 RETURN
« 8 OR H<;) - 9 THEN BF<1)
2
> 9 THEN BF(1)=3
5
21


1630 REM 6ERRV
1640 ;F H<2> < 3 THEN DF(2) «
1650 ;F H(2)
«
n) 3 OR H(2> =4 THEN RF(2)
a DF<2) - 6
1660 ;F H(2)
- 1
> 4 AND H<2) < 8 THEN BF<2)
RF<2) «
DF(2)=4
;F H<2) > 5 THEN DF<2)=14
1670 ;F H(2>
= 2
a:8 OR H(2>=9 THEN BF(2)
RF(2)=1
DF<2)=21
1680 ;F H(2)=10 THEN BF(2)=3
RF(2>=3
DF<2>=21
1690 ;F H<2) > 10 THEN BF(2) - 3
RF(2)=5
DF<2)=21
1700 RETURN



1710 REM WALTER
1720 ;F H<3) < 3 THEN DF(3) =
1730 ;F H<3>
« 3
= 3 OR H<3) =4 THEN RF(3)
:DF(3)=6
1740 ;F H<3>
« 1
RF(3) =
< 8 AND H<3) > 4 THEN BF(3)
s
:DF<3)=4
:;F H(3) > 5 THEN DF<3>=10
1750 ;F H<3>=8 THEN BF<3)=2
:RF(3)=2
:DF<3)=21
1760 ;F H(3) >=9 THEN BF(3)=3
:RF(3)=3
; DF(3)=21
1770 ;F H(3) == 6 THEN GOSUB 1800ELSE ;F H
(3)=8 THEN GOSUB 1850
1780 RETURN
1800 FOR ;=1 TO 5
1810 ;F ;=VAL ; M;D^ (H^<3).2,1)) OR ;
= VAL
;F V<X5,
( RIGHT$(H^<3),;)) THEN 183
1820 VAL ( M;D* (H*(X),2,1)>) <
> 14 AND V<3,;)=14 THEN H^(3> =
HS(3) + "K"+RIGHT:< STR^ <;>,1)
:BF(3)=2
:RF(3)=4
:DF<3>=21
1830 NEXT
1040 RETURN
1850 FOR ;=1 TO 5
;860 ;F ;=VAL ( n)r>% (H^(3)p251)) OR ;
= VAL ( M;D^ <H$<3),2,2)> OR ; =
VAL ( RIGHT* (H*(3),1)) THEN 1880
1870 ;F V<Xs, VAL < M;D* <H* (X) , 2, 1 > > ) <
> 14 AND V<3,;)=14 THEN H*<3) =
H*(3) + "K" -;- RIGHT* ( STR* < ; ) , 1
)
:BF(3)=1
:RF(3)=4
2 DF(3)=21
1880 NEXT
1890 RETURN


1900 REM BETSY
1910 ;F H<4) < 3 THEN DF(4)=0
1920 ;F R(4) > 50 AND H(4) < 3 THEN RF(4)
= O
:DF(4)=6
1930 ;F H<4) > 2 AND H(4> < 6 THEN RF<4>
= O
:DF(4)=6
1940 ;F H(4) =6 THEN BF(4)=1
:RF(4)=0
- DF(4) = 9
1950 ;F H{4) =7 OR H<4) =8 THEN BF(4)
= 2
:RF(4)=2
:DF<4)=21
1960 ;F H(4) > 8 THEN BF(4)=3
- RF<4)=3
:DF<4)=21
1970 RETURN



2000 REM BET DRAW CARD:AND F;BURE HANDS
2010 DR=26
:X=D + 1
:;F X=6 THEN X=1
2030 ;F P<X) < > THEN 4190
2035 FOR ;=0 TO 3
:NC(;) =0
:NEXT
2040 ON X GOSUB 7000, 7040, 7080, 71 20p 7160
20S0 ;F X=5 THEN 3470
2060 ON H<X) SOTO 2320,2520,29105 3000,307
0,3140,3220,3310
2070 ;F H(X) > 8 THEN 3460




2080 D;SC(X>=3
:PRINT@L0K,B$(10)+ "3";
2090 FOR ;=1 TO 5
2100 FOR ;;=1 TO 5
2110 ;F V(X,;) < VCKp;;) THEN ;;=5
:FLA6=1
2120 NEXT
:;F FLAG=1 THEN FLA:«=
:BOTO 2140
2130 Kl=;
§ V(KpK1)=V<X,;>
; 1=5
2140 NEXT
2150 FOR ;=1 TO 5
2155 ;F ;=Kl THEN 2220
2160 FOR ;;=1 TO 5
2180 ;F ;;=Kl THEN 2200
2190 ;F V<X,;> < V<Xp;;) THEN ;; = 5
:FLAB «^ 1
2200 NEXT
a ;F FLA6=1 THEN FLA:«
3 BOTO 2220
2210 K2 = ;
:V<Xs,K2>=VCXp;)
3 1=5
2220 NEXT
2250 FOR ; «* 1 TO 3
2255 ;F ; > 1 THEN NC(;>=NC(; -- 1) + 1
:BOTO 2270
2260 NC(;)=NC(;) + 1
2270 ;F NC(;) = Kl OR NC(;>=K2
NEXT
THEN 226
2300
2310 GOSUB 20
3 GOSUB 40
3 GOSUB 50
8 GOTO 2820



2320 D;SC(X)=1
; PRINT@L0KpB^<10) -f "l"p
2330 NC(1)=1
2340 FOR ;=3 TO 7



2350 ;F NC(1) == VAL ( H;D^ (H* (X> , ;=1 ) )
THEN NC(1)=NC(1) + 1 §1=7
:FLAG=t
NEXT
;F FLAB=1 THEN FLA6 -= O
60T0 2340
GOSUB 20
;F C(DR - 1)=VAL < H;D* <H*(X),7))
THEN CH<X)=V<XpS5<X))
:H(X)=9
J H*<X)="STRA;GHT TO " + V*(X,S5<X))
2360
2370
2380
:BOTO 3750
2390 ;F ;N<X) == O THEN 2440
2400 FOR N=1 TO 5
2410 ;F VCX^N) - 1 THEN V<X,N)=14
2420 NEXT
2430 ;N<X)=0
2440 FOR Y=1 TO 5
2460 ;F Y < > NCd) AND C(DR - 1) = V(X,Y
> THEN H«(X)="PAIR OF " -s- C*<DR
- 1> + "S"
2470 NEXT Y
2480 ;F LEFT* <H*<X),1) < > "P" THEN 3750
2500 CH(X)=C(DR - 1)
:H(X) * 6
:;F CH<X) < 11 THEN H<X> = 5
2510 BOTO 3750





2520
§
2530
2540
2550
2560
2570
2580
2590
2600
2620
2630
2635
2640
2641
2642
D;SC(K)=2
PRINT@L0KpB^<10) •«
FOR ;=1 TO 5
;F ST^CXs;;) < >
1) = ; 1=5
NEXT
FOR ;=NC(1) -;-
2"!
ST^<K,F<X>) THEN HC;
;F ST^CXp;) < >
2)=; 1=5
NEXT
GOSUB 20
eOSUB 40
;F S^<DR - 2)
DR - 1) < >
1 TO 5
STS<X,F(X)) THEN HC;
< > ST^<X5,F<X>) OR S^<
ST^(X5,F(X)) THEN 2820
H^<X)="FLUSH "+ S^<DR - 1 ) «- S$(D
R - 1) -;- S$(DR - 1)
REM CHECK FOR STRA;BHT FLUSH
;N(X)=0
FOR Zl=1 TO 5
FOR Z5=1 TO 5
;F V(X5Z5)=V(K,Z1) + 4 THEN S;=Z
1
:S5=Z5
:Z;=5
8 Z5=5
:FLA:- 1
2643 NEXT ZSpZl
:;F FLAB =« 1 THEN FLAB=0
8 GOTO 2649
2644 ;F ;N(X)
:GOTO 3750
2645 FOR ;=1
2646 ;F V<X,;)
2647 NEXT
2648 GOTO 2640
2649 FOR Z2 = 1 TO 5
2650 ;F V<X,Z2>=V(X,S1) + 1
2
:Z2=5
:FLAG=1
2651 NEXT
:;F FLAG=1 THEN FLAG=0
:GOTO 2653
2652 GOSUB 2740
:GOTO 3750
2653 FOR Z3=1 TO 5
2654 ;F V(X,Z3)=V(X,S2) + 1 THEN S3=Z
3
:Z3=5
: FLAG=1
2655 NEXT
:;F FLAG=; THEN FLAG=0
:GOTO 2657




2656 GOSUB 2740
:GOTO 3750
2657 FOR Z4=1 TO 5
2658 ;F V(X,Z4)=V(X,S3) + 1 THEN H*(X>
= "STRA;GHT FLUSH"
: Z4=5
: FLAG=1
2659 NEXT
3 ;F FLAG=0 THEN GOSUB 2740ELSEFLAG
= O
:H<X)=13
2730 GOTO 3750
2740 ;N(X) == O
2741 FOR ;=1 TO 5
2742 ;F V(X,;)=1 THEN V(X,;)=14
2743 NEXT
2745 FOR ;=1 TO 5
2750 FOR N=1 TO 5
2760 ;F V<X,;) < V(X,N) THEN N=5
: FLAG=1
2770 NEXT
:;F FLAG=1 THEN FLA:« O
:GOTO 2790
2780 CH<X) «= V<X,;)
:;=5
2790 NEXT
: ;F CH<X)=0 THEN CH<X)=V(X,5)
2800 H(X)=10
:RETURN



2820 REDO=1
t GOSUB 100
: REDO =



2840 ;F H(X)=6 THEN CH(X) = V<K, VAL <
M;D* (H«<X>,2,1)))
3 H*(X)="PAIR OF = -s- V*<X5, VAL <
M;D* <H*<X),231))> + "S"
2850 ;F H<X)=7 AND VAL ( M;D* <H*(X);,3,
1)) > VAL < M;D* <H*(X),5,1>)
THEN CH<X)=V<X, VAL ( M;D* <H*(X
),3s,1)))
:H*(X) - "TWO PAIR:"
2860 ;F H(X>=7 AND VAL ( M;D* (H*(X),33,
D) < VAL < M;D* <H*(X)p3, 1))
THEN CH(X)=V<X, VAL < M;D* (H*(X
),5,1)>)
: H*(X)="TWO PAIRS"
2870 ;F H<X)=8 THEN CH<X)=V<X, VAL <
RIGHT* (H*<X),1)))
: H*(X)="THREE " + V*<Xs; VAL <
R;6HT* <H*<X)51))) + "S"
2880 ;F H<X)=9 THEN CH(X>=V<XjF3)
2890 ;F H<X)=11 OR H<X)=12 THEN
GOSUB 32000
2900 GOTO 3750




32000 REM FULL HOUSE AND FOUR OF A K;ND
CH<X) ROUTINE
32010 CH«=RIGHT* (H«<X);2)
32020 ;F CH$="AS" THEN CH(X>=14
:BOTO 32140
32030 ;F CH$ - "K8" THEN CH<X)=13
5 GOTO 32140
32040 ;F CH$ = "QS" THEN CH<X>=12
:BOTO 32140
32050 ;F CH$="JS" TWN CH<X) «= 11
:GOTO 32140
32060 ;F CH$="TS" THEN CH<X) = 10
8 BOTO 32140
32070 CH<X)=VAL ( H;D* <H*<X>, LEN (H*(X
)> - 1,1))
32140 RETURN




2910 D;SC(K>=1
; PRINT@LOK,B$(;O) + "l"p
2920 NC(1)=1
2930 FOR ; «= 3 TO 7
2940 ;F MC(1>=VAL < H;D^ (H^CX)^!,!))
THEN NC(1)=NC(1) + 1
:;=7
:FLAB=1
2950 NEXT
:;F FLA:= 1 THEN FLAB=0
:GOTO 2930
2960 GOSUB 20
2970 ;F C(DR - 1)=V<X5, VAL ( M;D^ <H^<X
),3s,1))) - 1 THEN CH<X)=V(X,
VAL < M;D^ (H^<X),65 1))>
:H$(X)="STRA;GHT TO " + V^CX,, VAL (
H;D^ (H^<X),6p 1) ))
: H(X) == 9
:GOTO 3750
2980 ;F C(DR - 1)=V(Xp VAL < M;D^ <H^<X
),6s,1)>) + 1 THEN H^(X)="STRA;GH
T TO " + C$(DR - 1)
:CH(X)=C(DR - 1)
:H<X)=9
:GOTO 3750
2985 ;F C(DR - 1) «= 14 AND VAL ( H;D^ <H^
;X>,Z,t))=2 THEN C(DR - 1)=1
:;N(X)=1
:GOTO 2970
2990 V<XpNC(1))=C(DR - 1)
:GOTO 2390



3000 D;SC(X) «= 1
8 PRINT@LOK,B$(10) + "1";
3010 FOR ;=1 TO 5



3020 ;F ST^(Xp;) < > ST^(XpF(X)> THEN NC
<
1)=;
:; =>= 5
3030 NEXT
3040 GOSUB 20
3050 ;F SS(DR - 1)=STt<X,F<X>) THEN 262
3060 SOTO 2820



3070 D;SC(X>=3
8 PRINT@L0K,B^<10) + "3";
3080 FOR ;=1 TO 3
3090 NC(;) =« NCd - 1) ^" 1
3100 ;F NCd)=VAL < M;D^ <H®<X),2,1))
OR NC(;)=VAL < M;D^ (H^CX) ^S, 1 )
>
THEN NCd)=NC(;) + 1
:60T0 3100
3110 NEXT
3120 GOSUB 20
:GOSUB 40
8 GOSUB 50
:BOTO 2820



3140 ;F LEN <H^(X))=4 THEN 3070
3150 D;SC(X)=2
8 PRINT SLOKpB^dO)="2"?
3160 FOR ;=1 TO 2
3170 NCd)=NCd - 1) + 1
3180 ;F NCd)=VAL ( H;J)^ <H«<X> ,2^ 1) )
OR NCd)=VAL < M;D^ <H^<X),3, 1))
OR NC(;) - VAL < R;SHT* <HlS(X)9,1))
THEN NCd)=NCd) + 1
:GOTO 3180
3190 NEXT
3200 GOSUB 20
:GOSUB 40
8 eOTO 2820



3220 PRINT S>L0K,B«<10) + "l";1
3 D;SC(X> = 1
:NC(1)=1
3240 FOR ;=3 TO 7
32S0 ;F NC(1)=VAL < H;D* (H«<X);;a;)>
THEN NC(1>=NC(1> + :;
:; = 7
E FLA:« 1
3260 NEXT
:;F FLAB=1 THEN FLA:«
:GOTO 3240
3270 eOSUB 20
3280 ;F CCDR ' ;) n) V(x, VAL C H;D;l <H«CX
)p3,1))) THEN H*(X)="FULL HOUSE,
" + Ct<DR - 1) + "8"
:CH(X)=CCDR - 1)
:H(X)=11
:GOTO 3750
3290 ;F C(DR - 1) = V(Xp VAL C H;D* CHtCX
>,5,1))) THEN n);X)="FULL HOUSE,
" + C*(DR - 1) + "8"
:CH(X)=CCDR - 1)
8 HCX) " 11
:GOTO 3750
3300 GOTO 2850


3310 ;F LEW CHSCX)) > 4 THEN PRINT@LOK,B
^C10) -g- "1";
: D;SCCX)=1
3320 ;F LEN CHS(X))=4 THEN PRINT@LOK^B
SC;O) + "2"!
:D;SCCK)=2




3340
3350
3360
3370
3380
3400
3410
3420
3425
3430
3440
3450
FOR ;=1 TO 2
NCC;)=NC(;-1>+1
;F NC(;)=VAL ( M;D$ (H^ (X) , 2, 1 )
)
OR NC(;)=VAL ( H;D^ <H^<X),3p1))
OR NC(;)=VAL ( M;D;$ (H^(X),451))
THEN NC(;>=NC(;> + 1
GOTO 3360
NEXT
GOSUB 20
;F LEN (W;<X)) > 4 THEN 3430ELSE
GOSUB 40
;F C(DR - 1)=C(DR - 2) THEN H^<X)
= "FULL HOUSE p " + V^<X, VAL <
RIGHT$(H^(X)5,;)))="S"
H(X>=11
GOSUB 32000
;F C(DR - 1) =: V(X5, VAL < RIGHT:<H^
(X),!))) OR C(DR - 2)=V(X, VAL (
RIGHT$(H^(X),1))) THEN H*<X)="F
OUR " + V^<X, VAL ( RIGHTH (H$<X),
1))) -«- "S"
GOSUB 32000
;F LEFT^ (H^<X),1>="T" THEN CH<X)
= V(X, VAL < M;D^ <H^(X),25, 1) ) )
H^(X)="THREE " H
(H^(X),251))) +
GOTO 3750
;F C(0R - 1)=14
V^<X3
"S"
VAL < M;D^
THEN H^(X) =
HOUSE, " -s- V^(X, VAL < M;D^
) 5,2, 1) ) ) -;- "S"
GOSUB 32000
;F C(DR - 1)=V(X, VAL < n;D%
),2,;))) THEN H^(X)="FOUR "
"FULL
(H*(X
<H$<X
+ V!;
<X5, VAL <
GOSUB 32000
GOTO 3420




3460 PRINT SLOKj^;'LL PLAY THESE. "p
:GOSUB 63000
:GOSUB 27180
:GOTO 4190





3750 LOK=412 -=- ((X - 1)=20)
:;F X=4 THEM LOK=1372
3760 FOR ;=1 TO D;SC(X>
:PRINT@LOKpERAS^&p
:LOK=LOK ~ 83
:NEXT
3770 PRINT@LOK,ART^§
:LOK=LOK + 83
:GOSUB 63020
3780 FOR ;=1 TO D;SC(X>
:PRINT SLOK.ART^p
:LOK=LOK + 03
:GOSUB 63020
:NEXT



3470 PRINT aLOKp"Ho*« n)any cards" p
:;NPUT § D;SC (5)
3480 GOSUB 7160
3490 ;F D;SCO) < > ;NT <D;SC(5)) OR D;SC
<5) > 3 OR D;SCO) < O THEN GOTO 3
470
3500 ;F D;SCO)=0 THEN PRINT SLOK^, "Okay
:goto' 4190
3510 1=0
3520 FOR N=21 TO 25
3525 GOSUB 7160
3530 PRINT atOK:"Replace " + CS<N) + S$(N
) + " <V/N)";
3540 ;NPUT pANS
3550 ;F ANt="N" THEN 3590
3560 ;F AN^ < > "Y" THEN 3525ELSECD^ <N)
^ CD^<DR)
:C$(N)=C$(DR)
:S$(N)=S$(DR)
3 cn))=C(DR)
8 S(N) =« S(DR)
3570 DR=DR -s- 1
3580 1=1+1
3 ;F ;=D;SCO) THEN N=25
3590 NEXT
3600 ;F ; < > D;SC(5) THEN PRINT SLOKp "Yo
u only took ";;;"« Let':try aga;n
; GOSUB 63000
:PRINT@L0K,B^<12) + B$(12);
:GOTO 3510
3610 LOK=1060
3620 FOR N=21 TO 25
3630 PRINT@LOKjCDWCN)!
3640 GOSUB 63020
3650 LOK «= LOK + 83
3660 NEXT
3670 GOTO 4190


4190 X=X + 1
4200 ;F X=6 THEN X=1
4210 ;F X=1 AND D < > 5 THEN 2030
4220 ;F X < > 1 AND X < > D -«- 1 THEN 2030
4230 RETURN



5000 FOR X=1 TO 4
5010 ;F P<X) < > O THEN 5030
5020 ON X GOSUB 5050p 51 10, 5190p 5270
5030 NEXT
5040 RETURN



5050 REM MARV;N
5060 ;F HIT) < 6 THEN DF(1> ==
:BF(1) =
5070 ;F H<1)
= 1
< 8 AND H<1) > 5 THEN BF(1)
RF<1)=0
DF(1)=14
5080 ;F H<1)
^ 2
> 7 AND HIT) < 10 THEN BF(1)
RF(1)=2
DF(1)=21
5090 ;F H<1> > 9 THEN@F<1) = 3
RF<1)=5
DF<1) =1 21
5100° RETURN




5110 REM 8ERRY
5120 ;F H;2)=3 OR H<2)=4 THEN BLCX)
= RND (10)
:;F BL<X) < 3 THEN BF<2)=2
:RF(2)=3
:DF<2)=14
:RETURN
5130 ;F H(2> < 6 THEN DF<2)=0
:BF(2)=0
5140 ;F H(2)=6 OR H<2)=7 THEN BF<2)
= 1
: RF<2)=0
:DF(2)=8
5150 ;F H<2)=8 OR H<2>=9 THEN BF<2)
= 2
:RF<2)=1
:DF(2) - 12
:;F H(2) * 9 THEN DF<2)=21
5160 ;F H<2)=10 THEN BF(2)=3
:RF<2)=3
:DF(2) * 21
5170 ;F H<2) > 10 THEN BF<2)=3
:RF(2)=5
5 DF<2>=21
5180 RETURN


S; 90 REM WALTER
5200 ;F H<3) < 3 THEN DF<3)=0
8 BF<3) ^
5210 ;F H(3) =3 OR H(3) =4 THEN BL(X)
= RND <10)
:;F BL(X) = 7 THEN BF<3)=2
:RF(3>=3
:DF<3)=10
5220 ;F BL<X> < > 7 AND H<3) < 6 THEN DF
(
3)=0
:BF<3) 3= O
5230 ;F H<3) < 8 AND H(3) > 5 THEN BF<3)
^ 1
:RF(3)=0
:DF(3)=7
5240 ;F H(3) =8 THEN eF(3> - 2
8 RF<3>=2
8 DF(3)=21
5250 ;F H<3> >=9 THEN BF(3)=3
: RF<3)=3
1 DF<3)=21
5260 RETURN


5270 REM BETSY
5280 ;F H(4> < 9 THEN BL<X) =^ RND (4)
:;F BL<X)=4 THEN BF(4)=3
:RF(4)=3
. DF<4)=21
:GOTO 5340



5290 ;F H(4) < 6 THEN DF(4) =
:BF<4)=0
5300 ;F H(4) =6 THEN BF<4)=2
:RF<4)=0
: DF(4)=8
5310 ;F H<4)=7 THEN BF(4)=2
:RF(4)=1
:DF(4)=10
5320 ;F H(4) =8 THEN BF<4)=2
:RF(4)=2
:DF<4)=12
5330 ;F H(4) > 8 THEN BF<4)=3
5 RF(4)=3
:DF(4)=21
5340 ;F R(4) > 50 AND DF<4> > O THEN BF(4
>=BF<4) + 1
:RF(4)=RF(4) + 1
:;F R(4) > 100 THEN BF(4)=BF(4) + 1
2 RF(4)=RF(4) + 1
:DF<4)=DF(4) + 1
5350 RETURN

6000 REM SHUFFLE
6010 CLS:N=-1
6020 PRINT"SHUFFLING":CHR$(16) AND (17)
6060 FORX=1TO40
6070 C(X)=RND(52)
6080 ;FCH(C(X))=1THEN6070
6090 CH(C(X))=1
6130 S(X)=;NT((C(X)-1)/13)+1
6140 S$(K)=CHR$(196-S(X))
6180 ;FC(X)>13THENC(X)=C(X)-13:GOTO6180
6190 ;FC(X)<10THENC$(X)=STR$(C(X))
6195 ;FC(X)=10THENC$(X)="T"
6200 ;FC(X)=11THENC$(X)="J"
6210 ;FC(X)=12THENC$(X)="Q"
6220 ;FC(X)=13THENC$(X)="K"
6230 ;FC(X)=1THENC$(X)="A":C(X)=14
6240 CD$(X)=TPCARD$+GOBACK$+CHR$(149)+RIGHT$(C$(X),1)+S$(X)+CHR$(170)+GOBACK$+BOTCARD$
6245 ;FX/6=;NT(X/6)THENGOSUB6270
6250 NEXT
6255 FORX=1TO52:CH(X)=0:NEXT
6260 RETURN
6270 REM ANTE
6275 ;FN=-1THENPRINT:PRINT"PLEASE ANTE:":PRINT:PRINT:N=0:RETURN
6280 N=N-1:;F N=5THEN6320
6290 ;FP(N)<>0THENPRINTP$(N)+" ;S BUSTED.":PRINT:RETURN
6300 R(N)=R(N)-1:PRINTP$(N)+" ;S ;N.":PT=PT+1:PRINT:RETURN
6320 PRINT "ARE YOU ;N?"
6325 C$=INKEY$
6330 ;FC$="Y"THENR(5)=R(5)-1
6340 ;FC$="N"THENEND
6341 GOTO6325

7000 LOK=720
; PRINT@LCH<,B«<12)
a RETURN
7040 LOK=745
; PRINT@L0K,Bt(12)
:RETL^N
7080 LOK=770
:PRINT@L0KpB^<12)
:RETURN
7120 LOK=1680
:PRINT@LOK5,B;&(12)
:RETURN
7160 LOK - 1705
8 PRINT@L0K,B*<12)
:RETURN



8000 REM F;RST ROUND OF BETT;NB
8010 NB «=
:RD=1
:OP=D + 1
B ;F OP=6 THEN OP=1
8050 ;F P<OP)=THEN 8110
8060 OP=0P + 1
:;F OP=6 THEN OP=1
8070 RD=RD + 1
: ;F RD=6 THEN DROPFLA:« 1
: D=D + 1
:BOTO 8090
8080 GOTO 8050
8090 ;F D = 6 THEN D * 1
8095 ;F P<D) == 1 THEN D=D + 1
:GOTO 8090
8100 GOSUB 29170
:CLS
:RETURN


8110 ON OP GOSUB 7000=7040s, 70805 7 ;205, 7160
8120 ;F OP < > 5 THEN 8250
8130 PRINT@LOK:"What':your bet"?
8140 ;NPUT ;B<OP>
8150 ;F H<5) < 6 AND B(OP> > THEN
GOSUB 7160
:PRINT@LOK,"You can"! open!";
:OP=1
:GOTO 8070
8160 ;F B(OP> > 5 OR B<OP) > R(5) OR B<OP
) < O OR B(OP) < > ;NT (B(OP))
THEN GOSUB 7160
:PRINT SLOK, ";llegal b®t"5
:GOSUB 63000
:GOTO 8130
8170 ;F B(OP)=0 THEN OP=1
:GOTO 8070
8240 R(5>=R(5) - BCCT)
:PT=PT "#• B(OP)
:LB(OP)=B<CF)
: GOTO 8330
8250 ;F H<OP) >=6 AND R(OP) >=BF<OP)
THEN PRINT S>L0K,B$(1) + RIGHT* <
STR^ (BF<0P)>,1)5
:R(OP)=R(OP) - BF(OP)
:FT=PT 4. BF<OP)
:LB (OP)=BF(OP)
:GOTO 8330
8260 ;F H<OP) >=6 TWN PRINT@L0K,B$(1)
+ "1"5
:R(OP)=R(OP) - 1
:PT =: PT =• 1
:LB(OP)=1
:GOTO 8330
8270 PRINT S)L0K5B^<8)p
:GOSUB 63000
:GOTO 8060



8330 BE :LB (OP)
:ST :a>
:RD SB 1
:eOSUB &3000


8340 REM BET:CONT;NUE AFTER OPENER
8350 OP=0P -;- 1
:;F OP=6 THEN OP=1
8360 ;F P<OP) < > O THEN RD == RD + 1
:BOTO 0530
8370 GOSUB 31000
8380 ON OP GOSUB 7000,7040,7080,71205 7160
LB(0
> BE
<
BE - LB(0
8390 ;F OP < > 5 THEN 8480
8400 PRINT@LOKj^Mlhaf:your b@t?5
8410 ;NPUT 5B(0P)
8420 ;F B(OP> > R(5) OR B<OP) > BE -
P) -8- 5 OR BCOP) < O OR <B(OP)
- LB(OP) AND NB = 3> OR B<OP)
> ;NT (B(OP)) THEN GOSUB 7160
8 PRINT S>LOK, ";LLEGAL BET";
: GOSUB 63000
:GOTO 8400
8430 ;F B<OP) < > O AND B<OP) <
P) THEN GOSUB 7160
:PRINT S>LOK, ";LLEGAL BET";
:GOSUB 63000
:GOTO 8400
8440 ;F B(OP)=0 THEN P<5) == 10
:GOSUB 40000
8450 R(5)=R(5> - B(OP)
- PT=PT + B<cr)
:RD=RD + 1
8460 ;F B<OP) > BE - LB (OP) THEN RF(OP)
= BCOP) - BE - LB (OP)
:BE=BE + RF(OP)
:NB=NB + 1
= BE THEN PRINT 5>L0K,B$(
:RD 3= 1
8470 LB (OP)=BE
:GOTO 8520
8480 ;F DF(OP) <
9)5
:RD=RD + 1
P(OP)=10
GOSUB 40000
GOTO 8520




8490 ;F NB < 3 AND RF<OP) > THEN
PRINT S>L0K,B$(3) + RIGHT* < STR* (
RF<OP> >, 1)
5
:R(OP)=R(OP) - RF(OP) - BE + LB (OP)
! PT=PT + RF(OP) + BE - LB (OP)
: RD=1
8500 ;F NB < 3 AND RF(OP) > THEN BE=B
E + RF(OP)
: LB (OP)=BE
: NB=NB + 1
£ 60T0 8520
8510 RD=RD + 1
2 PT=PT -t" BE - LB (OP)
:R(OP)=R(OP) - BE + LB (OP)
5 LB (OP)=BE
: PRINT 5>LOK,B«(2);
8520 GOSUB 63000
8530 ;F RD < > 5 THEN 8350






8540 BE =
:LB(OP)=0
:GOSUB 31000
8550 SOFAR == O
8560 FOR N = 1 TO 5
8570 ;F P<N) < > O THEN SOFAR=SOFAR + 1
8580 NEXT
8590 ;F SOFAR < > 4 THEN SOFAR =
:RETURN
8600 FOR N=1 TO 5
8610 ;F P<N)=THEN W;NNER =« N
8620 NEXT
8630 GOSUB 28250
:W;NFLAG=1
:RETURN


9000 REM SECOND ROUND OF BETTING
9020 FOR OP=1 TO 5
. LB (OP) «= O
:NEXT
9050 OP=STARTER
3 RD=;
t NB =
9060 BOTO 9080



9070 OP=0P+ 1
; ;F OP=6 THEN OP == 1
9080 ;F P(OP) < > THEN RD=RD + 1
:GOTO 9260
9090 GOSUB 31000
9100 ON OP GOSUB 7000,7040,7080,7120,7160
9110 ;F OP < > 5 THEN 9200


9120 PRINT SLOK^^';Mhaf:your bet=;
9130 ;NPUT ;B<OP)
9140 ;F B(OP) > R(5) OR B<OP) > BE -
P) + 5 OR B(OP) < O OR (B(OP)
- LB(OP) AND NB «= 3> OR B(OP>
> ;NT <B(OP)) THEN GOSUB 7160
8 PRINT@LOK, ";LLEGAL BET"?
:GOSUB &3000
:GOTO 9120
9150 ;F B(OP) < > O AND BCOP) <
P) THEN GOSUB 7160
:PRINT@LOK 5, ";LLEGAL BET";
:GOSUB 63000
:GOTO 9120
9160 ;F B(OP>=0 AND BE > O THEN P(5> =
10
:GOSUB 40000
9170 R(5)=R(5) - BCOP)
:pj := pT=B(OP)
a RD=RD -s- 1
§ ;F BE=0 THEN BE=B<QP>
:RD=1
9180 ;F B<OP) > BE - LB^OP) THEN RF(OP)
= B(OP> - BE - LB (OP)
:BE=BE «- RF<OP)
:;F BE < > O THEN NB=NB + 1
:RD=1
9190 LB (OP)=BE
§ GOTO 9250


9200 ;F BF(OP> > O AND NB=0 AND BE=0
THEN PRINT SL0K,B^<4) + RIGHT:<
STR^ (BFCOP)),!)?
:LB(OP)=BF<OP)
:BE=BF(OP)
3 RD=1
:PT=PT + BE
; R(OP)=R(OP) - BE
:GOTO 9250
9210 ;F DF<OP> < BE THEN PRINT aL0K,B^<9)
;
:RD=RD + 1
:P<OP)=10
; GOSUB 40000
8 GOTO 9250
9220 ;F NB < 3 AND RFCOP) > O THEN
PRINT@L0K,B$(3) -*- RIGHT$( STR^ (
RF<OP))e,l>;
:R(OP)=R(OP) - RF(OP) " BE + LB(OP>
:RD=1
9230 ;F NB < 3 AND RF<OP> > O THEN PT - P
T+RF<OP) + BE - LB(OP)
; BE=BE+ RF(OP)
:LB (OP)=BE
8 NB *« NB + 1
:GOTO 9250
9240 LB (OP)=BE - LB (OP)
:RD=RD + 1
t PT=PT 4- LB (OP)
:R(OP)=R(OP) - LB (OP)
:PRINT S)L0KpB$(2);


9250 GOSUB 63000
9260 ;F RD < > 5 THEN 9070
9270 BE =
8 LB (OP)=0
: GOSUB 31000
9280 REM CHECK FOR DEFAULT W;NNER
9300 FOR N == 1 TO 5
9305 ;F P(N) < > O THEN SOFAR=SOFAR + 1
9310 NEXT
9320 ;F SOFAR < > 4 THEN RETURN
9330 GOTO 8600

10000 GOSUB60000:REM ;NTRO AND SEED
10010 GOSUB50000:REM HOUSEKEEPING
10020 GOSUB6000:REM SHUFFLE AND ANTE
10030 GOSUB18000:REM DEAL
10040 GOSUB90:REM F;GURE HANDS
10050 GOSUB8000:REM F;RST ROUND OF BETTING
10055 ;FDROPFLAG=1THENDROPFLAG=0:GOTO10020
10056 ;FW;NFLAG=1THENW;NFLAG=0:GOTO 10140
10060 GOSUB19000:REM CLEAR SCREEN
10070 GOSUB2000:REM GET DRAW CARD:AND F;GURE HANDS
10080 GOSUB5000:REM SET NEW PATTERN:OF BETTING
10090 GOSUB19000
10100 GOSUB9000:REM SECOND ROUND OF BETTING
10105 ;FW;NFLAG=1THENW;NFLAG=0:GOTO10140
10110 GOSUB19000
10120 GOSUB27000:REM DECLARAT;ON
10130 GOSUB28000:REM F;GURE W;NNER
10140 GOSUB29000:REM CLEAR THE DECKS AND DO ;T AGA;N
10150 GOTO10020

18000 REM DEAL
18010 CLS
18050 ;FP(1)=0THENPRINTP$(1)
18070 ;FP(2)=0THENPRINT@12,P$(2)
18090 ;FP(3)=0THENPRINT@25,P$(3)
18110 ;FP(4)=0THENPRINT@960,P$(4)
18130 PRINT@985,P$(5)
18140 FORX=1TO5
18150 LOK=(80*X)+((X-1)*3)
18160 FORY=1TO5
18170 ;FY>1THENLOK=LOK+20:;FY=4THENLOK=LOK+900
18180 ;FP(Y)<>0THEN18200
18190 ;FY<>5THENPRINT@LOK,ART$
18195 ;FY=5THENPRINT@LOK,CD$(20+X);
18200 NEXTY
18210 NEXTX
18240 GOSUB 31000:RETURN

19000 REM CLEAR SCREEN A B;T FOR T;D;NESS
19010 GOSUB 63000
:GOSUB 63000
5 GOSUB 63000
19020 GOSUB 7000
19030 GOSUB 7040
19040 GOSUB 7080
19050 GOSUB 7120
19060 GOSUB 7160
19070 NB =
'
:BE =
; FOR ;=1 TO
!; LBd) =0
'
; NEXT
: GOSUB 31000
!! GOSUB 63000
s
• RETURN



27000 REM DECLARAT;ON
27010 OOSUB 47000
27020 FOR X=; TO 5
27030 ;F P(X) < > O THEN 27080
27040 ON X OOSUB 7000p 7040, 7080, 71 20p 7160
27050 ;F X = 5 THEN GOSUB 27100
:PRINT@LOK, "You've got " + H*(5)5
:OOTO 27080
27060 ;F H<X> > 5 THEN PRINT@LOK^H^CX)!
27070 ;F H(X) <=5 THEN PRINT@LOK,Bt(ll>
27080 NEXT
27090 RETURN


27100 REM TRANLATE PREV;OUSLY UNTRANSLATE
D HAND:;N H^(X>+CHECK<X)
27110 REDO=1
5 GOSUB 130
:GOSUB 1360
:REDO=0
27120 ;F H<X) < 6 THEN H^<5) = "DCM3DLY SQU
AT"
:RETURN
27130 ;F H<X)=6 THEN CH<X)=V<X:VAL (
HID^ (H^(X)p2,l>))
:H$(X)="PAIR OF " + V^<X, VAL (
MID% (H^(X>52, 1))> + "S"


27140 IF H(X)=7 AND VAL < MID^ <H*(X)p3,
1)) > VAL ( MIDHi (H*(X),5,1))
THEN CH(X)=V<X, VAL < MID« (H*(X
),3,1))>
I H^(X>="TWO PAIR:"
27150 IF H<X)=7 AND VAL < HID* (H$<X),35,
D) < VAL < HID* <H*(X),5sl>)
THEN CH(X)=VtX, VAL ( HID* (H*<X
>,5s1)>)
i H*(X)="TWO PAIRS"
IF H<X) = 8 THEN CH<X)=V<Xsi VAL (
RIBHT* (H*(X),1}))
H*(X>="THREE " -s- V*(Xsi VAL <
RISHT* <H*(X)31))) «- "S"
IF H(X>=10 THEN GOSUB 2740
IF H<X) = 11 OR H(X)=12 THEN
GOSUB 32000
27200 RETURN

28000 REM FI6URE iMHO WON
28010 FOR X=1 TO 5
28020 IF PCX) < > THEN 28070
28030 FOR I = 1 TO 5
28040 IF H(X) < H<I) THEN I = 5
:FLAB=1
28050 NEXT
:IF FLAG=1 THEN FLAB=0
:GOTO 28070
28060 MINNER «= X
3 X=5

28080 Y=2
3 TIEd) '
28090 FOR N «
28100 IF P<N)
20
' WINNER
1 TO 5
< >
28110 IF Hin)=H<WINIMER) THEN TIE<Y)=H
:Y=Y + 1
28120 NEXT
28130 IF Y=2 THEN 28250

28140 FOR X = 1 TO Y - 1
28150 FOR I - 1 TO Y - 1
28160 IF CH(TIE<X)) < CH<TIE<I>) THEN I =
Y - 1
:FLAB=1
28170 NEXT
:IF FLA6=1 THEN FLAB=0
8 GOTO 28185
28180 WINNER=TIE<X)
:X «= 5
28185 NEXT
28190 HULTI=2
8 MULTK1)=NINNER
28200 FOR N=1 TO Y - 1
28210 IF TIECN)=WINNER THEN 28230
28220 IF CH(TIE(N))=CH(WINNER) THEN MULT
KMULTI)=TIECN)
:MULTI=MULTI + 1
28230 NEXT
28240 IF MULTI > 2 THEN 28320

29150 REM CLEAR THE DECKS
29160 GOSUB 29170
:GOTO 29290
29170 FOR I=1 TO s
:B<I> =
:LB(I) -
3 IN<I> =
:NEXT
29190 BE =
29200 CH^=""
29210 FOR I=I TO s
:CH<I) =
1 DISC(I) =
:BF<I> «
: BL<I) «
i DUBCHKS<I>=Bl >S
:NEXT
29220 FOR I=1 TO 5
1 F<1) =
:HSCI)=""
:HCI) =
§ NEXT
29230 HB =
1 TPC ^
29240 FOR 1=TO 3
:Nca> ^
:NEXT
292S0 REDO «
i SOFAR «
29260 FOR I=1 TO 3
:TIE(I) =
:NEXT
29270 WINNER «
29280
STARTER =«
RETURN

29290 D=D -fr 1
I IF D=6 THEN D=1
29300 IF P(D) < > O THEN 29290
29310 RETURN

31000 REM SET ONGOING INFORMATION
31010 IFSTARTER<>0THENPRINT@1090,P$(STARTER)=BS(7);
31030 PRINT@1170,"DEALER:"+P$(D);
31040 PRINT@1250,B$(12);
31050 PRINT@1250,B$(4);:BE-LB(OP);
31080 PRINT@1330,"RAISES"NB;
31110 PRINT@1410,B$(5);PT;
31120 PRINT@1490,B$(12);
31130 PRINT@1490,B$(6);R(5)p
31140 RETURN

40000 REM CHANSE D;SPLAY ^HEN A PLAYER FO
LDS
40010 LOK=412
:;F OP=2 THEN LOK=432ELSE ;F OP
« 3 THEN LOK=452ELSE ;F OP=4
THEN LOK=1372ELSE ;F OP=5
THEN LOK=1392
40020 FOR ; - 1 TO 5
40030 PRINT@LOKpERASS;
40040 LOK=LOK - 83
40050 NEXT
40060 RETURN



46100 LOK =
:RETURN
46200 LOK=25
:RETURN
46300 LOK=50
:RETURN
46400 LOK=960
:RETURN
46500 LOK=985
: RETURN


47000 REM SHOW CARDS
47010 FOR ;=1 TO 5
47020 LOK=(80 $ ;) + ((; - 1) $ 3)
47030 FOR Y=1 TO 5
47040 ;F Y > 1 THEN LOK=LOK + 20
:;F Y=4 THEN LOK=LOK + 900
47050 ;F P<Y) < > O THEN 47070
47060 PRINT S)LOK p CD$( ( ( Y - 1) W 5) + ;).
47070 NEXT Y
47080 NEXT ;
47090 RETURN

50000 REM SET D;M AND VAR;ABLE NAMES
50010 D;M R(5),P(5):P$(5)
50020 FORX=1TO5:R(X)=100:NEXT
50030 REM P(X)=PLAYER NUMBER-0/;N, 1/OUT, 10/OUT FROM TH;S HAND ONLY
50040 D=1
50060 P$(1)="MARV;N"
50070 P$(2)="GERRY"
50080 P$(3)="WALTER"
50090 P$(4)="BETSY"
50100 P$(5)="YOU"
50110 D;MC(40),C$(40),S(40),S$(40),CD$(40)
50115 D;MCH(52)
50120 FINGER$=CHR$(244)>+CHR$(245)+CHR$(246)
50130 D;M V(5,5);,V*(5,5) 5,ST(5,5) s,ST$(5,5)
50140 TPCARD$=
50145 M;DCARD$
50150 BOTCARD$
50155 GOBACK$
50160 ART$
50162 ERAS$
50170 D;MB$(12)
50190 B$(1)="I'LL OPEN FOR $"
50200 B$(2)="I'LL SEE THAT"
50210 B$(3)="I'LL RA;SE YOU $"
50220 B$(4)="THE BET ;S $"
50230 B$(5)="THE POT ;S $"
50240 B$(6)="YOU HAVE $"
50250 B$(7)=": OPENER"
50260 B$(8)=""I CAN'T OPEN"
50270 B$(9)="I'M OUT!"
50280 B$(10)="I'LL TAKE "
50290 B$(l1)="I'VE GOT Z;LCH!"
50300 B$(12)="                   "
50320 RETURN

60000 CLS:PRINT TAB(11)"DRAW POKER"
60010 PRINT:PRINT
60020 PRINT TAB(2)"COPYRIGHT 1984 BY JIM MENICK"
60025 PRINT CHR$(15)+CHR$(21)
60030 FORPAUSE=1TO2500:NEXT
60040 CLS
60050 THESE ARE THE HOUSE RULES:"
60060 PRINT"EACH PLAYER BEGINS WITH:"
60070 PRINT"$1 ANTE"
60080 PRINT"JACKS OR BETTER TO OPEN"
60090 PRINT"THREE RA;SE L;M;T"
60100 PRINT"$5 BETTING L;M;T"
60110 PRINT"HIT SPACE TO CONT;NUE"
60120 REM RANDOMIZE
60130 X$=INKEY$
63000 FORPAUSE=1TO1500:NEXT
63010 RETURN
63020 FORPAUSE=1TO2500:NEXT
63030 RETURN
