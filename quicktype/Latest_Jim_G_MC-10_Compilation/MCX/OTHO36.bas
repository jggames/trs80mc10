10 CLS6:PRINT@236,"OTHO 3.6";:PRINT@303,"BY";:PRINT@329,"ALAIN DUSSAULT";:PRINT@363,"OCT. 1982";
20 PRINT@450,"MC-10 VERSION BY JIM GERRIE";:FORK=1TO1500:NEXT
30 DIME(88),B(99),BB(66),C(8),D(60),G(25),H(25),W(88),B1(25),B2(25),EV(25),B3(25),CC(25),JK
40 FORR=1TO8:W(10+R)=257+2*R:W(20+R)=225+2*R:W(30+R)=193+2*R:W(40+R)=161+2*R:W(50+R)=129+2*R
41 W(60+R)=97+2*R:W(70+R)=65+2*R:W(80+R)=33+2*R:NEXT
50 DATA3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0,0,2,1,0,0,0,3,3,0,0,0,1,2
51 DATA0,0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,-11,-10,-9,-1,1,9,10,11
60 DATA81,88,11,18,83,86,61,68,31,38,13,16,63,66,33,36,84,85,51,58,41,48,14,15,64,65,53,56,43,46,34,35,74,75,52,57,42
61 DATA47,24,25,73,76,62,67,32,37,23,26,82,87,71,78,21,28,12,17,72,77,22,27
70 DATA64,-32,32,16,16,32,-32,64,0,0,-32,-64,2,2,2,2,-64,-32,0,0,32,2,8,4,4,8,2,32,0,0,16,2,4,0,0,4,2,16,0,0,16,2,4,0
71 DATA0,4,2,16,0,0,32,2,8,4,4,8,2,32,0,0,-32,-64,2,2,2,2,-64,-32,0,0,64,-32,32,16,16,32,-32,64
80 FORK=0TO99:READB(K):NEXT
90 FORK=1TO8:READC(K):NEXT
100 FORK=1TO60:READD(K):NEXT
110 FORK=11TO88:READE(K):NEXT
120 X=0:X1=0
130 CLS0:PRINT@1,"";:FORJK=1TO19:PRINTCHR$(211);:NEXT
131 FORK=33TO320STEP32:PRINT@K,CHR$(223);:PRINT@K+18,CHR$(223);:NEXT:PRINT@290,"";:FORJK=1TO17:PRINTCHR$(211);:NEXT
140 PRINT@0,CHR$(131);:PRINT@32,"8";:PRINT@64,"7";:PRINT@96,"6";:PRINT@128,"5";:PRINT@160,"4";:PRINT@192,"3";:PRINT@224,"2";
141 PRINT@256,"1";:PRINT@288," ";
150 PRINT@320,"   A B C D E F G H  ";
160 PRINT@54,"OTHO  3.6";:PRINT@117,"LEVEL";:PRINT@181,"I9 =   PASS";:PRINT@245,"L  =  LEVEL";
170 PRINT@448,"PLAY AGAINST COMPUTER";:INPUTZ$:PRINT@448,"";:FORJK=1TO32:PRINTCHR$(128);:NEXT
171 IFZ$="N"THENU=-4:B(54)=-4:B(45)=-4:B(55)=4:B(44)=4:GOSUB920:PRINT@375,"P#1";:PRINT@380,"P#2";:GOTO220
180 PRINT@375,"YOU";:PRINT@380,"COM";:GOSUB2400:IFZ$="Y"THENU=3
190 UU=0:VV=0:FF=0:PRINT@448,"YOU PLAY FIRST (Y/N)";:INPUTX$
191 PRINT@448,"";:FORJK=1TO32:PRINTCHR$(128);:NEXT:IFX$="Y"THEN200
192 IFX$="N"THEN210
193 GOTO190
200 GOSUB920:GOTO220
210 B(54)=2:B(55)=1:B(44)=1:B(45)=2:GOSUB920:GOTO580
220 FF=FF+1:IFZ$="N"THENU=-U
230 SOUND100,1:SOUND150,1:PRINT@416,"";:FORJK=1TO20:PRINTCHR$(128);:NEXT:PRINT@480,"";:FORJK=1TO10:PRINTCHR$(128);:NEXT
240 IFZ$="N"ANDU=4THENPRINT@416,"PLAYER #1: ";:GOTO270
250 IFZ$="N"ANDU=-4THENPRINT@416,"PLAYER #2: ";:GOTO270
260 PRINT@416,"YOUR TURN: ";
270 Y$=INKEY$:JK=RND(1000):IFY$=""THEN270
271 IFY$>="A"ANDY$<="I"ORY$="L"THENPRINTY$;:GOTO280
272 GOTO270
280 IFY$="L"THENGOSUB2400:GOTO230
310 O=VAL(INKEY$):IFO<1ORO>9THEN310
311 PRINTO;:A=10*O+(ASC(Y$)-64)
320 IFA=99ANDZ$="Y"THENBB(FF)=A:X1=1:GOTO580
330 IFA=99ANDZ$="N"ANDU=4THENBB(FF)=A:X=1:GOTO220
340 IFA=99ANDZ$="N"ANDU=-4THENBB(FF)=A:X1=1:GOTO220
350 IFB(A)<>0THENPRINT@480,"SQUARE OCCUPIED ";:FORR=1TO500:NEXT:PRINT@480,"";:FORJK=1TO20:PRINTCHR$(128);:NEXT:FF=FF-1:GOTO230
360 BB(FF)=A:X1=0
370 IFZ$="N"THEN2490
380 R5=1:GOSUB440:R5=0:GOTO540
390 R5=0:B1=0:FORR1=1TO60:A=D(R1)
400 IFB(A)<>0THEN420
410 GOSUB440
420 NEXT
430 B1(Z)=B1:GOTO730
440 N=0:FORJ=1TO8:K=A+C(J)
450 IFB(K)<>1THEN500
460 K=K+C(J):IFB(K)=1THEN460
470 IFB(K)<>2THEN500
480 K=K-C(J):IFK=A THEN500
490 N=N+1:IFR5=1THENB(K)=2:GOTO480
491 GOTO480
500 NEXT
510 IFN>0ORN<B1 THEN530
520 B1=N
530 RETURN
540 IFN>0THEN550
541 SOUND100,2:PRINT@480,"";:FORJK=1TO10:PRINTCHR$(128);:NEXT
542 PRINT@490,"ILLEGAL MOVE";:FORR=1TO1200:NEXT:PRINT@490,"";:FORJK=1TO15:PRINTCHR$(128);:NEXT:GOTO230
550 IFZ$="Y"THENB(A)=2:GOSUB920
560 IFZ$="N"THENB(A)=U:GOSUB920
570 IFZ$="N"THEN220
580 FF=FF+1:IFFF=1THEN1240
590 IFLL=1ORFF<=14THEN610
600 GOTO1280
610 N1=0:G(1)=0:R4=0:FORR=1TO60:A=D(R):PRINT@360,R;:IFB(A)<>0THEN640
620 GOSUB780
630 IFG(1)<>0AND(FF<=14ORLL=1)THENR4=1:GOSUB780:GOTO900
640 NEXT
650 IFG(1)=0THEN770
660 IFLL=4ANDFF>=53THEN720
670 FORZ=1TON1
680 EV(Z)=E(G(Z))+60-CC(Z):NEXT:RR=EV(1):GG=CC(1)
690 FORZ=1TON1:IFEV(Z)<=RR THEN710
700 GG=CC(Z)
710 NEXT:A=D(GG):R4=1:GOSUB780:GOTO900
720 FORZ=1TON1:R4=2:A=G(Z):B(A)=1:S1=A:GOSUB780:GOTO390
730 GOSUB1150:V=0:NEXT
740 FORZ=1TON1:IFB1(Z)=0THENB1(Z)=.1
750 B3(Z)=B2(Z)/B1(Z):NEXT
760 GOSUB1160:R4=1:GOSUB780:GOTO900
770 PRINT@480,"COMPUTER HAS NO MOVE";:X=1:BB(FF)=A:IFX=1ANDX1=1THEN1060
771 GOTO220
780 PRINT@416,"";:FORJK=1TO10:PRINTCHR$(128);:NEXT:N=0
781 FORJ=1TO8:K=A+C(J):PRINT@480,"";:FORJK=1TO20:PRINTCHR$(128);:NEXT:PRINT@480,"THINKING";
790 IFB(K)<>2THEN860
800 K=K+C(J):IFB(K)=2THEN800
810 IFB(K)<>1THEN860
820 K=K-C(J):IFK=A THEN860
830 N=N+1:IFR4=1THENB(K)=1
840 IFR4=2THENB(K)=1:V=V+1:H(V)=K
850 GOTO820
860 NEXT
870 IFR4=2THEN890
880 IFN>0THENN1=N1+1:G(N1)=A:B2(N1)=N:CC(N1)=R
890 RETURN
900 S=INT(A/10):T=A-10*S+64:W$=CHR$(T):V=0:B(A)=1
910 X=0:BB(FF)=A:SOUND200,1:PRINT@480,"I PLAY AT: ";W$;S;
911 FORJ=1TON1:H(J)=0:G(J)=0:B2(J)=0:B3(J)=0:B1(J)=0:EV(J)=0:CC(J)=0:NEXT:GG=0:GOSUB920:GOTO220
920 Z=0:FORI=1TO8:FORJ=81TO88:IFB(J+Z)=1ANDX$="Y"THENP=195:VV=VV+1
930 IFB(J+Z)=1ANDX$="N"THENP=243:VV=VV+1
940 IFB(J+Z)=2ANDX$="Y"THENP=243:UU=UU+1
950 IFB(J+Z)=2ANDX$="N"THENP=195:UU=UU+1
960 IFB(J+Z)=4ANDZ$="N"THENP=243:UU=UU+1
970 IFB(J+Z)=-4ANDZ$="N"THENP=195:VV=VV+1
980 IFB(J+Z)=0THENP=163
990 PRINT@W(J+Z),CHR$(P);:NEXT:Z=Z-10:NEXT
1000 IFX$="Y"ORZ$="N"THENPRINT@408,CHR$(243);:PRINT@413,CHR$(195);
1010 IFX$="N"THENPRINT@408,CHR$(195);:PRINT@413,CHR$(243);
1020 PRINT@471,UU;:PRINT@476,VV;
1030 UU=0:VV=0
1040 IFX=1ANDX1=1THEN1060
1050 RETURN
1060 M=0:N=0:FORK=11TO88:IFB(K)=1THENM=M+1
1070 IFB(K)=2THENN=N+1
1080 NEXT:IFN>N THENA$="COMPUTER WINS":PRINT@448,A$;
1090 IFM=N THENA$="IT IS A TIE":PRINT@448,A$;
1100 IFM<N THENA$="YOU WIN":PRINT@448,A$;
1110 FORK=1TO3000:NEXT
1130 PRINT@480,CHR$(128);:INPUT"PLAY AGAIN (Y/N)";A$:IFLEFT$(A$,1)="Y"THENRUN30
1131 IFLEFT$(A$,1)="N"THEN1140
1132 GOTO1130
1140 END
1150 FORR=1TOV:B(H(R))=2:NEXT:B(S1)=0:RETURN
1160 N=N1:D=1
1170 D=D*2:IFD<N THEN1170
1180 D=INT((D-1)/2)
1190 IFD=0THENA=G(1):RETURN
1200 IT=N-D:FORI=1TOIT:J=I
1210 L=J+D
1220 IFB3(L)>B3(J)THENT=B3(J):T1=G(J):B3(J)=B3(L):G(J)=G(L):B3(L)=T:G(L)=T1:J=J-D:IFJ>0THEN1210
1230 NEXT:GOTO1180
1240 SS=RND(4):IFSS=1THENA=35:B(45)=1:GOTO900
1250 IFSS=2THENA=46:B(45)=1:GOTO900
1260 IFSS=3THENA=53:B(54)=1:GOTO900
1270 IFSS=4THENA=64:B(54)=1:GOTO900
1280 A$="":B$="":C$="":D$="":FORK=11TO18:A$=A$+MID$(STR$(B(K)),2):B$=B$+MID$(STR$(B(K+70)),2):NEXT
1350 FORK=11TO81STEP10:C$=C$+MID$(STR$(K)),2):D$=D$+MID$(STR$(K+7)),2):NEXT
1420 IFB(11)=1THENE(12)=20:E(21)=20:E(22)=20
1430 IFB(189=1THENE(17)=20:E(27)=20:E(28)=20
1440 IFB(81)=1THENE(71))=20:E(72)=20:E(82)=20
1450 IFB(88)=1THENE(77)=20:E(78)=20:E(87)=20
1460 IFA$="00111100"ORA$="01111100"ORA$="00112200"ORA$="00122200"ORA$="00111200"THENE(17)=24
1470 IFA$="00111100"ORA$="00111110"ORA$="00221100"ORA$="00222100"ORA$="00211100"THENE(12)=24
1480 IFB$="00111100"ORB$="01111100"ORB$="00112200"ORB$="00122200"ORB$="00111200"THENE(87)=24
1490 IFB$="00111100"ORB$="00111110"ORB$="00221100"ORB$="00222100"ORB$="00211100"THENE(82)=24
1500 IFC$="00111100"ORC$="01111100"ORC$="00112200"ORC$="00122200"ORC$="00111200"THENE(71)=24
1510 IFC$="00111100"ORC$="00111110"ORC$="00221100"ORC$="00222100"ORC$="00211100"THENE(21)=24
1520 IFD$="00111100"ORD$="01111100"ORD$="00112200"ORD$="00122200"ORD$="00111200"THENE(78)=24
1530 IFD$="00111100"ORD$="00111110"ORD$="00221100"ORD$="00222100"ORD$="00211100"THENE(28)=24
1540 IFA$="20111110"THENE(12)=-64
1550 IFA$="01111102"THENE(17)=-64
1560 IFB$="20111110"THENE(82)=-64
1570 IFB$="01111102"THENE(87)=-64
1580 IFC$="20111110"THENE(21)=-64
1590 IFC$="01111102"THENE(71)=-64
1600 IFD$="20111110"THENE(28)=-64
1610 IFD$="01111102"THENE(78)=-64
1620 IFA$="02220100"THENE(15)=-32
1630 IFA$="00102220"THENE(14)=-32
1640 IFB$="02220100"THENE(85)=-32
1650 IFB$="00102220"THENE(84)=-32
1660 IFC$="02220100"THENE(51)=-32
1670 IFC$="00102220"THENE(41)=-32
1680 IFD$="02220100"THENE(58)=-32
1690 IFD$="00102220"THENE(48)=-32
1700 IFLEFT$(A$,4)="0102"THENE(13)=-32:GOTO1710
1701 IFRIGHT$(A$,4)="2010"THENE(16)=-32
1710 IFLEFT$(B$,4)="0102"THENE(83)=-32:GOTO1720
1711 IFRIGHT$(B$,4)="2010"THENE(86)=-32
1720 IFLEFT$(C$,4)="0102"THENE(31)=-32:GOTO1730
1721 IFRIGHT$(C$,4)="2010"THENE(61)=-32
1730 IFLEFT$(D$,4)="0102"THENE(38)=-32:GOTO1740
1731 IFRIGHT$(D$,4)="2010"THENE(68)=-32
1740 IFA$="00002100"THENE(14)=24:GOTO1750
1741 IFA$="00120000"THENE(15)=24
1750 IFB$="00002100"THENE(84)=24:GOTO1760
1751 IFB$="00120000"THENE(85)=24
1760 IFC$="00002100"THENE(41)=24:GOTO1770
1761 IFC$="00120000"THENE(51)=24
1770 IFD$="00002100"THENE(48)=24:GOTO1780
1771 IFD$="00120000"THENE(58)=24
1780 IFA$="00001110"THENE(14)=24:GOTO1790
1781 IFA$="01110000"THENE(15)=24
1790 IFB$="00001110"THENE(84)=24:GOTO1800
1791 IFB$="01110000"THENE(85)=24
1800 IFC$="00001110"THENE(41)=24:GOTO1810
1801 IFC$="01110000"THENE(51)=24
1810 IFD$="00001110"THENE(48)=24:GOTO1820
1811 IFD$="01110000"THENE(58)=24
1820 IFA$="00210000"ORA$="00221000"ORA$="00211000"ORA$="01111200"THENE(17)=24
1830 IFA$="00001200"ORA$="00012200"ORA$="00011200"ORA$="01111200"THENE(17)=24
1840 IFB$="00210000"ORB$="00221000"ORB$="00211000"ORB$="00211110"THENE(82)=24
1850 IFB$="00001200"ORB$="00012200"ORB$="00011200"ORB$="01111200"THENE(87)=24
1860 IFC$="00210000"ORC$="00221000"ORC$="00211000"ORC$="00211110"THENE(21)=24
1870 IFC$="00001200"ORC$="00012200"ORC$="00011200"ORC$="01111200"THENE(71)=24
1880 IFD$="00210000"ORD$="00221000"ORD$="00211000"ORD$="02111100"THENE(28)=24
1890 IFD$="00001200"ORD$="00012200"ORD$="00011200"ORD$="01111200"THENE(78)=24
1900 IFA$="00022200"ORA$="00222200"THENE(17)=-32:GOTO1910
1901 IFA$="00222000"ORA$="00222200"THENE(12)=-32
1910 IFB$="00022200"ORB$="00222200"THENE(87)=-32:GOTO1920
1911 IFB$="00222000"ORB$="00222200"THENE(82)=-32
1920 IFC$="00022200"ORC$="00222200"THENE(71)=-32:GOTO1930
1921 IFC$="00222000"ORC$="00222200"THENE(21)=-32
1930 IFD$="00022200"ORD$="00222200"THENE(78)=-32:GOTO1940
1931 IFD$="00222000"ORD$="00222200"THENE(28)=-32
1940 IFA$="00200200"THENE(14)=-2:E(15)=-2
1950 IFB$="00200200"THENE(84)=-2:E(85)=-2
1960 IFC$="00200200"THENE(41)=-2:E(51)=-2
1970 IFD$="00200200"THENE(48)=-2:E(58)=-2
1980 IFA$="01110000"THENE(16)=-32:GOTO1990
1981 IFA$="00001110"THENE(13)=-32
1990 IFB$="01110000"THENE(86)=-32:GOTO2000
1991 IFB$="00001110"THENE(83)=-32
2000 IFC$="01110000"THENE(61)=-32:GOTO2010
2001 IFC$="00001110"THENE(31)=-32
2010 IFD$="01110000"THENE(68)=-32:GOTO2020
2011 IFD$="00001110"THENE(38)=-32
2020 IFA$="01110200"THENE(15)=-32:GOTO2030
2021 IFA$="01111020"ORA$="00111020"THENE(16)=-32:GOTO2030
2022 IFA$="00201110"THENE(14)=-32:GOTO2030
2023 IFA$="02011110"ORA$="02011100"THENE(13)=-32
2030 IFB$="01110200"THENE(85)=-32:GOTO2040
2031 IFB$="01111020"ORB$="00111020"THENE(86)=-32:GOTO2040
2032 IFB$="00201110"THENE(84)=-32:GOTO2040
2033 IFB$="02011110"ORB$="02011100"THENE(83)=-32
2040 IFC$="01110200"THENE(51)=-32:GOTO2050
2041 IFC$="01111020"ORC$="00111020"THENE(61)=-32:GOTO2050
2042 IFC$="00201110"THENE(41)=-32:GOTO2050
2043 IFC$="02011110"ORC$="02011100"THENE(31)=-32
2050 IFD$="01110200"THENE(58)=-32:GOTO2060
2051 IFD$="01111020"ORD$="00111020"THENE(68)=-32:GOTO2060
2052 IFD$="00201110"THENE(48)=-32:GOTO2060
2053 IFD$="02011110"ORD$="02011100"THENE(38)=-32
2060 IFA$="02222200"THENE(17)=-96
2070 IFA$="00222220"THENE(12)=-96
2080 IFB$="02222200"THENE(87)=-96
2090 IFB$="00222220"THENE(82)=-96
2100 IFC$="02222200"THENE(71)=-96
2110 IFC$="00222220"THENE(21)=-96
2120 IFD$="02222200"THENE(78)=-96
2130 IFD$="00222220"THENE(28)=-96
2140 IFLL<3THEN2390
2150 IFA$="00222220"ANDB(31)<>0THENE(22)=24
2160 IFA$="20222220"THENE(12)=34
2170 IFA$="02222200"ANDB(38)<>0THENE(27)=24
2180 IFA$="02222202"THENE(17)=34
2190 IFB$="00222220"ANDB(61)<>0THENE(72)=24
2200 IFB$="20222220"THENE(82)=34
2210 IFB$="02222200"ANDB(68)<>0THENE(77)=24
2220 IFB$="02222202"THENE(87)=34
2230 IFC$="00222220"ANDB(13)<>0THENE(22)=24
2240 IFC$="20222220"THENE(21)=34
2250 IFC$="02222200"ANDB(83)<>0THENE(72)=24
2260 IFC$="02222202"THENE(71)=34
2270 IFD$="00222220"ANDB(16)<>0THENE(27)=24
2280 IFD$="20222220"THENE(28)=34
2290 IFD$="02222200"ANDB(86)<>0THENE(77)=24
2300 IFD$="02222202"THENE(78)=34
2310 IFA$="00111110"ORC$="00111110"THENE(11)=-96
2320 IFA$="01111100"ORD$="00111110"THENE(18)=-96
2330 IFB$="00111110"ORC$="01111100"THENE(81)=-96
2340 IFB$="01111100"ORD$="01111100"THENE(88)=-96
2350 IFA$="01111110"THENE(11)=64:E(18)=64
2360 IFB$="01111110"THENE(81)=64:E(88)=64
2370 IFC$="01111110"THENE(11)=64:E(81)=64
2380 IFD$="01111110"THENE(18)=64:E(88)=64
2390 GOTO610
2400 PRINT@448,"LEVEL (1/4)";:INPUTLL:PRINT@125,LL;:PRINT@448,"";:FORJK=1TO32:PRINTCHR$(128);:NEXT:RETURN
2490 N=0:FORJ=1TO8:K=A+C(J)
2500 IFB(K)<>-U THEN2550
2510 K=K+C(J):IFB(K)=-U THEN2510
2520 IFB(K)<>U THEN2550
2530 K=K-C(J):IFK=A THEN2550
2540 N=N+1:B(K)=U:GOTO2530
2541 GOTO2540
2550 NEXT:X=0:GOTO540
