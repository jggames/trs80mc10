0 CLS0:DIM C$(3),H$(3),X(160),Y(160),P,Q,T,C,MC,WD(2):GOSUB1000
20 GOSUB100
25 GOSUB120:GOSUB130:GOSUB560:GOSUB120:GOSUB150:GOSUB560:GOSUB120:GOSUB160:GOSUB560:GOTO25
90 FORT=1TON:SET(X(T),Y(T),1):RESET(X(T),Y(T)):NEXT:RETURN
100 X=0:Y=12:GOSUB500:X=27:Y=12:GOSUB500:RETURN
120 X=RND(23)-1:P=(X+4)*2-1:Y=0:Q=4:GOSUB550:GOSUB700:RETURN
130 C=2:N=0
135 P=P+C:ON1-(P+C>0ANDP+C<64)GOTO137:ON1-(POINT(P,Q)<>-1)GOTO138:N=N+1:X(N)=P:Y(N)=Q:SET(P,Q,2):Q=Q+1:C=RND(3)-2
136 ONABS(C)GOTO135:C=SGN(O):GOTO135
137 GOSUB200
138 GOSUB90:GOTO199
150 N=0:A=0
151 FORC=0TO6STEP3:ON1-(P+C>0ANDP+C<64)GOTO155:ON1-(POINT(P+C,Q)=0)GOTO156:N=N+1:X(N)=P+C:Y(N)=Q:SET(P+C,Q,3):NEXT:ONAGOTO158
152 P=P+O:Q=Q+1:GOTO151
155 GOSUB200:C=7:NEXT:GOTO158
156 A=1:ON1-(POINT(P+C,Q)<>-1)GOTO158:N=N+1:X(N)=P+C:Y(N)=Q:SET(P+C,Q,3):NEXT:GOTO158
158 GOSUB90:GOTO199
160 N=0:A=0
161 FORC=0TO6STEP2:ON1-(P+C>0ANDP+C<64)GOTO165:ON1-(POINT(P+C,Q)=0)GOTO166:N=N+1:X(N)=P+C:Y(N)=Q:SET(P+C,Q,5):NEXT:ONAGOTO168
162 P=P+O+RND(3)*(RND(0)-.5):Q=Q+1:GOTO161
165 GOSUB200:C=7:NEXT:GOTO168
166 A=1:ON1-(POINT(P+C,Q)<>-1)GOTO168:N=N+1:X(N)=P+C:Y(N)=Q:SET(P+C,Q,5):NEXT:GOTO168
168 GOSUB90:GOTO199
199 ON1-(INKEY$<>"")GOTO199:RETURN
200 PRINT@0,"out€of€bounds";:SOUND20,15:PRINT@0,"€€€€€€€€€€€€€";:GOSUB550:RETURN
500 FORT=1TO3:PRINT@32*Y+X,H$(T);:Y=Y+1:NEXT:RETURN
550 PRINT@32*Y+X,C$(1);:PRINT@32*Y+X+32,C$(2);:RETURN
560 PRINT@32*Y+X,C$(0);:PRINT@32*Y+X+32,C$(0);:RETURN
700 W=RND(100):D=RND(2):WD=WD(D):O=((W*.64)/26)*WD:PRINT@480,"                               ";:PRINT@492,W;WD$(D);
710 POKEMC+511,96:FORT=MC+480TOMC+511:POKET,PEEK(T)-64:NEXT:RETURN
1000 MC=16384:WD(1)=1:WD(2)=-1:WD$(1)="->":WD$(2)="<-"
1100 C$(0)="€€€€€€€€€€€":C$(1)="Ó×ßÛ×ÓßßÛÒ€":C$(2)="ÔÝßßßßßßßÞÐ"
1130 H$(1)="€ƒƒƒ€"
1140 H$(2)="‡‹"
1150 H$(3)="…‡€‹Š"
1999 RETURN
