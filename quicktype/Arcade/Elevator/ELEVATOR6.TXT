0 CLS:DIMA(31),B(31),C(31),K(255),T,A,E,F,D,X,Y,I,J,S,R,K,P,G,H,M,N,L,Z,U:M=16384:GOTO1000
1 D=2:ONK(PEEK(P-3+M))GOTO30,50,90,80:P=P-3:GOTO30
2 D=.:ONK(PEEK(P+3+M))GOTO30,50,93,80:P=P+3:GOTO30
3 IFDTHEND=3:GOTO30
4 D=1:GOTO30
5 RETURN
6 I=I+J*2:J=.:D=1:GOTO48
7 RESET(X,13):X=T:GOSUB44:RETURN
8 X=T:RETURN
9 I=I+J*2:J=.:RETURN

20 PRINT@507,"MEN";:POKEM+511,117-N:FORN=.TO5STEP.:PRINT@.,;:FORA=F+1TOF-1STEP-1
21 ?L$A$F$(B(A))A$R$L$B$(A(A))G$(B(A))B$(C(A))R$L$C$(A(A))H$(B(A))C$(C(A))R$L$D$(A(A))I$(B(A))D$(C(A))R$L$F$J$(B(A))F$R$;
25 NEXT:PRINT@P,M$(D);:PRINT@P+32,N$(D);:PRINT@P+64,O$(D);:K=PEEK(2)ANDPEEK(17023):ONK(K)GOTO1,2,70,3,87
30 IFGTHEN?@G,M$(H);:?@G+32,N$(H);:?@G+64,O$(H);:IFJ=.THENIFRND(Q)=1THENJ=SGN(P-G):H=5+J:J=J*2:I=L+J*2:GOTO40
31 IFRND(5)=1THENT=2-RND(3):IFABS(E+T-F)<3THENIFE+T>1ANDE+T<30THENE=E+T:B(E+1)=1:B(E)=2:B(E-1)=.:PRINT@480,"ELV"E" YOU"F;
34 IFJTHENFORI=ITOI+J*2STEPJ:ONPOINT(I,13)GOSUB5,6,5,5,9:RESET(I,13):NEXT
36 NEXT:GOTO200

40 IFH=5THENONRND(3)GOSUB42,43,44
41 NEXT:GOTO200
42 H=4:D=1:GOSUB47:GOTO48
43 H=6:D=1:GOSUB47:GOTO48
44 D=.:H=5:?@G,M$(H);:?@G+32,N$(H);:?@G+64,O$(H);:SOUND1,2:Z=Z+1:IFZ=3THENG=.
45 RETURN
47 PRINT@P,M$(D);:PRINT@P+32,N$(D);:PRINT@P+64,O$(D);:RETURN
48 N=N+1:POKEM+511,117-N:SOUND1,4:RETURN

50 P=207:J=.
51 PRINT@.,;:FORA=F+1TOF-1STEP-1
52 ?L$A$F$(B(A))A$R$L$B$(A(A))G$(B(A))B$(C(A))R$L$C$(A(A))H$(B(A))C$(C(A))R$L$D$(A(A))I$(B(A))D$(C(A))R$L$F$J$(B(A))F$R$;
53 NEXT:PRINT@P,M$(D);:PRINT@P+32,N$(D);:PRINT@P+64,O$(D);
54 K=PEEK(2)ANDPEEK(17023):ONK(K)GOTO64,65,60,55:GOTO51

55 IFF=2ANDU-S=0THENGOSUB1080
56 IFF>2THENF=F-1:E=E-1:B(E+1)=1:B(E)=2:B(E-1)=.:PRINT@480,"ELV"E" YOU"F" ";:SOUND200,1
57 GOSUB99:GOTO51
60 IFF<29THENF=F+1:E=E+1:B(E+1)=1:B(E)=2:B(E-1)=.:PRINT@480,"ELV"E" YOU"F" ";:SOUND200,1
61 GOSUB99:GOTO51
64 P=P-4:D=2:NEXTN
65 P=P+4:D=0:NEXTN

66 IFK(PEEK(J(C1+V)-32+M))<>1THENP=J(C1+V)-32:GOSUB75:GOSUB47:P=P+32:IFK(PEEK(J(C1+V+V)+M))<>1THENP=J(C1+V+V):GOSUB75:GOSUB47
67 GOSUB75:IFGTHEN?@G,M$(H);:?@G+32,N$(H);:?@G+64,O$(H);
68 T=J(C1+V):ONK(PEEK(P+M+1))GOTO30,50,91,86:GOTO30

70 IFD=1THEND=.:GOSUB47:GOTO30
71 IFD=3THEND=.:GOSUB47:GOTO30
72 IFD=.THENV=1:GOSUB78:GOTO66
73 V=-1:GOSUB78:GOTO66
75 A=F:PRINT@160,;
76 ?L$A$F$(B(A))A$R$L$B$(A(A))G$(B(A))B$(C(A))R$L$C$(A(A))H$(B(A))C$(C(A))R$L$D$(A(A))I$(B(A))D$(C(A))R$L$F$J$(B(A))F$R$;
77 RETURN
78 FORT=1TO7:IFP=J(T)THENC1=T
79 NEXT:RETURN

80 T=P:D=.:FORP=207TO416STEP64:PRINT@.,;:FORA=F+1TOF-1STEP-1
81 ?L$A$F$(B(A))A$R$L$B$(A(A))G$(B(A))B$(C(A))R$L$C$(A(A))H$(B(A))C$(C(A))R$L$D$(A(A))I$(B(A))D$(C(A))R$L$F$J$(B(A))F$R$;
82 NEXT:PRINT@P,M$(D);:PRINT@P+32,N$(D);:PRINT@P+64,O$(D);:SOUNDP/2,1:D=D+1:NEXT
83 IFE=F-1THENPRINT@P,"ììì";:D=.:P=P-96:GOSUB47:F=E:PRINT@480,"ELV"E" YOU"F;:GOTO50
84 GOSUB48:P=T:D=.:GOTO30
86 P=T:GOTO80

87 IFGTHENPRINT@G,M$(H);:PRINT@G+32,N$(H);:PRINT@G+64,O$(H);
88 Y=(D=2)-(D=.):IFY=.THEN30
89 X=((P/32)-INT(P/32))*64+2+Y*3:T=-(Y=-1)+63*-(Y=1):FORX=XTOTSTEPY*2:ONPOINT(X,13)GOSUB5,5,5,5,8,5,5,7:RESET(X,13):NEXT:GOTO30

90 P=P-3
91 IFP>207THENC(F)=C(F)+2:GOSUB75:C(F)=1:GOTO97
92 A(F)=A(F)+2:GOSUB75:A(F)=1:GOTO97

93 P=P+3
94 IFP>207THENC(F)=C(F)+2:GOSUB75:C(F)=1:GOTO97
96 A(F)=A(F)+2:GOSUB75:A(F)=1:GOTO97

97 S=S+1:SC=SC+1:SOUND100,1:SOUND200,1:PRINT@496,"SC"SC;
98 GOTO30

99 G=.:RETURN:IFRND(0)=1THENRETURN
100 IFRND(2)=1THENT=RND(2):G=211+T*3:I=34+T*6:L=I:H=6:GOTO110
101 T=RND(2):G=194+T*3:I=6+T*6:L=I:H=4:GOTO110
110 J=.:Z=.:IFPEEK(G+M+1)=159THEN100
111 RETURN

200 PRINT@480,"YOU'RE DEAD!  PLAY AGAIN (Y/N)?";:POKEM+511,96
210 M$=INKEY$:IFM$=""THEN210
220 IFM$="Y"THENRUN
230 IFM$="N"THENEND
240 GOTO210

249 REM NEXT LEVEL
250 Z=0:Q=Q-1:IFQ<9THENQ=9

1000 L$="€€€€Ï":R$="Ï€€€":F$="ÏÏÏÏÏÏÏÏÏ"
1010 A$="ßßßßßßßßß"
1011 B$(1)="ß¯¯¯ß¯¯¯ß":B$(2)="ß¿¿¿ß¯¯¯ß":B$(3)="ß¯¯¯ß¿¿¿ß":B$(4)="ßÐÐÐß¯¯¯ß":B$(5)="ß¯¯¯ßÐÐÐß"
1012 C$(1)="ß®¯¯ß®¯¯ß":C$(2)="ß¾¿¿ß®¯¯ß":C$(3)="ß®¯¯ß¾¿¿ß":C$(4)="ßÐÐÐß®¯¯ß":C$(5)="ß®¯¯ßÐÐÐß"
1013 D$(1)="ß¯¯¯ß¯¯¯ß":D$(2)="ß¿¿¿ß¯¯¯ß":D$(3)="ß¯¯¯ß¿¿¿ß":D$(4)="ßÐÐÐß¯¯¯ß":D$(5)="ß¯¯¯ßÐÐÐß"
1014 B$(6)="ßÐÐÐroofß":B$(7)="ßÐÐÐexitß"
1015 C$(6)="ßÐÐÏßßßßß":C$(7)="ßÐÐÐßßßßß"
1016 D$(6)="ßÐÏÏßßßßß":D$(7)="ßÐÐÐßßßßß"

1020 F$(0)="ÐÐÐÐÐ":F$(1)="ÐåÐêÐ":F$(2)="ïßßßï"
1021 G$(0)="ÐÐÐÐÐ":G$(1)="ÐåÐêÐ":G$(2)="ïßïßï"
1022 H$(0)="ÐÐÐÐÐ":H$(1)="ÐåÐêÐ":H$(2)="ïßßßï"
1023 I$(0)="ÐÐÐÐÐ":I$(1)="ÐåÐêÐ":I$(2)="ïßßßï"
1024 J$(0)="ÐÐÐÐÐ":J$(1)="ÐåÐêÐ":J$(2)="ììììì"

1030 M$(0)="ßŸß":M$(1)=""
1031 N$(0)="ßÔÑ":N$(1)="ßßß"
1032 O$(0)="ÞÖß":O$(1)="ØÒ"

1033 M$(2)="ßŸß":M$(3)=""
1034 N$(2)="ÒØß":N$(3)="ßßß"
1035 O$(2)="ßÙÝ":O$(3)="žÑÔ"

1040 M$(6)="ßÿß":M$(5)=""
1041 N$(6)="ßÔÑ":N$(5)="ßßß"
1042 O$(6)="ÞÖß":O$(5)="ØÒý"

1043 M$(4)="ßÿß":M$(7)=""
1044 N$(4)="ÒØß":N$(7)="ßßß"
1045 O$(4)="ßÙÝ":O$(7)="þÑÔ"

1050 Q=15:Z=0

1060 DIMJ(8):J(0)=194:J(1)=197:J(2)=200:J(3)=203:J(4)=207:J(5)=211:J(6)=214:J(7)=217:J(8)=220

1070 K(65)=1:K(83)=2:K(87)=3:K(90)=4:K(32)=5
1071 K(128)=1:K(207)=1:K(239)=2:K(191)=3:K(208)=4:K(229)=4:K(234)=4
1073 GOSUB1080:GOTO20

1080 U=.:FORT=2TO29:E=RND(3):A(T)=E:IFE>1THENU=U+1
1081 E=RND(3):C(T)=E:IFE>1THENU=U+1
1082 B(T)=.:NEXT
1083 A(30)=6:C(30)=6:A(1)=7:C(1)=7
1084 F=29:E=29:B(E+1)=1:B(E)=2:B(E-1)=0:P=200:D=.:S=0:Z=0:Q=Q-1:IFQ<10THENQ=10
1087 GOSUB99
1090 RETURN
