0 DIMK(255),A(7),O(7),D(7),T,P,M,A,B,C,D,E,F,K,J,X,Y,Z,R:M=16384:GOTO2000
1 RETURN
2 D=-1:K=K(PEEK(P-1)):ONKGOTO3,50,50,50,24,50,50,50,50,1,1:STOP
3 POKEP,B:P=P-1:POKEP,Y:SOUND40,1:B=143:POKEP,X:RETURN
5 POKEP,B:P=P-32+D:POKEP,X:B=143:GOSUB18:RETURN
6 POKEP,B:P=P+32+D:POKEP,X:B=143:GOSUB18:RETURN
7 POKEA(A),O(A):A(A)=A(A)+D(A):O(A)=C:POKEA(A),65:RETURN
8 D=1:K=K(PEEK(P+1)):ONKGOTO9,51,51,51,29,51,51,51,51,1,1:STOP
9 POKEP,B:P=P+1:POKEP,Y:SOUND40,1:B=143:POKEP,X:RETURN
10 POKET,94:SOUND220,1:POKET,F:NEXT:RETURN
11 ONK(PEEK(A(A)+D(A)+32))GOTO13,7,37,7,7,7,7,7,7,7,7:STOP
12 POKEP,F:P=P+32:POKEP,X:GOTO21
13 D(A)=D(A)*-1:RETURN
14 ON1-(P>31)GOTO1:FORT=P-32TOMSTEP-32:ONK(PEEK(T))GOTO10:SOUND200,1:POKET,F:ON1-(PEEK(T-1)<>191)GOTO15:POKET-1,F
15 ON1-(PEEK(T+1)<>191)GOTO1:POKET+1,F:RETURN
18 ONK(PEEK(A(A)+32))GOTO28:C=PEEK(A(A)+D(A)):ONK(C)GOTO11,13,39,11,11,11,11,11,11,13,13:STOP
20 FORZ=1TOE:ONK(PEEK(2)ANDPEEK(17023))GOSUB25,2,14,8,55,57,58,59,61,33,54:A=RND(J):GOSUB18
21 ONK(PEEK(P+32))GOTO12:NEXT:ONZ-EGOTO32,31,42:STOP
22 FORT=1TO2:ON1-(P-32>M)GOTO30:K=K(PEEK(P-32+D)):ONKGOSUB5,1,1,52,45,52,52,52,52,1,1:NEXT
23 FORT=1TO2:K=K(PEEK(P+32+D)):ONKGOSUB6,1,1,53,46,53,53,53,53,1,1:NEXT:RETURN
24 POKEP,B:P=P-1:POKEP,Y:SOUND40,1:B=95:POKEP,X:RETURN
25 ON1-(P-32>M)GOTO30:ON1-(PEEK(P-32)=95)GOTO27,26:RETURN
26 POKEP,B:P=P-32:B=95:POKEP,88:RETURN
27 ON1-(B=95)GOTO22:K=K(PEEK(P-32)):ONKGOTO47,1,47,47,47,47,47,47,47,1,1:RETURN
28 POKEA(A),F:A(A)=A(A)+32:POKEA(A),65:GOTO18
29 POKEP,B:P=P+1:POKEP,Y:SOUND40,1:B=95:POKEP,X:RETURN
30 Z=E+1:POKEP,F:X=143:Y=143:RETURN
31 CLS:LV=LV+1:PRINT@269,"LEVEL";LV:FORZ=1TO4000:NEXT:CLS1:GOTO100
32 PRINT@32*6+1," YOU TOOK TOO LONG. THEY WERE ";:PRINT@32*7+1," ABLE TO RELEASE TOXIC GAS... ";
33 PRINT@32*8+1," YOU HAD TO RETREAT A LEVEL! ";
34 FORZ=1TO5000:NEXT:CLS1:LV=LV-1:IFLV<1THENLV=1
35 GOTO100
37 ON1-(PEEK(A(A)+D(A)+32)=32)GOTO38,7
38 POKEA(A),F:A(A)=A(A)+D(A):POKEA(A),65:SOUND1,2:POKEA(A),F:A(A)=A(A)+32:POKEA(A),65:GOTO40
39 POKEA(A),F:A(A)=A(A)+D(A):POKEA(A),65
40 FORZ=1TO10:POKEP,X:SOUND1,1:POKEP,F:SOUND2,1:POKEP,65:SOUND3,1:NEXT:Z=E+2:LF=LF-1:X=143:Y=143:RETURN
41 POKEP,B:P=P+32:B=143:POKEP,88:ONKGOSUB1,1,1,69,1,62,64,66,68,1,1:RETURN
42 IFLF=0THEN80
43 X=88:Y=89:P=OS:B=PEEK(P):POKEP,X:GOSUB310:GOTO20
44 POKEP,B:P=P+32:B=95:POKEP,88:RETURN
45 POKEP,B:P=P-32+D:POKEP,X:B=95:GOSUB18:RETURN
46 POKEP,B:P=P+32+D:POKEP,X:B=95:GOSUB18:RETURN
47 POKEP,B:P=P-32:B=143:POKEP,88:ONKGOSUB1,1,1,69,1,62,64,66,68,1,1:RETURN
50 GOSUB3:ONKGOSUB1,40,1,69,1,62,64,66,68,1,1:RETURN
51 GOSUB9:ONKGOSUB1,40,1,69,1,62,64,66,68,1,1:RETURN
52 GOSUB5:ONKGOSUB1,1,1,69,1,62,64,66,68,1,1:RETURN
53 GOSUB6:ONKGOSUB1,1,1,69,1,62,64,66,68,1,1:RETURN
54 D=0:SOUND15,1:RETURN
55 ON1-(O>0)GOTO1:O=O-1:B=95:GOSUB71:FORT=P-32TOEP STEP-32:ONK(PEEK(T))GOTO56:T=M:NEXT:GOSUB300:RETURN
56 POKET,95:NEXT:GOSUB300:RETURN
57 K=K(PEEK(P+32)):ONKGOTO1,1,1,41,44,41,41,41,41,1,1:RETURN
58 D=-1:SOUND15,1:RETURN
59 D=1:SOUND15,1:RETURN
60 C2=(PEEK(17024)AND1)*256+PEEK(17025):PRINTN;:N$=STR$(N):R=LEN(N$):FORC1=M+C2TOM+C2+R:POKEC1,PEEK(C1)-64:NEXT:RETURN
61 ON1-(DR>0)GOTO1:ON1-(PEEK(P+32)=175)GOTO1:POKEP+32,143:DR=DR-1:GOSUB320:RETURN
62 ON1-(O<9)GOTO1:SOUND120,1:O=O+1:GOSUB300:RETURN
64 ON1-(LF<3)GOTO1:SOUND140,1:LF=LF+1:GOSUB310:RETURN
66 ON1-(DR<9)GOTO1:SOUND160,1:DR=DR+1:GOSUB320:RETURN
68 SOUND1,5:SOUND100,5:SC=SC+(100*DL):GOSUB70:PL=1:RETURN
69 SOUND1,1:SOUND100,1:SC=SC+(10*DL):GOSUB70:RETURN
70 N=SC:PRINT@486,"";:GOSUB60:RETURN
71 EP=P-96:ON1-(EP>M)GOSUB72:RETURN
72 EP=M:RETURN
80 PRINT@493,"PLAY AGAIN? (Y/N) ";:POKEM+511,96:FORT=M+493TOM+511:POKET,PEEK(T)-64:NEXT
81 I$=INKEY$:IFI$=""THEN81
82 IFI$="Y"THEN85
83 IFI$="N"THENEND
84 GOTO81
85 IFSC>HSTHENHS=SC
86 GOSUB5020:PRINT@267-32,"LAST:";SC:PRINT@267+32,"HIGH:";HS:PRINT@480,"";:GOTO4099
90 O=1:DR=2:LF=3:P=M+16:LV=1:PL=0:SC=0:F=143
100 OS=P+448:IFOS>M+479THENOS=M+448+16
105 P=OS:IFLV=10THEN150
110 GOSUB200:GOTO20
150 CLS6:FORT=1TO25:C1=RND(11):C2=RND(6):R=RND(384):PRINT@R,LEFT$(C$,C1);:PRINT@R,MID$(C$,C2,5);
160 NEXT:GOSUB330:SC=SC+(1000*DL):GOSUB70:POKEP,X:PRINT@263,"YOU ESCAPED ALIVE!";
170 IFPL>0THENPRINT@196,"YOU SAVED THE EARTH AND";:GOSUB5100
175 PRINT@32*1+4,S1$;:PRINT@32*2+4,S2$;:PRINT@32*3+4,S2$;:PRINT@32*4+4,S1$;
180 GOTO80
200 CLS1:X=88:Y=89:FORT=1TO20:R=RND(459):L=(5+RND(18-LV))-DL
210 PRINT@R,LEFT$(L$,L);:NEXT:FORT=0TO14:R=RND(25):PRINT@T*32+R,LEFT$(L$,5+RND(5));:NEXT
220 FORT=1TO14:PRINT@T*32-1,CHR$(191);CHR$(191);:NEXT:POKEM+479,191:POKEM,191:GOSUB330
240 FORT=1TOJ
250 R=RND(448)+M:ON1-(PEEK(R)=143ANDPEEK(R+32)=175)GOTO250:A(T)=R:D(T)=1:O(T)=106:POKER,65:NEXT
255 IFLV=3ORLV=7THENR=RND(448):ON1-(PEEK(M+R)=143ANDPEEK(M+R+32)=175)GOTO255:PRINT@R,"@";
260 FORT=1TO4
270 R=RND(448):ON1-(PEEK(M+R)=143ANDPEEK(M+R+32)=175)GOTO270:PRINT@R,"*";:NEXT
271 ONRND(3)GOTO272,273,274
272 R=RND(448):ON1-(PEEK(M+R)=143ANDPEEK(M+R+32)=175)GOTO272:PRINT@R,CHR$(127);:GOTO275
273 R=RND(448):ON1-(PEEK(M+R)=143ANDPEEK(M+R+32)=175)GOTO273:POKEM+R,43:GOTO275
274 R=RND(448):ON1-(PEEK(M+R)=143ANDPEEK(M+R+32)=175)GOTO274:PRINT@R,"V";
275 FORT=1TO3+LV+DL
276 R=RND(448):ON1-(PEEK(M+R)=175)GOTO276:PRINT@R,CHR$(191);:NEXT
280 B=143:POKEP,X
290 GOSUB70:GOSUB300:GOSUB310:GOSUB320:RETURN
300 N=O:PRINT@508,"";:GOSUB60:RETURN
310 N=LF:PRINT@498,"";:GOSUB60:RETURN
320 N=DR:PRINT@503,"";:GOSUB60:RETURN
330 PRINT@480,"SCORE:          X:   D:   G:   ";:FORC1=M+480TOM+511:POKEC1,PEEK(C1)-64:NEXT:POKEM+511,32:RETURN
2000 CLS
2010 PRINT"               * RARE ELEMENT"
2020 PRINT"               @ SECRET PLANS"
2030 PRINT"                 FOR D-DEVICE"
2040 PRINT"               "CHR$(127)" LADDER GUN"
2050 PRINT"               "CHR$(95)" SPIKE LADDER"
2060 PRINT"               + FIRST AID KIT":POKEM+175,43
2070 PRINT"               V DRILL"
2080 PRINT:FORT=0TO7:PRINT@T*32,"";:FORP=1TO14:READZ:PRINTCHR$(Z);:NEXT:NEXT:PRINT
2110 PRINT"YOU HAVE BEEN IMPRISONED AT THE"
2120 PRINT"BOTTOM OF A MINE BY AN INVADING"
2130 PRINT"ALIEN RACE.  THEY ARE MINING A"
2140 PRINT"RARE ELEMENT NEEDED FOR THEIR"
2150 PRINT"DOOMSDAY DEVICE. YOU HAVE NOW"
2160 PRINT"OVERWHELMED YOUR CAPTORS. GET"
2170 PRINT"TO THE SURFACE AND WARN EARTH!"
2180 FORT=1TO63:K(T)=10:NEXT
3000 K(87)=1:K(65)=2:K(32)=3:K(83)=4:K(71)=5:K(90)=6:K(8)=7:K(9)=8:K(68)=9:K(82)=10:K(94)=11
3005 K(143)=1:K(191)=10:K(175)=11:K(88)=3:K(106)=4:K(95)=5:K(31)=6:K(43)=7:K(86)=8:K(64)=9
3006 K(46)=8:K(44)=7:K(76)=11:K(81)=7:K(69)=8
3010 FORT=1TO31:L$=L$+CHR$(175):NEXT:B$=CHR$(143):X=88:Y=89
3020 S1$=CHR$(223)+CHR$(159)+CHR$(159)+CHR$(223):S2$=CHR$(159)+CHR$(159)+CHR$(159)+CHR$(159)
3030 C$=CHR$(223)+CHR$(223)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(223)+CHR$(223)
3040 PRINT"      HIT ANY KEY TO BEGIN";
3050 ON1-(INKEY$="")GOTO4020,3050
4020 GOSUB5020
4030 PRINT"A=MOVE LEFT       ,=FACE LEFT"
4040 PRINT"S=MOVE RIGHT      .=FACE RIGHT"
4045 PRINT"W=JUMP OR CLIMB   L=FACE UP"
4050 PRINT"Z=CLIMB DOWN      R=RESIGN"
4060 PRINT"G=FIRE SPIKE GUN  D=DRILL DOWN"
4080 PRINT:PRINT"RARE ELEMENT =  10 * DIFFICULTY"
4085 PRINT"SECRET PLANS = 100 * DIFFICULTY"
4090 PRINT:PRINT"ALIENS ('A') CAN GET YOU FROM"
4095 PRINT"ABOVE, BUT YOU CAN WALK ON TOP"
4096 PRINT"OF THEM. THERE ARE 9 LEVELS TO":PRINT"CLIMB TO GET TO THE SURFACE."
4099 GOSUB5200:GOTO90
5020 CLS:PRINTTAB(10)"tunnel jumper"
5030 PRINTTAB(7)"for cococoding 2013":FORT=M+54TOM+57:POKET,PEEK(T)-64:NEXT:RETURN
5100 SOUND28,2:SOUND79.5,2:SOUND147,2:SOUND147,8:SOUND79.5,2:SOUND147,2:SOUND133,2:SOUND133,8:SOUND159,8
5110 SOUND133,8:SOUND89,8:SOUND28,8:RETURN
5200 PRINT@480,"  WHICH LEVEL (1 EASY-3 HARD)?";
5210 I$=INKEY$:IFI$=""THEN5210
5220 DL=VAL(I$):IFDL<1ORDL>3THEN5200
5230 E=1000+((3-DL)*100):J=4+DL:RETURN
5300 DATA143,143,143,143,143,191,191,191,191,191,191,143,143,143
5310 DATA143,143,143,191,191,191,191,191,191,191,191,191,191,143
5320 DATA143,143,191,191,191,191,191,191,191,191,191,191,191,191
5330 DATA143,143,191,191,191,143,143,191,191,143,143,191,191,191
5340 DATA143,143,191,191,191,191,191,191,191,191,191,191,191,191
5350 DATA143,143,143,143,143,191,191,143,143,191,191,143,143,143
5360 DATA143,143,143,143,191,191,143,143,143,143,191,191,143,143
5370 DATA143,143,191,191,143,143,143,191,191,143,143,143,191,191
