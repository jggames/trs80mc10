CLOSEOUT



READY.

100 REM VIC-20 CLOSEOUT

110 DIM EX%(2),EY%(2),EC%(2),EP%(2),PC%(2),DX%(2),DY%(2),SV%(21)

120 S1=36874:S3=S1+3:V=36878:POKES1,0:POKEV,0:S2=S1+1

130 R=0:PTS=0:SH=1:O=0:CD$=CHR$(19):FORI=1TO23:CD$=CD$+CHR$(17):NEXT

140 PRINTCHR$(147)CHR$(18)CHR$(156)"  CLOSEOUT"

150 R=R+1:PRINTCHR$(19)TAB(12)CHR$(30)"ROUND"R

160 SH=SH+2:GOSUB900

170 SC=36879:Q=22:M=O

180 TX=4*(PEEK(36866)AND128)+64*(PEEK(36869)AND120)

190 COLOUR=37888+4*(PEEK(36866)AND128)

200 FORI=44TO65:POKETX+I,104:POKECO+I,6:NEXT

210 FORI=88TO400STEP44

220 FORJ=ITOI+21

230 POKETX+J,104:POKECO+J,6

240 POKETX+J-Q,46:POKECO+J-Q,6*RND(O)+2

250 NEXT:NEXT

260 FORI=66TO378STEPQ:POKETX+I,64:POKECO+I,O:POKETX+21+I,64:POKECO+21+I,O:

NEXT

270 FORI=1TO10

280 SX=INT(7*RND(O))*3+3:SY=5+INT(6*RND(O))*2

290 LN=2+INT(3*RND(O))*2:IF SY+LN>18 THEN 290

300 FORJ=SY*QTO(SY+LN)*QSTEPQ

310 POKETX+SX+J,64:POKECO+SX+J,O

320 NEXT:NEXT

330 EX%(O)=1:EX%(1)=2:EX%(2)=3:FORI=OTO2:EY%(I)=3:NEXT

340 EC%(O)=65:EC%(1)=88:EC%(2)=81

350 DX%(O)=1:DX%(1)=1:DX%(2)=-1

360 FORI=OTO2:EP%(I)=46:PC%(I)=INT(6*RND(O)+2):NEXT

370 PX=2:PY=17:PC=94:DX=O:DY=O:PK=32

380 GETA$:IFA$<>""THENB$=A$

390 IFB$=" "THENGOSUB800

400 IFB$="I"THENDY=-1:DX=O

410 IFB$="M"THENDY=1:DX=O

420 IFB$="J"THENDX=-1:DY=O

430 IFB$="K"THENDX=1:DY=O

440 CP=TX+PX+Q*PY

450 IFPK<>64ORPEEK(CP+Q*DY)=104THENDY=O

460 IFPEEK(CP+DX)=104THENDX=O:B$=""

470 POKE CP,PK:POKECO+CP-TX,CC

480 PX=PX+DX:PY=PY+DY

490 IFPX<0THENPX=O:B$="":DX=O

500 IFPX>21THENPX=21:B$="":DX=O

510 NP=TX+PX+Q*PY:CC=PEEK(CO+NP-TX)

520 PK=PEEK(NP):IFPK<>46ANDPK<>42THEN560

530 PTS=PTS+1:IFPK=42THENPTS=PTS+49

540 GOSUB980:PK=32:FORI=15TO0STEP-5:POKES3,255-I:POKEV,I:NEXT:POKES3,0

550 M=M+1:IFM=120THEN140

560 IFPK=EC%(O)ORPK=EC%(1)ORPK=EC%(2)THEN730

570 POKENP,PC:POKECO+PX+Q*PY,2

580 E=-(E+1)*(E<2)

590 EX=EX%(E):EY=EY%(E):EC=EC%(E):XX=DX%(E):YY=DY%(E):EP=EP%(E):C=PC%(E)

600 POKETX+EX+Q*EY,EP:POKECO+EX+Q*EY,C

610 CP=TX+EX+Q*EY

620 IF(PEEK(CP-Q)=64ORPEEK(CP+Q)=64)ANDRND(1)>.1THENXX=0:YY=SGN(PY-EY)

630 IFPEEK(CP+YY*Q)=104OR(EY=PYANDEY/2<>INT(EY/2))THENYY=O:XX=SGN(PX-EX)

640 EX=EX+XX:EY=EY+YY

650 IFEX=OOREX=21THENXX=-XX

660 NP=TX+EX+Q*EY:EP=PEEK(NP):C=PEEK(CO+NP-TX)

670 IFEP=PCTHENPOKENP,161:GOTO730

675 IFEP<>EC%(O)ANDEP<>EC%(1)ANDEP<>EC%(2)THEN700

680 FORI=OTO2:IFEP<>EC%(I)THENNEXT:STOP

690 EP=EP%(I):C=PC%(I)

700 POKENP,EC:POKECO+NP-TX,3+E

710 EX%(E)=EX:EY%(E)=EY:EP%(E)=EP:PC%(E)=C:DX%(E)=XX:DY%(E)=YY

720 GOTO380

730 FORI=128TO255STEP2:POKESC,I:POKES3,I:POKEV,(I-128)/8:NEXT

740 POKESC,27:PRINTCHR$(19)CHR$(18)CHR$(156)"  NABBED! "

750 PRINTLEFT$(CD$,23);CHR$(31);"PRESS "CHR$(18);

760 PRINTCHR$(156)"SPACE"CHR$(146)CHR$(31)" TO REPLAY";

770 FORI=1TO10:GETA$:NEXT

780 GETA$:IFA$<>" "THEN780

790 RUN

800 REM SHOVE!

810 IFDX=0THENPOKESC,31:POKES2,200:POKEV,10:FORW=1TO100:NEXT:POKESC,27:POK

ES2,0:RETURN

820 IFSH=0THENPOKESC,28:POKES2,255:POKEV,10:FORW=1T0100:NEXT:POKESC=27:POK

ES2,0:RETURN

830 CP=TX+Q*PY:LC=64:B$=""

840 FORI=PXTO-21*(DX>0)STEPDX

850 SV%(I)=PEEK(CP+I):POKECP+I,LC:LC=131-LC:POKES1,LC:POKEV,(IAND15)

860 IFSV%(I)=EC%(O)ORSV%(I)=EC%(1)ORSV%(I)=EC%(2)THENGOSUB920

870 NEXTI:POKES1,0:POKEV,0

880 FORI=PXTO-21*(DX>0)STEPDX

890 POKECP+I,SV%(I):NEXT:SH=SH-1

900 PRINTCHR$(156);LEFT$(CD$,23);TAB(10)"SHOVES ="SH;

910 RETURN

920 FORJ=OTO2:IFSV%(I)<>EC%(J)THENNEXT:STOP

930 SV%(I)=EP%(J):POKECO+CP+I-TX,PC%(J)

940 EX%(J)=INT(20*RND(O)+1):EY%(J)=3

950 DX%(J)=-1:IFRND(O)>.5THENDX%(J)=1

960 DY%(J)=O:EP%(J)=46

970 PTS=PTS+50:FORJ=0TO15:POKES3,128+J:POKEV,15-J:NEXT:POKES3,0:POKEV,0

980 PRINTCHR$(159)LEFT$(CD$,21)"      SCORE:"PTS;

990 RETURN


READY.

