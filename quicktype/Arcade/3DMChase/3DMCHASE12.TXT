0 REM01234567890123456789012345678901234567890123456
1 CLS:GOSUB10000
2 DATA60,54,55,150,246,129,126,38,25,220,247,195,1,5,131,1,1,221,252,206,67,113,236,1
3 DATA221,246,236,3,221,248,236,5,221,250,51,50,56,57,240,129,58,37,1,57,126
10 M=16384:GOTO200
50 DATA".... .... .... .... .... .... .... .... .... .... .... .... .... .... .... ...."
60 DATA".... WN.. .NS. .NS. .N.. .NS. .NS. .NS. .N.. .NS. .NS. .NS. .NS. .NS. .N.E ...."
70 DATA".... W..E .... .... W..E .... .... .... W..E .... .... .... .... .... W..E ...."
80 DATA".... W..E .... WN.. ..S. .NS. .NS. .NS. ...E .... WN.. .NS. .NS. .NS. ...E ...."
90 DATA".... W..E .... W..E .... .... .... .... W..E .... W..E .... .... .... W..E ...."
100 DATA".... W... .NS. .... .NS. .NS. .NS. .NS. ...E .... W... .NS. .NS. .NS. ...E ...."
110 DATA".... W..E .... W..E .... .... .... .... W..E .... W..E .... .... .... W..E ...."
120 DATA".... W... .NS. ..S. .N.. .NS. .NS. .NS. ...E .... W..E .... WN.. .NS. ...E ...."
130 DATA".... W..E .... .... W..E .... .... .... W..E .... W.S. .NS. ...E .... W..E ...."
140 DATA".... W..E .... WN.. ..S. .N.E .... WN.. ..S. .N.E .... .... W..E .... W..E ...."
150 DATA".... W..E .... W..E .... W..E .... W..E .... W.S. .N.E .... W..E .... W..E ...."
160 DATA".... W..E .... W..E .... W..E .... W..E .... .... W..E .... W..E .... W..E ...."
170 DATA".... W.S. .NS. ..S. .NS. ..S. .NS. ..S. .NS. .NS. ..S. .NS. ..S. .NS. ..SE ...."
180 DATA".... .... .... .... .... .... .... .... .... .... .... .... .... .... .... ...."
190 DATA""
200 CLS0:DIMM(16,14),A(2,2),X,Y,A,B,C,D,V,M$,B$,L,H,G,C(16,16),D$(3),W$(6),O,Q
240 W$(5)="ßßßßßßßßßßßßßßßß":W$(6)="ïïïïïïïïïïïïïïïï"
245 D$(0)="NORTH":D$(1)="EAST ":D$(2)="SOUTH":D$(3)="WEST ":B$="€€€€€€€€€€€€€€€€"
250 X=0:Y=0:D=0:XS=0:YS=0:WA=0:A=0:B=0
260 PRINT"SETTING UP MAP";
270 READL$:IFLEN(L$)=0THEN410
300 K=0:FORI=1TOLEN(L$):M$=MID$(L$,I,1)
330 IFM$="N"THENK=KOR8:GOTO380
340 IFM$="E"THENK=KOR4:GOTO380
350 IFM$="S"THENK=KOR2:GOTO380
360 IFM$="W"THENK=KOR1:GOTO380
370 IFM$=" "THENM(X,Y)=K:C(X,Y)=(K=0):PRINT@16+(Y+1)*32+X,CHR$(143-(K=0));:K=0:X=X+1
380 IFX>=XSTHENXS=X
390 NEXT:M(X,Y)=K:X=0:Y=Y+1:GOTO270
410 YS=Y:XS=XS+1:PRINT@16+6*32+3,"B";:C(3,5)=-1:PRINT@17,"SCORE"SC;
415 FORI=1TO10
420 X=RND(14):Y=RND(12):IFC(X,Y)THEN420
421 C(X,Y)=1:NEXT
440 X=1:Y=1
450 GOSUB700:GOSUB2000:GOTO450
700 ?@0,B$;:?@32,B$B$B$;:?@96,B$;:?@128,B$;:?@160,B$;:?@192,B$;:?@224,B$;:?@256,B$;
702 ?@288,B$;:?@320,B$;:?@352,B$;:?@384,B$;:?@416,B$;:?@448,B$B$B$;:A=X:B=Y:H=D+X+YAND1
800 FORI=0TO2:GOSUB2440:A(1,I)=0:IFA>=0ANDB>=0ANDA<XSANDB<YSTHENA(1,I)=M(A,B):A(.,I)=Q:A(2,I)=O:GOSUB2550:NEXT
840 L=A(1,2):GOSUB2330:IFFTHENV=5-(H=1):M$=LEFT$(W$(V),6):FORA=165TO293STEP32:PRINT@A,M$;:NEXT
930 V=6+(H=1):M$=LEFT$(W$(V),5):FORG=0TO2STEP2:L=A(G,2):GOSUB2330:IFFTHENA=G*5.5:FORB=A+160TOA+288STEP32:PRINT@B,M$;:NEXT
1020 NEXT:L=A(1,2):GOSUB2330:IFQTHENC=V*16+143:FORA=M+164TOM+292STEP32:POKEA,C:NEXT:POKEM+132,V*16+139:POKEM+324,V*16+142
1100 IFOTHENC=V*16+143:FORA=M+171TOM+299STEP32:POKEA,C:NEXT:POKEM+139,V*16+135:POKEM+331,V*16+141
1160 L=A(1,1):GOSUB2330:C=V*16+143:IFFTHENM$=LEFT$(W$(V),8):FORA=132TO324STEP32:PRINT@A,M$;:NEXT
1250 V=5-(H=1):M$=LEFT$(W$(V),4):FORG=0TO2STEP2:L=A(G,1):GOSUB2330:IFFTHENA=G*6:FORB=4TO10:PRINT@A+B*32,M$;:NEXT
1350 NEXT:V=5-(H=1):L=A(1,1):GOSUB2330:IFQ=0THEN1470
1400 IFV=6THEN1405
1401 PRINT@33,"Û";:PRINT@65,"ßÛ";:PRINT@97,"ßßÛ";:PRINT@129,"ßßß";:PRINT@161,"ßßß";:PRINT@193,"ßßß";:PRINT@225,"ßßß";
1402 PRINT@257,"ßßß";:PRINT@289,"ßßß";:PRINT@321,"ßßß";:PRINT@353,"ßßÞ";:PRINT@385,"ßÞ";:PRINT@417,"Þ";:GOTO1470
1405 PRINT@33,"ë€€";:PRINT@65,"ïë€";:PRINT@97,"ïïë";:PRINT@129,"ïïï";:PRINT@161,"ïïï";:PRINT@193,"ïïï";:PRINT@225,"ïïï";
1406 PRINT@257,"ïïï";:PRINT@289,"ïïï";:PRINT@321,"ïïï";:PRINT@353,"ïïî";:PRINT@385,"ïî";:PRINT@417,"î";
1470 IFO=.THEN1560
1480 IFV=6THEN1485
1481 PRINT@46,"×";:PRINT@77,"×ß";:PRINT@108,"×ßß";:PRINT@140,"ßßß";:PRINT@172,"ßßß";:PRINT@204,"ßßß";:PRINT@236,"ßßß";
1482 PRINT@268,"ßßß";:PRINT@300,"ßßß";:PRINT@332,"ßßß";:PRINT@364,"Ýßß";:PRINT@397,"Ýß";:PRINT@430,"Ý";:GOTO1560
1485 PRINT@46,"ç";:PRINT@77,"çï";:PRINT@108,"çïï";:PRINT@140,"ïïï";:PRINT@172,"ïïï";:PRINT@204,"ïïï";:PRINT@236,"ïïï";
1486 PRINT@268,"ïïï";:PRINT@300,"ïïï";:PRINT@332,"ïïï";:PRINT@364,"íïï";:PRINT@397,"íï";:PRINT@430,"í";
1560 L=A(1,.):GOSUB2330:IFFTHENM$=LEFT$(W$(V),14):FORA=33TO417STEP32:PRINT@A,M$;:NEXT
1630 V=6+(H=1):C=V*16+143:FORG=0TO2STEP2:L=A(G,.):GOSUB2330:IFFTHENA=G*7.5:FORB=M+A+32TOM+A+416STEP32:POKEB,C:NEXT
1700 NEXT:L=A(1,.):GOSUB2330:IFQTHENPOKEM,V*16+139:POKEM+448,V*16+142:C=V*16+143:FORB=M+32TOM+416STEP32:POKEB,C:NEXT
1790 IFOTHENPOKEM+15,V*16+135:POKEM+463,V*16+141:C=V*16+143:FORA=M+47TOM+431STEP32:POKEA,C:NEXT:RETURN
1800 RETURN
1860 PRINT@389,"‘““’";:PRINT@421,"•CCš";:PRINT@453,"•žžž’";
1890 PRINT@486,"œ””˜";:SOUND200,1:SOUND225,2:SOUND175,2:SOUND100,1:C(X,Y)=2:SC=SC+1:PRINT@17,"SCORE"SC;
1900 PRINT@389,"ÁÃÃÂ";:PRINT@421,"ÅMCÊ";:PRINT@453,"ÅÎÎÎÂ";:PRINT@486,"ÌÄÄÈ";:RETURN
2000 PRINT@16+32*(Y+1)+X,"*";:PRINT@497,"FACING "D$(D);:IFC(X,Y)>0THENSOUND50,1:ONC(X,Y)GOSUB1860,1900
2005 KK=PEEK(2)ANDPEEK(17023):IFKK=0THEN2005
2010 PRINT@16+32*(Y+1)+X,".";:IFKK=87THENDM=1:GOTO2170
2015 IFKK=90THENDM=-1:GOTO2170
2020 IFKK=65THEND=(D-1)AND3:RETURN
2030 IFKK=83THEND=(D+1)AND3:RETURN
2040 IFKK=81THEN1860
2050 GOTO2000
2070 ONDGOTO2080,2090,2100:Y=Y-DM:GOTO2110
2080 X=X+DM:GOTO2110
2090 Y=Y+DM:GOTO2110
2100 X=X-DM:GOTO2110
2110 WA=0:IFY>=YSTHENY=0
2130 IFY<0THENY=YS-1
2140 IFX>=XSTHENX=0
2150 IFX<0THENX=XS-1
2160 RETURN
2170 K=M(X,Y):IFDM=-1THEN2270
2200 ONDGOTO2210,2220,2230:IFKAND8THEN2250
2201 GOTO2070
2210 IFKAND4THEN2250
2211 GOTO2070
2220 IFKAND2THEN2250
2221 GOTO2070
2230 IFKAND1THEN2250
2231 GOTO2070
2250 WA=1:RETURN
2270 ONDGOTO2280,2290,2300:IFKAND2THEN2250
2271 GOTO2070
2280 IFKAND1THEN2250
2281 GOTO2070
2290 IFKAND8THEN2250
2291 GOTO2070
2300 IFKAND4THEN2250
2301 GOTO2070
2330 N=0:IFLAND8THENN=1
2360 E=0:IFLAND4THENE=1
2370 S=0:IFLAND2THENS=1
2380 W=0:IFLAND1THENW=1
2390 ONDGOTO2400,2410,2420:F=N:O=E:Q=W:RETURN
2400 F=E:O=S:Q=N:RETURN
2410 F=S:O=W:Q=E:RETURN
2420 F=W:O=N:Q=S:RETURN
2440 ONDGOTO2460,2470,2480:LY=B:RY=B:LX=A-1:RX=A+1:GOTO2490
2460 LX=A:RX=A:LY=B-1:RY=B+1:GOTO2490
2470 LY=B:RY=B:LX=A+1:RX=A-1:GOTO2490
2480 LX=A:RX=A:LY=B+1:RY=B-1:GOTO2490
2490 Q=0:O=0:IFLX<0ORLX>=XSORLY<0ORLY>=YSTHEN2520
2510 Q=M(LX,LY)
2520 IFRX<0ORRX>=XSORRY<0ORRY>=YSTHENRETURN
2530 O=M(RX,RY):RETURN
2550 ONDGOTO2570,2580,2590:B=B-1:RETURN
2570 A=A+1:RETURN
2580 B=B+1:RETURN
2590 A=A-1:RETURN
10000 FORA=0TO44:READB:POKE17227+A,B:NEXT:EXEC17227:RETURN
