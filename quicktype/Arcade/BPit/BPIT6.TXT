0 CLS:CLEAR1000:DIMRI(4),AD(4),GP(8),LR(8),X,V,U,Q,A,B,I,Z,FP,GP,GF,BN,HL,PK,C,E,A$,C(124),P$(10):GOTO300
1 A=0:B=0:IFPEEK(2)AND4ANDNOTPEEK(16952)THENB=30:RETURN
2 IFPEEK(2)AND4ANDNOTPEEK(16948)THENB=29:RETURN
3 IFPEEK(2)AND1ANDNOTPEEK(16946)THENA=27:RETURN
4 IFPEEK(2)AND1ANDNOTPEEK(16949)THENA=23:RETURN
5 IFPEEK(2)AND8ANDNOTPEEK(16952)THENA=15:RETURN
6 RETURN
100 SOUNDHL,1:RETURN
300 FORI=1TO124:READC(I):NEXT:FORI=1TO4:READAD(I),RI(I):NEXT
400 X=16384:BA=12:E=32
410 P$(1)="10000 ANDREAS   ":P$(2)="09000 ERIK      "
411 P$(3)="08000 ACHIM     ":P$(4)="07000 ANTJE     "
412 P$(5)="06000 THOMAS    ":P$(6)="05000 KARL-HEINZ"
413 P$(7)="04000 USE: wasd ":P$(8)="03000 space AND "
414 P$(9)="02000 q KEYS    "
500 CLS0
510 GOSUB20000
520 EF=0:LB=5:BL=1:PK=0:GF=0
530 GOSUB5000
532 GP=0:BN=5000
533 PRINT@60,"x:";:POKEX+62,LB+112
535 GOSUB2500
537 GOSUB2100
540 GOSUB2000
560 GOSUB1000
570 GOTO2200
572 IFEF=1THEN3000
580 BN=BN-10:GOSUB2400:IFBN<1THENBN=0:GOTO3000
600 IFGP=ZTHEN4000
610 IFGF=1THENGOSUB2600
620 GOTO560
1000 FORU=449TO97STEP-E:FORV=UTOU+29:Q=X+V:C=PEEK(Q):IFC=ETHEN1020
1002 IFC<>96THEN1120
1003 IFPEEK(Q-E)<>15THEN1007
1004 POKEQ-E,E
1005 IFPEEK(Q+E)<>ETHEN1120
1006 POKEQ+E,42:Z=Z+1:GOTO1120
1007 IFPEEK(Q-E)<>42THEN1120
1008 POKEQ-E,E
1015 Z=Z-1:IFPEEK(Q+E)=ETHENPOKEQ+E,15
1016 GOTO1120
1020 C=PEEK(Q-E):IFC=15ORC=42THEN1030
1021 GOTO1040
1030 POKEQ,PEEK(Q-E):POKEQ-E,E:GOTO1120
1040 C=PEEK(Q-33):IFC=15ORC=42THEN1050
1041 GOTO1080
1050 C=PEEK(Q-1):IFC=EORC=24ORC=96THEN1080
1060 IFPEEK(Q-E)=ETHEN1065
1061 GOTO1120
1065 IFPEEK(Q-1)=191THEN1120
1070 POKEQ,PEEK(Q-33):POKEQ-33,E:GOTO1120
1080 C=PEEK(Q-31):IFC=15ORC=42THEN1090
1081 GOTO1120
1090 C=PEEK(Q+1):IFC=EORC=24ORC=96THEN1120
1100 IFPEEK(Q-E)=ETHEN1105
1101 GOTO1120
1105 IFPEEK(Q+1)=191THEN1120
1110 POKEQ,PEEK(Q-31):POKEQ-31,E
1120 NEXTV:NEXTU:RETURN
2000 Z=0:FORI=97TO449STEPE:FORJ=ITOI+29:IFPEEK(X+J)=42THENZ=Z+1
2010 NEXT:NEXT:RETURN
2100 FP=449:POKEX+FP,24:RETURN
2200 GOSUB1:FORI=1TO4
2205 IF(A=15ORB=15)ANDSP>0THEN2300
2207 IFPEEK(2)AND4ANDNOTPEEK(16946)THEN3000
2210 IFA=RI(I)ORB=RI(I)THEN2220
2211 NEXT:GOTO572
2220 Q=PEEK(X+FP+AD(I)):IFQ=159ORQ=15ORQ=96THEN572
2225 IFQ=38THENEF=1:GOTO572
2230 IFQ=42THENGP=GP+1:PK=PK+5:GOTO2235
2231 GOTO2240
2235 HL=18:GOSUB100:GOSUB100
2240 POKEX+FP+AD(I),24:POKEX+FP,E:FP=FP+AD(I):GOTO572
2300 FORI=64TO16STEP-16:HL=I:GOSUB100:GOSUB100:NEXT
2304 FORI=1TO4:IFPEEK(X+FP+AD(I))=159THEN2310
2305 POKEX+FP+AD(I),E
2310 NEXT:SP=SP-1:GOTO572
2400 A$=MID$(STR$(PK),2):A$="00000"+A$:PK$=RIGHT$(A$,6)
2416 FORI=1TO5:A$=MID$(PK$,I,1):B=ASC(A$):POKEX+34+I,B+64:NEXT
2420 A$=MID$(STR$(BN),2):A$="000"+A$:BN$=RIGHT$(A$,4)
2435 FORI=1TO4:A$=MID$(BN$,I,1):B=ASC(A$):POKEX+44+I,B+64:NEXT
2440 A$=MID$(STR$(SP),2):A$="0"+A$:SP$=RIGHT$(A$,2)
2475 FORI=1TO2:A$=MID$(SP$,I,1):B=ASC(A$):POKEX+53+I,B+64:NEXT:RETURN
2500 PRINT@33,"s:000000";:PRINT@43,"t:0000";:PRINT@52,"d:00";
2510 POKEX,159:RETURN
2600 FORI=1TOGA:J=RND(4):IFJ=LR(I)THEN2690
2610 Q=PEEK(X+GP(I)+AD(J)):IFQ<>ETHEN2630
2620 POKEX+GP(I)+AD(J),38:POKEX+GP(I),E:GP(I)=GP(I)+AD(J):LR(I)=J:GOTO2690
2630 IFQ=24THEN3000
2690 NEXTI:RETURN
3000 FORI=1TO100STEP10:HL=I:GOSUB100:NEXT:FORI=100TO1STEP-10
3007 HL=I:GOSUB100:NEXT:LB=LB-1:IFLB=-1THEN500
3010 EF=0:POKEX+62,LB+112:GOTO530
4000 FORI=200TO10STEP-10:HL=I:GOSUB100:NEXT:FORI=10TO200STEP10
4010 HL=I:GOSUB100:NEXT
4020 BL=BL+1:PK=PK+INT(BN/2):GOSUB2400:IFBL>BATHEN500
4030 GOTO530
5000 CLS:FORI=0TO95:POKEX+I,159:NEXT:FORI=96TO448STEP32
5010 POKEX+I,159:POKEX+I+31,159:NEXT:FORI=480TO511:POKEX+I,159
5025 NEXT:ONBLGOTO5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,6100,6200
5100 FORI=257TO260:POKEX+I,159:NEXT:FORI=262TO268:POKEX+I,159
5110 NEXT:FORI=270TO276:POKEX+I,159:NEXT:FORI=278TO284
5120 POKEX+I,159:NEXT:POKE286+X,159:FORI=105TO233STEP32
5130 POKEX+I,159:NEXT:FORI=113TO241STEP32:POKEX+I,159:NEXT
5140 FORI=123TO251STEP32:POKEX+I,159:NEXT:FORI=97TO254
5150 IFRND(2)=1THENQ=15:GOTO5160
5151 Q=42
5160 IFPEEK(X+I)=32THENPOKEX+I,Q
5170 SP=10:NEXT:FORI=321TO449STEP32:FORJ=ITOI+29:POKEX+J,191
5180 NEXT:NEXT:RETURN
5200 FORI=257TO270:POKEX+I,159:NEXT:FORI=273TO286:POKEX+I,159
5210 NEXT:FORI=97TO225STEP32:FORJ=ITOI+29
5215 IFRND(2)=1THENQ=15:GOTO5220
5216 Q=42
5220 POKEX+J,Q:NEXT:NEXT:FORI=289TO449STEP32:FORJ=ITOI+29
5230 POKEX+J,191:NEXT:NEXT:SP=20:RETURN
5300 FORI=161TO189STEP2:POKEX+I,159:NEXT:FORI=257TO270
5310 POKEX+I,159:NEXT:FORI=273TO286:POKEX+I,159:NEXT
5320 Q=-1:FORI=335TO428STEP31:Q=Q+2:FORJ=ITOI+Q:POKEX+J,159
5330 NEXT:NEXT:FORI=97TO225STEP32:FORJ=ITOI+29
5340 IFRND(2)=1THENQ=15:GOTO5345
5341 Q=42
5345 IFPEEK(X+J)=159THEN5350
5346 POKEX+J,Q
5350 NEXT:NEXT:FORI=289TO478:IFPEEK(X+I)=159THEN5370
5360 POKEX+I,191
5370 NEXT:SP=20:RETURN
5400 FORI=225TO257STEP32:FORJ=ITOI+29:POKEX+J,191:NEXT:NEXT
5405 FORI=97TO193STEP32
5410 FORJ=ITOI+29:IFRND(2)=1THENQ=15:GOTO5420
5411 Q=42
5420 POKEX+J,Q:NEXT:NEXT:FORI=290TO354STEP32:POKEX+I,159
5430 POKEX+I+8,159:POKEX+I+10,159:POKEX+I+17,159:POKEX+I+19,159
5440 POKEX+I+27,159:NEXT:FORI=387TO453STEP33:POKEX+I,159
5450 POKEX+I+10,159:POKEX+I+19,159:NEXT:FORI=393TO455STEP31
5460 POKEX+I,159:POKEX+I+9,159:POKEX+I+19,159:NEXT
5470 POKEX+454,159:POKEX+473,159:SP=10:RETURN
5500 FORI=97TO449STEP32:FORJ=ITOI+29:POKEX+J,191:NEXT:NEXT
5505 FORI=130TO133:FORJ=0TO3:Q=X+I+J*32:POKEQ,32:POKEQ+9,32
5510 POKEQ+15,32:POKEQ+24,32:POKEQ+192,32:POKEQ+201,32
5515 POKEQ+207,32:POKEQ+216,32:NEXT:NEXT:FORI=227TO228
5520 Q=X+I:POKEQ,42:POKEQ+9,42:POKEQ+15,42:POKEQ+24,42
5525 POKEQ+192,42:POKEQ+201,42:POKEQ+207,42:POKEQ+216,42:NEXT
5530 GF=1:GA=8:SP=2
5540 GP(1)=195:GP(2)=204:GP(3)=210:GP(4)=219:GP(5)=387:GP(6)=396
5550 GP(7)=402:GP(8)=411:RETURN
5600 FORI=225TO449STEP32:FORJ=ITOI+29:POKEX+J,191:NEXT:NEXT
5605 FORI=193TO204:POKEX+I,159:NEXT:FORI=211TO222:POKEX+I,159
5610 NEXT:Q=-1:FORI=463TO331STEP-33:Q=Q+2:FORJ=ITOI+Q
5615 POKEX+J,32:NEXT:NEXT:Q=1:FORI=462TO330STEP-33:Q=Q+2
5620 POKEX+I,159:POKEX+I+Q,159:NEXT:FORI=97TO161STEP32
5630 FORJ=ITOI+29:IFRND(2)=1THENQ=15:GOTO5640
5631 Q=42
5640 POKEX+J,Q:NEXT:NEXT:GA=6:SP=17:FORI=1TO6:POKEX+I+204,38
5650 GP(I)=I+204:NEXT:GF=1:RETURN
5700 FORI=289TO449STEP32:FORJ=ITOI+29:POKEX+J,191:NEXT:NEXT
5705 FORI=97TO257STEP32:FORJ=ITOI+29:IFRND(3)=1THENQ=42:GOTO5710
5706 Q=15
5710 POKEX+J,Q:NEXT:NEXT:FORI=355TO387STEP32:FORJ=ITOI+4
5715 POKEX+J,32:POKEX+J+8,32:POKEX+13+J,32:POKEX+J+21,32:NEXT
5720 NEXT:GA=4:SP=15:GF=1:GP(1)=389:GP(2)=397:GP(3)=402
5730 GP(4)=410:RETURN
5800 FORI=161TO190:POKEX+I,191:POKEX+I+64,191:NEXT
5810 FORI=97TO126:POKEX+I,42:NEXT:FORI=129TO158:POKEX+I,15:NEXT
5820 FORI=257TO321STEP32:FORJ=ITOI+29:POKEX+J,15:NEXT:NEXT
5830 FORI=353TO449STEP32:FORJ=ITOI+29:POKEX+J,42:NEXT:NEXT
5840 FORI=2TO16:GP(I/2)=I+198:NEXT:SP=10:GF=1:GA=8:RETURN
5900 FORI=225TO237:POKEX+I,159:POKEX+I+17,159:POKEX+I+96,159
5910 POKEX+I+113,159:NEXT:FORI=111TO239STEP32:FORJ=ITOI+1
5920 POKEX+J,159:POKEX+J+224,159:NEXT:NEXT:FORI=97TO449STEP32
5930 FORJ=ITOI+29:IFPEEK(X+J)=32THEN5940
5931 GOTO5950
5940 IFRND(3)=1THENQ=15:GOTO5945
5941 Q=42
5945 POKEX+J,Q
5950 NEXT:NEXT:GP(1)=238:GP(2)=241:GP(3)=334:GP(4)=337
5960 FORI=1TO4:POKEX+GP(I),38:NEXT:GA=4:GF=1:SP=20:RETURN
6000 FORI=130TO450STEP64:FORJ=ITOI+28STEP2:POKEX+J,159:NEXT
6010 NEXT:FORI=97TO449STEP32:FORJ=ITOI+29:IFPEEK(X+J)=32THEN6020
6015 NEXT:NEXT:GF=0:SP=40:RETURN
6020 IFRND(3)=1THENQ=15:GOTO6030
6021 Q=42
6030 POKEX+J,Q:GOTO6015
6100 FORI=449TO325STEP-31:POKEX+I,159:POKEX+I+19,159
6105 POKEX+I-218,159:POKEX+I-199,159:NEXT:FORI=97TO229STEP33
6110 POKEX+I,159:POKEX+I+19,159:POKEX+I+230,159:POKEX+I+249,159
6120 NEXT:FORI=225TO226:POKEX+I,159:POKEX+I+96,159
6125 POKEX+I+28,159:POKEX+I+124,159:NEXT:FORI=232TO243
6130 POKEX+I,159:POKEX+I+10,159:NEXT:POKEX+228,159:POKEX+324,159
6140 POKEX+251,159:POKEX+347,159:FORI=97TO193:FORJ=ITOI+29
6145 IFPEEK(X+J)<>32THEN6150
6147 IFRND(3)=1THENQ=42:GOTO6149
6148 Q=15
6149 POKEX+J,Q
6150 NEXT:NEXT:FORI=257TO286:POKEX+I,191:POKEX+I+32,191:NEXT
6160 GP(1)=227:GP(2)=230:GP(3)=239:GP(4)=240:GP(5)=249:SP=30
6170 GP(6)=252:GA=6:GF=1:FORI=1TO6:POKEX+GP(I),38:NEXT:RETURN
6200 FORI=225TO449STEP32:FORJ=ITOI+29:POKEX+J,191:NEXT:NEXT
6210 FORI=226TO238:POKEX+I,159:POKEX+I+15,159:NEXT
6220 Q=1:FORI=238TO106STEP-33:Q=Q+2:POKEX+I,159:POKEX+I+Q,159
6230 NEXT:FORI=301TO461STEP32:POKEX+I,159:POKEX+I+5,159:NEXT
6240 FORI=303TO304:POKEX+I,96:NEXT:FORI=97TO193STEP32
6250 FORJ=ITOI+29:IFPEEK(X+J)<>32THEN6270
6260 IFRND(3)=1THENQ=42:GOTO6265
6261 Q=15
6265 POKEX+J,Q
6270 NEXT:NEXT:SP=20:GF=1:GA=2:GP(1)=225:GP(2)=254:FORI=1TO2
6280 POKEX+GP(I),38:NEXT:RETURN
7010 DATA142,140,130,134,140,130,138,32,138,138,32,32,142,140,130
7011 DATA142,140,136,142,140,130,32,32,142,140,130,141,136,140
7012 DATA142,136,139,131,136,138,32,138,138,32,138,138,32,32,138
7013 DATA32,138,139,130,32,139,131,136,32,32,139,131,136,133,32
7014 DATA32,138,32,138,32,138,138,32,138,138,32,138,138,32,32,138
7015 DATA32,138,138,32,32,138,137,32,32,32,138
7016 DATA32,32,133,32,32,138,32
7017 DATA140,140,32,132,140,32,132,140,32,132,140,136,140,140,32
7018 DATA140,140,136,136,32,136,32,32,136,32,32,140,136,32,136,32
7020 DATA-32,30,32,29,-1,27,1,23
9999 END
20000 CLS:FORC=0TO96STEP32:PRINT@C,"€";:NEXT:Q=0:FORI=1TO97STEP32:FORJ=ITOI+30:Q=Q+1
20005 IFC(Q)=32THENC(Q)=128
20010 POKEX+J,C(Q)+16:NEXT:NEXT:POKEX+160,142
20020 FORI=161TO190:POKEX+I,140:NEXT:POKEX+191,141
20030 FORI=192TO480STEP32:POKEX+I,138:POKEX+I+31,133:NEXT
20040 POKEX+480,139:FORI=481TO510:POKEX+I,131:NEXT
20050 POKEX+511,135:POKEX+172,142:FORI=204TO460STEP32
20060 POKEX+I,138:NEXT:POKEX+492,139:POKEX+288,139
20070 FORI=289TO299:POKEX+I,131:NEXT:PRINT@193,"ABCDEFGHIJ";
20080 PRINT@225,"KLMNOPQRST";:PRINT@257,"UVWXYZ. e ";
20090 PRINT@353,"<B>=BEGIN";:PRINT@385,"<Q>=QUIT";
20100 Q=0:FORI=206TO462STEP32:Q=Q+1:PRINT@I,LEFT$(P$(Q)+"                ",16);:NEXT
20105 IFPK>VAL(P$(9))THEN22000
20110 A$="--- BOULDER PIT --- (C) 1985 BY AP-SOFT, BACHGASSE 3"
20120 A$=A$+"0, 6944 HEMSBACH --- PLEASE PRESS THE BUTTON OF "
20130 A$=A$+"YOUR CHOICE ---   "
20140 BP=458:L=1:P=1:HL=50
20150 PRINT@BP,MID$(A$,P,L);:FORC=1TO1000:NEXT
20160 C=INT(RND(2))
20165 HL=HL+1:IFHL=100THENHL=50
20170 GOSUB100:IFPEEK(2)AND1ANDNOTPEEK(16947)THEN21000
20180 IFPEEK(2)AND4ANDNOTPEEK(16946)THENCLS:GOTO9999
20190 IFBP=449THEN20200
20191 BP=BP-1
20200 IFL=10THEN20210
20201 L=L+1:GOTO20150
20210 IFP=LEN(A$)THEN20140
20211 P=P+1
20220 GOTO20150
21000 RETURN
22000 P$(10)=MID$(PK$,2)+"            "
22005 FORI=1TO10:FORJ=2TO10:IFVAL(P$(J-1))>=VAL(P$(J))THEN22020
22010 A$=P$(J-1):P$(J-1)=P$(J):P$(J)=A$
22020 NEXT:NEXT:FORI=1TO9:PRINT@206+(I-1)*32,LEFT$(P$(I)+"                ",16);
22030 IFPK=VAL(P$(I))THENT=I-1
22040 NEXT:PS=193:P=-1
22050 C=PEEK(X+PS):IFC>64THENPOKEX+PS,PEEK(X+PS)-64
22060 FORC=1TO1000:NEXT:GOSUB1:FORI=1TO4
22065 IFA=15ORB=15THEN22100
22070 IFA=RI(I)ORB=RI(I)THEN22080
22071 NEXT:GOTO22060
22080 C=PEEK(X+PS+AD(I)):IF(C<65ORC>90)ANDC<>5THEN22060
22090 C=PEEK(X+PS):POKEX+PS,C+64:IFC=5ANDPS=265THENPOKEX+PS,5
22095 PS=PS+AD(I):GOTO22050
22100 HL=32:GOSUB100:IFPEEK(X+PS)=5ANDPS=265THEN22200
22120 P=P+1:POKEX+212+T*32+P,PEEK(PS+X)+64
22130 IFP=9THEN22200
22131 GOTO22060
22200 P$(T+1)=LEFT$(P$(T+1),6)
22205 POKEX+PS,PEEK(X+PS):FORI=212+T*32TO221+T*32
22210 Q=PEEK(X+I):IFQ>64ANDQ<91THENP$(T+1)=P$(T+1)+CHR$(Q)
22220 IFQ<27THENP$(T+1)=P$(T+1)+CHR$(Q+64)
22230 NEXT:GOTO20110
