0 CLS:DIMC$(1),C4,C3,C5,C1,C2,MC:MC=16384:C1=RND(-(PEEK(9)*256+PEEK(10))):GOSUB5000:GOTO10
1 C3=C1*2+C2*64:C5=C4*2:PRINT@C3,MID$(C$(0),C5,2);:PRINT@C3+32,MID$(C$(1),C5,2);:RETURN
10 DIMR(12),D(12),X(15),Y(15)
56 DATA110,0,1110,0,1010,0,1000,1,101,5,111,0,1110
60 DATA0,1000,4,1,2,1,7,11,6,1000,8
80 FORN=1TO12:READA,B:D(N)=A:R(N)=B:NEXTN
90 TL=30:X=14:Y=6:YR=4:O=0:SN=1:SL=1:PI=1:MT=0:FORT=1TO4:GOSUB95:READA:R(I)=A:NEXTT:GOTO300
95 I=INT(RND(0)*7)+1:IFR(I)=0THENRETURN
96 GOTO95:DATA10,11,14,15
100 PRINT@1,"DOCTOR¸WHO";:PRINT@22,"ADVENTURE";:PRINT@501,"TIME";:RETURN
110 IFAANDY=0THENYR=YR-1:Y=6:GOTO300
120 IFBANDX=15THENYR=YR+4:X=1:GOTO300
130 IFCANDY=7THENYR=YR+1:Y=1:GOTO300
140 IFDANDX=0THENYR=YR-4:X=14:GOTO300
150 GOTO391
160 TL=TL-0.01:PRINT@505,LEFT$(STR$(TL),6);:IFTL=INT(TL)THENTL=TK-.4:IFTL<.01THEN8000
170 RETURN
180 C1=X:C2=Y:C4=1:GOSUB1
190 GOSUB160:XX=-(PEEK(2)AND1ANDNOTPEEK(16946))+(PEEK(2)AND4ANDNOTPEEK(16948))*.25
200 YY=-(PEEK(2)AND4ANDNOTPEEK(16952))*.25+(PEEK(2)AND8ANDNOTPEEK(16947))*.125
210 IFPEEK(MC+(X+XX)*2+(Y+YY)*64)<>128THENXX=0:YY=0
220 C1=X:C2=Y:C4=19:GOSUB1:X=X+XX:Y=Y+YY:RETURN

300 GOSUB4000
320 D=D(YR):R=R(YR)
330 IFD/1000>=1THENA=1:C2=0:C4=19:FORC1=7TO9:GOSUB1:NEXT:D=D-1000
340 IFD/100>=1THENB=1:C1=15:C4=19:FORC2=3TO4:GOSUB1:NEXT:D=D-100
350 IFD/10>=1THENC=1:C2=7:C4=19:FORC1=7TO9:GOSUB1:NEXT:D=D-10
360 IFDTHENC1=0:C4=19:FORC2=3TO4:GOSUB1:NEXT
370 IFRTHENSOUND100,2:PRINT@480,R;(R*200)+300;:REM WEIRD ON GOSUB

380 GOSUB100
390 GOSUB180:GOSUB110
391 IFPEEK(2)ANDPEEK(17023)<>32ORO=0THEN390
499 GOTO390:REM DROP

REM DRAW WALLS
4000 CLS0:C4=18:FORXX=0TO14:C1=XX:C2=0:GOSUB1:C2=7:GOSUB1:NEXT
4010 FORYY=0TO6:C1=0:C2=YY:GOSUB1:C1=15:GOSUB1:NEXT:FORYY=0TO7:C1=0:C2=YY:GOSUB1:NEXT:C1=15:C2=7
4020 C3=C1*2+C2*64:PRINT@C3,MID$(C$(0),C4*2,2);:PRINT@C3+32,MID$(C$(1),C4*2,1);
4030 POKEMC+511,ASC(MID$(C$(1),C4*2+1,1)):RETURN

5000 C$(0)="Ä◊“∑≤∑∫ÄìÄ”ììçÄ¡ÄÄ“∆Àß´˘Ä·‡«∆˜ÚçÄ«¬¸¯ÄÄ":C$(1)="Ä÷“∂≤∑ªûó‹€˛†Öá…»‹ﬁŒÕß´Ä˘ÔÍ∆¬ûöéçŒ Ù¸ÄÄ":RETURN

REM 1 DOCTOR
REM 2 MASTER
REM 3 DALEK
REM 4 KEY
REM 5 SPANNER
REM 6 GUN
REM 7 SNAKE
REM 8 RING
REM 9 LANCE
REM 10 BIG SPOOK
REM 11 CASKET
REM 12 ROPE
REM 13 TIME DEVICE
REM 14 MUMMY
REM 15 PRIEST
REM 16 SPHINX
REM 17 SMALL SPOOK
REM 18 WALL
REM 19 BLANK

REM LARGE TARDIS
5020 C3=C1+32*C2:PRINT@C3,"ÄëÄÄ";:C3=C3+32:PRINT@C3,"•≠≠Ä";:PRINT@C3,"•≠≠Ä";:C3=C3+32:PRINT@C3,"•ØØ†";:C3=C3+32:PRINT@C3,"ßØØ¢";
5030 RETURN
