100 REM DRAW TABLE
110 CLS(5):DIMX,Y,DX,DY,K,J,XB,YB,I$:POKE16925,0:POKE16926,1
120 FORI=0TO14:PRINT@I,"¿";:PRINT@31-I,"¿";:PRINT@I*32,"¿";:PRINT@I*32+31,"¿";:NEXTI
130 PRINT@15,"¿"+"¿";:PRINT@480,"¿";:POKE16895,191
140 FORJ=1TO4
150 J2=(16-J)*32:J3=J2+31
160 FORI=1TO2*(5-J)+1
170 PRINT@J2+I,"¯";:PRINT@J3-I,"¯";
180 NEXTI
190 NEXTJ
200 PRINT@353,"¯";:PRINT@382,"¯";
210 E$="":BL$="ÏÏÏÏÏÏ"
220 PRINT@166,E$;:PRINT@180,E$;:PRINT@207,"ÿÿ";:PRINT@239,"ÿÿ";
230 FORI=0TO9:PRINT@331+I,"ï";:NEXTI
240 FORI=1TO4:PRINT@489+I,"Ã";:PRINT@502-I,"Ã";:NEXTI
250 FORI=0TO128STEP32:PRINT@353+I,"Ï";:NEXTI
260 PRINT@33,"¿";
500 SC=0:NB=3:PRINT@504,"¯¯¯¯¯¯¯";
510 W=1000:PB=1:PA=1
520 GOSUB4000:REM PRINTSCORE
530 RESET(2,31)
540 PRINT@385,"Ï";:PRINT@353,"Ï";:IFNB>0THEN560
550 PRINT@0,"AGAIN?";:I$=INKEY$:IFI$<>"Y"ANDI$<>"N"THEN550
551 IFI$="N"THEN5000
552 PRINT@0,"¿¿¿¿¿¿";:GOTO500
560 J=RND(10):PRINT@0,"HIT SPACE";:PRINT@21,"USE A AND S";:IFINKEY$<>" "THEN560:REM FIRE?
570 PRINT@0,"¿¿¿¿¿¿¿¿¿";:PRINT@21,"¿¿¿¿¿¿¿¿¿¿¿";:NB=NB-1
580 E=-1
590 SOUND100,1
600 PRINT@481,"Ë";
610 FORI=449TO65STEP-32
620 PRINT@I+32,"Ï";:PRINT@I,"Í";:PRINT@I,"Ë";
630 NEXTI
640 PRINT@385,"¯";:PRINT@353,"¯";
650 IFNB>0THENRESET(2,31)
660 KJ=RND(8):GOSUB1000
670 X=3:Y=4
680 SOUND240,1
690 GOSUB2000:IFE>0THEN540
710 I$=INKEY$:GOSUB3000:GOSUB3500:GOTO690
1000 ONKJGOTO1010,1020,1030,1040,1050,1060,1070,1080,1090,1100,1110,1120
1010 K=1:DX=-1:DY=+1:RETURN
1020 K=2:DX=-1:DY=+2:RETURN
1030 K=2:DX=+1:DY=+2:RETURN
1040 K=1:DX=+1:DY=+1:RETURN
1050 K=3:DX=+2:DY=+1:RETURN
1060 K=3:DX=+2:DY=-1:RETURN
1070 K=1:DX=+1:DY=-1:RETURN
1080 K=2:DX=+1:DY=+2:RETURN
1090 K=2:DX=-1:DY=-2:RETURN
1100 K=1:DX=-1:DY=-1:RETURN
1110 K=3:DX=-2:DY=-1:RETURN
1120 K=3:DX=-2:DY=+1:RETURN
1500 PRINT@339,BL$;:PRINT@307,"ïï";:PRINT@180,BL$;:FORI=1TO100:NEXTI
1501 PRINT@180,E$;:PRINT@307,"ÏÏ";:PRINT@339,"ïï";
1510 RETURN
1999 REM MOVE IT
2000 X2=X+DX:Y2=Y+DY:IFY2>31THENSOUND5,2:E=1:SET(X,Y,5):RETURN
2030 P=POINT(X2,Y2)+1:ONPGOTO2050,2110,2260,2150,2190,2260,2260,2310,2350
2050 SOUND10,1:IFX<32THEN2090
2070 IFPA>2THENDX=-DX:SET(X,Y,5):X=X+DX:RESET(X,Y):RETURN
2071 DY=-DY:SET(X,Y,5):Y=Y+DY:RESET(X,Y):RETURN
2090 IFPB>2THENDX=-DX:SET(X,Y,5):X=X+DX:RESET(X,Y):RETURN
2091 DY=-DY:SET(X,Y,5):Y=Y+DY:RESET(X,Y):RETURN
2110 SOUND160,1:IFX=10ORX=11THENDX=-DX:GOTO2130
2121 DY=-DY
2130 SC=SC+100:GOSUB4000:RETURN
2150 SOUND240,1
2160 IFX>31THENKJ=7+RND(5):GOTO2170
2161 KJ=4+RND(5)
2170 GOSUB1000:RETURN
2190 SOUND240,1
2200 IFPOINT(X+DX,Y-DY)<>5THEN2220
2210 DY=-DY:RETURN
2220 IFPOINT(X-DX,Y+DY)<>5THEN2240
2230 DX=-DX:RETURN
2240 KJ=RND(12):GOSUB1000:RETURN
2260 IFPOINT(X,Y+SGN(DY))=0THEN2050
2270 IFPOINT(X+SGN(DX),Y)=0THEN2050
2280 IFPOINT(X+SGN(DX),Y+SGN(DY))=0THEN2050
2290 SET(X,Y,5):RESET(X2,Y2):X=X2:Y=Y2:RETURN
2310 SOUND150,1:IFX=20ORX=21THENDX=-DX:GOTO2330
2321 DY=-DY
2330 SC=SC+50:GOSUB4000:RETURN
2350 SOUND170,1:SOUND170,1:IFX=11ORX=16THENDY=-DY:GOTO2370
2361 DX=-DX
2370 SC=SC+500:GOSUB4000:RETURN
3000 ONPBGOTO3010,3050,3080,3110,3140
3010 IFI$<>"A"THENRETURN
3020 FORXB=27TO22STEP-1:SET(XB,30,5):NEXT:RESET(22,29):RESET(23,29):RESET(24,28):RESET(25,28):RESET(26,27):PB=2:RETURN
3050 SET(26,27,5):SET(25,28,5):SET(24,28,5):SET(23,29,5):SET(22,29,5):SET(21,30,5)
3060 FORXB=21TO25:RESET(XB,50-XB):NEXT:PB=3:RETURN
3080 FORXB=25TO21STEP-1:SET(XB,50-XB,5):NEXT
3090 RESET(20,29):RESET(21,28):RESET(21,27):RESET(22,26):RESET(22,25):RESET(23,24):PB=4:RETURN
3110 SET(23,24,5):SET(22,25,5):SET(22,26,5):SET(21,27,5):SET(21,28,5)
3120 FORYB=29TO23STEP-1:RESET(20,YB):NEXT:PB=5:RETURN
3140 FORYB=23TO29:SET(20,YB,5):NEXT:FORXB=21TO27:RESET(XB,30):NEXT:PB=1:RETURN
3500 ONPAGOTO3510,3550,3580,3610,3640
3510 IFI$<>"S"THENRETURN
3520 FORXB=36TO42:SET(XB,30,5):NEXT:RESET(42,29):RESET(41,29):RESET(40,28):RESET(39,28):RESET(38,27):PA=2:RETURN
3550 SET(38,27,5):SET(39,28,5):SET(40,28,5):SET(41,29,5):SET(42,29,5)
3560 FORXB=42TO38STEP-1:RESET(XB,XB-13):NEXT:PA=3:RETURN
3580 FORXB=38TO42:SET(XB,XB-13,5):NEXT
3590 RESET(43,29):RESET(42,28):RESET(42,27):RESET(41,26):RESET(41,25):RESET(40,24):PA=4:RETURN
3610 SET(40,24,5):SET(41,25,5):SET(41,26,5):SET(42,27,5):SET(42,28,5)
3620 FORYB=29TO23STEP-1:RESET(43,YB):NEXT:PA=5:RETURN
3640 FORYB=23TO29:SET(43,YB,5):NEXT
3650 FORXB=42TO36STEP-1:RESET(XB,30):NEXT:PA=1:RETURN
4000 REM PRINT SCORE
4010 S$=STR$(SC)
4020 L=LEN(S$)-1
4030 PRINT@511-L,RIGHT$(S$,L);
4040 IFSC<WTHENRETURN
4050 W=W+1000
4060 GOSUB1500
4070 IFW>100000THENE=1:FORI=10TO100STEP10:SOUND140+I,1:NEXTI
4080 RETURN
5000 END
