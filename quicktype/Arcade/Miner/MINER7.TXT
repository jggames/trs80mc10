0 CLS:GOTO900
1 PRINT@A,A$(N);:T=RND(2)+2:A=J(T,RND(3)):C=J(T,0):B=A+C*15:N=K(PEEK(A+M)):RETURN
2 PRINT@L,A$(U);:PRINT@L+Z,B$(U);:T=RND(2)+2:L=J(T,4):H=J(T,0):G=L+H*15:U=K(PEEK(L+M)):RETURN
20 FORF=FTO4STEP.:IFRND(W)>1ORU=15ORN=15THEN23
21 PRINT@S,A$(1);:PRINT@S+Z,B$(1);:S=S+R:T=K(PEEK(S+M)):IFT<>1THENIFT<>5THENS=S-R:R=-R
22 PRINT@S,A$(15);:PRINT@S+Z,B$(15);
23 PRINT@A,A$(N);:A=A+C:N=K(PEEK(A+M)):IFN>4THENT=N:N=O:IFT>5THENN=15:GOTO25
24 PRINT@A,A$(RND(2)+10);:IFA=BTHENGOSUB1:IFA=PTHENN=2:GOTO80
25 PRINT@L,A$(U);:PRINT@L+Z,B$(U);:L=L+H:U=K(PEEK(L+M)):IFU>4THENT=U:U=O:IFT>5THENU=15:GOTO30
26 PRINT@L,A$(13);:PRINT@L+Z,B$(13);:IFL=GTHENGOSUB2:IFL=PTHENU=2:GOTO80
30 IFJTHENK=J(I,J):J=J+1:ONKGOTO49,59,45,47,51,53,55,57:J=0
31 K=K(PEEK(P+M+64)):IFK<4THENIFO<>1ANDK<>1THENY=Y+2:F=F+1:GOTO60
40 F=.:FORT=.TODL:K=PEEK(2):T=T+K:NEXT:ONK(KANDPEEK(17023))GOTO41,43,45,47,90,91,92,95,180:GOTO63
41 IFK(PEEK(P+M-2))<4THENX=X-2:D=6:GOTO60
42 GOTO63
43 IFK(PEEK(P+M+2))<4THENX=X+2:D=5:GOTO60
44 GOTO63
45 IFK(PEEK(P+M-64))<5THENY=Y-2:GOTO60
46 GOTO63
47 IFK(PEEK(P+M+64))<4THENY=Y+2:GOTO60
48 GOTO63
49 ON-((X-2)<0)GOTO60:X=X-2:D=6:GOTO60
51 IFK(PEEK(P+M-66))<5THENX=X-2:Y=Y-2:D=8
52 GOTO60
53 IFK(PEEK(P+M+62))<4THENX=X-2:Y=Y+2:D=10
54 GOTO60
55 IFK(PEEK(P+M-62))<5THENY=Y-2:X=X+2:D=7
56 GOTO60
57 IFK(PEEK(P+M+66))<4THENY=Y+2:X=X+2:D=9
58 GOTO60
59 ON-((X+2)>31)GOTO60:X=X+2:D=5
60 ONK(PEEK(P+M))+1GOTO200,61,61,140,61,61,80
61 IFP>.THENPRINT@P,A$(O);
62 PRINT@P+Z,B$(O);:P=Y*32+X
63 ONK(PEEK(P+M))+1GOTO200,68,68,140,68,71,80
68 O=K(PEEK(P+M)):IFP>.THENPRINT@P,A$(D);
70 PRINT@P+Z,B$(D);
71 NEXT:K=K(PEEK(P+M+64)):F=3:IFK<4THEN20
72 PRINT@P,A$(18);:PRINT@P+Z,B$(18);:SOUND1,5
73 LF=LF-1:PRINT@508,LF;:IFLF=.THEN945
74 PRINT@P,A$(O);:PRINT@P+Z,B$(O);:X=14:Y=1:P=Y*32+X:O=K(PEEK(P+M)):D=5:PRINT@P,A$(D);:PRINT@P+Z,B$(D);:F=.
75 M$="":FORT=P+M+2TOP+M+6:M$=M$+CHR$(PEEK(T)):NEXT:PRINT@P+2,"@#?@!";:FORT=1TO10:SOUNDRND(200),1:NEXT:PRINT@P+2,M$;:GOTO20
80 F=4:NEXT:GOTO72
90 J=1:I=1:K=.:GOTO63
91 J=1:I=2:K=.:GOTO63
92 IFV=0THEN71
93 K=K(PEEK(P+M+62)):IFK=2THENPRINT@P+62,A$(1);:PRINT@P+62+Z,B$(1);:SOUND100,1:V=V-1:PRINT@496,V;
94 GOTO71 
95 IFV=0THEN71 
96 K=K(PEEK(P+M+66)):IFK=2THENPRINT@P+66,A$(1);:PRINT@P+66+Z,B$(1);:SOUND100,1:V=V-1:PRINT@496,V;
97 GOTO71
140 GP=GP+1:SC=SC+100*GP:PRINT@480,SC;:O=2:PRINT@P,A$(D);:PRINT@P+Z,B$(D);:SOUND100,2:GOTO71
200 F=4:NEXT:GOTO1000
900 DIMK(255),X,Y,M,T,P,K,D,O,Z,C,A$(18),B$(18),J(4,4),I,J,A,L,S,B,C,N,G,H,U,Q,R,V,W,DL,ZZ,CC,SC,LF
910 PRINTTAB(11)"manic miner":PRINT:PRINTTAB(5)"BY JIM & CHARLIE GERRIE":PRINT:PRINTTAB(3)"FOR RETROCHALLENGE 03/2019"
911 PRINT
912 PRINT"COLLECT THE GOLD AS YOU DESCEND"
913 PRINT"   1ST=100  2ND=200  3RD=300"
914 PRINT"NEW LIFE AWARDED EVERY 5 LEVELS"
920 PRINT:PRINT"MOVE=   W      JUMP=  Q   E "
930 PRINT"     A  S  D    OR    ,   , ":PRINT
935 PRINT"PLACE LADDER=       M       ?"
940 GOSUB10100
945 IFSC>HSTHENHS=SC
947 IFHS>0THENPRINT@10,"HIGH"HS;
951 PRINT@489,"START GAME? (Y/N)  ";
952 M$=INKEY$:IFM$=""THEN952
953 IFM$="Y"THEN999
954 IFM$="N"THENEND
955 GOTO952
999 CLS0:LF=3:SC=0:W=50:GP=0:LV=0:DF=0
1000 PRINT@480,;:GOSUB10200:FORY=1TO3:FORC=1TO4:IFC=2ORC=4THENPRINT"∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞";:GOTO1060
1001 IFC=3THENPRINT"ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ";:GOTO1060
1010 FORX=1TO32:M=RND(3):ZZ=RND(2)*2
1020 IFX+(M*2)>=32THENM=(32-X+1)/2
1030 FORT=1TOM:PRINTA$(ZZ);:NEXTT
1040 X=X+(M*2)-1:NEXTX
1060 NEXTC
1070 NEXTY
2000 FORY=1TO6:PRINT@Y*32+4,"ŒÕ";:NEXT
2010 FORY=7TO14:PRINT@Y*32+14,"ŒÕ";:NEXT
2020 FORY=3TO10:PRINT@Y*32+26,"ŒÕ";:NEXT
2030 PRINT@32*15+14,"ûù";:M=16384:Z=32:FORT=1TO2+DF
2040 X=(RND(16)-1)*2:Y=(RND(5)*2)-1:P=Y*32+X:IFK(PEEK(P+M+64))<>4ORPEEK(P+M)<>128THEN2040
2050 PRINT@P,A$(3);:PRINT@P+Z,B$(3);:NEXT
2051 X=(RND(16)-1)*2:Y=(RND(7)*2)-1:P=Y*32+X:IFK(PEEK(P+M+64))<>4ORPEEK(P+M)<>128THEN2051
2052 PRINT@P,A$(3);:PRINT@P+Z,B$(3);
2060 X=14:Y=1:P=Y*32+X:O=K(PEEK(P+M)):D=5:PRINT@P,A$(D);:PRINT@P+Z,B$(D);
2070 T=RND(2)+2:A=J(T,1+RND(2)):C=J(T,0):B=A+C*15:A=A+RND(3)*C:N=K(PEEK(A+M))
2071 T=RND(2)+2:L=J(T,4):H=J(T,0):G=L+H*15:U=K(PEEK(L+M))
2080 ONRND(3)GOTO2081,2082,2083
2081 S=3*32+4:R=-64:GOTO2090
2082 S=13*32+14:R=-64:GOTO2090
2083 S=9*32+26:R=-64:GOTO2090
2090 PRINT@480,SC;:PRINT@488,STR$(LV+1);:V=3:PRINT@496,V;:PRINT@508,LF;:PRINT@S,A$(15);:PRINT@S+Z,B$(15);:GOSUB10300
2091 W=W-1:IFW<30THENW=30
2092 DL=W-29:LV=LV+1:IF(LV/5)-INT(LV/5)=0ANDGP>0THENSOUND100,1:SOUND200,1:SOUND50,1:SOUND250,1:LF=LF+1:DF=DF+1
2093 IFLF>3THENLF=3
2094 PRINT@508,LF;:IFDF>5THENDF=5
2095 GP=0:F=0:GOTO20
10100 A$="ŒÕÄÄêÄØØ◊””€◊÷Ÿ€◊“—€∂ππ∂∑ª±≤ç∞∞éûùππ"
10110 B$="ŒÕ∞∞óõÄÄ÷“—Ÿ÷“—Ÿ÷÷ŸŸÄÄÄÄΩæøøÖáãäûùππ"
10120 C$="1 2 3 4 5 5 5 5 5 5 6 6 6 6 6 6 0 6 ":FORT=0TO255:K(T)=10:NEXT
10130 FORT=0TO17:X=1+(2*T):C=VAL(MID$(C$,X,1)):ZZ=ASC(MID$(A$,X,1)):K(ZZ)=C
10140 A$(T+1)=MID$(A$,X,2):B$(T+1)=MID$(B$,X,2):NEXT:K(96)=4
10150 K(65)=1:K(68)=2:K(87)=3:K(83)=4:K(44)=5:K(46)=6:K(ASC("M"))=7:K(ASC("/"))=8:K(ASC("L"))=3
10151 K(81)=5:K(69)=6:K(82)=6
10160 J(1,1)=5:J(1,2)=1:J(1,3)=6:J(2,1)=7:J(2,2)=2:J(2,3)=8
10170 T=1:FORX=1TO4:J(3,X)=32*T:J(4,X)=32*T+30:T=T+4:NEXT:J(3,0)=2:J(4,0)=-2
10190 FORT=16384-32TO16383:K(PEEK(T))=4:NEXT:RETURN
10200 PRINT"              ûù                ";
10210 PRINT"∞∞∞∞∞∞∞∞∞∞∞∞∞∞ŒÕ∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞";
10220 PRINT"ÄÄÄÄÄÄÄÄÄÄÄÄÄÄŒÕÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ";
10230 PRINT"∞∞∞∞∞∞∞∞∞∞∞∞∞∞ŒÕ∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞∞";:RETURN
10300 SOUND125,2:SOUND141,2:SOUND147,2:SOUND159,2:SOUND170,2:SOUND147,2:SOUND170,4:SOUND167,2
10310 SOUND141,2:SOUND167,4:SOUND159,2:SOUND133,2:SOUND159,4:SOUND125,2:SOUND141,2:SOUND147,2
10320 SOUND159,2:SOUND170,2:SOUND147,2:SOUND170,2:SOUND193,2:SOUND185,2:SOUND170,2:SOUND147,2
10330 SOUND170,2:SOUND185,4:RETURN
