0 CLS:DIMK(255),S(31,15),A,B,X,Y,U,W,Q,Z,E,I,MC,L:GOTO100
1 X=X-1:RETURN
2 Y=Y-1:RETURN
3 X=X+1:RETURN
4 Y=Y+1:RETURN
5 FORI=0TO31:POKES(I,0),WW:POKES(31-I,15),WW:POKES(0,INT(I/2)),WW:POKES(31,INT(I/2)),WW:NEXT
6 FORI=1TO18:POKEMC+64+RND(447),WW:NEXT:I=0
7 B=1+RND(13):A=RND(1+29):IFPEEK(S(A,B))=46THENPOKES(A,B),42:I=I+1:IFPEEK(S(A,B+1))=46THENPOKES(A,B+1),20
8 IFI<LTHEN7
9 ON1-(N<L)GOTO50:A=X:B=Y:ONK(PEEK(17023)ANDPEEK(2))GOSUB1,2,3,4
10 ONK(PEEK(S(X,Y)))GOSUB25,26,27
12 R=-R:POKES(A,B),E:POKES(X,Y),P(1-R):PRINT@0,S;
13 ON1-((K(PEEK(S(U-1,W)))=0ORK(PEEK(S(U+1,W)))=0)AND(K(PEEK(S(U,W-1)))=0ORK(PEEK(S(U,W+1)))=0))GOTO17
14 ONABS(Q)GOTO16
15 ON1-(U<XANDK(PEEK(S(U+1,W)))=0)GOTO28:Q=1:Z=0:GOTO17
16 ON1-(W<YANDK(PEEK(S(U,W+1)))=0)GOTO29:Z=1:Q=0
17 POKES(U,W),E:ON1-(K(PEEK(S(U+Q,W+Z)))=0)GOTO19:U=U+Q:W=W+Z
18 POKES(U,W),D(1-R):ON1-(X=UANDY=W)GOTO9,24
19 ONRND(4)GOTO20,21,22,23
20 Q=1:Z=0:GOTO17
21 Q=-1:Z=0:GOTO17
22 Q=0:Z=1:GOTO17
23 Q=0:Z=-1:GOTO17
24 SOUND1,1:SOUND10,1:SOUND2,1:SOUND10,1:SOUND3,1:SOUND10,1:SOUND4,1:SOUND10,1:SOUND5,1:PRINT@0,"YOUR SCORE IS"S:END
25 SOUND200,1:SOUND225,1:S=S+10:N=N+1:RETURN
26 X=A:Y=B:RETURN
27 S=S+1:RETURN
28 ON1-(U>XANDK(PEEK(S(U-1,W)))=0)GOTO17:Q=-1:Z=0:GOTO17
29 ON1-(W>YANDK(PEEK(S(U,W-1)))=0)GOTO17:Z=-1:Q=0:GOTO17
50 L=L-(L<29):FORZZ=1TO100STEP25:SOUNDZZ,1:NEXT
60 CLS0:FORX=16416TO16447:POKEX,32:NEXT:FORX=16448TO16895:POKEX,46:NEXT:X=30:Y=1:U=L:W=1:Q=1:Z=0:N=0
70 GOTO5
100 MC=16384:WW=96:K(65)=1:K(87)=2:K(83)=3:K(90)=4:K(42)=1:K(WW)=2:K(46)=3:K(20)=3:FORX=112TO121:K(X)=22:NEXT
105 FORY=0TO15:FORX=0TO31:S(X,Y)=32*Y+X+MC:NEXT:NEXT:E=32:P(0)=24:P(2)=25:D(0)=60:D(2)=61
110 L=9:S=0:R=1
120 GOTO50
