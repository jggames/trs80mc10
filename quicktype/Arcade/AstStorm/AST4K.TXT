0 CLS:CLEAR80:DIMT,V,E,P,L,X,Y,Z,S,M,J,Q,K,F,A:B$=CHR$(143)+CHR$(143)+CHR$(143):C$=B$+CHR$(143):D$=C$+CHR$(143):GOTO110
4 FORA=1TO3:POKEP,64:SOUND100,1:POKEP,95:SOUND200,1:NEXT:S=S+250:RETURN
5 FORA=1TO3:POKEP,191:SOUND1,5:POKEP,95:NEXT:C=C-1:F=FF:S=S-15:PRINT@496,"SHIPS"C;:IFC<1THENM=999:RETURN
6 POKEP,143:P=V+287:POKEP,95:SOUND100,1:RETURN
7 C=C+1:FORA=1TO5:GOSUB90:PRINT"+ ship";:POKEP,31:SOUND200,1:GOSUB90:PRINT"+ SHIP";:POKEP,95:SOUND100,1:NEXT:RETURN
8 IFC THEN5
9 RETURN
15 L=PEEK(P):IFL>128ANDL<143THEN5
16 IFL=94THEN7
17 IFL=64THEN4
18 RETURN
20 FORM=1TO150:A$="":FORT=V TOE:A$=A$+CHR$(PEEK(T)):NEXT:POKEP,143:PRINT@480,A$"SCORE"S,"SHIPS"C;
21 GOSUB15:FORT=1TOQ:POKEP,143:P=P+X+Y:S=S-1:IFP<=E ORP>Z THENP=P+X*-1+Y*-1
22 GOSUB15:X=0:Y=0:POKEP,95:K=PEEK(17023)ANDPEEK(2):IFK=65THENX=-1:S=S+LS:NEXT:NEXT:GOTO27
23 IFK=87THENY=-32:NEXT:NEXT:GOTO27
24 IFK=90THENY=32:NEXT:NEXT:GOTO27
25 IFK=32THEN80
26 NEXT:NEXT
27 IFM>999ORS<0THEN100
28 FORT=1TO10:SOUNDRND(200),2:NEXT:POKEP,143:GOSUB90:PRINT"NEXT LEVEL";:FORT=1TO10:SOUNDRND(100),2:NEXT
29 FORT=1TOJ:W=RND(RR):I=RND(29-W*2)+W:H=RND(61-W*2)+W:FORR=1TOW:GOSUB30:NEXT:SOUND1,5:NEXT:GOSUB195:GOTO210
30 N=0:O=R:PC=3-2*R
35 GOSUB70
40 IFPC<0THENPC=PC+4*N+6:GOTO50
45 PC=PC+4*(N-O)+10:O=O-1
50 N=N+1
55 IFN<O THEN35
60 IFN=O THENGOSUB70 
65 RETURN
70 RESET(H+N,I+O):RESET(H-N,I+O):RESET(H+N,I-O):RESET(H-N,I-O):RESET(H+O,I+N):RESET(H-O,I+N):RESET(H+O,I-N):RESET(H-O,I-N)
75 RETURN
80 ON-(F<1)GOTO26:PRINT@P-33-V,"/-"CHR$(92);:PRINT@P-2-V,"( "CHR$(95)" )";:PRINT@P+31-V,CHR$(92)"-/";
83 F=F-1:PRINT@P-33-V,B$;:PRINT@P-2-V,D$;:PRINT@P+31-V,C$;:GOTO26
90 PRINT@480,"                               ";:PRINT@480,;:RETURN
100 IFS>HS THENHS=S
110 PRINT@200," asteroid storm ":A$="HIGH"+STR$(HS):PRINT@288+(32-LEN(A$))/2,A$;
170 V=16384:E=V+31:Z=V+479:PRINT@480,"SCORE"S,"LEVEL (1-3)?";
172 A=RND(0):A$=INKEY$:J=4-VAL(A$):ON-(J<1OR J>3)GOTO172:CLS1
180 S=0:LV=0:C=3:LS=3:FF=12:MM=10:RR=3:IFJ=1THENJ=2:FF=8:MM=15:RR=4
190 Q=4-J:FORT=1TOMM:W=RND(RR):I=RND(29-(W*2))+W:H=RND(61-(W*2))+W:FORR=1TOW:GOSUB30:NEXT:NEXT
195 T=RND(480)+V:IFPEEK(T)=143THENPOKET,94:GOTO210
200 GOTO195
210 LV=LV+1:FORA=1TOLV
211 T=RND(480)+V:IFPEEK(T)=143THENPOKET,64:GOTO213
212 GOTO211
213 NEXT:P=V+287:X=0:F=FF:GOSUB90:LS=LS+J:GOTO20
