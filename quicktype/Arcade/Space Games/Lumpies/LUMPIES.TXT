0 DIMZ(22,25,2),XP(10,4),YP(10,4),H,V,C:GOTO50
2 Z=INT(ABS(Z(X+XP(PL,DI),Y+YP(PL),DI),LE):RETURN
3 Z1=ABS(Z(X+XP(PL,DI),Y+YP(PL,DI),LE)):RETURN
50 CLS:PRINT@256+10,"LUMPIES OF LOTIS IV";:PRINT:PRINT:PRINT"HIT A KEY"
55 I$=INKEY$:A=RND(1000):IFI$=""THEN55
110 YS=20:YW=0:DI=3:LE=1:GW=1:GX=1:HO=0
120 FORA=1TO4:READDR(A):NEXT:FORA=1TO4:FORB=1TO10:READXP(B,A):NEXTB,A:FORA=1TO4:FORB=1TO10:READYP(B,A):NEXTB,A
130 FORA=0TO7:READWP$(A):NEXT:FORA=1TO4:READCO$(A):NEXT:FORC=1TO2:FORA=2TO23:FORB=1TO19:Z(B,A,C)=VAL(MID$(A$,B,1)):
131 IFZ(B,A,C)=1ANDRND(0)<.023THENZ(B,A,C)=5
140 NEXTB,A,C
150 CLS0:GOSUB5000
199 GOTO199
410 H=0:FORV=1TO5:SET(H,V,C):H=H+1:NEXT:FORH=5TO26:SET(H,5,C):NEXT:V=5:FORH=27TO31:SET(H,V,C):V=V-1:NEXT
411 H=4:FORV=16TO20:SET(H,V,C):H=H-1:NEXT:FORH=5TO26:SET(H,16,C):NEXT:V=16:FORH=27TO31:SET(H,V,C):V=V+1:NEXT:RETURN
420 FORV=2TO19:SET(1,V,C):NEXT:FORV=3TO18:SET(2,V,C):NEXT:FORV=4TO17:SET(3,V,C):NEXT:FORV=5TO16:SET(4,V,C):NEXT:RETURN
430 FORH=0TO4:FORV=5TO16:SET(H,V,C):NEXT:NEXT:RETURN
440 FORH=0TO5:SET(H,5,C):SET(H,16,C):NEXT:RETURN
450 FORH=0TO5:FORV=9TO12:SET(H,V,C):NEXT:NEXT:RETURN
460 FORV=2TO19:SET(30,V,C):NEXT:FORV=3TO18:SET(29,V,C):NEXT:FORV=4TO17:SET(28,V,C):NEXT:FORV=5TO16:SET(27,V,C):NEXT:RETURN
470 FORH=27TO31:FORV=5TO16:SET(H,V,C):NEXT:NEXT:RETURN
480 FORH=26TO31:SET(H,5,C):SET(H,16,C):NEXT:RETURN
490 FORH=22TO31:FORV=9TO12:SET(H,V,C):NEXT:NEXT:RETURN
500 FORH=5TO26:FORV=5TO16:SET(H,V,C):NEXT:NEXT:RETURN
501 SET(5,15,C):SET(6,14,C):SET(7,13,C):SET(8,12,C):SET(5,6,C):SET(6,7,C):SET(7,8,C):SET(8,9,C)
502 SET(26,15,C):SET(25,14,C):SET(24,13,C):SET(23,12,C):SET(23,9,C):SET(24,8,C):SET(25,7,C):SET(26,6,C):RETURN
510 FORV=6TO15:SET(5,V,C):NEXT:FORV=7TO14:SET(6,V,C):NEXT:FORV=8TO13:SET(7,V,C):NEXT:FORV=9TO12:SET(8,V,C):NEXT:RETURN
520 FORH=5TO9:FORV=9TO12:SET(H,V,C):NEXT:NEXT:RETURN
530 REM DOOR
540 FORV=6TO15:SET(26,V,C):NEXT:FORV=7TO14:SET(25,V,C):NEXT:FORV=8TO13:SET(24,V,C):NEXT:FORV=9TO12:SET(23,V,C):NEXT:RETURN
550 FORH=22TO27:FORV=9TO12:SET(H,V,C):NEXT:NEXT:RETURN
570 FORH=10TO21:FORV=9TO12:SET(H,V,C):NEXT:NEXT:RETURN
5000 FORX=0TO31:SET(X,0,C):SET(X,21,C):NEXT:FORY=0TO21:SET(0,Y,C):SET(31,Y,C):NEXT:RETURN
5020 FORX=0TO31:SET(X,5,C):SET(X,16,C):NEXT:RETURN
5030 FORX=0TO31:SET(X,9,C):SET(X,12,C):NEXT:RETURN
5040 Y=1:FORX=0TO9:SET(X,Y,C):Y=Y+1:NEXT:RETURN
5050 Y=20:FORX=0TO9:SET(X,Y,C):Y=Y-1:NEXT:RETURN
5060 Y=1:FORX=31TO22STEP-1:SET(X,Y,C):Y=Y+1:NEXT:RETURN
5070 Y=20:FORX=31TO22STEP-1:SET(X,Y,C):Y=Y-1:NEXT:RETURN
5080 FORY=3TO18:SET(31,Y,C):NEXT:FORY=4TO17:SET(30,Y,C):NEXT:FORY=5TO16:SET(29,Y,C):NEXT
5085 FORY=6TO14:SET(28,Y,C):NEXT:RETURN
5090 FORY=7TO13:SET(27,Y,C):NEXT:FORY=8TO13:SET(26,Y,C):NEXT:FORY=9TO12:SET(25,Y,C):NEXT:RETURN
