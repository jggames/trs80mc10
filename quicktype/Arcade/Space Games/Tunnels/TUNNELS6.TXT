0 CLS1:DIMK(255),A(6),O(6),T,M,A,C,R:GOTO1000
1 RETURN
2 D=-1:ONK(PEEK(M+P-1))GOTO3,1,1,50,23:RETURN
3 POKEM+P,B:P=P-1:PRINT@P,"Y";:SOUND40,1:B=143:PRINT@P,"X";:RETURN
4 FORT=1TO2:ON1-(P-32>0)GOTO30:ONK(PEEK(M+P-32+D))GOSUB5,1,1,52:NEXT:FORT=1TO2:ONK(PEEK(M+P+32+D))GOSUB6,1,1,53:NEXT:RETURN
5 PRINT@P,B$;:P=P-32+D:PRINT@P,"X";:GOSUB18:RETURN
6 PRINT@P,B$;:P=P+32+D:PRINT@P,"X";:GOSUB18:RETURN
7 POKEM+A(A),O(A):A(A)=A(A)+D(A):O(A)=C:PRINT@A(A),"A";:RETURN
8 D=1:ONK(PEEK(M+P+1))GOTO9,1,1,51,29:RETURN
9 POKEM+P,B:P=P+1:PRINT@P,"Y";:SOUND40,1:B=143:PRINT@P,"X";:RETURN
10 PRINT@T,"^";:SOUND1,1:PRINT@T,B$;:NEXT:RETURN
11 ONK(PEEK(M+A(A)+D(A)+32))GOTO13,7,40,7:GOTO7
12 PRINT@P,B$;:P=P+32:PRINT@P,"X";:GOTO21
13 D(A)=D(A)*-1:RETURN
14 FORT=P-32TO0STEP-32:ONK(PEEK(M+T))GOTO10:PRINT@T,B$;:ONK(PEEK(M+T+1))GOTO16,16:PRINT@T+1,B$;:ONK(PEEK(M+T-1))GOTO17,17
15 PRINT@T-1,B$;:RETURN
16 ONK(PEEK(M+T-1))GOTO17:GOTO15
17 T=0:NEXT:RETURN
18 ONK(PEEK(M+A(A)+32))GOTO28:C=PEEK(M+A(A)+D(A)):ONK(C)GOTO11,13,40,11:GOTO13
20 ONK(PEEK(2)ANDPEEK(17023))GOSUB25,2,14,8,55:A=RND(6):GOSUB18
21 ONK(PEEK(M+P+32))GOTO12
22 GOTO20
23 POKEM+P,B:P=P-1:PRINT@P,"Y";:SOUND40,1:B=95:PRINT@P,"X";:RETURN
25 ON1-(PEEK(M+P-32)=95)GOTO27,26:RETURN
26 POKEM+P,B:P=P-32:B=95:POKEM+P,88:RETURN
27 ON1-(B=95)GOTO4:ON1-(PEEK(M+P-32)=143)GOTO1:POKEM+P,B:P=P-32:B=143:POKEM+P,88:RETURN
28 PRINT@A(A),B$;:A(A)=A(A)+32:PRINT@A(A),"A";:GOTO18
29 POKEM+P,B:P=P+1:PRINT@P,"Y";:SOUND40,1:B=95:PRINT@P,"X";:RETURN
30 PRINT@0,"TOP";:END
40 ON1-(PEEK(M+A(A)+D(A)+32)=32)GOTO41:RETURN
41 PRINT@0,"GOTCHA";:END
50 GOSUB3:SOUND1,1:SOUND100,1:SC=SC+100:GOSUB70:RETURN
51 GOSUB9:SOUND1,1:SOUND100,1:SC=SC+100:GOSUB70:RETURN
52 GOSUB5:SOUND1,1:SOUND100,1:SC=SC+100:GOSUB70:RETURN
53 GOSUB6:SOUND1,1:SOUND100,1:SC=SC+100:GOSUB70:RETURN
55 ON1-(O>0)GOTO1:O=O-1:B=95:FORT=P-32TO(P-96)*ABS(P-96>0)STEP-32:ONK(PEEK(M+T))GOTO56:T=0:NEXT:GOSUB300:RETURN
56 PRINT@T,CHR$(95);:NEXT:GOSUB300:RETURN
60 C2=(PEEK(17024)AND1)*256+PEEK(17025):PRINTN;:N$=STR$(N):R=LEN(N$):FORC1=M+C2TOM+C2+R:POKEC1,PEEK(C1)-64:NEXT:RETURN
70 N=SC:PRINT@486,"";:GOSUB60:RETURN
100 GOSUB200:GOTO20
200 FORT=1TO20:R=RND(459):L=5+RND(15)
210 PRINT@R,LEFT$(L$,L);:NEXT:FORT=0TO14:R=RND(25):PRINT@T*32+R,LEFT$(L$,5+RND(5));:NEXT
220 FORT=1TO14:PRINT@T*32-1,CHR$(191);CHR$(191);:NEXT:POKEM+479,191:POKEM,191
221 PRINT@480,"SCORE:       MEN:    SPIKES:   ";:FORC1=M+480TOM+511:POKEC1,PEEK(C1)-64:NEXT:POKEM+511,32
230 P=448+16:O=1:LF=3
240 FORT=1TO6
250 R=RND(448):ON1-(PEEK(M+R)=143ANDPEEK(M+R+32)=175)GOTO250:A(T)=R:D(T)=1:O(T)=143:PRINT@R,"A";:NEXT
260 FORT=1TO10
270 R=RND(448):ON1-(PEEK(M+R)=143ANDPEEK(M+R+32)=175)GOTO270:PRINT@R,"*";:NEXT
280 PRINT@P,"X";:B=143
290 GOSUB300:GOSUB310:RETURN
300 N=O:PRINT@508,"";:GOSUB60:RETURN
310 N=LF:PRINT@497,"";:GOSUB60:RETURN
1000 K(87)=1:K(65)=2:K(32)=3:K(83)=4:K(82)=5:K(143)=1:K(191)=2:K(88)=3:K(106)=4:K(95)=5:M=16384
1010 FORT=1TO31:L$=L$+CHR$(175):NEXT:B$=CHR$(143)
1999 GOTO100
