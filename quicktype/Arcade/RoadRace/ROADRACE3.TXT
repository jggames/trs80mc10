0 DIMX(168),Y(168),C(4),A(4),B(4):GOTO100
1 IFA=1ANDB=0THENA=0:B=1:RETURN
2 IFA=0ANDB=1THENA=-1:B=0:RETURN
3 IFA=-1ANDB=0THENA=0:B=-1:RETURN
4 A=1:B=0:RETURN
5 IFA=1ANDB=0THENA=0:B=-1:RETURN
6 IFA=0ANDB=-1THENA=-1:B=0:RETURN
7 IFA=-1ANDB=0THENA=0:B=1:RETURN
8 A=1:B=0:RETURN
9 C(C)=1:B(C)=-RND(4)+2:A(C)=-RND(5)+1:L(C)=L(C)+1:PRINT@321+(32*C),CHR$(143+(C-1)*16)"LAP"L(C);:RETURN
10 SET(X,Y,5):FORC=2TO4:RESET(X(C(C))+A(C),Y(C(C))+B(C)):C(C)=C(C)+RND(3):IFC(C)>168THENGOSUB9
20 SET(X(C(C))+A(C),Y(C(C))+B(C),C):NEXT:I$=INKEY$
30 IFI$="S"THENGOSUB1:GOTO50
40 IFI$="A"THENGOSUB5
45 IFI$=","THENS=S-1:IFS=0THENS=1
46 IFI$="."THENS=S+1:IFS=4THENS=4
50 RESET(X,Y):X=X+A*S:Y=Y+B*S:IFPOINT(X,Y)=0THEN10
60 STOP
100 X=3:Y=3:A=1:B=0:S=2:GOSUB1000:FORC=2TO4:C(C)=RND(168):NEXT:B(1)=1:B(2)=0:B(3)=-1:B(4)=-2:GOTO10
1000 CLS1:PRINT@32,;
1001 PRINT"";
1002 PRINT"";
1003 PRINT"";
1004 PRINT"";
1005 PRINT"";
1006 PRINT"";
1007 PRINT"";
1008 PRINT"";
1009 PRINT"";
1010 PRINT"";
1011 PRINT"";
1012 PRINT"";
1013 PRINT"";
1014 PRINT"";
1100 FORC=1TO168:READX(C),Y(C):NEXT:RETURN
2000 DATA6,4,7,4,8,4,9,4,10,4,11,4,12,4,13,4,14,4,15,4,16,4,17,4,18,4,19,4,20,4,21,4,22,4,23,4,24
2001 DATA4,25,4,26,4,27,4,28,4,29,4,30,4,31,4,32,4,33,4,34,4,35,4,36,4,37,4,38,4,39,4,40,4,41,4,42
2002 DATA4,43,4,44,4,45,4,46,4,47,4,48,4,49,4,50,4,51,4,52,4,53,4,54,4,55,4,56,4,57,4,58,4,59,4,60
2003 DATA4,60,5,60,6,60,7,60,8,60,9,60,10,60,11,60,12,60,13,60,14,60,15,60,16,60,17,60,18,60,19,60
2004 DATA20,60,21,60,22,60,23,60,24,60,25,60,26,60,27,60,28,59,28,58,28,57,28,56,28,55,28,54,28,53
2005 DATA28,52,28,51,28,50,28,49,28,48,28,47,28,46,28,45,28,44,28,44,27,44,26,44,25,44,24,44,23,44
2006 DATA22,44,21,44,20,44,19,44,18,44,17,44,16,44,15,44,14,44,13,44,12,44,11,43,11,42,11,41,11,40
2007 DATA11,39,11,38,11,37,11,36,11,35,11,34,11,33,11,33,12,33,13,33,14,33,15,33,16,33,17,32,17,31
2008 DATA17,30,17,29,17,28,17,27,17,26,17,25,17,24,17,23,17,22,17,21,17,20,17,19,17,18,17,17,17,16
2009 DATA17,15,17,14,17,13,17,12,17,11,17,10,17,9,17,8,17,7,17,6,17,6,16,6,15,6,14,6,13,6,12,6,11,6,10,6,9,6,8,6,7,6,6,6,5
