0 CLS0:P$="BJ@@QJI@JB@@IJQ@IIII@D@@JJ@@JJ@@QQJ@AC@@JII@CQ@@IIJ@CA@@JQQ@QC@@"
1 BS=0:FORY=1TO19:SET(15,Y,1):SET(29,Y,1):NEXT:FORX=15TO29:SET(X,20,1):NEXTX
2 X=19:C=X:R=C:IFRTHENGOSUB15
4 Y=.:Z=INT(RND(0)*6)*8:Z=Z-(Z>39)*8:I=8-(Z>31)*8:FORO=0TO1STEP0:CS=1
5 H=0:GOSUB8:CS=2:IFHTHENR=Q:X=U:IFA$=""THENY=Y-1:GOSUB8:GOTO2
6 GOSUB8:Q=R:U=X:TI=TI+1:A$=INKEY$:REM IFA$=""THENFORZZ=1TO5:NEXTZZ
7 CS=3:GOSUB8:X=X+(A$="A")-(A$="D"):Y=Y-(A$=""):R=R-(A$="W")*4:NEXTO
8 FORC=1TO4:N3=R-(I*INT(R/I)):D=ASC(MID$(P$,Z+N3+C))-64:W=INT(D/8):ON-(D<>0)GOSUB9:NEXT:RETURN
9 D=D-1AND7:H=H+(POINT(X+W+D,Y+C)>.):ONCSGOSUB12,13,14:ON-(D<>0)GOTO9:RETURN
10 RESET(E,C):RETURN
11 SET(E,C,1):RETURN
12 RETURN
13 SET(X+W+D,Y+C,1):RETURN
14 RESET(X+W+D,Y+C):RETURN
15 D=13:FORE=16TO28:D=D+(POINT(E,R)=1):NEXT
16 IFDTHENFORE=16TO28:ONPOINT(E,R)+1GOSUB10,11:NEXT:C=C-1
17 R=R-1:IFR=0THENRETURN
18 GOTO15
