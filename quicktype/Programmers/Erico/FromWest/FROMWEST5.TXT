0 M=16384:V=32:GOTO6100
1 POKEM+511,31:IFI$=""THEN1100
2 IFI$="A"THENTX=-1:GOTO1112
3 IFI$="D"THENTX=1:GOTO1112
4 IFI$="W"THENTY=-1:GOTO1112
5 IFI$="S"THENTY=1:GOTO1112
6 IFI$="Q"THENNEXT:GOTO1112
7 IFI$="E"THENIFHA>0ANDPS=0THENPS=1:PRINT@505,"SHOOT ";:GOTO1112
8 GOTO1100

9 I$=INKEY$
10 IFI$="A"THENTX=-1:GOTO16
11 IFI$="D"THENTX=1:GOTO16
12 IFI$="W"THENTY=-1:GOTO16
13 IFI$="S"THENTY=1:GOTO16
14 IFI$="E"THENPS=0:PRINT@505," WALK ";:GOTO1120
15 GOTO9

16 FORT1=1TO4:TT=X(0)+T1*TX+(Y(0)+T1*TY)*V:TP=PEEK(TT+M):POKETT+M,42:FORB=1TO100:NEXT:POKETT+M,TP
17 IFX(0)+T1*TX<0ORX(0)+T1*TX>31ORY(0)+T1*TY<0ORY(0)+T1*TY>14THENT1=4:GOTO20
18 IFTP=143THENIFRND(2)=1THENPRINT@TT,CHR$(159);:SOUND90,3:T1=4:GOTO20
19 IFTP=176THENT1=4
20 NEXT:TX=0:TY=0:PS=0:PRINT@505," WALK ";:HA=HA-1:GOTO1120

30 POKEM+511,30:ONRND(3)GOTO35,38:TX=0:TY=0:GOTO1121
35 IFY(0)<Y(T)THENTY=-1:GOTO1121
36 TY=1:GOTO1121
38 IFX(0)<X(T)THENTX=-1:GOTO1121
39 TX=1:GOTO1121

40 POKEM+511,30:IFRND(2)=1THENTX=RND(3)-2:GOTO1123
41 TY=RND(3)-2:GOTO1123

50 FORT1=-1TO1:FORT2=-1TO1:IFPEEK(X(T)+TX+T1+(Y(T)+TY+T2)*V+M)=208THEN55
51 NEXT:NEXT:GOTO1142
55 PF$=P$(RND(8)-1):PRINT@X(T)+TX+T1+(Y(T)+TY+T2)*V,PF$;:NEXT:NEXT:GOTO1142

60 IFHK>0THENHK=HK-1:PRINT@X(T)+TX+(Y(T)+TY)*V,CHR$(207);:TX=0:TY=0:NEXT:GOTO1144
61 IFRND(2)=1THENHK=1:GOTO1140
62 GOTO1144

1010 PRINT@480,"P:"MID$(STR$(HP)+"  ",2,3)"S:"MID$(STR$(INT(HS))+"  ",2,3)"A:"MID$(STR$(HA)+"  ",2,3);
1012 PRINT"K:"MID$(STR$(HK)+"  ",2,3)"F:"MID$(STR$(INT(HF))+"  ",2,3)" WALK ";:POKEM+511,31

1040 HS=HS-.1:IFHS<1THENHS=0:?@505," WEAK ";
1045 IFPS>1THENPRINT@505,"DRIVE ";:IFHF<1THENHF=0:PS=0:CB=B(0):B(0)=235:F(0)=255:PRINT@X(0)+Y(0)*V,CHR$(255);

1060 FORT1=1TO20:IFF(T1)=0THENB=T1:T1=20:NEXT:GOTO1070
1066 NEXT:GOTO1075
1070 Y(B)=RND(16)-1:IFPEEK(X(B)+Y(B)*V+M)<>175THEN1075
1073 F(B)=143:PRINT@(X(B)+Y(B)*V),CHR$(143);:B(B)=175

1075 IFHP=0THENPRINT@480,"ENOUGH! THIS IS THE END.       ";:GOTO5020

1080 FORT=0TON:IFPEEK(X(T)+Y(T)*V+M)=159THENIFF(T)=143THENF(T)=0:PRINT@X(T)+Y(T)*V,CHR$(B(T));
1090 IFT<>1THEN1100
1095 IFPS=2THENPS=3:T=T-1:GOTO1100
1096 IFPS=3THENHF=HF-.25:PS=2:IFHF<1THENHF=0

1100 TX=0:TY=0:IFTTHEN1115
1101 I$=INKEY$:IFPS>1THENIFI$="E"THENPS=0:CB=B(0):B(0)=235:F(0)=255:PRINT@X(0)+Y(0)*V,CHR$(255);:NEXT
1111 IFPS<>1THEN1
1112 IFX(0)=31THENIFB(0)=192THEN5000
1114 IFPS=0THENIFHS=0THENIFRND(4)=1THENSOUND150,2:TX=0:TY=0:NEXT
1115 IFPS=1THEN9

1120 IFF(T)=143THEN30

1121 IFF(T)=191THEN40
1123 IFPEEK(X(T)+Y(T)*V+M)=239THENF(T)=0:PRINT@X(T)+Y(T)*V,CHR$(B(T));
1124 IFF(T)=191THENIFPEEK(X(T)+Y(T)*V+M)=159THENF(T)=143:PRINT@X(T)+Y(T)*V,CHR$(F(T));

1127 IFX(T)+TX<0ORX(T)+TX>31THENTX=0
1128 IFY(T)+TY<0ORY(T)+TY>14THENTY=0

1130 TP=PEEK(X(T)+TX+(Y(T)+TY)*V+M):IFTP<>191THENIFTP<>255THEN1137
1132 IFTP=191THENIFT=0THENHP=HP+1:PRINT@X(0)+TX+(Y(0)+TY)*V,CHR$(239);:TX=0:TY=0:NEXT
1134 IFTP=255THENIFF(T)=143THENHP=HP-1:?@X(0)+Y(0)*V,CHR$(239);:SOUND1,1:PRINT@X(0)+Y(0)*V,CHR$(F(0));
1136 IFTP=191THENIFF(T)=143THENPRINT@X(T)+TX+(Y(T)+TY)*V,CHR$(159);:TX=0:TY=0

1137 IFTTHEN1144
1138 IFTP=235THENPRINT@X(T)+TX+(Y(T)+TY)*V,CHR$(CB);:PS=3:F(0)=235:TP=192
1140 IFTP<>200THEN1144
1141 IFHK>0THEN50
1142 GOTO60

1144 IFTTHEN1200
1145 IFTP=19THENHS=HS+5:PRINT@X(T)+TX+(Y(T)+TY)*V,P$(0);:TP=192:GOTO1150
1146 IFTP=1THENHA=HA+5:PRINT@X(T)+TX+(Y(T)+TY)*V,P$(0);:TP=192:GOTO1150
1147 IFTP=11THENHK=HK+5:PRINT@X(T)+TX+(Y(T)+TY)*V,P$(0);:TP=192:GOTO1150
1148 IFTP=6THENHF=HF+5:PRINT@X(T)+TX+(Y(T)+TY)*V,P$(0);:TP=192:GOTO1150
1150 IFPS<=1THEN1200
1151 IFTP=143THENPRINT@X(T)+TX+(Y(T)+TY)*V,CHR$(159);:HF=HF-5:NEXT
1155 IFTP<>192THENTX=0:TY=0:GOTO1100

1200 IFF(T)THENIFTP=192ORTP=169ORTP=175ORTP=207THEN1250
1201 IFT=0THEN1100
1203 NEXT:GOTO1010

1250 PRINT@X(T)+Y(T)*V,CHR$(B(T));:X(T)=X(T)+TX:Y(T)=Y(T)+TY
1260 B(T)=PEEK(X(T)+Y(T)*V+M):PRINT@X(T)+Y(T)*V,CHR$(F(T));:NEXT:GOTO1010

5000 IFLV=10THENPRINT@480,"YOU HAVE ESCAPED!              ";:GOTO5020
5010 LV=LV+1:GOTO6152
5020 PRINT@505,"AGAIN?";
5100 M$=INKEY$
5110 IFM$="Y"THENRUN
5120 IFM$="N"THENEND
5130 GOTO5100

6090 B$(0)="¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯":B$(1)="¯¯¯¯¯°°¯¯°°¯¯¯¯¯":B$(2)="°°°¯°ÐÈ¯°°°¯¯¯¯¯"
6091 B$(3)="°°°°°ÐÐ°°°È°¯¯¯¯":B$(4)="¯°°°¯ÈÐ°¯°Ð°¯°°°":B$(5)="©©©©ÀÀÀÀÀÀÀÀ©©©©"
6092 B$(6)="©ÀÀ©ÀÀÀ©ÀÀÀ©©©©©":B$(7)="©©©©ÀÀÀ©ÀÀÀ©©ÀÀ©":B$(8)="©ÀÀ©©ÀÀ©©ÀÀ©©ÀÀ©"
6093 B$(9)="©©©©©ÀÀÀ©ÀÀÀ©ÀÀ©":B$(10)="©ÀÀ©©ÀÀÀ©ÀÀÀ©©©©":RETURN

6100 DIMX(20),Y(20),B(20),F(20),P$(7),T,TP,TX,TY,PS,B$(11):GOSUB6090
6110 LV=1:HP=1:HA=5:HK=5:HF=20.75:HS=RND(-(PEEK(9)*256+PEEK(10))):HS=15.9
6142 CB=192:PS=0

6152 P$(0)=CHR$(207):P$(1)="s":P$(2)="a":P$(3)="k":P$(4)="f":P$(5)=CHR$(207):P$(6)=CHR$(207):P$(7)=CHR$(207)
6154 FORT=1TO20:F(T)=0:B(T)=0:NEXT
6155 PF$=""
6160 BP=0
6165 T=0
6170 TP=0:TT=0:TX=0:TY=0:T1=0:T2=0:BT=5:N=20:B=0

6210 CLS3:FORT=0TO31
6220 BT=RND(5)-1:FORTP=0TO3:IFT=31ANDTP=3THENNEXT:GOTO6230
6221 PRINT@BP+TP*32,MID$(B$(BT),TP*4+1,4);:NEXT
6230 BP=BP+4:IFBP=32ORBP=160ORBP=288THENBP=BP+96
6240 NEXT

6300 T=0:BT=5:BP=RND(4)-1:X(0)=1:Y(0)=BP*4:BP=BP*128

6310 IFBP=412ORBP=284ORBP=156ORBP=28THENBT=5
6320 FORTP=0TO3
6330 IFBP=412ANDTP=3THEN6340
6331 PRINT@BP+TP*V,MID$(B$(BT),TP*4+1,4);
6340 NEXT
6350 IFBP=412ORBP=284ORBP=156ORBP=28THENY(0)=Y(0)+RND(2):B(0)=176:GOTO7000
6400 IFT=.THENBP=BP+4:T=1
6410 IFT=2THEN6415
6411 GOTO6420
6415 BP=BP-128:IFRND(2)=1ANDBP>31THENBT=8:GOTO6420
6416 T=0:BT=9
6420 IFT=3THEN6425
6421 GOTO6430
6425 BP=BP+128:IFRND(2)=1ANDBP<384THENBT=8:GOTO6430
6426 T=0:BT=10
6430 IFT=1THEN6435
6431 GOTO6450
6435 IFRND(3)=1THENIFBP>31THENT=2:BT=6:GOTO6450
6436 IFRND(3)=1THENIFBP<384THENT=3:BT=7:GOTO6450
6437 T=0:BT=5
6450 GOTO6310

7000 IFLV=1THENF(0)=255
7002 PRINT@X(0)+Y(0)*V,CHR$(F(0));
7003 FORT=1TO10:X(T)=INT(RND(V)-1):Y(T)=RND(15)-1:B(T)=175:F(T)=143:IFPEEK(M+X(T)+Y(T)*V)=175THENNEXT:GOTO7005
7004 T=T-1:NEXT
7005 FORT=1TO10:IFT<LVTHENF(T)=143:NEXT:GOTO7007
7006 F(T)=191:NEXT
7007 FORT=1TO10:PRINT@X(T)+Y(T)*V,CHR$(F(T));:NEXT
7008 B(0)=192:IFLV=1THENPRINT@X(0)+2+Y(0)*V,CHR$(235);
7010 GOTO1010
