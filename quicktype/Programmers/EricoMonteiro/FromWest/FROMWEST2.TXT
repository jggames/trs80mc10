0 M=16384:GOTO100:FOR COCO M=1024
1 POKEM+511,31:IFI$=""THEN1100
2 IFI$="A"THENTX=-1:GOTO1112
3 IFI$="D"THENTX=1:GOTO1112
4 IFI$="W"THENTY=-1:GOTO1112
5 IFI$="S"THENTY=1:GOTO1112
6 IFI$="Q"THENNEXT:GOTO1112
7 IFI$="E"THENIFHA>0ANDPS=0THENPS=1:PRINT@505,"SHOOT ";:GOTO1112
8 GOTO1100

9 I$=INKEY$:IFI$=""THEN1120
10 IFI$="A"THENTX=-1:GOTO16
11 IFI$="D"THENTX=1:GOTO16
12 IFI$="W"THENTY=-1:GOTO16
13 IFI$="S"THENTY=1:GOTO16
14 IFI$="E"THENPS=0:PRINT@505," WALK ";:GOTO1120
15 GOTO1120

16 FORT1=1TO4:TT=X(0)+T1*TX+(PY(0)+T1*TY)*32:TP=PEEK(TT+M):POKETT+M,42:SOUND1,2:POKETT+M,TP
17 IFTP=143ANDRND(2)=1THENPRINT@TT,CHR$(159);:SOUND90,3:T1=4:GOTO19
18 IFTP=176THENT1=4
19 NEXT:TX=0:TY=0:PS=0:PRINT@505," WALK ";:HA=HA-1:GOTO1120

30 POKEM+511,30:ONRND(3)GOTO35,38:TX=0:TY=0:GOTO1121
35 IFPY(0)<PY(T)THENTY=-1:GOTO1121
36 TY=1:GOTO1121
38 IFX(0)<X(T)THENTX=-1:GOTO1121
39 TX=1:GOTO1121

40 POKEM+511,30:IFRND(2)=1THENTX=RND(3)-2:GOTO1123
41 TY=RND(3)-2:GOTO1123

50 FORT1=-1TO1:FORT2=-1TO1:IFPEEK(X(T)+TX+T1+(PY(T)+TY+T2)*32+M)=208THEN55
51 NEXT:NEXT:GOTO1142
55 PF$=P$(RND(8)-1):PRINT@X(T)+TX+T1+(PY(T)+TY+T2)*32,PF$;:NEXT:NEXT:GOTO1142

60 IFHK>0THENHK=HK-1:PRINT@X(T)+TX+(PY(T)+TY)*32,CHR$(207);:TX=0:TY=0:NEXT:GOTO1144
61 IFRND(2)=1THENHK=1:GOTO1140
62 GOTO1144

90 B$(0)="¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯":B$(1)="¯¯¯¯¯°°¯¯°°¯¯¯¯¯":B$(2)="°°°¯°ÐÈ¯°°°¯¯¯¯¯"
91 B$(3)="°°°°°ÐÐ°°°È°¯¯¯¯":B$(4)="¯°°°¯ÈÐ°¯°Ð°¯°°°":B$(5)="©©©©ÀÀÀÀÀÀÀÀ©©©©"
92 B$(6)="©ÀÀ©ÀÀÀ©ÀÀÀ©©©©©":B$(7)="©©©©ÀÀÀ©ÀÀÀ©©ÀÀ©":B$(8)="©ÀÀ©©ÀÀ©©ÀÀ©©ÀÀ©"
93 B$(9)="©©©©©ÀÀÀ©ÀÀÀ©ÀÀ©":B$(10)="©ÀÀ©©ÀÀÀ©ÀÀÀ©©©©":RETURN

100 DIMX(20),PY(20),PB(20),PF(20),P$(7),T,TP,TX,TY,PS,B$(11):GOSUB91
110 LV=1:HP=1:HS=15.9:HA=5:HK=5:HF=20.75
142 CB=192:PS=0

152 P$(0)=CHR$(207):P$(1)="s":P$(2)="a":P$(3)="k":P$(4)="f":P$(5)=CHR$(207):P$(6)=CHR$(207):P$(7)=CHR$(207)
154 FORT=1TO20:PF(T)=0:PB(T)=0:NEXT
155 PF$=""
160 BP=0
165 T=0
170 TP=0:TT=0:TX=0:TY=0:T1=0:T2=0:BT=5:N=20:BO=0

200 REM---GENERATE CITY BULDINGS
210 CLS3:FORT=0TO31
220 BT=RND(5)-1:FORTP=0TO3:IFT=31ANDTP=3THENNEXT:GOTO230
221 PRINT@BP+TP*32,MID$(B$(BT),TP*4+1,4);:NEXT
230 BP=BP+4:IFBP=32ORBP=160ORBP=288THENBP=BP+96
240 NEXT

300 REM---GENERATE ROAD
300 T=0:BT=5:BP=RND(4)-1:X(0)=1:PY(0)=BP*4:BP=BP*128

310 IFBP=412ORBP=284ORBP=156ORBP=28THENBT=5
320 FORTP=0TO3
330 IFBP=412ANDTP=3THEN340
331 PRINT@BP+TP*32,MID$(B$(BT),TP*4+1,4);
340 NEXT
350 IFBP=412ORBP=284ORBP=156ORBP=28THENPY(0)=PY(0)+RND(2):PB(0)=176:GOTO1000
400 IFT=.THENBP=BP+4:T=1
410 IFT=2THEN415
411 GOTO420
415 BP=BP-128:IFRND(2)=1ANDBP>31THENBT=8:GOTO420
416 T=0:BT=9
420 IFT=3THEN425
421 GOTO430
425 BP=BP+128:IFRND(2)=1ANDBP<384THENBT=8:GOTO430
426 T=0:BT=10
430 IFT=1THEN435
431 GOTO450
435 IFRND(3)=1THENIFBP>31THENT=2:BT=6:GOTO450
436 IFRND(3)=1THENIFBP<384THENT=3:BT=7:GOTO450
437 T=0:BT=5
450 GOTO310

1000 REM---TEST START POSITIONS PRE DRAW STUFF
1001 IFLV=1THENPF(0)=255
1002 PRINT@X(0)+PY(0)*32,CHR$(PF(0));
1003 FORT=1TO10:X(T)=RND(32)-1:PY(T)=RND(15)-1:PB(T)=175:PF(T)=143:IFPEEK(M+X(T)+PY(T)*32)=175THENNEXT:GOTO1005
1004 T=T-1:NEXT
1005 FORT=1TO10:IFT<LVTHENPF(T)=143:NEXT:GOTO1007
1006 PF(T)=191:NEXT
1007 FORT=1TO10:PRINT@X(T)+PY(T)*32,CHR$(PF(T));:NEXT
1008 PB(0)=192:IFLV=1THENPRINT@X(0)+2+PY(0)*32,CHR$(235);

REM---MAIN LOOP
1010 PRINT@480,"P:"MID$(STR$(HP)+"  ",2,3)"S:"MID$(STR$(INT(HS))+"  ",2,3)"A:"MID$(STR$(HA)+"  ",2,3);
1012 PRINT"K:"MID$(STR$(HK)+"  ",2,3)"F:"MID$(STR$(INT(HF))+"  ",2,3)" WALK ";:POKEM+511,31

1040 HS=HS-.1:IFHS<1THENHS=0:?@505," WEAK ";
1045 IFPS>1THENPRINT@505,"DRIVE ";:IFHF<1THENHF=0:PS=0:CB=PB(0):PB(0)=235:PF(0)=255:PRINT@X(0)+PY(0)*32,CHR$(255);

1060 BO=0:FORT1=1TO20:IFPF(T1)=0THENBO=T1:T1=20:NEXT:GOTO1070
1066 NEXT:GOTO1075
1070 PY(BO)=RND(16)-1:IFPEEK(X(BO)+PY(BO)*32+M)<>175THEN1075
1073 PF(BO)=143:PRINT@(X(BO)+PY(BO)*32),CHR$(143);:PB(BO)=175

1075 IFHP=.THENPRINT@480,"ENOUGH! THIS IS THE END. AGAIN?";:GOTO5100

REM---LOOP ACTORS
1080 FORT=0TON:IFPEEK(X(T)+PY(T)*32+M)=159THENIFPF(T)=143THENPF(T)=0:PRINT@X(T)+PY(T)*32,CHR$(PB(T));
1090 IFT<>1THEN1100
1095 IFPS=2THENPS=3:T=T-1:GOTO1100
1096 IFPS=3THENHF=HF-.25:PS=2:IFHF<1THENHF=.

REM---CONTROL  
REM PLAYER
1100 TX=0:TY=0:IFTTHEN1115
1101 I$=INKEY$:IFPS>1THENIFI$="E"THENPS=0:CB=PB(0):PB(0)=235:PF(0)=255:PRINT@X(0)+PY(0)*32,CHR$(255);:NEXT
1111 IFPS<>1THEN1
1112 IFX(0)=31THENIFPB(0)=192THEN5000
1114 IFPS=0THENIFHS=0THENIFRND(4)=1THENSOUND1,2:TX=0:TY=0:NEXT
1115 IFPS=1THEN9

REM ZOMBIE
1120 IFPF(T)=143THEN30

REM HUMANS
1121 IFPF(T)=191THEN40
1123 IFPEEK(X(T)+PY(T)*32+M)=239THENPF(T)=0:PRINT@X(T)+PY(T)*32,CHR$(PB(T));
1124 IFPF(T)=191THENIFPEEK(X(T)+PY(T)*32+M)=159THENPF(T)=143:PRINT@X(T)+PY(T)*32,CHR$(PF(T));

REM IF PF(T)=143 AND PEEK(X(T)+PY(T)*32+M)=159 THEN PF(T)=00:PRINT@X(T)+PY(T)*32,CHR$(PB(T));

1127 IFX(T)+TX<0ORX(T)+TX>31THENTX=0
1128 IFPY(T)+TY<0ORPY(T)+TY>14THENTY=0

1130 TP=PEEK(X(T)+TX+(PY(T)+TY)*32+M)
1132 IFTP=191THENIFT=0THENHP=HP+1:PRINT@X(0)+TX+(PY(0)+TY)*32,CHR$(239);:TX=0:TY=0:NEXT
1134 IFTP=255THENIFPF(T)=143THENHP=HP-1:?@X(0)+PY(0)*32,CHR$(239);:SOUND1,1:PRINT@X(0)+PY(0)*32,CHR$(PF(0));
1136 IFTP=191THENIFPF(T)=143THENPRINT@X(T)+TX+(PY(T)+TY)*32,CHR$(159);:TX=0:TY=0

1137 IFTTHEN1144
1138 IFTP=235THENPRINT@X(T)+TX+(PY(T)+TY)*32,CHR$(CB);:PS=3:PF(0)=235:TP=192
1140 IFTP<>200THEN1144
1141 IFHK>0THEN50
1142 GOTO60

1144 IFTTHEN1200
1145 IFTP=19THENHS=HS+5:PRINT@X(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1146 IFTP=1THENHA=HA+5:PRINT@X(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1147 IFTP=11THENHK=HK+5:PRINT@X(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1148 IFTP=6THENHF=HF+5:PRINT@X(T)+TX+(PY(T)+TY)*32,P$(0);:TP=192
1150 IFPS<=1THEN1200
1151 IFTP=143THENPRINT@X(T)+TX+(PY(T)+TY)*32,CHR$(159);:HF=HF-5:NEXT
1155 IFTP<>192THENTX=0:TY=0:GOTO1100

REM WALK
1200 IFPF(T)THENIFTP=192ORTP=169ORTP=175ORTP=207THEN1250
1201 IFT=0THEN1100
1203 NEXT:GOTO1010

1250 PRINT@X(T)+PY(T)*32,CHR$(PB(T));:X(T)=X(T)+TX:PY(T)=PY(T)+TY
1260 PB(T)=PEEK(X(T)+PY(T)*32+M):PRINT@X(T)+PY(T)*32,CHR$(PF(T));:NEXT:GOTO1010

5000 LV=10THENPRINT@480,"YOU HAVE ESCAPED!              ";:GOTO1076
5010 LV=LV+1:GOTO152
5100 M$=INKEY$
5110 IFM$="Y"THENRUN
5120 IFM$="N"THENEND
5130 GOTO5100
