0 DIM SU(80):REM ARRAY TO HOLD THE CREATED SUDOKU
1 DIM CAN$,TMP$,N1$
2 DIM II,JJ,K,IND,BOX,INX
3 DIM ROW:REM AS INTEGER, COL AS INTEGER
4 DIM ARR(9):REM BOOLEAN
5 DIM I,J,LST,LES,SYC,CAC,R1:REM INTEGER
10 GOTO1000
100 CAN$="":IND=I
110 REM CONVERT ARRAY INDEX INTO A TABLE INDEX
120 ROW=INT(IND/9)
130 COL=IND-(ROW*9)
140 FOR JJ=1 TO 9:REM LOOP SYMBOLS 1 TO 9
150 ARR(JJ)=0:REM DEFAULT
160 REM CHECK PUZZLE ROW FOR AVAILABLE CANDIDATES
170 FOR II=(ROW*9) TO ((ROW*9)+8)
180 IF SU(II)=JJ THEN ARR(JJ)=-1
190 NEXT
200 REM CHECK PUZZLE COLUMN FOR AVAILABLE CANDIDATES
210 FOR II=COL TO (72+COL) STEP 9
220 IF SU(II)=JJ THEN ARR(JJ)=-1
230 NEXT
240 NEXT
250 REM CHECK BOX (3*3 GRID) FOR AVAILABLE CANDIDATES
260 BOX=(INT(IND/27)*27)+(INT(COL/3)*3)
270 FOR II=0 TO 2:REM ROW COUNTER
280 FOR JJ=0 TO 2:REM COLUMN COUNTER
290 INX=BOX+(II*9)+JJ
300 FOR K=1 TO 9:REM LOOP SYMBOLS 1 TO 9
310 IF SU(INX) = K THEN ARR(K)=-1
320 NEXT
330 NEXT
340 NEXT
350 REM RETURN CANDIDATES IN A STRING
360 FOR II=1 TO 9
370 IF ARR(II)=0 THEN CAN$=CAN$+RIGHT$(STR$(II),1)
380 NEXT:PRINT CAN$
390 RETURN
1000 SYC=0
1010 FOR J=1 TO 81:REM WE NEED ALL THE 81 SYMBOLS FOR A STANDARD 9*9 SUDOKU
1020 LES=10:REM SEED VALUE (HIGHER THAN NBR OF POSSIBLE CANDIDATES, I.E. 9)
1030 FOR I=0 TO 80:REM LOOP SUDOKU ARRAY TO FIND A CELL W/ LOWEST NBR OF CANDIDATES
1040 IF SU(I)<>0 THEN2000
1050 TMP$=""
1060 GOSUB 100
1070 CAC=LEN(TMP$)
1080 IF CAC=0 THEN 3000
1090 IF CAC<LES THEN LES=CAC:CAN$=TMP$:LST=I
1100 IF LEN(CAN$)=1 THEN SU(LST)=VAL(CAN$):GOTO 2000
1110 R1=RND(LES):N1$=MID$(CAN$,R1,1):SU(LST)=VAL(N1$)
2000 NEXT
2010 REM CHECK THE NUMBER OF SYMBOLS FOUND SO FAR ...
2020 FOR I=0 TO 80
2030 IF SU(I)>0 THEN SYC=SYC+1
2040 NEXT:PRINT"SYMBOL COUNT=";SYC
3000 IF SYC<>81 THEN 1000
3010 REM FINISHED
3020 C=0:FORY=1TO9:FORX=1TO9:PRINTSU(C);:C=C+1:NEXT:PRINT:NEXT
3030 END
4000 REM -----------------------------------------
4010 REM NOW WE SHOULD HAVE A SOLVED SUDOKU STORED
4020 REM IN AN ARRAY. REPLACE THE FOLLOWING
4030 REM CODE DEPENDING ON HOW YOU WILL IMPLEMENT
4040 REM YOUR GAME GUI. IN THIS DEMO WE WILL
4050 REM FILL THE SUDOKU GRID (TEXTBOX CONTROL ARRAY)
4060 REM WITH SYMBOLS ON FORM1
4070 REM FOR I = 0 TO 80
4080 REM    FORM1.TXTSYMBOL(I) = SU(I)
4090 REM NEXT
5000 REM ------------------------------------------
