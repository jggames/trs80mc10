1 CLS:CLEAR250
2 REM *** SUDOGEN: SUDOKU GENERATOR & COACH (C) VALENTIN ALBILLO, 2006
3 REM DESTROY ALL:OPTION BASE 1:STD
4 DIMA(9,9),P(9,9),S(9,9),D(9,9),E(9),L(9),Z(81,4),B$,TM(9,9),BP$(3)
5 GOSUB80
6 REM USER-DEFINED FUNCTIONS
7 REM
8 REM 
9 REM DEF FNW(X)=INT((U-1)/3)
10 REM DEF FNV  R=RND(0):V=(U+(R<.5)-3*INT((U+(R<.5))/3))+1+3*INT((U-1)/3)
11 REM
12 REM INITIALIZATION
13 REM
14 PRINT"INITIALIZING ...":FOR I=1 TO 9:K=3*INT((I-1)/3)+1
15 FOR J=1 TO 9:S(I,J)=K+INT((J-1)/3):NEXT J:E(I)=2^I:NEXT I
16 REM
17 REM REQUEST USER OPTIONS
18 REM
19 G=1:REM INPUT "GENER/COACH G/C";R$:IF R$="G" THEN 21
20 REM PRINT"ENTER PUZZLE: ":MAT INPUT D:GOTO 53
21 REM INPUT "CHECK SOLVE Y/N? : ","Y";R$:G=UPRC$(R$)="Y":M=62-11*G
22 INPUT "SYMMETRIC Y/N";R$:X=ABS(R$="Y"):IFX=0THENX=2
23 INPUT "BLANKS (1-51)";T
24 REM IF T<1 OR T>M OR FP(T) THEN 23
25 REM IF X AND (T-4*INT(T/4))>1 THEN 22
26 REM INPUT "PRINT SOLUT Y/N? : ","N";R$:H=UPRC$(R$)="Y"
27 REM INPUT "PRINT/PRINTP/D? : ","P";R$:Y=UPRC$(R$)="D"
28 REM
29 REM GENERATE PUZZLE
30 REM
31 FOR I=1 TO 9:L(I)=I:NEXT I
32 FOR K=1 TO 20:I=RND(9):J=RND(9):U=L(I):L(I)=L(J):L(J)=U:NEXT K
33 FORR=1TO3:PRINTBP$(R):NEXT:PRINT:R=RND(3):B$=BP$(R):GOSUB68
34 FOR K=0 TO 80:I=(K-2*INT(K/2))+1
35 A(INT(K/9)+1,(K-9*INT(K/9))+1)=L(VAL(MID$(STR$(ASC(MID$(B$,INT(K/2)+1,1))-23),I+1,1))):NEXT K
36 FOR K=1 TO 20
37 U=RND(9):R=RND(0):V=(U+(R<.5)-3*INT((U+(R<.5))/3))+1+3*INT((U-1)/3):FOR I=1 TO 9:N=A(I,U):A(I,U)=A(I,V):A(I,V)=N:NEXT I
38 U=RND(9):R=RND(0):V=(U+(R<.5)-3*INT((U+(R<.5))/3))+1+3*INT((U-1)/3):FOR J=1 TO 9:N=A(U,J):A(U,J)=A(V,J):A(V,J)=N:NEXT J
39 NEXT K:W=0:IF RND(0)<.5 THEN FORA=1TO9:FORB=1TO9:TM(B,A)=A(A,B):NEXT:NEXT:FORA=1TO9:FORB=1TO9:A(A,B)=TM(A,B):NEXT:NEXT
40 W=W+1:PRINT" GEN ";STR$(W):FORA=1TO9:FORB=1TO9:D(A,B)=A(A,B):NEXT:NEXT
41 FORB=1TO9:FORA=1TO9:PRINTSTR$(A(A,B));:LPRINTSTR$(A(A,B));:NEXT:PRINT:LPRINT:NEXT:PRINT:PRINT:GOSUB68:PRINT:PRINT
42 LPRINT:LPRINT:ON X GOSUB 64,60
43 FORB=1TO9:FORA=1TO9:PRINTSTR$(D(A,B));:LPRINTSTR$(D(A,B));:NEXT:PRINT:LPRINT:NEXT:LPRINT:LPRINT
44 END
58 REM SUBROUTINES: BLANK, SYMMETRIC BLANK, WAIT KEY, OUTPUT HINTS
59 REM
60 FOR K=1 TO T
61 I=RND(9):J=RND(9):IF D(I,J) THEN D(I,J)=0:NEXT K:RETURN
62 GOTO61
63 REM
64 IF T-2*INT(T/2) THEN D(5,5)=0
65 FOR K=1 TO INT(T/4)
66 I=RND(9):J=RND(9):IF I=5 OR J=5 OR D(I,J)=0 THEN 66
67 D(I,J)=0:D(I,10-J)=0:D(10-I,J)=0:D(10-I,10-J)=0:NEXT K:RETURN
68 PRINT"HIT A KEY":REM PAUSE
69 R$=INKEY$:IF R$="" THEN 69
70 RETURN
71 PRINT"NO MORE FORCED VALUES":FOR N=2 TO 9:FOR U=1 TO K:IF Z(U,3)<>N THEN 76
72 I=Z(U,1):J=Z(U,2):W=Z(U,4)
73 PRINT"[";STR$(I);"-";STR$(J);"] ADMITS ";
74 FOR V=1 TO 9:IF NOT BIT(W,V) THEN PRINTSTR$(V);
75 NEXT V:PRINT:GOSUB 69
76 NEXT U:NEXT N:RETURN
77 REM
78 REM DATA FOR BASE PUZZLE CLASSES
79 REM
80 BP$(1)="Xi^Bs$pFOFtX)4/Xj(O^Bso6scD)P;4FAJyV>WiP!"
81 BP$(2)=CHR$(91)+",>Db@Z3tx9Q#Z*K;kBQTx-"+CHR$(91)+"u"+CHR$(96)+"&&Uk"+CHR$(96)+"tu^K"+CHR$(91)+"i"+CHR$(96)+"wM."
82 BP$(3)="7*Mck"+CHR$(92)+"i"+CHR$(96)+"JQ^;H1Q/r"+CHR$(96)+"u;^iP#=OH*P"+CHR$(91)+".G;H0(2D$yS"
83 RETURN
