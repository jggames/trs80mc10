0 DIMC1,C2,M$:M=16384:GOTO10
7 C1=(PEEK(17024)AND1)*256+PEEK(17025)+16383:FORC2=1TOLEN(M$):POKEC1+C2,ASC(MID$(M$,C2))AND63:NEXT:?@C1-M+C2,:RETURN
10 REM INITIALIZE
30 CLS:PRINT@7*32+12,"SOLITAIRE":PRINT:PRINT@486,"HIT ANY KEY TO START";
40 A=RND(0):A$=INKEY$:IFA$=""THEN40
41 CLS:F5=1:C=52:W=1
50 DIM P(4,13),D(52),T(52):GOSUB770:PRINT@7*32+10,"SHUFFLING...":GOSUB820
60 PRINT@7*32+10,"DEALING..."
70 FORI=1TO4:FORJ=1TO13:GOSUB870:NEXTJ:NEXTI:GOSUB950
75 GOTO75
80 PRINT@0*32+26," mOVE ";
90 PRINT@1*32+26," pLACE";
100 IFW=5THENW=1:F1=0:GOSUB980:IFF1=0THEN520
110 I=INT(E(W)-1)/13)+1:J=E(W)-13*INT((E(W)-1)/13)
120 IFJ=1THEN150
130 LL=P(I,J-1):IFLL/13=INT(LL/13)THENW=W+1:GOTO100
140 IFLL=1ORLL=14ORLL=27ORLL=40THENW=W+1:GOTO100
150 N$=CHR$(8):N1$=" ":S$="  ":GOSUB940
160 X$=INKEY$:IFX$=""THENGOSUB940
170 IFX$<>""THEN190
180 X$=INKEY$:IFX$=""THENGOSUB940:GOTO160
190 IFX$="P"THEN210
200 IFX$="M"THENN$=" ":GOSUB940:W=W+1:GOTO100
201 GOTO160
210 IFJ=1THEN340
220 LL=P(I,J-1)
230 IFLL/13=INT(LL/13)THEN160
240 IFLL=1ORLL=14ORLL=27ORLL=40THEN160
250 TE=P(I,J):TT=T(P(I,J)):L=T(P(I,J-1)+1)
260 T(P(I,J)=T(P(I,J-1)+1
270 T(P(I,J-1)+1)=TT
280 P(I,J)=P(INT((L-1)/13+1),L-13*INT((L-1)/13))
290 P(INT((L-1)/13)+1,L-13*INT((L-1)/13))=TE
300 GOSUB870
310 I=INT((L-1)/13)+1:J=L-13*INT((L-1)/13):GOSUB870
320 GOSUB950:W=1:GOTO100
330 REM OFFER CHOICE OF TWOS
340 PRINT@416,;
350 PRINT "NOW YOU HAVE A CHOICE OF"
360 PRINT "WHICH '2' YOU WANT TO PLACE"
370 PRINT "TWO OF 'S','H','D',OR 'C'"
380 T$=INKEY$:IFT$=""THEN380
390 IFT$="S"THENN2=2:GOTO450
400 IFT$="H"THENN2=15:GOTO450
410 IFT$="D"THENN2=28:GOTO450
420 IFT$="C"THENN2=41:GOTO450
430 GOTO380
440 REM NOW EXCHANGE LOCATION 
450 TE=P CI,J1: TT= T(P(I,J11:L= TCN2> 
460 T(P(I,J11=T CN2> FH 470 	T CN2> mTT
480 LOCATE 21 , 1
490 FOR A=1 TO 3: PRINT " ":NEXT
500 GOTO 280
510 REM PLAYER CANNOT MOVE SO RESHUFFLE
520 FOR I= 1 TO 4: N C I 1 =0
530 IF PC1,)) < >2 AND PC1 , )) <> 15 AND P(I,))<>28 AND P(I ,))<>41 THEN 580
540 N C I 1 = 1 
550 FOR J=2 TO 12:1F PC1,J1-1 <>PC1,J-1) THEN J=141GOTO 570
560 NC I> =N < I 1 + 1
570 NEXT J
580 NEXT I 
590 IF NC11 =12 AND NC21=12 AN D NC31=12 AND NC41=12 THEN 1040
600 F5=F5+1
610 REM ERASE THE WRONG ENTRI ES
620 LOCATE 1,1:FOR A= 1 TO 2:P RINT " ";:NE XT
630 N$=" ":S$=" ":LOCATE 1: 11 COLOR 1,3,12:PRINT TABC13 ); " RESHUFFLING=== "
640 FOR 1=1 TO 52: D<I1 = I:NEXT
650 FOR 1=1 TO 4:FOR J=NC11+1 TO 13:GOSUB 940:NEXT J,I
660 C3=52: FOR I=1 TO 4
670 IF N<))=0 THEN 690
680 FOR J=1 TO NC11:DCPC1 , J1 1 =01NEXT J
690 NEXT I
700 FOR I =1 TO 4:FOR J = 1+NCi1 TO 13
710 R1=1NT CRND ( 11 =C3+11
720 IF DCR11=0 THEN DCR))=D<C 31:C3=C3-1:GOTO 710
730 P(I,J1 =DCR11 :DCR11 =DCC31: C3=C3-11NEXT J,I
740 FOR II=1 TO 52:T<II>=0:NEXT
750 GOSUB 850: GOTO 60
760 REM SET UP BOXES
770 REM
780 REM
790 REM
800 RETURN
810 REM SET UP DECK
820 FORI=1TO52:D(I)=I:NEXT
830 FORI=1TO4:FORJ=1TO13:R1=INT(RND(0)*C+1):P(I,J)=D(R1):D(R1)=D(C):C=C-1
840 NEXT:NEXT
850 FORII=1TO4:FORJJ=1TO13:T(P(II,JJ))=(II-1)*13+JJ:NEXT:NEXT:RETURN
860 REM SHOW CARD
870 S$=MID$("ßÚ»º·²×Ò",INT((P(I,J)-1)/13)*2+1,2):S1$=MID$("Ô´´Ô",INT((P(I,J)-1)/13)+1,1)
880 REM
890 N=P(I,J)-13*INT((P(I,J)-1)/13)
900 IFN=1THENS$=" "
910 N$=MID$(" 23456789TJQK",N,1)
920 GOSUB940:RETURN
930 REM LOCATE CARD POSITION
940 PRINT@32*(I*2)+J*2,S$;:PRINT@32*(I*2)+J*2+32,S1$;:M$=N$:GOSUB7:RETURN
950 Z=1:FORI=1TO52STEP13:E(Z)=T(I):Z=Z+1:NEXT
960 FORJ=1TO4:FORI=1TO3:IFE(I)>E(I+1)THENAA=E(I):E(I)=E(I+1):E(I+1)=AA
970 NEXTI,J:RETURN
980 FOR K=1 TO 4
990 X= INT((E(K1-1)/13+11:Y=E< K1-13*INT(<E<K1-1)/13)
1000 IF Y=1 THEN F1=1 
1010 W2=P<X,Y-11:IF W2<>1 AND W2<>14 AND W2<>27 AND W 2<>40 AND W2/13<>INT(W2/ 13! THEN F1=1
1020 NEXT:RETURN
1030 REM YOU WON
1040 LOCATE 21,13:COLOR 14,3, 12:PRINT "CONGRATULATION S! ! II
1050 PRINT SPC<161 "YOU WON!'" :PRINT SPC < 1)) "IT TOOK y OU";F51"TRIES"
1060 PRINT SPC(101 "TYPE 'Y' T 0 PLAY AGAIN"= IN 1010 X$=INKEY=: IF X$="Y" THEN 30 ELSE IF X$="N" THEN END ELSE GOTO 1070



REM µ·Õß±»ÑÛ€€€€€€€€€€€€€€€€€€€€€
REM ¸Ø¸Ø€€€€€€€€€€€€€€€€€€€€€



REM ßÚ»º·²×Ò€€€€€€€€€€€€€€€€€€€€€€€€
REM Õ´´Õ€€€€€€€€€€€€€€€€€€€€€€€€
