10 POKE65495,1:PMODE4,1:DIMEX(15,10):DIMEY(15,10):DIMK(15):PCLS:DIMX(15):DIMY(15):DIMBX(64):DIMBY(64):M=85:N=77:PP=3.14 /8:FORI=0TO15:SQ=SIN(I*PP):CQ=COS(I*PP):R=RND(0)*.3+.7:X(I)=SQ*M*R+120:Y(I)=CQ*M*R+100:BX(I)=SIN((I+.5)*PP)*M+120
20 BY(I)=COS((I+.5)*PP)*M+100:BX(I+16)=SIN((I+.3)*PP)*N+120:BY(I+16)=COS((I+.3)*PP)*N+100:BX(I+32)=SIN((I+.7)*PP)*N+120:BY(I+32)=COS((I+.7)*PP)*N+100:NEXT:FORI=0TO15:LINE(X(I),Y(I))-(120,100),PSET:LINE(X(I),Y(I))-(X((I+1)AND15),Y((I+1)AND15)),PSET
30 FORJ=1TO9:EX(I,J)=SIN((I+.5)*PP)*M*J/10+120:EY(I,J)=COS((I+.5)*PP)*M*J/10+100:NEXT:NEXT:SCREEN1,1:GOTO 80
65 IFKC=15 THEN F=0:GOTO 610::ELSEA$=INKEY$:IFA$=" " THENGOTO600:ELSEIFA$="" THENGOTO100:ELSE LINE(BX(P),BY(P))-(BX(P+16),BY(P+16)),PRESET:LINE(BX(P),BY(P))-(BX(P+32),BY(P+32)),PRESET:Q=P:IFA$="A" THENP=P-1:ELSEIFA$="D" THENP=P+1
80 P=P AND 15:P=K(P)*Q+P*(1-K(P)): LINE(BX(P),BY(P))-(BX(P+16),BY(P+16)),PSET:LINE(BX(P),BY(P))-(BX(P+32),BY(P+32)),PSET
100 A=INT(RND(0)*11):S=S+(15-KC):Z=0:IFA>C THENEP(C)=INT(RND(0)*16):D(C)=1:A=C:C=C+1:F=400:GOSUB610:GOTO65:ELSE IFK(EP(A)) THENEP(A)=(EP(A)+1)AND15:D(A)=4:GOTO65:ELSE CIRCLE(EX(EP(A),D(A)),EY(EP(A),D(A))),15/(11-D(A)),0
140 B=INT(RND(0)*4):IFB=0 THENEP(A)=EP(A)-1:ELSEIFB=1 THENEP(A)=EP(A)+1:ELSED(A)=D(A)+B-1
145 F=400:EP(A)=EP(A)AND15:IFD(A)>9 THENFORI=1TO9:CIRCLE(EX(EP(A),I),EY(EP(A),I)),20/(10-I),1:NEXT:K(EP(A))=1:KC=KC+1:D(A)=1:GOSUB610:GOTO65:ELSEGOSUB610:GOTO65
600 F=600:LINE(BX(P),BY(P))-(120,100),PSET:FORA=0TOC:IFP=EP(A) THENZ=1:CIRCLE(EX(EP(A),D(A)),EY(EP(A),D(A))),15/(11-D(A)),0:EP(A)=(EP(A)+5)AND15:D(A)=1:NEXT:ELSENEXT
610 IF F=600 THEN LINE(BX(P),BY(P))-(120,100),PRESET:GOTO100:ELSE IF F=400 THEN CIRCLE(EX(EP(A),D(A)),EY(EP(A),D(A))),15/(11-D(A)),1:RETURN:ELSE PRINT"GAME OVER,SCORE:",S