0 CLS:CLEAR400:DIMT,A,G,I,J,M$,P(5),C$(5),C(5),M$(10),L(10,1),Z(12,1):C=127:I=64:J=47:GOTO12
1 GOSUB304:GOSUB309:GOSUB7:CHAIN"AKALABET",166
2 GOSUB304:GOSUB150:GOSUB7:CHAIN"AKALABET",166
5 PRINTM$;:A=((PEEK(384)AND1)*256+PEEK(385))+16383:FORT=A-LEN(M$)+1TOA:POKET,PEEK(T)-I:NEXT:RETURN
7 IFG1THENLINE(0,0)-(255,159),0,BF:RETURN
9 Q$=INKEY$:IFQ$=""THEN9
10 RETURN
12 GOSUB297:LE=0:G1=0:PRINT@198,"WELCOME TO AKALABETH,":PRINT@233,"WORLD OF DOOM!"
13 DIMD(10,10),T(20,20),X(10),Y(10),E(10,3),Q(10,5),R(10,3),F(10,5),A(10,3)
14 FORX=0TO20:T(X,0)=1:T(0,X)=1:T(X,20)=1:T(20,X)=1:NEXT:PRINT@448,"PLEASE WAIT";
15 FORX=1TO19:FORY=1TO19:T(X,Y)=INT(RND(0)^5*4.5):IFRND(0)>.5THENIFT(X,Y)=3THENT(X,Y)=0
16 NEXT:PRINT".";:NEXT
17 T(INT(RND(0)*19+1),INT(RND(0)*19+1))=5:TX=INT(RND(0)*19+1):TY=INT(RND(0)*19+1):T(TX,TY)=3
18 X(0)=C:Y(0)=79
19 FORX=2TO20STEP2:X(X/2)=INT(ATN(1/X)/ATN(1)*128+.5):Y(X/2)=INT(X(X/2)*4/7):E(X/2,0)=C-X(X/2):E(X/2,1)=C+X(X/2):E(X/2,2)=79-Y(X/2):E(X/2,3)=79+Y(X/2):NEXT
20 E(0,0)=0:E(0,1)=255:E(0,2)=0:E(0,3)=159
21 FORX=1TO10:R(X,0)=C-X(X)/3:R(X,1)=C+X(X)/3:R(X,2)=79-Y(X)*.7:R(X,3)=79+Y(X):NEXT:PRINT".";
22 FORX=0TO9:Q(X,0)=(E(X,0)*2+E(X+1,0))/3:Q(X,1)=(E(X,0)+2*E(X+1,0))/3:W=Q(X,0)-E(X,0):Q(X,2)=E(X,2)+W*4/7:Q(X,3)=E(X,2)+2*W*4/7:Q(X,4)=(E(X,3)*2+E(X+1,3))/3:Q(X,5)=(E(X,3)+2*E(X+1,3))/3
23 Q(X,2)=Q(X,4)-(Q(X,4)-Q(X,2))*.8:Q(X,3)=Q(X,5)-(Q(X,5)-Q(X,3))*.8:IFQ(X,3)=Q(X,4)THENQ(X,3)=Q(X,3)-1
24 NEXT
25 FORX=0TO9:F(X,0)=C-X(X)/3:F(X,1)=C+X(X)/3:F(X,2)=C-X(X+1)/3:F(X,3)=C+X(X+1)/3:F(X,4)=79+(Y(X)*2+Y(X+1))/3:F(X,5)=79+(Y(X)+2*Y(X+1))/3:NEXT
26 FORX=0TO9:A(X,0)=(F(X,0)*2+F(X,1))/3:A(X,1)=(F(X,0)+2*F(X,1))/3:A(X,3)=F(X,4):A(X,2)=159-A(X,3):NEXT
27 CHAIN"AKALABET",28

150 PRINT@480,;:M$="PRESS ENTER TO CONTINUE":GOSUB5
151 Q$=INKEY$:ON-(Q$<>CHR$(13))GOTO151:RETURN

277 FORG=1TO2000:NEXT:SCREEN0,0:CLS:PRINTTAB(5)"WE MOURN THE PASSING OF":IFLEN(PN$)>12THENPN$=""
278 IFPN$=""THENPN$="THE PEASANT"
279 PN$=PN$+" AND HIS COMPUTER"
280 PRINTTAB((32-LEN(PN$))/2)PN$:PRINT:M$="FOR RESURRECTION, PRESS R":GOSUB5
281 IFINKEY$="R"THENRUN ELSE 281

282 SCREEN0,0:CLS:G1=.:IFPN$<>""THEN289
283 PRINT"WELCOME PEASANT TO THE HALLS OF":PRINT"MIGHTY LORD BRITISH!"
284 PRINT:INPUT"WHAT IS THY NAME";PN$
285 PRINT:PRINT"THY FIRST TASK IS TO GO TO":PRINT"THE DUNGEONS AND RETURN AFTER":TA=INT(C(4)/3):IFTA>10THENTA=10
286 PRINT"KILLING A(N) "M$(TA)
287 PRINT:PRINT"ALSO I, BRITISH, HAVE INCREASED":PRINT"EACH OF THY ATTRIBUTES BY ONE!"
288 FORX=0TO5:C(X)=C(X)+1:NEXT:GOSUB150:CLS:CHAIN"AKALABET",166
289 IFTA>0THENPRINTPN$"!?":PRINT"WHY HAST THOU RETURNED?":PRINT"THY QUEST IS TO KILL A(N)":PRINTM$(TA):GOSUB150:CLS:CHAIN"AKALABET",166
290 PRINT"THY QUEST IS ACOMPLISHED!":IFABS(TA)=10THEN293
291 PRINT"BUT IT IS STILL NOT ENOUGH TO":PRINT"BECOME A KNIGHT. THOU MUST NOW":TA=ABS(TA)+1:PRINT"KILL A(N) "M$(TA)
292 GOTO287
293 PRINT:PN$="LORD "+PN$:PRINTPN$","
294 PRINT"YOU HAVE EARNED A KNIGHTHOOD!"
295 PRINT:IFLP=10THENPRINT"CONGRATULATIONS!":GOTO288
296 PRINT"BE THOU FOOLHEARTY ENOUGH TO":PRINT"TRY DIFFICULTY LEVEL"STR$(LP+1)"?":GOTO288

297 SCREEN0,0:CLS:G1=.:INPUT"TYPE THY LUCKY NUMBER";Q$:LN=VAL(Q$):PRINT:INPUT"LEVEL OF PLAY (1-10)";Q$:LP=INT(VAL(Q$)):IFLP<1ORLP>10THEN297
298 G=RND(-ABS(LN)):FORX=0TO5:READC$(X):NEXT:FORX=1TO10:READM$(X):NEXT
299 DATA"HP ",STR,DEX,STA,WIS,"GP "
300 DATASKELETON,THIEF,GIANT RAT,ORC,VIPER,CARRION CRAWLER,GREMLIN,MIMIC,DAEMON,BALROG,FOOD,RAPIER,AXE,SHIELD,BOW AND ARROWS,MAGIC AMULET
301 FORX=0TO5:C(X)=INT(SQR(RND(0))*21+4):NEXT:PRINT@128,;:FORX=0TO5:PRINTC$(X)C(X):NEXT:PRINT@352,"PLAY THOU WITH THESE QUALITIES?":GOSUB9:IFQ$<>"Y"THEN301
302 PRINT@352,"BE THOU A FIGHTER OR A MAGE?":GOSUB9:IFQ$<>"M"ANDQ$<>"F"THEN302
303 PT$=Q$:DIMW$(5):FORX=0TO5:READW$(X):NEXT:GOSUB304:GOSUB309:RETURN

304 SCREEN0,0:CLS:G1=.
305 PRINT@2,"STAT'S":PRINT@20,"WEAPONS":FORX=0TO5:PRINT@(X+1)*32,C$(X)C(X)TAB(11)RIGHT$("     "+STR$(INT(P(X))),5)TAB(17)W$(X);:NEXT
306 PRINT@480,;:M$="Q=QUIT":GOSUB5:PRINT"                         ";
307 PRINT@256,"PRICE"TAB(9)"DAMAGE"TAB(17)"ITEM"
308 PRINT"1 FOR 10"TAB(9)"N/A"TAB(17)W$(0):PRINT"8"TAB(9)"1-10"TAB(17)W$(1):PRINT"5"TAB(9)"1-5"TAB(17)W$(2):PRINT"6"TAB(9)"1"TAB(17)W$(3):PRINT"3"TAB(9)"1-4"TAB(17)W$(4):PRINT"15"TAB(9)"?"TAB(17)W$(5):RETURN

309 PRINT@224,"":PRINT@224,;:M$="WHAT DOST THOU WANT? ":GOSUB5:GOSUB9:IFQ$="Q"THENCLS:G1=.:RETURN
310 Z=-1
311 IFQ$="F"THENPRINT"FOOD":Z=.:PR=1
312 IFQ$="R"THENPRINT"RAPIER":Z=1:PR=8
313 IFQ$="A"THENPRINT"AXE":Z=2:PR=5
314 IFQ$="S"THENPRINT"SHIELD":Z=3:PR=6
315 IFQ$="B"THENPRINT"BOW":Z=4:PR=3
316 IFQ$="M"THENPRINT"AMULET":Z=5:PR=15
317 PRINT@487,;:IFZ=-1THENPRINT"WE DON'T HAVE THAT.     ";:GOTO309
318 IF(Q$="R"ORQ$="B")ANDPT$="M"THENPRINT"MAGES CAN'T USE THAT!   ";:GOTO309
319 IFC(5)-PR<0THENPRINT"THOU CANNOT AFFORD THAT.";:GOTO309
320 IFZ=0THENP(Z)=P(Z)+9
321 P(Z)=P(Z)+1:C(5)=C(5)-PR:GOSUB305:GOTO309
