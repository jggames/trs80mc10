10 'ALIEN ATTACK':BY PETER LEAR ADAPTED FOR 16K TRS-80 EXTENDED COLOR COMPUTER BY SCOTT MCCANN
20 DIMA(5,5),B(9,9),C(10,10),M(8),D(9,9)
30 CLS:PRINT@10,"ALIEN ATTACK"
40 PLAY"T12DEFDEFP5DEFP5DEFGGP2DEFFEEFFGFDFGEDT255T255"
50 PRINT:PRINT" - SHIELDS REPLACED WHEN           INDICATOR REACHES TOP.":PRINT
70 RESTORE
80 XX=0:YY=0:X=0:Y=0
90 FORJ=1TO8:READU(J),V(J):NEXT
100 FORI=1TO8:READN(I):NEXT
110 A$="qTYUJMNBG"
120 REM INPUT"(1) JOYSTICKS OR (2) KEYS"; A:IFA<>1ANDA<>2THEN120
121 A=2
130 PRINT" - TO FIRE USE:":PRINT"   TYU":PRINT"   G J":PRINT"   BNM":PRINT:PRINT" - 9=EASY AND 1=HARD":PRINT
131 INPUT"SHOTS FACTOR (1-9)";JJ:IFJJ>9ORJJ<1THEN131
140 CLS:PRINT@236,"GOOD LUCK";:TIMER=0
150 SC=0:CS=0
152 FORW=1TO8:M(W)=0:NEXT
160 PMODE4,1:PCLS
190 DRAW"BM40,40NF9BD5NR9BD4NE9BR4NU9BR4NH9":LINE(42,42)-(47,47),PSET,BF:GET(40,40)-(49,49),D,G
200 DRAW"BM21,20R3F1L4D1R4D1L4F1R3":GET(21,20)-(26,25),B,G
210 DRAW"BM43,40ND10R1ND10BR2ND10R1D10":GET(40,40)-(50,50),C,G
220 PCLS:GOSUB780
230 DRAW"BM4,36S4NR5D120R5U120BR2NR7NE2F2"
240 SCREEN1,1
250 FORDD=1TOJJ:I=INSTR(A$,INKEY$)
260 IFI>1THENI=I-1:GOTO430
270 NEXT:GOTO560
430 X=U(I)*1.3+128:Y=V(I)*1.3+96:DRAW"BM"+STR$(X-2)+","+STR$(Y-2)+";S4G2R4H2D2G2E2F2":PLAY"O4EDF"
440 XX=128+9.8*U(I):YY=96+9.8*V(I)
450 PUT(XX-2,YY-2)-(XX+2,YY+2),B,PSET:LINE(XX-2,YY-2)-(XX+2,YY+2),PRESET,BF
460 XX=XX+U(I):YY=YY+V(I):IFXX<42ORXX>220ORYY<5ORYY>182THEN520
470 IFPPOINT(XX,YY)<>5THEN450
490 IFI/2=INT(I/2)THENS=75ELSES=50
500 SC=SC+S:CS=CS+S:M(I)=0:IFSC>1199THENGOSUB780:SC=0:LINE(6,156)-(7,37),PRESET,BF:PLAY"O2DO4DO2DO4DO3DFO1DFEGO4DEFGO2DEFFGO1DFFGCCA"
510 PLAY"O1FDE"
520 LINE(X-2,Y-2)-(X+2,Y+2),PRESET,BF
530 X=U(I)*17+128:Y=V(I)*17+96:LINE(X-5,Y-5)-(X+4,Y+4),PRESET,BF
540 LINE(6,156)-(7,156-INT(SC/10)),PSET,BF
550 GOTO270
560 FORDD=3TOJJ/3STEP-1:J=RND(8):IFM(J)=2THEN630
580 IFM(J)=1THENM(J)=2:GOSUB620
590 IFM(J)=0THENM(J)=1
600 NEXT:GOTO250
620 X=U(J)*17+128:Y=V(J)*17+96:PUT(X-5,Y-5)-(X+4,Y+4),D,PSET:RETURN
630 XX=U(J)*14+128:YY=V(J)*14+96:I=N(J)
650 LINE(XX,YY)-(XX+U(I)/5,YY+V(I)/5),PSET:LINE(XX,YY)-(XX+U(I)/5,YY+V(I)/5),PRESET
660 IFH THENH=0:LINE(XX-6,YY-6)-(XX+6,YY+6),PSET,BF:LINE(XX-6,YY-6)-(XX+6,YY+6),PRESET,BF:PLAY"O1FF":GOTO580
670 IFXX=128THENIFYY=96THEN700
680 XX=XX+U(I)*2:YY=YY+V(I)*2:IFPPOINT(XX,YY)ORPPOINT(XX+U(I),YY+V(I))THENH=1
690 GOTO650
700 FORW=1TO44:SCREEN1,RND(2)-1:NEXT:SCREEN1,1
710 FORW=1TO18:PLAY"V"+STR$(W+12)+"O1C":CIRCLE(128,96),W,5:NEXT:FORW=18TO1STEP-1:PLAY"V"+STR$(W+12)+"DC":CIRCLE(128,96),W,0:NEXT
720 DRAW"BM125,93S4":GOSUB180:FORW=1TO100:NEXT:FORW=1TO36STEP4:DRAW"BM125,93;S"+STR$(W):GOSUB180:NEXT
730 PCLS:CLS:FORW=1TO50:NEXT:SCREEN1,0:PRINT@0,"TIME";INT(TIMER/60),"SCORE";CS:M$=INKEY$
740 IFCS>S(JJ)THENS(JJ)=CS
750 M$=INKEY$:PRINT:PRINTTAB(10)"high scores":PRINT:FORW=1TO9:PRINT"LEVEL"W;TAB((16-LEN(STR$(S(W)))/2));S(W):NEXT:FORW=1TO1000
760 M$=INKEY$:IFM$="C"THEN30ELSEIFM$=CHR$(13)THENCLS:GOTO140
765 PRINT@448,"PRESS <C> TO CHANGE SHOTS FACTOR"
770 PRINT@480,"PRESS <ENTER> TO PLAY AGAIN";:GOTO760
780 FORW=4TO12STEP4
790 DRAW"BM128,96;S"+STR$(W)+";BU15R5F10D10G10L10H10U10E10R5"
800 NEXT:RETURN
810 DATA -5,-5,0,-5,5,-5,5,0,5,5,0,5,-5,5,-5,0
820 DATA 5,6,7,8,1,2,3,4
