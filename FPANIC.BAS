0 SOUND176,1:CLS:GOTO4500
5 FORC1=1TOLEN(M$):PRINTMID$(AL$,(ASC(MID$(M$,C1,1))-31)*2,2);:NEXT:RETURN
6 FORC1=1TOLEN(M$):PRINTMID$(A1$,(ASC(MID$(M$,C1,1))-31)*2,2);:NEXT:RETURN
10 C1=K+K+K+(L+L)*32:PRINT@C1,MID$(F1$,P*3+1,3);:PRINT@C1+32,MID$(F2$,P*3+1,3);
20 RETURN
49 REM ### PUT MAZE ###
50 F=0:FORK=0TO8:FORL=0TO7
60 P=P(K,L):IFP=0THEN90
70 GOSUB10:F=F-(P=2)
80 IFP=6THENX=K:Y=L
90 NEXT:NEXT:RETURN
299 REM ### TITLE PAGE ###
300 CLS0:PRINT@4+32*2,;:M$="FRUIT PANIC":GOSUB5
310 FORI=1TO24
320 NEXT
370 P=2:FORI=0TO9:FORC1=1TO25:NEXT
380 K=I:L=0:GOSUB10:K=9-I:L=2:GOSUB10:NEXT
390 L=1:GOSUB10:K=9:GOSUB10
400 PRINT@8*32+4,;:M$="TOM":GOSUB5:PRINT@8*32+22,;:M$="HOME":GOSUB5
401 PRINT@10*32+4,;:M$="WALL":GOSUB5:PRINT@10*32+22,;:M$="YUM":GOSUB5
402 PRINT@12*32+4,;:M$="KEY":GOSUB5:PRINT@12*32+22,;:M$="ROCK":GOSUB5
430 ZZ=0:FORL=3.5TO5.5:FORK=0TO6STEP6
440 ZZ=ZZ+1:P=TP(ZZ):GOSUB10:NEXT:NEXT
460 PRINT@14*32,;:M$="1":GOSUB5:M$="MAKE ":GOSUB6:M$="3":GOSUB5:M$="LOAD ":GOSUB6:M$="PLAY":GOSUB6
470 PRINT@15*32,;:M$="2":GOSUB6:M$="CONT ":GOSUB5:M$="4":GOSUB6:M$="SAVE ":GOSUB5:M$="SPC":GOSUB5
471 J=300:GOSUB800:IFHTHEN900
480 FORI=7TO11STEP2:PRINT@I*32,"€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€";
500 NEXT
509 REM ### DEMO MODE ###
510 FORI=0TO8:FORJ=0TO2:P(I,J)=0:NEXT
520 P(I,7)=0:NEXT
540 P(0,3)=3:P(1,3)=3:P(2,3)=3:P(3,3)=3:P(4,3)=3:P(5,3)=3:P(6,3)=5:P(7,3)=3:P(8,3)=3
550 P(0,4)=4:P(1,4)=2:P(2,4)=0:P(3,4)=2:P(4,4)=0:P(5,4)=2:P(6,4)=0:P(7,4)=2:P(8,4)=3
560 P(0,5)=3:P(1,5)=0:P(2,5)=2:P(3,5)=0:P(4,5)=2:P(5,5)=0:P(6,5)=2:P(7,5)=6:P(8,5)=3
570 P(0,6)=3:P(1,6)=3:P(2,6)=3:P(3,6)=3:P(4,6)=3:P(5,6)=3:P(6,6)=3:P(7,6)=3:P(8,6)=3
580 GOSUB50:Z=1:Q=0:P(X,Y)=0
581 KX=0:KY=4
582 RESTORE:FORI=0TO30:READA:V=(A=0)-(A=1):W=(A=2)-(A=3)
584 J=50:GOSUB800:IFHTHEN900
585 GOSUB1110:NEXT
600 J=200:GOSUB800:IFHTHEN900
620 GOTO300
799 REM ### GET KEY ###
800 H=0
810 FORK=1TOJ:A$=INKEY$
820 IFA$>"0"ANDA$<"5"ORA$=" "THENK=J:H=VAL(A$)+1
830 NEXT:RETURN
899 REM ### MENU ITEM SELECTED ###
900 CLS0:CH=5
910 IFH>3THEN4000
920 IFH=1THENM=0:GOTO1000
930 PRINT@2+5*32,;
935 IFH=2THENM$="  EDIT WHICH":GOSUB5
940 IFH=3THENM$="CONTINUE WHICH":GOSUB5
950 PRINT@10+8*32,:M$="MAZE":GOSUB5
960 PRINT@20+8*32,;:M$=STR$(M+1)+" ":GOSUB5:A$=INKEY$:IFA$=""THEN960
970 IFA$=CHR$(13)THEN1000
980 S=ASC(A$+"*"):M=M+((S=65ORS=45ORS=90)ANDM>0)-((S=83ORS=43ORS=87)ANDM<HM):GOTO960
999 REM ### PLAY GAME ###
1000 CLS0:FORI=0TO8:P(I,0)=3:P(I,7)=3
1002 IFI<7THENP(0,I)=3:P(8,I)=3
1003 NEXT:PRINT@9+7*32,;:M$="MAZE"+STR$(M+1):GOSUB5:FORZZ=1TO500:NEXT
1005 I=0
1010 FORY=1TO6:FORX=1TO7:P(X,Y)=R(M,I)
1020 I=I+1:NEXT
1030 NEXT:CLS0:K=R(M,43):KY=INT(K/9)
1040 KX=K-KY*9:P(KX,KY)=4:A=INT(R(M,42)/9)
1050 P(R(M,42)-A*9,A)=5
1060 IFH=2THEN3000
1070 PRINT@26+6*32,;:M$=STR$(M+1):GOSUB5
1074 PRINT@26+13*32,;:M$=STR$(CH):GOSUB5
1079 GOSUB50:P(X,Y)=0:KE=0
1081 S=9:Z=0:Q=0
1082 REM ### GET DIRECTION ###
1083 A$=INKEY$:IFA$=""THEN1083
1084 S=ASC(A$):IFS=13ORS=82THEN7000
1085 V=(S=65)-(S=83):W=(S=87)-(S=90)
1100 IFV+W=0THEN1083
1110 A=P(X+V,Y+W):IFA>2THEN1150
1120 IFP(X+V+V,Y+W+W)<>0ANDA=1THEN1150
1130 P=Q:K=X:L=Y:GOSUB10:Q=0
1140 X=X+V:Y=Y+W:P=6:K=X:L=Y:GOSUB10
1145 IFA=2THENP=8:GOSUB10
1150 ONAGOSUB1160,1170,1180,1180,1200,,1190:IFZTHENRETURN
1155 GOTO1083
1160 IFP(X+V,Y+W)THENRETURN
1162 P=A:K=X+V:L=Y+W:GOSUB10
1163 P(X,Y)=0:P(X+V,Y+W)=1:RETURN
1170 Q=1:F=F-1
1173 IFF=0THENP=7:K=KX:L=KY:GOSUB10:P(KX,KY)=7
1175 P(X,Y)=1:RETURN
1180 RETURN
1190 P=7:K=9.4:L=5:GOSUB 10:K=X+V:L=Y+W:P=3:GOSUB10
1195 P(X+V,Y+W)=3:KE=1:RETURN
1199 REM ### HOME ###
1200 IFKE=0ORZ=1THENRETURN
1210 M=M+1:POKE49151,68:FORI=0TO2500:NEXT
1220 CLS0:POKE49151,4
1240 IFM<16THEN1000
1249 REM ### ALL CLEAR ###
1250 CLS0:POKE49151,4:C=1:P=6:K=5:L=3.5:GOSUB10
1260 FORI=0TO500:NEXT
1270 FORK=1TO4:C1=4:I=13:FORJ=6TO0STEP-1:PRINT@I+J*32,;:PRINTUL$;:FORZZ=1TOC1:PRINTUS$;:NEXT:PRINTUR$;
1272 PRINT@I+(15-J)*32,;:PRINTBL$;:FORZZ=1TOC1:PRINTBS$;:NEXT:PRINTBR$;
1274 FORZZ=I+J*32+32TOI+(15-J)*32-32STEP32:PRINT@ZZ,SL$;:PRINT@ZZ+C1+1,SR$;:NEXT:C1=C1+2:I=I-1:NEXT
1276 C1=4:I=13:FORJ=6TO0STEP-1:PRINT@I+J*32,;:PRINT"€";:FORZZ=1TOC1:PRINT"€";:NEXT:PRINT"€";
1278 PRINT@I+(15-J)*32,;:PRINT"€";:FORZZ=1TOC1:PRINT"€";:NEXT:PRINT"€";
1279 FORZZ=I+J*32+32TOI+(15-J)*32-32STEP32:PRINT@ZZ,"€";:PRINT@ZZ+C1+1,"€";:NEXT:C1=C1+2:I=I-1:NEXT
1290 NEXT
1300 P=6:K=5:L=3.5:GOSUB10
1310 FORL=4TO6.5STEP.5
1320 GOSUB10:PRINT@C1-32,"€€€";
1330 FORJ=0TO30:NEXT:NEXT:CLS0:POKE49151,0
1331 PRINT@13*32+15,"·¿»";
1332 PRINT@14*32+15,"©¯¦";
1333 PRINT@15*32+15,"¬ ¬";
1335 PRINT@0*32+8,"CONGRATULATIONS!";
1340 PRINT@3*32," AT LAST TOM ESCAPED THE BUILD-"
1341 PRINT@4*32,"ING AND RETURNED HOME."
1342 PRINT@5*32," BUT TOM'S HOUSE WAS BROKEN."
1343 PRINT@6*32," TOM DECIDED TO MAKE HIS HOUSE"
1344 PRINT@7*32,"AGAIN."
1345 PRINT@8*32," TOM HAD TO EARN MUCH MONEY..."
1400 O=0:M$="ICDCIABICIBGABAFGAABICDCIABICDGFEDCIBAGBICDCIABICIBGABAFGAABICDAGFEDCCIBIC":GOSUB1480
1410 M$="IBBBBEEBBICDCIBAAAAADDAAGABICDIBBBBEEBBICDCIBAAAAADDAABABAB":GOSUB1480
1420 M$="ICDCIABICIBGABAFGAABICDCIABICDGFEDCIBAGBICDCIABICIBGABAFGAAICDAGFEDCCIBIC":GOSUB1480
1470 GOTO1870
1480 FORZZ=1TOLEN(M$):C1=ASC(MID$(M$,ZZ,1))-64+O
1490 ONC1GOSUB1500,1510,1520,1530,1540,1550,1560,1570,1580,1600,1610,1620,1630,1640,1650,1660,1570,1580
1495 NEXT:RETURN
1500 SOUND87,3:RETURN
1510 SOUND103,3:RETURN
1520 SOUND113,3:RETURN
1530 SOUND129,3:RETURN
1540 SOUND142,3:RETURN
1550 SOUND149,3:RETURN
1560 SOUND161,3:RETURN
1570 FORC1=1TO25:NEXT:RETURN
1580 IFO=0THENO=9:RETURN
1590 O=0:RETURN
1600 SOUND171,3:RETURN
1610 SOUND181,3:RETURN
1620 SOUND185,3:RETURN
1630 SOUND189,3:RETURN
1640 SOUND200,3:RETURN
1650 SOUND203,3:RETURN
1660 SOUND209,3:RETURN
1870 PRINT@11*32+7,"this€game€is€over";
1880 GOTO1880
2999 REM ### EDITOR ###
3000 CLS0:GOSUB50
3045 FORZZ=0TO14:PRINT@27+ZZ*32,"€€€€€";:NEXT
3050 FORP=0TO6:K=9.8:L=P
3060 GOSUB10:PRINT@27+(P+P)*32,;:M$=CHR$(48+P):GOSUB6:NEXT
3080 PP=16384+L*64+K*3
3090 POKEPP,255-PEEK(PP)
3070 K=1:L=1
3100 A$=INKEY$:IFA$="E"ORA$=CHR$(13)THEN3300
3110 IFA$="A"ORA$="W"ORA$="S"ORA$="Z"THEN3200
3120 IFA$=" "ORA$>"/"ANDA$<"7"THEN3150
3130 IFA$<>"C"THEN3100
3140 FORK=1TO7
3142 FORL=1TO6:P(K,L)=0:NEXT
3144 P(K,0)=3:P(K,7)=3:NEXT
3146 FORL=0 TO 7:P(0,L)=3:P(8,L)=3:NEXT
3148 GOTO3000
3150 P=VAL(A$)
3155 IFP>=3ANDP<=5THEN3170
3160 IFK=0ORK=8ORL=0ORL=7THEN3100
3170 GOSUB10:P(K,L)=P:GOTO3090
3200 POKEPP,255-PEEK(PP):A=ASC(A$)
3210 K=K+(A=65ANDK>0)-(A=83ANDK<8):L=L+(A=87ANDL>0)-(A=90ANDL<7)
3220 GOTO3080
3299 REM ### EXIT EDITOR ###
3300 FORZZ=0TO14:PRINT@27+ZZ*32,"€€€€€";:NEXT
3305 POKE PP,255-PEEK(PP)
3310 PRINT@27,;:M$="CH":GOSUB6
3320 FF=0:KK=0:HH=0:MM=0:MI=0
3330 FORX=0TO8:FORY=0TO7
3340 ONP(X,Y)+1GOTO3390,3390,3350,3390,3360,3370,3380
3350 FF=FF+1:GOTO3390
3360 KK=KK+1:R(M,43)=Y*9+X:GOTO3390
3370 HH=HH+1:R(M,42)=Y*9+X:GOTO3390
3380 MM=MM+1
3390 NEXT:NEXT:K=9.4:L=1
3400 IFFF=0THENP=2:GOSUB3500
3410 IFKK-1THENP=4:GOSUB3500
3420 IFHH-1THENP=5:GOSUB3500
3430 IFMM-1THENP=6:GOSUB3500
3440 IFMITHENFORI=0TO2500:NEXT:GOTO3045
3450 PRINT@27+9*32,;:M$="OK":GOSUB6:FORZZ=1TO1000:NEXT
3470 A=0:FORY=1TO6:FORX=1TO7
3480 R(M,A)=P(X,Y):A=A+1
3490 NEXT:NEXT:GOTO300
3500 POKE49151,68:FORZZ=1TO150:NEXT:POKE49151,4:GOSUB10:L=L+1:MI=1:RETURN
3999 REM ### LOAD:SAVE ###
4000 B$="LOAD":IFH=5THENB$="SAVE"
4020 PRINT@3+7*32,;:M$="READY TO "+B$:GOSUB5:PRINT@13+9*32,;:M$="Y/N":GOSUB5
4040 A$=INKEY$:IFA$="N"THEN300
4050 IFA$<>"Y"THEN4040
4060 PRINT@7+12*32,;:M$="HIT ENTER":GOSUB5
4080 IFINKEY$<>CHR$(13)THEN4080
4085 CC=MC+7+14*32
4090 IFH=4THENM$="LOADING...":GOSUB5:CLOAD*R,"FRUITDAT":HM=R(15,44):GOTO300
4100 M$="SAVING...":GOSUB5:R(15,44)=HM:CSAVE*R,"FRUITDAT":GOTO300
4499 REM ### SETUP ###
4500 CLEAR500
4510 DIMP(8,7),R(15,44)
4520 GOSUB7200
4530 CLS0:POKE49151,4
4540 PRINT@4+32*5,;:M$="FRUIT PANIC":GOSUB5:FORC1=1TOLEN(AL$):A1$=A1$+CHR$(ASC(MID$(AL$,C1,1))+64):NEXT
4550 UL$="Ž":US$="Œ":UR$="":SL$="ª":SR$="•":BL$=CHR$(172):BS$="Œ":BR$="œ"
4560 GOSUB5000:GOTO300
4999 REM ### LOAD MAZES ###
5000 RESTORE:FORI=0TO30:READA:NEXT
5120 P=2:L=4:FORK=2TO7:GOSUB10:NEXT
5220 FORI=0TO15
5230 READA$:S=0
5240 FORJ=1TO42:A=VAL(MID$(A$,J,1)):S=S+A:R(I,J-1)=A:NEXT
5250 READR(I,42),R(I,43)
5260 S=S+R(I,42)+R(I,43)
5270 PRINT@32*8+I+6,"€€€";:PRINT@32*9+I+6,"€€€";
5280 READA:IFA=STHENNEXT:RETURN
5290 A=6000+I*30:CLS
5300 PRINT"DATA ERROR IN"A" -"A+20:PRINT:PRINT"LIST"A"-"A+20
5310 PRINT"SUM"S:END
5499 REM ### MAZE ###
6000 DATA 2,0,3,0,1,0,0,0,2,1,0,3,1,1,2,1,0,0,3,0,0,0,2,0,3,1,1,1,2,1,1
6020 DATA 010601030131030223020300333122030200001000,38,39,128
6030 DATA 030220003032320203020630303203030300201020,62,18,138
6060 DATA 000202011101111612120111012010201001302111,51,2,95
6090 DATA 002320020010023130313000300020212020123216,45,44,142
6120 DATA 111030601002200120111111210102201010220111,17,54,114
6150 DATA 111000020201111110200202611111102020200111,6,44,90
6180 DATA 220010003030130003000133323300222000022206,65,62,181
6210 DATA 001011011112016113001121220100100312010210,27,68,137
6240 DATA 610111020301001301010001301002202200220220,2,62,107
6270 DATA 102102011100101221111122001011101106001010,54,6,98
6300 DATA 001110001202102102012011111001020102012106,62,9,109
6330 DATA 103030131010130012100012321030121030001006,70,64,181
6360 DATA 000303022201112300161222311120301002030100,70,27,149
6390 DATA 611001010013100012012210301000332200103210,7,64,116
6420 DATA 002300211120100102111012321011101216002020,54,17,116
6450 DATA 200300022101121012201122212101101122206000,6,68,122
6999 REM ### OUT/GAME OVER ###
7000 CH=CH-1:IFCH>0THEN1000
7010 PRINT@3*32,"ŽŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒ";
7015 PRINT@4*32,;:M$="  GAME OVER  ":GOSUB6:PRINT@4*32,SL$;:PRINT@26+4*32,SR$;
7020 PRINT@5*32,CHR$(172)"ŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒŒœ";
7035 IFHM<MTHENHM=M
7050 FORI=0TO2500:NEXT:GOTO300
7200 F1$="€€€ÞöÊ˜Š¼¨¼üèüÇïÂÇÏÂÅÏ€‡‚€€€€€€"
7210 F2$="€€€ôÜàüÔè¨¼¼èüü”¼€§­¢€î€çíâ€€€€€€"
7220 AL$="€† »ª·‚µ‚·ˆ­ˆ— Ÿ ±¨½Š—¨‘€†€™€³€¦€¶€™ˆ›ª¯Š»¢»ˆ¿¢¾ ½ª®ª·¢¶ ®¢«‚¾ªºŠ»ª¾¨¼ªºˆ— µ «ª©¨¯ª¦¢¥ µ‚"
7230 AL$="€€€€€€€€€€€€€€€€€€€€€€€€€€€€€"+AL$
7240 TP(1)=8:TP(2)=5:TP(3)=3:TP(4)=2:TP(5)=4:TP(6)=1:RETURN
8000 REM <<<((((((III))))))>>>
8010 REM < FRUIT PANIC V1.1  >
8030 REM <    2005/8/6    I  >
8040 REM <<<((((((III))))))>>>
8050 REM http://p6ers.net/kaw/
8060 REM MC-10 EDITS J. GERRIE
